import{_,r as f,c as a,o as c,a as l,b as s,w as v,v as g,F as w,d as B,n as k,t as m,p as $,e as y,f as u,g as p}from"./index-DyKxGVLS.js";const P={data(){const t=f(a.contactList);return{onPhone:a.onPhone,contactorList:t,showAddOptions:!1}},methods:{genBotByPreset(){this.showAddOptions=!1,this.$router.push({name:"bot_preset"})},showChat(t){this.$route.name=="blank"||this.$route.name=="chat_view"?this.$router.push({name:"chat_view",params:{id:t}}):this.$route.name=="contactors"||this.$route.name=="profile_view"?this.$router.push({name:"profile_view",params:{id:t}}):this.$router.replace({name:"chat_view",params:{id:t}})},getId(t){let e=this.$route.params.id,n=t.id;return e==n?"active":t.priority==0?"important":""},genBlankBot(){const t={id:this.genFakeId(),name:a.default_model,activeModel:a.default_model,avatar:"/static/avatar/openai.png",title:"gpt",priority:1,options:{}};this.showAddOptions=!1,a.addConcator("openai",t)},startResize(t){this.isResizing=!0,this.startX=t.clientX,this.startWidth=this.$refs.friendlists.offsetWidth,document.addEventListener("mousemove",this.resize),document.addEventListener("mouseup",this.stopResize)},resize(t){if(this.isResizing){let e=this.startWidth+(t.clientX-this.startX);const n=500,d=176;e=e>n?n:e<d?d:e,this.$refs.friendlists.style.flexBasis=e+"px"}},stopResize(){this.isResizing=!1,document.removeEventListener("mousemove",this.resize),document.removeEventListener("mouseup",this.stopResize)},genFakeId(){const e=`1${Math.floor(1e3+Math.random()*9e3)}`;if(this.id){const n=Math.floor(1e3+Math.random()*9e3),d=`${this.id}${n}`;return parseInt(d)}else return parseInt(e)}},components:{},computed:{sortedList(){return[...this.contactorList].sort((t,e)=>e.priority-t.priority==-1?1:e.lastUpdate-t.lastUpdate)}},mounted(){this.contactorList.map(t=>{t.on("updateMessage",()=>{this.$forceUpdate()})})}},b=t=>($("data-v-e5b53247"),t=t(),y(),t),z={class:"upsidebar",id:"friends"},L=b(()=>s("div",{class:"search"},[s("i",{class:"iconfont sousuo listicon"}),s("input",{type:"text",id:"tosearch",placeholder:"搜索"})],-1)),I={class:"bu-add"},C={id:"add-options"},R={class:"people"},x=["onClick","id"],M={class:"avatar"},S=["src","alt"],N={class:"info"},A={class:"name"},O={class:"msginfo",id:"time"},W={class:"msginfo",id:"msgctt"};function E(t,e,n,d,r,i){return c(),l("div",{id:"friendlists",ref:"friendlists",class:k(r.onPhone?"mobile":"")},[s("div",z,[L,s("div",I,[s("button",{id:"addcont",onClick:e[0]||(e[0]=o=>r.showAddOptions=!r.showAddOptions)},"+"),v(s("div",C,[s("ul",null,[s("li",null,[s("button",{onClick:e[1]||(e[1]=(...o)=>i.genBlankBot&&i.genBlankBot(...o))},"新建空白Bot")]),s("li",null,[s("button",{onClick:e[2]||(e[2]=(...o)=>i.genBotByPreset&&i.genBotByPreset(...o))},"从预设新建Bot")])])],512),[[g,r.showAddOptions]])])]),s("div",R,[(c(!0),l(w,null,B(i.sortedList,(o,h)=>(c(),l("div",{onClick:T=>i.showChat(o.id),key:h,class:"lists",id:i.getId(o)},[s("div",M,[s("img",{src:o.avatar,alt:o.name},null,8,S)]),s("div",N,[s("div",A,m(o.name),1),s("div",O,m(o.getLastTime()),1),s("div",W,m(o.getMessageSummary()),1)])],8,x))),128))]),s("div",{class:"resizer",onMousedown:e[3]||(e[3]=(...o)=>i.startResize&&i.startResize(...o))},null,32)],2)}const F=_(P,[["render",E],["__scopeId","data-v-e5b53247"]]),X={data(){return console.log(a.onPhone),{onPhone:a.onPhone,client:a,pagePath:this.$route.path}},components:{friendlist:F},methods:{},mounted(){},computed:{},watch:{$route:function(t){this.pagePath=t.path}}},D={key:0,id:"main"},U={key:1,id:"main-mobile"},V={key:2,id:"main-mobile",class:"mobile-chat"};function H(t,e,n,d,r,i){const o=p("friendlist"),h=p("router-view");return r.onPhone?r.pagePath==="/"?(c(),l("div",U,[u(o)])):(c(),l("div",V,[u(h)])):(c(),l("div",D,[u(o),u(h)]))}const q=_(X,[["render",H]]);export{q as default};
