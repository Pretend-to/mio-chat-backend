var e=Object.defineProperty,t=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable,o=(t,a,s)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[a]=s,n=(e,n)=>{for(var i in n||(n={}))a.call(n,i)&&o(e,i,n[i]);if(t)for(var i of t(n))s.call(n,i)&&o(e,i,n[i]);return e},i=(e,t,a)=>new Promise(((s,o)=>{var n=e=>{try{l(a.next(e))}catch(t){o(t)}},i=e=>{try{l(a.throw(e))}catch(t){o(t)}},l=e=>e.done?s(e.value):Promise.resolve(e.value).then(n,i);l((a=a.apply(e,t)).next())}));import{_ as l,c,F as r,I as d,T as h,a as p,R as u,f as m,b as g,P as v}from"./components-D4WCFyhD.js";import{M as y,o as C,c as f,a as w,m as _,t as b,n as k,F as x,e as S,g as T,h as M,f as V,k as I,i as O,d as P,p as $,b as D,q as L,s as E,E as R,l as j,u as A,x as H,y as U,w as B,j as W,z}from"./vue-vendor-cI-vLX1f.js";import{h as F,_ as q}from"./vendor-Ce7tLmFI.js";import"./emoji-Cgk9UKZt.js";const K={data(){const e=parseInt(this.$route.params.id);return{activeContactor:c.getContactor(e),showwindow:!0,showemoji:!1,userInput:"",todld:!1,client:c,extraOptions:[],wraperPresets:{},cursorPosition:[],selectedWraper:null,currentDelay:0,toupdate:!1,ydaKey:0,showMenu:!1,menuTop:0,menuLeft:0,longPressTimer:null,validMessageIndex:-1,repliedMessage:null,autoScroll:!1,fullScreen:!1}},methods:{toButtom(e){e&&this.$message("已滑至底部");const t=this.$refs.chatWindow;setTimeout((()=>t.scrollTop=t.scrollHeight),0)},cleanScreen(){this.activeContactor.messageChain=[],this.activeContactor.updateFirstMessage(),c.setLocalStorage(),this.activeContactor.emit("updateMessageSummary"),this.toupdate=!0,this.$message({message:"已清除会话记录",type:"success"})},cleanHistory(){this.activeContactor.updateFirstMessage(),this.$message({message:"上下文信息已清除，之后的请求将不再记录上文记录",type:"success"})},isValidInput:e=>!/^[ \n]+$/.test(e),waiting(){this.$message({message:"此功能尚未开放",type:"warning"})},tolist(){this.$router.push({name:"home"})},setModel(e){return i(this,null,(function*(){this.activeContactor.options.model=e,this.activeContactor.title=e,this.activeContactor.loadAvatar(),yield c.setLocalStorage()}))},toimg(){const e=this.$refs.chatWindow.getBoundingClientRect();e.height=this.$refs.chatWindow.scrollHeight,F(this.$refs.chatWindow,{windowHeight:1.2*e.height,width:e.width}).then((e=>{const t=e.toDataURL("image/png"),a=document.createElement("a");a.download="chat.png",a.href=t,a.click()}))},hasOpening(){return!!this.activeContactor.options.opening},getFullMessages(){return this.hasOpening()?[{role:"other",content:[{type:"text",data:{text:this.activeContactor.options.opening}}],time:this.activeContactor.createTime},...this.activeContactor.messageChain]:this.activeContactor.messageChain},showTime(e){const t=this.getFullMessages(),a=t[e].time;if(0===e)return{show:!0,time:this.activeContactor.getShownTime(a)};return a-t[e-1].time>6e5?{show:!0,time:this.activeContactor.getShownTime(a)}:{show:!1,time:""}},separateTextAndImages(e){const t=/!\[([^\]]*)\]\((.*)\)/g;let a,s=[],o=0;for(;null!==(a=t.exec(e));){if(a.index>o){const t=e.slice(o,a.index).trim();t&&s.push({type:"text",data:{text:t}})}s.push({type:"image",data:{file:a[2]}}),o=t.lastIndex}if(o<e.length){const t=e.slice(o).trim();t&&s.push({type:"text",data:{text:t}})}return s},getChatwindowScrollheight(){var e=this.$refs.chatWindow.scrollTop,t=this.$refs.chatWindow.clientHeight,a=this.$refs.chatWindow.scrollHeight;return a-e/(a-t)*a},initContactor(e){e.active=!0,e.on("revMessage",(e=>{this.activeContactor.messageChain.push(e),this.toupdate=!0})),e.on("delMessage",(e=>{this.activeContactor.messageChain.splice(e,1),this.toupdate=!0})),e.on("updateMessage",(()=>{this.$forceUpdate(),this.toupdate=!0})),e.on("completeMessage",(e=>i(this,null,(function*(){const t=e.index,a=this.activeContactor.messageChain[t];a.status="completed",e.error?a.content=[{type:"text",data:{text:e.text}}]:a.content.forEach(((e,t)=>{if("text"===e.type&&"onebot"===this.activeContactor.platform){const s=this.separateTextAndImages(e.data.text);a.content.splice(t,1,...s)}})),this.$forceUpdate(),this.toupdate=!0,yield this.activeContactor.loadName(),yield c.setLocalStorage()}))))},disableContactor(e){e.active=!1,e.off("updateMessage"),e.off("revMessage"),e.off("delMessage"),e.off("completeMessage")},getReplyText(e){let t="";const a=this.activeContactor.messageChain.find((t=>t.id===e));if(a)return a.content.forEach((e=>{"text"===e.type?t+=e.data.text:"image"===e.type&&(t+="[图片]")})),t.length>20?`> ${t.substr(0,20)}...`:`> ${t}`},showMessageMenu(e,t){this.validMessageIndex="openai"===this.activeContactor.platform&&this.hasOpening()?t-1:t,e.preventDefault(),this.showMenu=!0,this.menuTop=e.clientY,this.menuLeft=e.clientX},messageMenuClick(e){switch(e){case"copy":{let e="";this.activeContactor.messageChain[this.validMessageIndex].content.forEach((t=>{"text"===t.type?e+=t.data.text:"image"===t.type&&(e+="[图片]")}));const a=document.createElement("textarea");a.style.position="absolute",a.style.left="-9999px",a.value=e,document.body.appendChild(a),a.select(),a.setSelectionRange(0,99999);try{document.execCommand("copy"),this.$message({message:"复制成功",type:"success"})}catch(t){}finally{document.body.removeChild(a)}break}case"reply":"onebot"===this.activeContactor.platform?(this.repliedMessage=this.activeContactor.messageChain[this.validMessageIndex],this.$message({message:"已引用该消息",type:"success"})):this.userInput+=this.getReplyText(this.activeContactor.messageChain[this.validMessageIndex].id)+"\n\n";break;case"delete":this.activeContactor.platform,this.activeContactor.messageChain.splice(this.validMessageIndex,1),this.showMenu=!1}this.showMenu=!1},scrollHandler(){this.showMenu=!1,this.showemoji&&(this.showemoji=!1);const e=this.getChatwindowScrollheight();this.autoScroll=!(e>300)}},mounted(){document.addEventListener("click",(()=>{this.showMenu=!1})),this.$refs.chatWindow.addEventListener("scroll",this.scrollHandler),this.toButtom();const e=this.$route.params.id,t=c.getContactor(e);this.initContactor(t),this.fullScreen=this.client.fullScreen,setInterval((()=>{this.currentDelay=this.client.socket.delay}),3e3)},updated(){this.toupdate&&this.autoScroll&&(this.toButtom(),this.toupdate=!1)},beforeUnmount(){this.disableContactor(this.activeContactor),this.$refs.chatWindow.removeEventListener("scroll",this.scrollHandler)},computed:{getDelayStatus(){return this.currentDelay>1e3?"high":this.currentDelay>500?"mid":this.currentDelay>100?"low":"ultra"},activeMessageChain(){return this.activeContactor.options.opening?[{role:"other",content:[{type:"text",data:{text:this.activeContactor.options.opening}}],time:this.activeContactor.createTime},...this.activeContactor.messageChain]:this.activeContactor.messageChain}},components:{MdPreview:y,ForwardMsg:r,InputEditor:d,ToolCallBar:h,FileBlock:p,ReasonBlock:u},watch:{"$route.params.id"(e,t){const a=parseInt(e),s=c.getContactor(a);if(this.activeContactor=s,this.initContactor(this.activeContactor),this.toButtom(),t){const e=parseInt(t),a=c.getContactor(e);this.disableContactor(a)}}}},G=e=>($("data-v-b1d2a571"),e=e(),D(),e),N={id:"chat-window"},X={class:"upside-bar"},Y=[G((()=>w("i",{class:"iconfont icon-return"},null,-1)))],Z={class:"delay-num"},J={class:"options"},Q=[G((()=>w("i",{class:"iconfont icon-share"},null,-1)))],ee={class:"message-window",ref:"chatWindow"},te={key:0,class:"message-time"},ae=["id"],se={key:0,class:"avatar"},oe=["src","alt"],ne=["src","alt"],ie={key:1,class:"msg"},le={class:"wholename"},ce={key:0,class:"title"},re={class:"name"},de=["onContextmenu"],he={key:6,class:"blank-message",style:{width:"10rem",height:"28.8px",position:"relative"}},pe=[G((()=>w("span",{class:"blank_loader"},null,-1)))],ue=[G((()=>w("i",{class:"iconfont fuzhi"},null,-1))),G((()=>w("span",null,"复制",-1)))],me=[G((()=>w("i",{class:"iconfont yinyong"},null,-1))),G((()=>w("span",null,"引用",-1)))],ge=[G((()=>w("i",{class:"iconfont shanchu"},null,-1))),G((()=>w("span",null,"删除",-1)))],ve={key:2,class:"system-message"};const ye=l(K,[["render",function(e,t,a,s,o,n){const i=P("MdPreview"),l=P("el-image"),c=P("ForwardMsg"),r=P("FileBlock"),d=P("ReasonBlock"),h=P("ToolCallBar"),p=P("InputEditor");return C(),f("div",N,[w("div",X,[w("div",{class:"return",onClick:t[0]||(t[0]=e=>n.tolist())},Y),w("div",{onClick:t[1]||(t[1]=t=>e.$router.push(`/profile/${o.activeContactor.id}`)),class:"name-area"},[_(b(o.activeContactor.name)+" ",1),w("span",{class:k("delay-status "+n.getDelayStatus)},null,2),w("span",Z,"当前延迟: "+b(o.currentDelay)+" ms",1)]),w("div",J,[w("div",{class:"share",onClick:t[2]||(t[2]=e=>n.toimg())},Q)])]),w("div",ee,[(C(!0),f(x,null,S(n.activeMessageChain,((a,s)=>(C(),f("div",{key:s,class:"message-container",ref_for:!0,ref:"message"},[n.showTime(s).show?(C(),f("div",te,b(n.showTime(s).time),1)):T("",!0),w("div",{class:"message-body",id:a.role},["mio_system"!==a.role?(C(),f("div",se,["other"===a.role?(C(),f("img",{key:0,onClick:t[3]||(t[3]=t=>e.$router.push(`/profile/${o.activeContactor.id}`)),src:o.activeContactor.avatar,alt:o.activeContactor.name},null,8,oe)):(C(),f("img",{key:1,src:o.client.avatar,alt:o.client.name},null,8,ne))])):T("",!0),"mio_system"!==a.role?(C(),f("div",ie,[w("div",le,[("other"===a.role?o.activeContactor.title:o.client.title)?(C(),f("div",ce,b("other"===a.role?o.activeContactor.title:o.client.title),1)):T("",!0),w("div",re,b("other"===a.role?o.activeContactor.name:o.client.name),1)]),w("div",{class:"content",onContextmenu:M((e=>n.showMessageMenu(e,s)),["self"])},[(C(!0),f(x,null,S(a.content,((e,t)=>(C(),f("div",{class:"inner-content",key:t},["text"===e.type?(C(),V(i,{key:0,noImgZoomIn:!1,previewTheme:"github",editorId:`previewer-${t}`,modelValue:e.data.text},null,8,["editorId","modelValue"])):"image"===e.type?(C(),V(l,{style:{"max-width":"20rem"},src:e.data.file,"zoom-rate":1.2,"max-scale":7,"min-scale":.2,"preview-src-list":[e.data.file],"initial-index":4,key:t,fit:"cover"},null,8,["src","preview-src-list"])):"reply"===e.type?(C(),V(i,{key:2,previewTheme:"github",editorId:`previewer-${t}`,modelValue:n.getReplyText(e.data.id)},null,8,["editorId","modelValue"])):"nodes"===e.type?(C(),V(c,{key:3,contactor:o.activeContactor,messages:e.data.messages},null,8,["contactor","messages"])):"file"===e.type?(C(),V(r,{key:4,file_url:e.data.file},null,8,["file_url"])):"reason"===e.type?(C(),V(d,{key:5,finished:e.data.finished,content:e.data.text},null,8,["finished","content"])):"blank"===e.type?(C(),f("div",he,pe)):"tool_call"===e.type?(C(),V(h,{key:7,tool_call:e.data},null,8,["tool_call"])):(C(),V(i,{key:8,previewTheme:"github",editorId:`previewer-${t}`,modelValue:"未知的消息类型：\n```\n"+e+"\n```"},null,8,["editorId","modelValue"]))])))),128))],40,de),o.showMenu&&o.validMessageIndex===s?(C(),f("div",{key:0,id:"message-menu",style:I({top:o.menuTop+"px",left:o.menuLeft+"px"})},[w("div",{onClick:t[4]||(t[4]=e=>n.messageMenuClick("copy"))},ue),w("div",{onClick:t[5]||(t[5]=e=>n.messageMenuClick("reply"))},me),w("div",{onClick:t[6]||(t[6]=e=>n.messageMenuClick("delete"))},ge)],4)):T("",!0)])):(C(),f("div",ve,b(a.content[0].data.text),1))],8,ae)])))),128))],512),O(p,{ref:"inputEditor",activeContactor:o.activeContactor,onStroge:t[7]||(t[7]=e=>o.client.setLocalStorage()),onSetModel:n.setModel,onCleanScreen:n.cleanScreen,onCleanHistory:n.cleanHistory,onSendMessage:n.toButtom},null,8,["activeContactor","onSetModel","onCleanScreen","onCleanHistory","onSendMessage"])])}],["__scopeId","data-v-b1d2a571"]]),Ce=L({history:E("/"),routes:[{path:"/",name:"home",component:()=>q((()=>Promise.resolve().then((()=>ke))),void 0),children:[{path:"/",name:"blank",component:()=>q((()=>Promise.resolve().then((()=>Ve))),void 0)},{path:"/contactors",name:"contactors",component:()=>q((()=>Promise.resolve().then((()=>Ve))),void 0)},{path:"/chat/:id",name:"chat_view",component:ye},{path:"/profile/:id",name:"profile_view",component:()=>q((()=>Promise.resolve().then((()=>mt))),void 0)}]},{path:"/auth",name:"auth",component:()=>q((()=>Promise.resolve().then((()=>kt))),void 0)},{path:"/settings",name:"settings",component:()=>q((()=>Promise.resolve().then((()=>Tt))),void 0)}]});Ce.beforeEach((e=>i(void 0,null,(function*(){let t=c.everLogin;if(t||(t=yield c.getLoginHistory()),!t&&"auth"!==e.name&&"settings"!==e.name)return R.warning("请先登录"),{name:"auth"}}))));const fe={key:0,id:"main"},we={key:1,id:"main-mobile"},_e={key:2,id:"main-mobile",class:"mobile-chat"};const be=l({data(){return{onPhone:window.innerWidth<600,pagePath:this.$route.path}},components:{friendlist:m},watch:{$route:function(e){this.pagePath=e.path}}},[["render",function(e,t,a,s,o,n){const i=P("friendlist"),l=P("router-view");return o.onPhone?"/"===o.pagePath?(C(),f("div",we,[O(i)])):(C(),f("div",_e,[O(l)])):(C(),f("div",fe,[O(i),O(l)]))}]]),ke=Object.freeze(Object.defineProperty({__proto__:null,default:be},Symbol.toStringTag,{value:"Module"})),xe={name:"BlankView",data:()=>({fullScreen:!1,client:c}),created(){this.fullScreen=c.fullScreen},methods:{waiting(){this.$message({message:"此功能尚未开放",type:"warning"})}},watch:{}},Se={class:"blank-view"},Te=[(e=>($("data-v-649f11a7"),e=e(),D(),e))((()=>w("div",{class:"upside-bar"},[w("div",{class:"options"})],-1)))];const Me=l(xe,[["render",function(e,t,a,s,o,n){return C(),f("div",Se,Te)}],["__scopeId","data-v-649f11a7"]]),Ve=Object.freeze(Object.defineProperty({__proto__:null,default:Me},Symbol.toStringTag,{value:"Module"})),Ie={data(){const e=parseInt(this.$route.params.id),t=c.getContactor(e);return{activeContactor:t,openaiSettings:this.getShownOpenAISettings(t.options),currentDelay:0,centerDialogVisible:!1,sliderTypeARange:[0,2,.1],sliderTypeBRange:[0,1,.1],sliderTypeCRange:[-2,2,.1],showPresetsDetail:!1,showToolsDetail:!1,presetHistory:t.options.history,openaiTools:g.openaiTools,toolsList:[]}},components:{PresetsList:v},mounted(){this.initContactor(),setInterval((()=>{this.currentDelay=c.socket.delay}),3e3)},computed:{getDelayStatus(){return this.currentDelay>1e3?"high":this.currentDelay>500?"mid":this.currentDelay>100?"low":"ultra"}},watch:{"$route.params.id"(e){this.activeContactor=c.getContactor(e),this.initContactor()}},methods:{handleToolConfig(){this.activeContactor.options.tools=this.toolsList.map((e=>e.enabled?e.name:void 0)),c.setLocalStorage()},initContactor(){"openai"==this.activeContactor.platform&&(this.openaiSettings=this.getShownOpenAISettings(this.activeContactor.options),this.presetHistory=[...this.activeContactor.options.history],this.loadToolsList())},loadToolsList(){const e=this.activeContactor.options.tools;this.toolsList=this.openaiTools.map((t=>({name:t.name,description:t.description,enabled:e.includes(t.name)})))},updateOpenaiPresets(e){this.activeContactor.setOpenaiPresets(e),c.setLocalStorage()},updateOpenaiOptions(){this.activeContactor.options=n(n({},this.activeContactor.options),this.openaiSettings),c.setLocalStorage()},getShownOpenAISettings(e){const t={};return["model","max_messages_num","stream","enable_tool_call","temperature","top_p","frequency_penalty","presence_penalty"].map((a=>{t[a]=e[a]})),t},getShownKey:e=>({enable_tool_call:"工具调用",model:"模型",max_messages_num:"最大历史消息数",stream:"流式响应",temperature:"温度 (temperature)",top_p:"核采样 (top_p)",frequency_penalty:"频率惩罚度 (frequency_penalty)",presence_penalty:"话题新鲜度 (presence_penalty)"}[e]),delContactor(){this.centerDialogVisible=!1,c.rmContactor(this.activeContactor.id),this.$router.push("/contactors")}}},Oe=e=>($("data-v-0a768191"),e=e(),D(),e),Pe={class:"profile-body"},$e={id:"profile"},De={class:"profile-container"},Le={class:"base-info"},Ee={class:"base-info-avatar"},Re=["src"],je={class:"base-info-content"},Ae={class:"name"},He={class:"id"},Ue={class:"status"},Be={class:"info-blocks"},We={key:0,class:"openai-settings"},ze=Oe((()=>w("div",{class:"block-title"},"OpenAI 基本配置",-1))),Fe={class:"block-content"},qe={class:"item-title"},Ke={class:"item-content"},Ge=Oe((()=>w("div",{class:"block-title"},"OpenAI 预设配置",-1))),Ne={class:"block-content"},Xe={class:"block-content-item"},Ye=Oe((()=>w("div",{class:"item-title"},"预设历史记录",-1))),Ze={class:"item-content"},Je=[Oe((()=>w("svg",{t:"1731677922196",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5948",width:"16",height:"16"},[w("path",{d:"M778.965749 128.759549l-383.064442 383.063419 388.097062 388.096039-0.070608 0.033769c12.709463 13.137205 20.529569 31.024597 20.529569 50.731428 0 40.376593-32.736589 73.112158-73.115228 73.112158-19.705807 0-37.591153-7.819083-50.730405-20.528546l-0.034792 0.035816L241.890654 564.622498l0.035816-0.035816c-13.779841-13.281491-22.3838-31.915897-22.3838-52.585659 0-0.071631 0-0.106424 0-0.178055 0-0.072655 0-0.10847 0-0.144286 0-20.669762 8.603959-39.341007 22.3838-52.622498l-0.035816-0.034792L680.573835 20.337187l0.180102 0.179079c13.139252-12.5662 30.950919-20.313651 50.587142-20.313651 40.378639 0 73.115228 32.736589 73.115228 73.114205C804.455283 95.485725 794.567076 115.334795 778.965749 128.759549z","p-id":"5949"})],-1)))],Qe=Oe((()=>w("div",{class:"block-title"},"OpenAI 工具配置",-1))),et={class:"block-content"},tt={class:"block-content-item"},at=Oe((()=>w("div",{class:"item-title"},"工具函数列表",-1))),st={class:"item-content"},ot=[Oe((()=>w("svg",{t:"1731677922196",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5948",width:"16",height:"16"},[w("path",{d:"M778.965749 128.759549l-383.064442 383.063419 388.097062 388.096039-0.070608 0.033769c12.709463 13.137205 20.529569 31.024597 20.529569 50.731428 0 40.376593-32.736589 73.112158-73.115228 73.112158-19.705807 0-37.591153-7.819083-50.730405-20.528546l-0.034792 0.035816L241.890654 564.622498l0.035816-0.035816c-13.779841-13.281491-22.3838-31.915897-22.3838-52.585659 0-0.071631 0-0.106424 0-0.178055 0-0.072655 0-0.10847 0-0.144286 0-20.669762 8.603959-39.341007 22.3838-52.622498l-0.035816-0.034792L680.573835 20.337187l0.180102 0.179079c13.139252-12.5662 30.950919-20.313651 50.587142-20.313651 40.378639 0 73.115228 32.736589 73.115228 73.114205C804.455283 95.485725 794.567076 115.334795 778.965749 128.759549z","p-id":"5949"})],-1)))],nt={id:"tools-list"},it=["title"],lt={class:"item-title"},ct={class:"item-content"},rt=Oe((()=>w("div",{class:"extra-info"},null,-1))),dt={class:"action-bar"},ht=Oe((()=>w("span",null," 确认要删除此好友吗？该操作不可逆。 ",-1))),pt={class:"dialog-footer"};const ut=l(Ie,[["render",function(e,t,a,s,o,n){const i=P("el-input"),l=P("el-switch"),c=P("el-slider"),r=P("PresetsList"),d=P("el-button"),h=P("el-dialog");return C(),f("div",Pe,[w("div",$e,[w("div",De,[w("div",Le,[w("div",Ee,[w("img",{src:o.activeContactor.avatar},null,8,Re)]),w("div",je,[w("div",Ae,b(o.activeContactor.name),1),w("div",He,"ID "+b(o.activeContactor.id),1),w("div",Ue,[w("span",{class:k("delay-status "+n.getDelayStatus)},null,2),_(" 在线 ")])])]),w("div",Be,["openai"==o.activeContactor.platform?(C(),f("div",We,[ze,w("div",Fe,[(C(!0),f(x,null,S(o.openaiSettings,((e,t)=>(C(),f("div",{key:t,class:"block-content-item"},[w("div",qe,b(n.getShownKey(t)),1),w("div",Ke,[["model","max_messages_num"].includes(t)?(C(),V(i,{key:0,onChange:n.updateOpenaiOptions,modelValue:o.openaiSettings[t],"onUpdate:modelValue":e=>o.openaiSettings[t]=e},null,8,["onChange","modelValue","onUpdate:modelValue"])):["stream","enable_tool_call"].includes(t)?(C(),V(l,{key:1,onChange:n.updateOpenaiOptions,modelValue:o.openaiSettings[t],"onUpdate:modelValue":e=>o.openaiSettings[t]=e},null,8,["onChange","modelValue","onUpdate:modelValue"])):["temperature"].includes(t)?(C(),V(c,{key:2,onChange:n.updateOpenaiOptions,modelValue:o.openaiSettings[t],"onUpdate:modelValue":e=>o.openaiSettings[t]=e,step:o.sliderTypeARange[2],min:o.sliderTypeARange[0],max:o.sliderTypeARange[1]},null,8,["onChange","modelValue","onUpdate:modelValue","step","min","max"])):["top_p"].includes(t)?(C(),V(c,{key:3,onChange:n.updateOpenaiOptions,modelValue:o.openaiSettings[t],"onUpdate:modelValue":e=>o.openaiSettings[t]=e,step:o.sliderTypeBRange[2],min:o.sliderTypeBRange[0],max:o.sliderTypeBRange[1]},null,8,["onChange","modelValue","onUpdate:modelValue","step","min","max"])):["frequency_penalty","presence_penalty"].includes(t)?(C(),V(c,{key:4,onChange:n.updateOpenaiOptions,modelValue:o.openaiSettings[t],"onUpdate:modelValue":e=>o.openaiSettings[t]=e,step:o.sliderTypeCRange[2],min:o.sliderTypeCRange[0],max:o.sliderTypeCRange[1]},null,8,["onChange","modelValue","onUpdate:modelValue","step","min","max"])):T("",!0)])])))),128))]),Ge,w("div",Ne,[w("div",Xe,[Ye,w("div",Ze,[w("button",{class:k({active:o.showPresetsDetail,"extra-info-button":!0}),onClick:t[0]||(t[0]=e=>o.showPresetsDetail=!o.showPresetsDetail)},Je,2)])]),w("div",{class:k({hidden:!o.showPresetsDetail,"block-content-item":!0})},[O(r,{onUpdatePresetsHistory:n.updateOpenaiPresets,presetsHistory:o.presetHistory},null,8,["onUpdatePresetsHistory","presetsHistory"])],2)]),Qe,w("div",et,[w("div",tt,[at,w("div",st,[w("button",{class:k({active:o.showToolsDetail,"extra-info-button":!0}),onClick:t[1]||(t[1]=e=>o.showToolsDetail=!o.showToolsDetail)},ot,2)])]),w("div",{class:k({hidden:!o.showToolsDetail,"block-content-item":!0})},[w("ul",nt,[(C(!0),f(x,null,S(o.toolsList,((e,t)=>(C(),f("li",{class:"block-content-item",title:e.description,key:t},[w("div",lt,b(e.name),1),w("div",ct,[O(l,{onChange:n.handleToolConfig,modelValue:e.enabled,"onUpdate:modelValue":t=>e.enabled=t},null,8,["onChange","modelValue","onUpdate:modelValue"])])],8,it)))),128))])],2)])])):T("",!0)]),rt])]),w("div",dt,[O(d,{onClick:t[2]||(t[2]=t=>e.$router.push(`/chat/${o.activeContactor.id}`)),type:"primary"},{default:j((()=>[_("发送消息")])),_:1}),O(d,{onClick:t[3]||(t[3]=e=>o.centerDialogVisible=!0),type:"danger"},{default:j((()=>[_("删除好友")])),_:1}),O(h,{modelValue:o.centerDialogVisible,"onUpdate:modelValue":t[5]||(t[5]=e=>o.centerDialogVisible=e),title:"警告",width:"300",center:""},{footer:j((()=>[w("div",pt,[O(d,{onClick:t[4]||(t[4]=e=>o.centerDialogVisible=!1)},{default:j((()=>[_("取消")])),_:1}),O(d,{type:"primary",onClick:n.delContactor},{default:j((()=>[_(" 确认 ")])),_:1},8,["onClick"])])])),default:j((()=>[ht])),_:1},8,["modelValue"])])])}],["__scopeId","data-v-0a768191"]]),mt=Object.freeze(Object.defineProperty({__proto__:null,default:ut},Symbol.toStringTag,{value:"Module"})),gt=e=>($("data-v-040a123a"),e=e(),D(),e),vt={class:"auth-view"},yt={class:"container"},Ct=[gt((()=>w("i",{class:"iconfont ChatGPT"},null,-1)))],ft=gt((()=>w("h1",{class:"title"},"登录验证",-1))),wt=gt((()=>w("p",{class:"hint"},"管理员开启了密码验证，请在下方填入访问码",-1))),_t={class:"controls"},bt=l({__name:"AuthView",setup(e){const t=A(),a=A(!1),s=A(),o=e=>i(this,null,(function*(){if(yield z((()=>s.value.classList.add("active"))),!a.value){a.value=!0;try{const t=yield c.login(e);t&&(R.success(`成功以${t.is_admin?"管理员身份":"游客身份"}登录，欢迎使用!`),yield Ce.push("/"))}catch(t){R.error(t)}a.value=!1}}));function n(e){"Enter"===e.key&&o(t.value)}return H((()=>{removeEventListener("keydown",n)})),U((()=>{addEventListener("keydown",n)})),(e,a)=>(C(),f("div",vt,[w("div",yt,[w("div",{class:"icon-container",ref_key:"iconContainer",ref:s},Ct,512),ft,wt,B(w("input",{type:"password","onUpdate:modelValue":a[0]||(a[0]=e=>t.value=e),placeholder:"在此处填写访问码"},null,512),[[W,t.value]]),w("div",_t,[w("button",{class:"later",onClick:a[1]||(a[1]=e=>o())},"游客登录"),w("button",{class:"login",onClick:a[2]||(a[2]=e=>o(t.value))},"Login")])])]))}},[["__scopeId","data-v-040a123a"]]),kt=Object.freeze(Object.defineProperty({__proto__:null,default:bt},Symbol.toStringTag,{value:"Module"})),xt={id:"settings-view"};const St=l({name:"SettingsView",data:()=>({}),methods:{reset(){this.$router.push("/auth"),setTimeout((()=>{c.reset()}),50)}}},[["render",function(e,t,a,s,o,n){const i=P("el-button");return C(),f("div",xt,[O(i,{onClick:t[0]||(t[0]=e=>n.reset()),type:"info",plain:""},{default:j((()=>[_("点我重置")])),_:1})])}],["__scopeId","data-v-13ebcf8e"]]),Tt=Object.freeze(Object.defineProperty({__proto__:null,default:St},Symbol.toStringTag,{value:"Module"}));export{Ce as r};
