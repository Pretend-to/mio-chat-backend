{"version":3,"file":"index-u0WLNUqJ.js","sources":["../../../src/App.vue","../../../src/main.js"],"sourcesContent":["<script>\nimport { client, config } from \"@/lib/runtime.js\";\nimport sideBar from \"@/components/SideBar.vue\";\nimport displayButtons from \"./components/DisplayButtons.vue\";\nexport default {\n  components: {\n    sideBar,\n    displayButtons,\n  },\n  data() {\n    const displayConfig = config.getBaseConfig();\n    const onPhone = window.innerWidth < 600;\n    return {\n      onPhone,\n      client: client,\n      fullScreen: displayConfig?.full_screen || false,\n      beian: displayConfig?.beian || \"\",\n      isTauri: !!(window.__TAURI__ || window.__TAURI_INTERNALS__),\n    };\n  },\n  computed: {\n    onPrivate() {\n      return (\n        this.$route.path.includes(\"/auth\") ||\n        this.$route.path.includes(\"/profile\") ||\n        this.$route.path.includes(\"/chat\")\n      );\n    },\n  },\n  created() {\n    const displayConfig = config.getBaseConfig();\n    if (Object.keys(displayConfig).length > 0) {\n      this.fullScreen = displayConfig.full_screen;\n      this.beian = displayConfig.beian;\n      document.title = displayConfig.title;\n    } else {\n      config.setBaseConfigCallback((data) => {\n        this.fullScreen = data.full_screen;\n        this.beian = data.beian;\n        document.title = data.title;\n      });\n    }\n\n    window.addEventListener(\"resize\", this.handleResize);\n  },\n  beforeUnmount() {\n    window.removeEventListener(\"resize\", this.handleResize);\n  },\n  methods: {\n    setWindowSize(fullScreen) {\n      this.fullScreen = fullScreen;\n      config.updateBaseConfig({\n        full_screen: fullScreen,\n      });\n    },\n    handleResize() {\n      this.onPhone = window.innerWidth < 600;\n    },\n    closeApp() {\n      this.$message({\n        message: \"浏览器端暂不支持关闭\",\n        type: \"warning\",\n      });\n    }\n  },\n};\n</script>\n<template>\n  <div id=\"mio-chat\" :class=\"{ browser: !isTauri }\">\n    <div v-if=\"onPhone\" class=\"app-mobile\">\n      <router-view></router-view>\n      <sideBar v-if=\"!onPrivate\"></sideBar>\n    </div>\n    <div\n      v-else\n      class=\"app-desktop\"\n      :class=\"{ fullscreen: fullScreen || isTauri }\"\n    >\n      <displayButtons :full-screen @close=\"closeApp\" @set-screen=\"setWindowSize\"></displayButtons>\n      <sideBar></sideBar>\n      <router-view></router-view>\n    </div>\n  </div>\n  <a\n    v-if=\"beian\"\n    id=\"beian\"\n    href=\"https://beian.miit.gov.cn/\"\n    target=\"_blank\"\n    >{{ beian }}</a\n  >\n</template>\n<style scoped>\n#mio-chat {\n  width: 100%;\n  height: 100%;\n  position: relative;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  background-size: cover;\n  background-position: center;\n  background-repeat: no-repeat;\n}\n#mio-chat.browser {\n  background-image: url(/static/background/default.png);\n}\n#mio-chat.browser::before {\n  content: \"\";\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  background-color: rgba(0, 0, 0, 0.5);\n  /* 黑色蒙版，可调整透明度 */\n}\n.app-desktop {\n  position: relative;\n  width: 60rem;\n  height: 85%;\n  min-height: 30rem;\n  z-index: 1;\n  box-shadow: 0px 0px 10px 0px rgba(0, 0, 0, 0.5);\n  border-radius: 1rem;\n  display: flex;\n  overflow: hidden;\n  margin: 5rem 5rem;\n  min-width: 35rem;\n}\n.app-desktop.fullscreen {\n  width: 100%;\n  height: 100%;\n  border-radius: 0rem;\n  margin: 0rem;\n}\n.app-mobile {\n  width: 100%;\n  height: 100%;\n  z-index: 1;\n  box-shadow: 0px 0px 10px 0px rgba(0, 0, 0, 0.5);\n  border-radius: 0;\n  display: flex;\n  flex-direction: column;\n  overflow: hidden;\n  margin: 0;\n}\na#beian {\n  position: fixed;\n  bottom: 1rem;\n  right: 50%;\n  transform: translateX(50%);\n  font-size: 0.8rem;\n  color: #fff;\n  text-decoration: none;\n}\n@media (min-width: 1024px) {\n}\n</style>\n","/**\n * @author Mio-FCIP <1099834705@qq.com>\n * @lastEditor 彭志勇 <2457305628@qq.com>\n * @lastEditTime 2024-04-25 06:25:30\n */\n\nimport \"./assets/global.sass\";\nimport \"element-plus/dist/index.css\";\nimport \"md-editor-v3/lib/style.css\";\nimport \"mio-previewer/style.css\";\nimport \"./assets/mio.css\";\n\nimport { createApp } from \"vue\";\n\nimport ElementPlus from \"element-plus\";\n\nimport App from \"./App.vue\";\nimport router from \"./router\";\n\nconst app = createApp(App);\n\napp.use(ElementPlus);\napp.use(router);\n\napp.mount(\"#app\");\n\n// 注册 Service Worker\nif (\"serviceWorker\" in navigator) {\n  window.addEventListener(\"load\", () => {\n    navigator.serviceWorker\n      .register(\"/service-worker.v4.js\")\n      .then((registration) => {\n        console.log(\"Service Worker registered: \", registration);\n\n        // 发送消息到 Service Worker\n        const isLocalhost =\n          window.location.hostname === \"localhost\" ||\n          window.location.hostname === \"127.0.0.1\";\n        const isDev = process.env.NODE_ENV === \"development\" || isLocalhost;\n\n        if (registration.active) {\n          // 确保 active 已经存在\n          registration.active.postMessage({\n            type: \"SET_DEV_MODE\",\n            isDevMode: isDev,\n          });\n        } else {\n          // 如果 active 为 null，等待激活后再发送消息 (可选)\n          navigator.serviceWorker.addEventListener(\"controllerchange\", () => {\n            if (navigator.serviceWorker.controller) {\n              navigator.serviceWorker.controller.postMessage({\n                type: \"SET_DEV_MODE\",\n                isDevMode: isDev,\n              });\n            }\n          });\n        }\n      })\n      .catch((error) => {\n        console.log(\"Service Worker registration failed: \", error);\n      });\n  });\n}\n"],"names":["key","class","id","href","target","app","createApp","components","sideBar","displayButtons","data","displayConfig","config","getBaseConfig","onPhone","window","innerWidth","client","fullScreen","full_screen","beian","isTauri","__TAURI__","__TAURI_INTERNALS__","computed","onPrivate","this","$route","path","includes","created","Object","keys","length","document","title","setBaseConfigCallback","addEventListener","handleResize","beforeUnmount","removeEventListener","methods","setWindowSize","updateBaseConfig","closeApp","$message","message","type","_openBlock","_createElementBlock","_Fragment","_createElementVNode","_normalizeClass","$data","_hoisted_1","_createVNode","_component_router_view","$options","_createCommentVNode","_createBlock","_component_sideBar","fullscreen","_component_displayButtons","onClose","onSetScreen","_hoisted_2","_toDisplayString","use","ElementPlus","router","mount","navigator","serviceWorker","register","then","registration","isDev","location","hostname","active","postMessage","isDevMode","controller","catch","error"],"mappings":"m+BAIA,SAJAA,IAAA,EAqEwBC,MAAM,iBArE9BD,IAAA,EAqFIE,GAAG,QACHC,KAAK,6BACLC,OAAO,gBCpELC,EAAMC,IDfG,CACbC,WAAY,CACVC,UACAC,kBAEF,IAAAC,GACQ,MAAAC,EAAgBC,EAAOC,gBAEtB,MAAA,CACLC,QAFcC,OAAOC,WAAa,IAGlCC,SACAC,WAAYP,GAAeQ,cAAe,EAC1CC,MAAOT,GAAeS,OAAS,GAC/BC,WAAYN,OAAOO,YAAaP,OAAOQ,qBAE1C,EACDC,SAAU,CACR,SAAAC,GACE,OACEC,KAAKC,OAAOC,KAAKC,SAAS,UAC1BH,KAAKC,OAAOC,KAAKC,SAAS,aAC1BH,KAAKC,OAAOC,KAAKC,SAAS,QAE7B,GAEH,OAAAC,GACQ,MAAAnB,EAAgBC,EAAOC,gBACzBkB,OAAOC,KAAKrB,GAAesB,OAAS,GACtCP,KAAKR,WAAaP,EAAcQ,YAChCO,KAAKN,MAAQT,EAAcS,MAC3Bc,SAASC,MAAQxB,EAAcwB,OAExBvB,EAAAwB,sBAAuB1B,IAC5BgB,KAAKR,WAAaR,EAAKS,YACvBO,KAAKN,MAAQV,EAAKU,MAClBc,SAASC,MAAQzB,EAAKyB,QAInBpB,OAAAsB,iBAAiB,SAAUX,KAAKY,aACxC,EACD,aAAAC,GACSxB,OAAAyB,oBAAoB,SAAUd,KAAKY,aAC3C,EACDG,QAAS,CACP,aAAAC,CAAcxB,GACZQ,KAAKR,WAAaA,EAClBN,EAAO+B,iBAAiB,CACtBxB,YAAaD,GAEhB,EACD,YAAAoB,GACOZ,KAAAZ,QAAUC,OAAOC,WAAa,GACpC,EACD,QAAA4B,GACElB,KAAKmB,SAAS,CACZC,QAAS,aACTC,KAAM,WAEV,mGA/DJ,OAAAC,IAAAC,EAAAC,EAAA,KAAA,CAoEEC,EAcM,MAAA,CAdDjD,GAAG,WAAYD,MApEtBmD,YAoEyCC,EAAOhC,YACjCgC,EAAOvC,SAAlBkC,IAAAC,EAGM,MAHNK,EAGM,CAFJC,EAA2BC,GACXC,EAAShC,UAvE/BiC,EAAA,IAAA,IAuEMV,IAAAW,EAAqCC,GAvE3C5D,IAAA,aAyEIiD,EAQM,MAAA,CAjFVjD,IAAA,EA2EMC,MA3ENmD,EA2EY,CAAA,cACgB,CAAAS,WAAAR,EAAAnC,YAAcmC,EAAOhC,aAE3CkC,EAA4FO,EAAA,CAA3E,cAAAT,EAAWnC,WAAE6C,QAAON,EAAQb,SAAGoB,YAAYP,EAAaf,+DACzEa,EAAmBK,GACnBL,EAA2BC,YAIvBH,EAAKjC,WADb6B,EAMC,IANDgB,EAMCC,EADKb,EAAKjC,OAAA,IAxFbsC,EAAA,IAAA,6CCqBArD,EAAI8D,IAAIC,GACR/D,EAAI8D,IAAIE,GAERhE,EAAIiE,MAAM,QAGN,kBAAmBC,WACdxD,OAAAsB,iBAAiB,OAAQ,KAC9BkC,UAAUC,cACPC,SAAS,yBACTC,KAAMC,IAIL,MAGMC,EAFyB,cAA7B7D,OAAO8D,SAASC,UACa,cAA7B/D,OAAO8D,SAASC,SAGdH,EAAaI,OAEfJ,EAAaI,OAAOC,YAAY,CAC9BjC,KAAM,eACNkC,UAAWL,IAIHL,UAAAC,cAAcnC,iBAAiB,mBAAoB,KACvDkC,UAAUC,cAAcU,YAChBX,UAAAC,cAAcU,WAAWF,YAAY,CAC7CjC,KAAM,eACNkC,UAAWL,QAMpBO,MAAOC"}