{"version":3,"mappings":"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","names":["BlankView","__vitePreload","Promise","resolve","then","__VITE_PRELOAD__","router","createRouter","history","createWebHistory","routes","path","name","component","HomeView$1","children","ChatView$1","ProfileView$1","AuthView$1","SettingsView$1","redirect","OverviewView$1","LLMAdaptersView$1","ServerConfigView$1","WebConfigView$1","OnebotConfigView$1","PluginsView$1","PresetsView$1","LogsView$1","beforeEach","async","to","client","everLogin","ElMessage","warning","query","fullPath","_hoisted_1","id","_hoisted_2","class","_hoisted_3","_hoisted_4","_hoisted_5","key","_hoisted_7","_hoisted_9","_hoisted_10","_hoisted_12","_hoisted_14","_hoisted_15","style","width","height","position","_hoisted_20","_hoisted_21","_hoisted_22","components","MdRenderer","ContextMenu","ForwardMsg","InputEditor","ToolCallBar","FileBlock","ReasonBlock","data","shareId","contactor","preview","scroll","currentUrl","window","location","href","params","URL","searchParams","has","get","currentId","parseInt","this","$route","getContactor","Error","e","defaultId","contactList","$router","push","activeContactor","showwindow","showemoji","userInput","extraOptions","wraperPresets","selectedOption","currentDelay","toupdate","seletedText","seletedImage","retryList","showMenu","menuTop","menuLeft","validMessageIndex","repliedMessageId","autoScroll","fullScreen","chatWindowRef","prevScrollTop","showRollDown","inputBarTop","clearMessageTip","loadingIcon","katexPlugin","mioPlugins","plugin","codeBlockPlugin","mermaidPlugin","cursorPlugin","options","shape","imageViewerPlugin","computed","getMenuStyle","innerWidth","basicHeight","top","bottom","innerHeight","left","getDelayStatus","activeMessageChain","presetSettings","opening","role","content","type","text","time","createTime","messageChain","watch","newVal","oldVal","initContactor","toButtom","oldId","oldContactor","disableContactor","mounted","document","addEventListener","$refs","chatWindow","scrollHandler","element","querySelector","pageHeight","offsetTop","loadOriginalContactors","$message","message","updated","length","beforeUnmount","removeEventListener","methods","handleMouseUp","selectedText","getSelection","toString","clicked","setTimeout","elm","getElementById","scrollTo","scrollHeight","behavior","scrollToBottom","cleanScreen","updateFirstMessage","setLocalStorage","emit","cleanHistory","i","splice","makeSystemMessage","delSystemMessage","index","firstMessageIndex","isValidInput","input","test","waiting","tolist","setModel","list","provider","model","base","loadAvatar","toimg","rect","getBoundingClientRect","html2canvas","windowHeight","canvas","img","toDataURL","link","createElement","download","click","share","shareResult","shareContactor","shareUrl","success","shareOrCopy","hasOpening","getFullMessages","showTime","thisTime","show","getShownTime","separateTextAndImages","markdownText","regex","matches","result","lastIndex","exec","textContent","slice","trim","file","getChatwindowScrollheight","scrollTop","clientHeight","active","on","$forceUpdate","messageId","rawMessage","getMessageById","includes","filter","item","forEach","platform","formatedMessage","loadName","off","getReplyText","find","String","imageLoaded","showMessageMenu","event","messageIndex","target","tagName","toLowerCase","imgSrc","src","preventDefault","clientY","clientX","currentSelectedText","toProfile","currentScrollTop","isScrollingDown","isScrollingUp","isAtBottom","getseletedMessage","handleMessageOption","option","webSend","targetIndex","validMessage","baseContainer","getBaseUserContainer","insertMessage","status","retryMessage","_openBlock","_createElementBlock","_createElementVNode","onClick","$options","args","_toDisplayString","$data","_normalizeClass","ref","_normalizeStyle","_createCommentVNode","_createVNode","_component_ContextMenu","onMessageOption","onClose","_Fragment","_renderList","ref_for","_hoisted_6","_hoisted_8","avatar","alt","_hoisted_11","title","_hoisted_13","onMouseup","onContextmenu","$event","elmIndex","_createBlock","_component_MdRenderer","md","theme","isStreaming","breaks","_hoisted_16","_component_ForwardMsg","messages","_component_FileBlock","_hoisted_17","_component_ReasonBlock","endTime","startTime","_hoisted_18","_cache","_component_ToolCallBar","_hoisted_19","_component_InputEditor","onStroge","onSetModel","onCleanScreen","onCleanHistory","onToButtom","created","friendlist","blankView","onPhone","pagePath","loaded","inited","_component_friendlist","_component_blankView","_component_router_view","_hoisted_23","_hoisted_24","_hoisted_25","ContactorSettings","toolCallModes","config","getToolCallModes","providers","getLLMProviders","safetyParams","getSafetySettingsParams","safetySimpleValue","Object","keys","map","value","label","allLLMTools","llmTools","toolsObject","toolsList","toolKey","enabled","tools","collapsed","centerDialogVisible","avatarPolicyList","namePolicyList","isOnebot","llmProviders","basicInfo","getAvatarPolicyValue","avatarPolicy","newId","handler","newOptions","JSON","parse","stringify","deep","newInfo","namePolicy","priority","delayInterval","setInterval","socket","delay","clearInterval","toolCallSettings","mode","handleUpdateOpenaiPresets","presets","delContactor","rmContactor","handleProviderSwitched","updateContactorName","updateContactorAvatar","_component_el_image","_createTextVNode","_component_el_input","modelValue","disabled","_component_el_select","onChange","default","_withCtx","_component_el_option","_","_component_el_switch","_component_ContactorSettings","onProviderChanged","onUpdatePresets","_component_el_button","plain","_ctx","_component_el_dialog","center","footer","route","useRoute","useRouter","configStore","useConfigStore","forbidden","isMobile","mobileMenuVisible","showMobileMenu","menuItems","icon","Menu","Connection","Monitor","ChromeFilled","ChatDotRound","Grid","Document","handleSwitchAccount","clearAdminCode","handleReturnHome","checkMobile","activeMenu","isInSubPage","currentPath","startsWith","getMobileTitle","currentItem","toggleMobileMenu","closeMobileMenu","handleBackToHome","handleMenuSelect","handleRestartService","ElMessageBox","confirm","confirmButtonText","cancelButtonText","info","error","handleReset","reset","reload","handleResetCache","resetCache","onMounted","isAuthenticated","fetchConfig","onUnmounted","accessCode","requesting","iconContainer","login","code","nextTick","classList","add","is_admin","setAdminCode","currentRoute","remove","handleEnter","presetsAPI","constructor","configAPI","getPresets","queryString","URLSearchParams","endpoint","request","getPreset","presetId","encodeURIComponent","createPreset","method","body","updatePreset","deletePreset","reloadPresets","importPreset","formData","FormData","append","headers","adminCode","response","fetch","json","ok","localStorage","removeItem","exportPreset","contentDisposition","filename","match","blob","url","createObjectURL","a","appendChild","removeChild","revokeObjectURL","presetData","exportData","category","Blob","fallbackError","batchDeletePresets","presetIds","results","validatePreset","usePresetsStore","defineStore","summary","totalCount","categoryCount","common","recommended","hidden","sourceCount","custom","pagination","total","start","nums","hasMore","loading","allPresets","preset","countByCategory","countBySource","presetsByCategory","grouped","hasOwnProperty","fetchPresets","newPresets","findIndex","p","searchPresets","keyword","presetsArray","lowerKeyword","some","h","findPresetById","findPresetByName","presetsStore","refreshing","showCompare","systemStatus","needRestart","values","adapters","instances","adapter","enable","systemStatusText","allAdapterTypes","typesFromApi","adapterTypes","types","typesFromConfig","getAdapterInstanceCount","getAdapterInstances","pendingItems","items","action","entries","providerName","models","disabledCount","flat","onebot","onebotConfig","reverse_ws_url","bot_qq","adapterTypeName","names","openai","gemini","vertex","deepseek","anthropic","charAt","toUpperCase","adapterInfo","handleRefreshModels","refreshAllModels","handleExportConfig","Date","toISOString","split","exportConfig","handleImportConfig","configData","importConfig","validateResult","validateConfig","valid","alert","errors","join","updateConfig","navigateTo","promises","fetchAdapterTypes","catch","all","editorVisible","editorMode","editorType","editorAdapter","editorIndex","allAdapters","modelCount","reduce","count","group","enabledCount","formatTypeLabel","handleAddAdapter","handleSelectionChange","selection","clearAdapterSelection","toggleAdapterSelection","handleRefreshAll","handleBatchEnable","selectedAdapters","successCount","batchToggleAdapters","r","handleBatchDisable","handleBatchDelete","batchDeleteAdapters","handleEditorClose","handleEditorSubmit","addAdapter","updateAdapter","row","updatedData","refreshAdapterModels","adapterName","deleteAdapter","formRef","saving","reactive","port","host","max_rate_pre_min","debug","originalData","rules","required","trigger","min","max","handleSave","validate","updateConfigSection","assign","clearValidate","serverConfig","server","fetchConfigSection","debugConfig","loadConfig","showAdminCode","showUserCode","beian","admin_code","user_code","full_screen","webConfig","web","showToken","token","admin_qq","validator","rule","callback","plugins","detailDialogVisible","configDialogVisible","debugDialogVisible","currentPlugin","currentTool","pluginTools","configJsonStr","savingConfig","debugParams","debugResult","debugging","activeCollapseNames","totalToolsCount","sum","toolCount","customPluginsCount","loadPlugins","pluginAPI","listPlugins","reloading","toggling","handleRefreshPlugins","handleReloadAll","reloadAllPlugins","handleReloadPlugin","reloadPlugin","displayName","handleSaveConfig","updatePluginConfig","SyntaxError","fillExampleParams","parameters","properties","example","props","prop","enum","minimum","handleExecuteDebug","debugTool","togglePlugin","getPluginTools","g","getPluginConfig","tool","searchKeyword","categoryFilter","sourceFilter","selectedPresets","editorPreset","fileInput","waterfallRef","loadTrigger","currentPage","pageSize","shouldShowTrigger","loadingMore","loadError","displayedPresets","getPresetId","isPresetSelected","searchTimeout","clearTimeout","handleFilterChange","newHasMore","oldHasMore","setupInfiniteScroll","cleanupObserver","fetchPresetsWithFilters","source","loadMore","retryLoad","handleSearch","handleRefresh","handleCreate","handleEdit","handleDelete","handleExport","handleImport","handleFileSelect","files","observer","IntersectionObserver","isIntersecting","rootMargin","threshold","observe","disconnect","selected","indexOf","useLogViewer","logs","isSubscribed","stats","isConnected","pendingRequests","Map","logMessageHandler","initLogListener","cleanupLogListener","protocol","request_id","resolver","delete","addLog","handleLogMessage","sendRequest","reject","requestId","randomString","set","sendMessage","log","mockLogInterval","startMockLogStream","counter","mockLog","timestamp","level","Math","floor","random","module","caller","ip","stopMockLogStream","cleanupSocketListeners","cleanupStatusPolling","autoSubscribe","defaultOptions","modules","realtime","bufferSize","sendHistory","subscribe","onConnect","onDisconnect","reason","onConnectError","setupSocketListeners","lastSocketId","interval","currentConnected","currentSocket","currentSocketId","setupStatusPolling","testLogs","now","extra","originalObject","temperature","max_tokens","choices","usage","prompt_tokens","completion_tokens","total_tokens","error_code","timeout","retry_info","details","retries","database","stack","limit","current","resetTime","addTestLogs","unsubscribe","clear","search","exportLogs","getStats","clearLogs","exportLogsData","clearLogsData","filterLevel","filterModule","logsContainer","exportDialogVisible","exportLoading","jsonDialogVisible","selectedLog","extraObjectKey","exportForm","format","maxRecords","includeMetadata","filteredLogs","filtered","performSearch","page","confirmExport","getContentType","replace","csv","txt","formatUptime","uptime","seconds","minutes","hours","days","getJsonSummary","jsonObj","formatJsonContent","copyJsonContent","formattedJson","navigator","clipboard","writeText","getObjectSummary","Array","isArray","substring","isObjectValue","formatTagValue","maxLength","str","truncateText","getTagTitle","getDisplayExtra","displayExtra","handleScroll","statsInterval","toLocaleString","year","month","day","hour","minute","second","fractionalSecondDigits","tempLog"],"ignoreList":[],"sources":["../../../src/router/index.js","../../../src/views/ChatView.vue","../../../src/views/BlankView.vue","../../../src/views/HomeView.vue","../../../src/views/ProfileView.vue","../../../src/views/SettingsView.vue","../../../src/views/AuthView.vue","../../../src/lib/presetsApi.js","../../../src/stores/presetsStore.js","../../../src/views/settings/OverviewView.vue","../../../src/views/settings/LLMAdaptersView.vue","../../../src/views/settings/ServerConfigView.vue","../../../src/views/settings/WebConfigView.vue","../../../src/views/settings/OnebotConfigView.vue","../../../src/views/settings/PluginsView.vue","../../../src/views/settings/PresetsView.vue","../../../src/composables/useLogViewer.js","../../../src/views/settings/LogsView.vue"],"sourcesContent":["import { client } from \"@/lib/runtime.js\";\nimport { ElMessage } from \"element-plus\";\nimport { createRouter, createWebHistory } from \"vue-router\";\nconst ChatView = () => import(\"../views/ChatView.vue\");\nconst HomeView = () => import(\"../views/HomeView.vue\");\nconst ProfileView = () => import(\"../views/ProfileView.vue\");\nconst SettingsView = () => import(\"../views/SettingsView.vue\");\nconst AuthView = () => import(\"../views/AuthView.vue\");\nconst BlankView = () => import(\"../views/BlankView.vue\");\n\nconst router = createRouter({\n  history: createWebHistory(import.meta.env.BASE_URL),\n  routes: [\n    {\n      path: \"/\",\n      name: \"home\",\n      component: HomeView,\n      children: [\n        {\n          path: \"/\",\n          name: \"blank\",\n          component: BlankView,\n        },\n        {\n          path: \"/contactors\",\n          name: \"contactors\",\n          component: BlankView,\n        },\n        {\n          path: \"/chat/:id\",\n          name: \"chat_view\",\n          component: ChatView,\n        },\n        {\n          path: \"/profile/:id\",\n          name: \"profile_view\",\n          component: ProfileView,\n        },\n      ],\n    },\n    {\n      path: \"/auth\",\n      name: \"auth\",\n      component: AuthView,\n    },\n    {\n      path: \"/settings\",\n      name: \"settings\",\n      component: SettingsView,\n      redirect: \"/settings\",\n      children: [\n        {\n          path: \"\",\n          name: \"settings_overview\",\n          component: () => import(\"../views/settings/OverviewView.vue\"),\n        },\n        {\n          path: \"llm-adapters\",\n          name: \"settings_llm_adapters\",\n          component: () => import(\"../views/settings/LLMAdaptersView.vue\"),\n        },\n        {\n          path: \"server\",\n          name: \"settings_server\",\n          component: () => import(\"../views/settings/ServerConfigView.vue\"),\n        },\n        {\n          path: \"web\",\n          name: \"settings_web\",\n          component: () => import(\"../views/settings/WebConfigView.vue\"),\n        },\n        {\n          path: \"onebot\",\n          name: \"settings_onebot\",\n          component: () => import(\"../views/settings/OnebotConfigView.vue\"),\n        },\n        {\n          path: \"plugins\",\n          name: \"settings_plugins\",\n          component: () => import(\"../views/settings/PluginsView.vue\"),\n        },\n        {\n          path: \"presets\",\n          name: \"settings_presets\",\n          component: () => import(\"../views/settings/PresetsView.vue\"),\n        },\n        {\n          path: \"logs\",\n          name: \"settings_logs\",\n          component: () => import(\"../views/settings/LogsView.vue\"),\n        },\n      ],\n    },\n  ],\n});\n\nrouter.beforeEach(async (to) => {\n  const everLogin = client.everLogin();\n  if (\n    // \n    !everLogin &&\n    //  \n    to.name !== \"auth\"\n  ) {\n    console.log(\n      `everLogin: ${everLogin} to.name!== auth: ${to.name !== \"auth\"}`,\n    );\n    ElMessage.warning(\"\");\n    //   login?redirect=\n    const query = to.path === \"/settings\" ? null : { redirect: to.fullPath };\n    return { name: \"auth\", query };\n  }\n});\n\nexport default router;\n","<script>\nimport ForwardMsg from \"@/components/ForwardMsg.vue\";\nimport InputEditor from \"@/components/InputEditor.vue\";\nimport FileBlock from \"@/components/FileBlock.vue\";\nimport ToolCallBar from \"@/components/ToolCallBar.vue\";\nimport ReasonBlock from \"@/components/ReasonBlock.vue\";\nimport ContextMenu from \"@/components/ContextMenu.vue\";\nimport MdRenderer from \"mio-previewer\";\nimport { mermaidPlugin, codeBlockPlugin, cursorPlugin, imageViewerPlugin } from 'mio-previewer/plugins/custom';\nimport { katexPlugin } from 'mio-previewer/plugins/markdown-it';\nimport \"emoji-picker-element\";\nimport html2canvas from \"html2canvas\";\nimport { client } from \"@/lib/runtime.js\";\nimport { shareOrCopy } from \"@/utils/tools.js\";\n\nexport default {\n  components: {\n    MdRenderer,\n    ContextMenu,\n    ForwardMsg,\n    InputEditor,\n    ToolCallBar,\n    FileBlock,\n    ReasonBlock,\n  },\n  data() {\n    let preview = false;\n    let shareId = undefined;\n    let contactor = undefined;\n    let scroll = true;\n\n    // URL\n    const currentUrl = window.location.href;\n    // URL\n    const url = new URL(currentUrl);\n    // URL\n    const params = url.searchParams;\n    // URLpreview\n    if (params.has(\"preview\")) {\n      if (params.get(\"preview\") === \"true\") {\n        preview = true;\n      }\n    }\n    // URLshareId\n    if (params.has(\"shareId\")) {\n      shareId = params.get(\"shareId\");\n    }\n    if (params.has(\"scroll\")) {\n      scroll = params.get(\"scroll\") || \"true\";\n    }\n\n    const currentId = parseInt(this.$route.params.id);\n    try {\n      contactor = client.getContactor(currentId);\n      if (!contactor) {\n        throw new Error(\"\");\n      }\n    } catch (e) {\n      const defaultId = client.contactList[0].id;\n      this.$router.push({\n        path: `/chat/${defaultId}`,\n        query: {\n          preview,\n          shareId,\n        },\n      });\n      contactor = client.getContactor(defaultId);\n    }\n    const mioPlugins = [{\n      plugin: codeBlockPlugin,\n    },\n    {\n      plugin: mermaidPlugin,\n    },\n    {\n      plugin: cursorPlugin,\n      options: {\n        shape: 'circle'\n      }\n    },\n    {\n      plugin: imageViewerPlugin,\n    }\n    ]\n\n    return {\n      scroll,\n      preview,\n      shareId,\n      activeContactor: contactor,\n      showwindow: true,\n      showemoji: false,\n      userInput: \"\",\n      client: client,\n      extraOptions: [],\n      wraperPresets: {},\n      selectedOption: null,\n      currentDelay: 0,\n      toupdate: false,\n      seletedText: \"\",\n      seletedImage: \"\",\n      retryList: [],\n      showMenu: false,\n      menuTop: 0,\n      menuLeft: 0,\n      validMessageIndex: -1,\n      repliedMessageId: -1,\n      autoScroll: false,\n      fullScreen: false,\n      chatWindowRef: null,\n      prevScrollTop: 0,\n      showRollDown: false,\n      inputBarTop: 0,\n      clearMessageTip: \"\",\n      loadingIcon: \"<span id='message-loading-icon'></span>\",\n      katexPlugin,\n      mioPlugins\n    };\n  },\n  computed: {\n    getMenuStyle() {\n      // 768px\n      if (window.innerWidth < 768) {\n        const basicHeight = 160;\n        // \n        if (this.menuTop - basicHeight < 0) {\n          return {\n            top: basicHeight + \"px\",\n          };\n        }\n        return {\n          bottom: window.innerHeight - this.menuTop + 16 + \"px\",\n        };\n      } else {\n        // \n        if (this.menuLeft + 110 > window.innerWidth) {\n          return {\n            top: this.menuTop + \"px\",\n            left: this.menuLeft - 110 + \"px\",\n          };\n        } else {\n          return {\n            top: this.menuTop + \"px\",\n            left: this.menuLeft + \"px\",\n          };\n        }\n      }\n    },\n    getDelayStatus() {\n      return this.currentDelay > 1000\n        ? \"high\"\n        : this.currentDelay > 500\n          ? \"mid\"\n          : this.currentDelay > 100\n            ? \"low\"\n            : \"ultra\";\n    },\n    activeMessageChain() {\n      return this.activeContactor.options.presetSettings?.opening\n        ? [\n          {\n            role: \"other\",\n            content: [\n              {\n                type: \"text\",\n                data: {\n                  text: this.activeContactor.options.presetSettings.opening,\n                },\n              },\n            ],\n            time: this.activeContactor.createTime,\n          },\n          ...this.activeContactor.messageChain,\n        ]\n        : this.activeContactor.messageChain;\n    },\n  },\n  watch: {\n    [\"$route.params.id\"](newVal, oldVal) {\n      const currentId = parseInt(newVal);\n      const contactor = client.getContactor(currentId);\n      this.activeContactor = contactor;\n      this.initContactor(this.activeContactor);\n      if (this.chatWindowRef) this.toButtom();\n      if (oldVal) {\n        const oldId = parseInt(oldVal);\n        const oldContactor = client.getContactor(oldId);\n        this.disableContactor(oldContactor);\n      }\n    },\n  },\n  async mounted() {\n    document.addEventListener(\"click\", () => {\n      this.showMenu = false;\n      this.seletedText = \"\";\n      this.seletedImage = \"\";\n      // if( this.showemoji) this.showemoji = false;\n    });\n    this.chatWindowRef = this.$refs.chatWindow;\n    this.chatWindowRef.addEventListener(\"scroll\", this.scrollHandler);\n    if (!this.preview && this.scroll) this.toButtom();\n    this.scroll = true;\n    this.initContactor(this.activeContactor);\n    this.fullScreen = this.client.fullScreen;\n    // setInterval(() => {\n    //   this.currentDelay = this.client.socket.delay;\n    // }, 3000);\n    // .input-barinputBarTop\n    const element = document.querySelector(\".input-bar\");\n    if (element) {\n      // \n      const pageHeight = window.innerHeight;\n      this.inputBarTop = pageHeight - element.offsetTop;\n      console.log(this.inputBarTop);\n    }\n\n\n    if (this.shareId) {\n      const loadAble = await client.loadOriginalContactors(this.shareId);\n      if (loadAble) {\n        this.$router.push({\n          path: \"/chat/\" + this.shareId,\n          query: {\n            preview: this.preview,\n            scroll: false,\n          },\n        });\n      } else {\n        this.$message({\n          message: \"\",\n          type: \"error\",\n        });\n      }\n    }\n  },\n  updated() {\n    if (this.toupdate && this.autoScroll && this.retryList.length === 0) {\n      this.toButtom();\n      this.toupdate = false;\n    }\n  },\n  beforeUnmount() {\n    // \n    this.disableContactor(this.activeContactor);\n    this.chatWindowRef.removeEventListener(\"scroll\", this.scrollHandler);\n  },\n  methods: {\n    handleMouseUp() {\n      const selectedText = window.getSelection().toString();\n      if (selectedText) {\n        this.seletedText = selectedText;\n        console.log(\"\" + selectedText);\n      }\n    },\n    toButtom(clicked) {\n      setTimeout(() => {\n        const scrollToBottom = () => {\n          const elm =\n            this.chatWindowRef ||\n            document.getElementById(\"main-messages-window\");\n          if (!elm) return;\n\n          //  or \n          elm.scrollTo({\n            top: elm.scrollHeight,\n            behavior: clicked ? \"smooth\" : \"instant\",\n          });\n        };\n        scrollToBottom();\n      }, 1);\n    },\n    cleanScreen() {\n      this.activeContactor.messageChain = [];\n      this.activeContactor.updateFirstMessage();\n      client.setLocalStorage(); //\n      this.activeContactor.emit(\"updateMessageSummary\");\n\n      this.toupdate = true;\n      this.$message({ message: \"\", type: \"success\" });\n    },\n    cleanHistory() {\n      this.activeContactor.updateFirstMessage();\n      this.$message({\n        message: \"\",\n        type: \"success\",\n      });\n      // \n      for (let i = this.activeContactor.messageChain.length - 1; i >= 0; i--) {\n        const message = this.activeContactor.messageChain[i];\n        // role  \"mio_system\"\n        if (\n          message.role === \"mio_system\" &&\n          message.content[0].type === \"text\" &&\n          message.content[0].data.text === this.clearMessageTip\n        ) {\n          this.activeContactor.messageChain.splice(i, 1);\n        }\n      }\n      this.activeContactor.makeSystemMessage(this.clearMessageTip);\n      // \n      client.setLocalStorage();\n    },\n\n    delSystemMessage(index) {\n      const message = this.activeContactor.messageChain[index];\n      // \n      if (\n        message.content[0].type === \"text\" &&\n        message.content[0].data.text === this.clearMessageTip\n      ) {\n        this.activeContactor.firstMessageIndex = 0;\n      }\n      this.activeContactor.messageChain.splice(index, 1);\n      // \n      client.setLocalStorage();\n    },\n\n    isValidInput(input) {\n      // \n      const regex = /^[ \\n]+$/;\n      const result = !regex.test(input);\n      return result;\n    },\n    waiting() {\n      this.$message({ message: \"\", type: \"warning\" });\n    },\n\n    tolist() {\n      this.$router.push({ name: \"home\" });\n    },\n\n    async setModel(list) {\n      const provider = list[0];\n      const model = list[2];\n      this.activeContactor.options.provider = provider;\n      this.activeContactor.options.base.model = model;\n      this.activeContactor.loadAvatar();\n      await client.setLocalStorage(); //\n    },\n    toimg() {\n      // html2canvas this.chatWindowRef \n      const rect = this.chatWindowRef.getBoundingClientRect();\n      rect.height = this.chatWindowRef.scrollHeight;\n\n      html2canvas(this.chatWindowRef, {\n        windowHeight: rect.height * 1.2,\n        width: rect.width,\n        // : allowTaint: true, backgroundColor: null\n      }).then((canvas) => {\n        // canvas\n        const img = canvas.toDataURL(\"image/png\");\n        // a\n        const link = document.createElement(\"a\");\n        link.download = \"chat.png\";\n        link.href = img;\n        // \n        link.click();\n      });\n    },\n    async share() {\n      const shareResult = await client.shareContactor(\n        this.activeContactor.id,\n      );\n      if (shareResult && shareResult.shareUrl) {\n        const { shareUrl } = shareResult;\n        // api\n        const { success, message } = shareOrCopy(shareUrl);\n        if (success) {\n          this.$message({\n            message: message,\n            type: \"success\",\n          });\n        } else {\n          this.$message({\n            message: message,\n            type: \"error\",\n          });\n        }\n      }\n    },\n    hasOpening() {\n      return this.activeContactor.options.presetSettings?.opening\n        ? true\n        : false;\n    },\n    getFullMessages() {\n      return this.hasOpening()\n        ? [\n          {\n            role: \"other\",\n            content: [\n              {\n                type: \"text\",\n                data: {\n                  text: this.activeContactor.options.presetSettings.opening,\n                },\n              },\n            ],\n            time: this.activeContactor.createTime,\n          },\n          ...this.activeContactor.messageChain,\n        ]\n        : this.activeContactor.messageChain;\n    },\n    showTime(index) {\n      const list = this.getFullMessages();\n      const thisTime = list[index].time;\n      if (index === 0) {\n        return {\n          show: true,\n          time: this.activeContactor.getShownTime(thisTime),\n        };\n      } else {\n        const earlyTime = list[index - 1].time;\n        if (thisTime - earlyTime > 600000) {\n          return {\n            show: true,\n            time: this.activeContactor.getShownTime(thisTime),\n          };\n        } else {\n          return {\n            show: false,\n            time: \"\",\n          };\n        }\n      }\n    },\n    separateTextAndImages(markdownText) {\n      // Markdown\n      const regex = /!\\[([^\\]]*)\\]\\((.*)\\)/g;\n      let result = [];\n      let lastIndex = 0;\n\n      // \n      let matches;\n      while ((matches = regex.exec(markdownText)) !== null) {\n        // \n        if (matches.index > lastIndex) {\n          const textContent = markdownText\n            .slice(lastIndex, matches.index)\n            .trim();\n          if (textContent) {\n            result.push({\n              type: \"text\",\n              data: {\n                text: textContent,\n              },\n            });\n          }\n        }\n\n        // \n        result.push({\n          type: \"image\",\n          data: {\n            // file: matches[2].length > 200 ? matches[2] : `/api/proxy?url=${matches[2]}`,\n            file: matches[2],\n          },\n        });\n\n        // lastIndex\n        lastIndex = regex.lastIndex;\n      }\n\n      // \n      if (lastIndex < markdownText.length) {\n        const textContent = markdownText.slice(lastIndex).trim();\n        if (textContent) {\n          result.push({\n            type: \"text\",\n            data: {\n              text: textContent,\n            },\n          });\n        }\n      }\n\n      return result;\n    },\n\n    getChatwindowScrollheight() {\n      var scrollTop = this.chatWindowRef.scrollTop; // \n      var clientHeight = this.chatWindowRef.clientHeight; // \n      var scrollHeight = this.chatWindowRef.scrollHeight; // \n\n      // \n      var scrollPercentage = scrollTop / (scrollHeight - clientHeight);\n      var height = scrollPercentage * scrollHeight;\n\n      return scrollHeight - height;\n    },\n\n    initContactor(contactor) {\n      contactor.active = true;\n\n      contactor.on(\"revMessage\", (message) => {\n        this.activeContactor.messageChain.push(message);\n        this.toupdate = true;\n      });\n      contactor.on(\"delMessage\", (index) => {\n        console.log(`${index}`);\n        // \n        this.activeContactor.messageChain.splice(index, 1);\n        this.toupdate = true;\n      });\n\n      contactor.on(\"updateMessage\", () => {\n        this.$forceUpdate();\n        this.toupdate = true;\n        client.setLocalStorage(); //\n      });\n\n      contactor.on(`completeMessage`, async (e) => {\n        const messageId = e.messageId;\n        const rawMessage = this.activeContactor.getMessageById(messageId);\n\n        if (this.retryList.includes(messageId)) {\n          this.retryList = this.retryList.filter((item) => item !== messageId);\n        }\n\n        rawMessage.content.forEach((element, index) => {\n          if (\n            element.type === \"text\" &&\n            this.activeContactor.platform === \"onebot\"\n          ) {\n            const formatedMessage = this.separateTextAndImages(\n              element.data.text,\n            );\n            //  formatedMessage  index \n            rawMessage.content.splice(index, 1, ...formatedMessage);\n          }\n        });\n\n        this.toupdate = true;\n        this.$forceUpdate();\n        this.activeContactor.loadName();\n        client.setLocalStorage(); //\n        console.log(e);\n      });\n    },\n    disableContactor(contactor) {\n      if (contactor) {\n        contactor.active = false;\n        contactor.off(`updateMessage`);\n        contactor.off(`revMessage`);\n        contactor.off(`delMessage`);\n        contactor.off(`completeMessage`);\n      }\n    },\n    getReplyText(id) {\n      let content = \"\";\n      const message = this.activeContactor.messageChain.find(\n        (item) => item.id === id || String(item.id) === String(id),\n      );\n      if (message) {\n        message.content.forEach((element) => {\n          if (element.type === \"text\") {\n            content += element.data.text;\n          } else if (element.type === \"image\") {\n            content += \"[]\";\n          }\n        });\n        // if (content.length > 20) {\n        //   return `${content.substr(0, 20)}...`;\n        // } else {\n        //   return `${content}`;\n        // }\n        return content.trim().slice(0, 20);\n      } else {\n        console.log(\"\");\n        // id\n        console.log(this.activeContactor.messageChain);\n        console.log(\"id\" + id);\n        return \"[] \";\n      }\n    },\n    imageLoaded() {\n      this.scroll && this.toButtom();\n    },\n    showMessageMenu(event, messageIndex) {\n      // \n      if (event.target.tagName.toLowerCase() === \"img\") {\n        const imgElement = event.target;\n        const imgSrc = imgElement.src;\n        this.seletedImage = imgSrc;\n      } else {\n        console.log(\"\");\n      }\n      this.validMessageIndex =\n        this.activeContactor.platform === \"openai\" && this.hasOpening()\n          ? messageIndex - 1\n          : messageIndex;\n      event.preventDefault();\n      this.showMenu = true;\n      this.menuTop = event.clientY;\n      this.menuLeft = event.clientX;\n\n      const currentSelectedText = window.getSelection().toString();\n      if (currentSelectedText) {\n        this.seletedText = currentSelectedText;\n      } else {\n        this.seletedText = \"\";\n      }\n    },\n    toProfile() {\n      this.$router.push({\n        name: \"profile_view\",\n        params: {\n          id: this.activeContactor.id,\n        },\n      });\n      // \n      // this.$message({\n      //   message: \"\",\n      //   type: \"warning\",\n      // });\n    },\n    scrollHandler() {\n      //  scrollTop\n      const currentScrollTop = this.chatWindowRef.scrollTop;\n\n      // \n      //  scrollTop  scrollTop\n      const isScrollingDown = currentScrollTop > this.prevScrollTop;\n      //  scrollTop  scrollTop\n      const isScrollingUp = currentScrollTop < this.prevScrollTop;\n      // \n\n      //  scrollTop \n      this.prevScrollTop = currentScrollTop;\n\n      // ---  ( isScrollingDown  isScrollingUp) ---\n      this.showMenu = false; // \n      if (this.showemoji) this.showemoji = false; // \n\n      const scrollHeight = this.getChatwindowScrollheight(); // \n\n      this.autoScroll = scrollHeight > 100 ? false : true;\n\n      const isAtBottom = scrollHeight <= 200 - 1; // \n\n      if (isScrollingDown && !this.autoScroll && !isAtBottom) {\n        this.showRollDown = true;\n      } else if (isScrollingUp || this.autoScroll || isAtBottom) {\n        this.showRollDown = false;\n      }\n    },\n    getseletedMessage() {\n      return this.activeContactor.messageChain[this.validMessageIndex];\n    },\n    handleMessageOption(option) {\n      const message = this.getseletedMessage();\n      switch (option) {\n        case \"retry\":\n          if (this.activeContactor.platform === \"onebot\") {\n            // \n            if (message.role === \"user\") {\n              this.activeContactor.webSend(message);\n            } else {\n              this.activeContactor.webSend({\n                ...message,\n                role: \"user\",\n              });\n            }\n            this.$message({ message: \"\", type: \"success\" });\n          } else {\n            const targetIndex =\n              message.role === \"user\"\n                ? this.validMessageIndex + 1\n                : this.validMessageIndex;\n\n            let validMessage = this.activeContactor.messageChain[targetIndex];\n            if (!validMessage || validMessage.role !== \"other\") {\n              // ,\n              const baseContainer = this.activeContactor.getBaseUserContainer();\n              baseContainer.role = \"other\";\n              this.activeContactor.insertMessage(baseContainer, targetIndex);\n              validMessage = baseContainer;\n            }\n            if (validMessage.status === \"retrying\") {\n              this.$message({\n                message: \"\",\n                type: \"warning\",\n              });\n              return;\n            }\n            this.activeContactor.retryMessage(validMessage.id);\n            validMessage.status = \"retrying\";\n            this.retryList.push(validMessage.id);\n          }\n          this.toButtom();\n          break;\n        case \"reply\":\n          if (this.activeContactor.platform === \"onebot\") {\n            this.repliedMessageId = message.id;\n            this.$message({ message: \"\", type: \"success\" });\n          } else {\n            this.userInput +=\n              this.getReplyText(\n                this.activeContactor.messageChain[this.validMessageIndex].id,\n              ) + \"\\n\\n\";\n          }\n          break;\n        case \"delete\":\n          this.activeContactor.messageChain.splice(this.validMessageIndex, 1);\n          client.setLocalStorage();\n          break;\n        default:\n          break;\n      }\n    },\n  },\n};\n</script>\n\n<template>\n  <div id=\"chat-window\">\n    <div class=\"upside-bar\">\n      <div class=\"return\" @click=\"tolist()\">\n        <i class=\"iconfont icon-return\"></i>\n      </div>\n      <div class=\"name-area\" @click=\"toProfile\">\n        <div class=\"contactor-name\">{{ activeContactor.name }}</div>\n        <span :class=\"'delay-status ' + getDelayStatus\"></span>\n        <span class=\"delay-num\">: {{ currentDelay }} ms</span>\n      </div>\n      <ul class=\"options\">\n        <li class=\"share\" @click=\"share()\">\n          <i class=\"iconfont icon-share\"></i>\n        </li>\n      </ul>\n    </div>\n    <div id=\"main-messages-window\" ref=\"chatWindow\" :class=\"{\n      'message-window': true,\n      preview: preview,\n    }\">\n      <div v-if=\"showRollDown\" id=\"roll-buttom-button\" :style=\"{ bottom: inputBarTop + 24 + 'px' }\"\n        @click=\"toButtom(true)\">\n        <i class=\"iconfont down1\"></i>\n      </div>\n      <ContextMenu v-show=\"showMenu\" type=\"message\" :message=\"getseletedMessage()\" :seleted-text :seleted-image\n        :style=\"getMenuStyle\" @message-option=\"handleMessageOption\" @close=\"showMenu = false\" />\n      <div v-for=\"(item, index) of activeMessageChain\" :key=\"`${activeContactor.id}-${item.id}`\" ref=\"message\"\n        class=\"message-container\">\n        <div v-if=\"showTime(index).show\" class=\"message-time\">\n          {{ showTime(index).time }}\n        </div>\n        <div :id=\"item.role\" class=\"message-body\">\n          <div v-if=\"item.role !== 'mio_system'\" class=\"avatar\">\n            <img v-if=\"item.role === 'other'\" :src=\"activeContactor.avatar\" :alt=\"activeContactor.name\"\n              @click=\"toProfile\" />\n            <img v-else :src=\"client.avatar\" :alt=\"client.name\" />\n          </div>\n          <div v-if=\"item.role !== 'mio_system'\" class=\"msg\">\n            <div class=\"wholename\">\n              <div v-if=\"\n                item.role === 'other' ? activeContactor.title : client.title\n              \" class=\"title\">\n                {{\n                  item.role === \"other\" ? activeContactor.title : client.title\n                }}\n              </div>\n              <div class=\"name\">\n                {{ item.role === \"other\" ? activeContactor.name : client.name }}\n              </div>\n            </div>\n            <div :class=\"['content', item.status]\" @mouseup=\"handleMouseUp\"\n              @contextmenu=\"showMessageMenu($event, index)\">\n              <div v-for=\"(element, elmIndex) of item.content\" :key=\"elmIndex\" class=\"inner-content\">\n                <MdRenderer v-if=\"element.type === 'text'\" :md=\"element.data.text\" :theme=\"'github'\" :isStreaming=\"['pending', 'retrying'].includes(item.status) &&\n                  item.content.length - 1 === elmIndex\n                  \" :custom-plugins=\"mioPlugins\" :markdown-it-plugins=\"[{ plugin: katexPlugin }]\"\n                  :markdown-it-options=\"{ breaks: activeContactor.platform === 'onebot' }\" />\n                <MdRenderer v-if=\"element.type === 'image'\" :md=\"`![image](${element.data.file})`\"\n                  :custom-plugins=\"mioPlugins\" :theme=\"'github'\" :key=\"element.data.file\" />\n                <div v-else-if=\"element.type === 'reply'\" class=\"reply-block\">\n                  {{ getReplyText(element.data.id) }}\n                </div>\n                <ForwardMsg v-else-if=\"element.type === 'nodes'\" :contactor=\"activeContactor\"\n                  :messages=\"element.data.messages\" />\n                <FileBlock v-else-if=\"element.type === 'file'\" :file-url=\"element.data.file\" />\n                <span v-else-if=\"element.type === 'at'\" />\n                <ReasonBlock v-else-if=\"element.type === 'reason'\" :end-time=\"element.data.endTime\"\n                  :start-time=\"element.data.startTime\" :content=\"element.data.text\" />\n                <div v-else-if=\"element.type === 'blank'\" class=\"blank-message\"\n                  style=\"width: 10rem; height: 28.8px; position: relative\">\n                  <span class=\"blank-loader\"></span>\n                </div>\n                <ToolCallBar v-else-if=\"element.type === 'tool_call'\" :tool-call=\"element.data\" />\n              </div>\n            </div>\n          </div>\n          <div v-else class=\"system-message\">\n            <div class=\"system-message-content\">\n              {{ item.content[0].data.text }}\n            </div>\n            <div class=\"system-message-button\">\n              <i class=\"iconfont close\" @click=\"delSystemMessage(index)\"></i>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n    <InputEditor ref=\"inputEditor\" :active-contactor :replied-message-id @stroge=\"client.setLocalStorage()\"\n      @set-model=\"setModel\" @clean-screen=\"cleanScreen\" @clean-history=\"cleanHistory\" @to-buttom=\"toButtom\" />\n  </div>\n</template>\n\n<style lang=\"sass\" scoped>\n$mobile: 600px\n$icon-hover: #09f\n\n.preview\n    position: fixed\n    top: 0\n    left: 0\n    width: 100vw\n    height: 100vh\n    z-index: 10000\n\n#chat-window\n    z-index: 1\n    min-width: 0.0625rem\n    position: relative\n    display: flex\n    flex-grow: 1\n    background-color: #f2f2f2\n    flex-direction: column\n\n    @media (max-width: $mobile)\n        height: 100%\n\n.upside-bar\n    flex-basis: 4rem\n    flex-shrink: 0\n    width: 100%\n    display: flex\n    align-items: flex-end\n    justify-content: flex-start\n    border-bottom: 0.0625rem solid #ebebeb\n    -webkit-app-region: drag\n\n    @media (max-width: $mobile)\n      position: fixed\n      height: 4rem\n      z-index: 1000\n      background-color: hsla(0, 0%, 100%, 0.8)\n      backdrop-filter: blur(0.5rem)\n\n    .return\n        display: none\n\n        &:hover\n            color: $icon-hover\n\n        @media (max-width: $mobile)\n            display: block\n            margin-left: 1rem\n            margin-bottom: .8rem\n\n    .name-area\n        cursor: pointer\n        position: relative\n        display: flex\n        align-items: center\n        flex-basis: 10rem\n        flex-grow: 1\n        justify-content: flex-start\n        margin: 0 0 .5rem 1rem\n\n        .contactor-name\n            text-overflow: ellipsis\n            white-space: nowrap\n            overflow: hidden\n            max-width: 10rem\n\n        .delay-status\n            width: .8rem\n            height: .8rem\n            border-radius: 50%\n            margin-left: .5rem\n            position: relative\n            top: .2rem\n\n            @media screen and (max-width: $mobile)\n              display: none\n\n\n            &:hover + .delay-num\n                display: inline-block\n\n            &.ultra\n                background-color: rgb(53, 233, 146)\n\n            &.low\n                background-color: rgb(255, 204, 0)\n\n            &.mid\n                background-color: rgb(255, 102, 102)\n\n            &.high\n                background-color: #ccc\n\n        .delay-num\n            display: none\n            position: absolute\n            font-size: 0.8rem\n            bottom: 0rem\n            background-color: #fff\n            border: 1px dashed #000\n            border-radius: 0.25rem\n            padding: 0.125rem 0.25rem\n            margin-left: 1rem\n            white-space: nowrap\n\n    .options\n        flex-basis: 10rem\n        display: flex\n        height: 2rem\n        flex-wrap: nowrap\n        flex-direction: row-reverse\n        align-items: flex-end\n        margin: 0 1rem .5rem 0\n\n        li\n            margin-left: 0.5rem\n            color: #000\n            font-weight: 580\n\n            &:hover\n              color: $icon-hover\n\n            i\n                font-size: 1.25rem\n\n\n.black-overlay\n    position: fixed\n    top: 0\n    left: 0\n    width: 100%\n    height: 100%\n    background-color: rgba(0, 0, 0, 0.4)\n    z-index: 1001\n/* z-index */\n\n#roll-buttom-button\n    position: fixed\n    right: 0.5rem\n    cursor: pointer\n    display: flex\n    z-index: 1000\n    background-color: #fff\n    width: 4rem\n    height: 1.5rem\n    border-radius: 0.75rem\n    align-items: center\n    justify-content: center\n    box-shadow: 0 0 0.25rem rgba(0, 0, 0, 0.2)\n    transition: background-color 0.3s ease, transform 0.3s ease\n    &:hover\n        background-color: #f0f0f0\n        transform: scale(1.1)\n\n    &:hover\n        color: $icon-hover\n    i\n        font-size: 1rem\n\n#theimg\n    position: fixed\n    top: 50%\n    left: 50%\n    transform: translate(-50%, -50%)\n    max-height: 75%\n    max-width: 50%\n.inner-content\n  display: flex\n\n.background img\n    position: absolute\n    top: 50%\n    left: 50%\n    transform: translate(-50%, -50%)\n\n.message-body > .avatar\n  cursor: pointer\n  flex-basis: 2.65rem\n  min-width: 2.65rem\n  height: 2.65rem\n\n\n.avatar > img\n  width: 100%\n  height: 100%\n  border-radius: 50%\n\n\n.window-controls\n    display: flex\n    flex-basis: 100%\n\n    @media (max-width: $mobile)\n        display: none\n\n    .button\n        display: flex\n        justify-content: center\n        padding-top: 0.5rem\n        flex: 0 0 2rem\n\n        &:hover\n            background-color: rgb(231, 231, 231)\n\n        &#close:hover\n            background-color: rgb(255, 0, 0)\n            color: white\n\n\n.button#close:hover svg path\n    fill: #fff\n\n\n.voice-box\n    display: flex\n    width: 11.25rem\n    height: 1.5rem\n    margin: 0.25rem 0\n\n    .icon\n        flex-basis: 1.5rem\n        background-color: rgb(0, 0, 0)\n        display: flex\n        justify-content: center\n        align-items: center\n        border-radius: 50%\n\n    .wave\n        display: flex\n        justify-content: center\n        align-items: center\n        flex-grow: 1\n\n.wave svg\n    height: 1.25rem\n    width: 80%\n\n.loader\n    width: 0.625rem\n    padding: 0.25rem\n    aspect-ratio: 1\n    border-radius: 50%\n    background: rgb(0, 153, 255)\n    --_m: conic-gradient(#0000 10%, #000), linear-gradient(#000 0 0) content-box\n    -webkit-mask: var(--_m)\n    mask: var(--_m)\n    -webkit-mask-composite: source-out\n    mask-composite: subtract\n    animation: l3 1s infinite linear\n    position: absolute\n\n@keyframes move\n    0%\n        left: -20% // \n    100%\n        left: 120% // \n\n.blank-loader\n    width: 10%\n    height: 200%\n    position: absolute\n    background: linear-gradient(to right, rgb(255, 255, 255), rgb(0, 0, 0) 50%, transparent 50%, transparent)\n    top: -50%\n    transform: rotate(30deg)\n    filter: blur(5px)\n    animation: move 1s linear infinite // 1s\n\n@keyframes l\n    to\n        transform: rotate(1turn)\n\n@media (max-width: 600px)\n    #chatwindow\n        height: 100%\n\n    .upsidebar\n        white-space: nowrap\n        max-width: 7rem\n        text-overflow: ellipsis\n        overflow: hidden\n        background: #00a8ff linear-gradient(to right, #00d2f8, #00a8ff)\n\n    .upsidebar *\n        color: white\n        fill: white\n\n    .delay-num\n        color: black\n\n    .window-controls\n        display: none\n\n    .name-area\n        padding-bottom: 0.25rem\n\n    .input-area\n        overflow-y: auto\n\n    .inputbar\n        flex-basis: 4rem\n\n    .delay-status\n        position: relative\n        top: -.2rem\n</style>\n","<template>\n  <div class=\"blank-view\">\n    <div class=\"upside-bar\">\n      <div class=\"options\"></div>\n    </div>\n  </div>\n</template>\n<script>\nimport { client } from \"@/lib/runtime.js\";\n\nexport default {\n  name: \"BlankView\",\n  data() {\n    return {\n      fullScreen: false,\n      client: client,\n    };\n  },\n  watch: {},\n  created() {\n    this.fullScreen = client.fullScreen;\n  },\n  methods: {\n    waiting() {\n      this.$message({ message: \"\", type: \"warning\" });\n    },\n  },\n};\n</script>\n<style lang=\"sass\" scoped>\n.blank-view\n  background-color: #f2f2f2\n  flex-grow: 1\n\n.upside-bar\n    flex-basis: 3.75rem\n    flex-shrink: 0\n    height: 3.75rem\n    width: 100%\n    display: flex\n    align-items: flex-end\n    flex-direction: row-reverse\n    justify-content: space-between\n\n    .options\n        flex-basis: 6rem\n        display: flex\n        height: 100%\n        width: 100%\n        flex-wrap: wrap\n        flex-direction: row-reverse\n</style>\n","<template>\n  <div v-if=\"!onPhone\" id=\"main\">\n    <friendlist></friendlist>\n    <router-view v-if=\"loaded\"></router-view>\n    <blankView v-else></blankView>\n  </div>\n  <div v-else-if=\"pagePath === '/'\" id=\"main-mobile\">\n    <friendlist v-if=\"loaded\"></friendlist>\n    <blankView v-else></blankView>\n  </div>\n  <div v-else id=\"main-mobile\" class=\"mobile-chat\">\n    <router-view v-if=\"loaded\"></router-view>\n    <blankView v-else></blankView>\n  </div>\n</template>\n\n<script>\nimport friendlist from \"@/components/FriendList.vue\";\nimport { client } from \"@/lib/runtime.js\";\nimport blankView from \"@/views/BlankView.vue\";\n\nexport default {\n  components: {\n    friendlist,\n    blankView,\n  },\n  data() {\n    const onPhone = window.innerWidth < 600;\n    return {\n      onPhone,\n      pagePath: this.$route.path,\n      loaded: false,\n    };\n  },\n  watch: {\n    $route: function (newVal) {\n      this.pagePath = newVal.path;\n    },\n  },\n  mounted() {\n    if (client.inited) {\n      this.loaded = true;\n    } else {\n      client.on(\n        \"loaded\",\n        () => {\n          this.loaded = true;\n        },\n        false,\n      );\n    }\n  },\n};\n</script>\n\n<style>\n#main {\n  background-color: rgb(255, 255, 255);\n  flex-grow: 1;\n  display: flex;\n  width: calc(100% - 4.5rem);\n  background-color: #f2f2f2;\n}\n\n#main > .profile-body {\n  margin-top: 4rem;\n}\n\n#main-mobile {\n  width: 100%;\n  max-height: calc(100vh - 4rem);\n  background-color: rgb(255, 255, 255);\n  flex-grow: 1;\n  display: flex;\n}\n\n.mobile-chat#main-mobile {\n  max-height: 100%;\n}\n</style>\n","<template>\n  <div class=\"profile-body\">\n    <div id=\"profile\">\n      <div class=\"profile-container\">\n        <div class=\"base-info\">\n          <div class=\"base-info-avatar\">\n            <el-image\n              :src=\"activeContactor.avatar\"\n              :preview-src-list=\"[activeContactor.avatar]\"\n            />\n          </div>\n          <div class=\"base-info-content\">\n            <div class=\"name\">{{ activeContactor.name }}</div>\n            <div class=\"id\">ID {{ activeContactor.id }}</div>\n            <div class=\"status\">\n              <span :class=\"'delay-status ' + getDelayStatus\"></span>\n              \n            </div>\n          </div>\n          <!-- LLM Provider select is now inside ContactorSettings -->\n        </div>\n\n        <div class=\"info-blocks\">\n          <div class=\"settings-block\">\n            <div class=\"block-title\">Bot </div>\n            <div class=\"block-content\">\n              <div class=\"block-content-item\">\n                <div class=\"contactor-name item-title\"></div>\n                <div class=\"item-content\">\n                  <el-input\n                    v-model=\"basicInfo.name\"\n                    :disabled=\"basicInfo.namePolicy !== 1\"\n                  ></el-input>\n                </div>\n              </div>\n              <div class=\"block-content-item\">\n                <div class=\"item-title\"></div>\n                <div class=\"item-content\">\n                  <el-input \n                    v-if=\"basicInfo.avatarPolicy !== 1\"\n                    :value=\"''\"\n                    :disabled=\"true\"\n                  ></el-input>\n                  <el-input \n                    v-else\n                    v-model=\"basicInfo.avatar\"\n                    :disabled=\"isOnebot\"\n                  ></el-input>\n                </div>\n              </div>\n              <div v-if=\"!isOnebot\" class=\"block-content-item\">\n                <div class=\"item-title\"></div>\n                <div class=\"item-content\">\n                  <el-select v-model=\"basicInfo.avatarPolicy\"\n                  @change=\"updateContactorAvatar\"\n                  >\n                    <el-option\n                      v-for=\"item in avatarPolicyList\"\n                      :key=\"item.value\"\n                      :label=\"item.label\"\n                      :value=\"item.value\"\n                    />\n                  </el-select>\n                </div>\n              </div>\n              <div v-if=\"!isOnebot\" class=\"block-content-item\">\n                <div class=\"item-title\"></div>\n                <div class=\"item-content\">\n                  <el-select\n                    v-model=\"basicInfo.namePolicy\"\n                    @change=\"updateContactorName\"\n                  >\n                    <el-option\n                      v-for=\"item in namePolicyList\"\n                      :key=\"item.value\"\n                      :label=\"item.label\"\n                      :value=\"item.value\"\n                    />\n                  </el-select>\n                </div>\n              </div>\n              <div class=\"block-content-item\">\n                <div class=\"item-title\"></div>\n                <div class=\"item-content\">\n                  <el-switch v-model=\"basicInfo.priority\"> </el-switch>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n\n        <div class=\"info-blocks\">\n          <ContactorSettings\n            v-if=\"!isOnebot\"\n            v-model:model-value=\"options\"\n            :active-contactor-platform=\"activeContactor.platform\"\n            :llm-providers-list=\"llmProviders\"\n            :tool-call-modes-list=\"toolCallModes\"\n            :all-llm-tools-data=\"allLLMTools\"\n            :safety-settings-params=\"safetyParams\"\n            :safety-simple-value-options=\"safetySimpleValue\"\n            :presets-history-data=\"options.presetSettings?.history\"\n            @provider-changed=\"handleProviderSwitched\"\n            @update-presets=\"handleUpdateOpenaiPresets\"\n          />\n        </div>\n      </div>\n    </div>\n    <div class=\"action-bar\">\n      <el-button plain @click=\"$router.push(`/chat/${activeContactor.id}`)\">\n        \n      </el-button>\n      <el-button type=\"danger\" plain @click=\"centerDialogVisible = true\">\n        \n      </el-button>\n      <el-dialog v-model=\"centerDialogVisible\" title=\"\" width=\"300\" center class=\"confirm-dialog\">\n        <span>  </span>\n        <template #footer>\n          <div class=\"dialog-footer\">\n            <el-button @click=\"centerDialogVisible = false\"></el-button>\n            <el-button type=\"primary\" @click=\"delContactor\">  </el-button>\n          </div>\n        </template>\n      </el-dialog>\n    </div>\n  </div>\n</template>\n\n<script>\nimport ContactorSettings from \"@/components/ContactorSettings.vue\"; // Import the new component\nimport { client, config } from \"@/lib/runtime.js\";\n\nexport default {\n  components: {\n    ContactorSettings, // Register the new component\n  },\n  data() {\n    const currentId = parseInt(this.$route.params.id);\n    const contactor = client.getContactor(currentId);\n\n    const toolCallModes = config.getToolCallModes();\n    const providers = config.getLLMProviders();\n    const safetyParams = config.getSafetySettingsParams();\n    const safetySimpleValue = Object.keys(safetyParams).map((key) => ({\n      value: key,\n      label: key,\n    }));\n\n    // Initial construction of allLLMTools remains here as it depends on global config\n    const allLLMTools = [];\n    for (const key in config.llmTools) {\n      const toolsObject = config.llmTools[key];\n      const toolsList = Object.keys(toolsObject).map((toolKey) => ({\n        enabled: false, // Initial state, child component will sync with options\n        ...toolsObject[toolKey],\n      }));\n      allLLMTools.push({\n        name: key,\n        tools: toolsList,\n        collapsed: true,\n      });\n    }\n    const avatarPolicyList = [\n      { value: 0, label: \"\" },\n      { value: 1, label: \"\" },\n    ];\n    const namePolicyList = [\n      { value: 0, label: \"\" },\n      { value: 1, label: \"\" },\n      { value: 2, label: \"\" },\n    ];\n\n    return {\n      activeContactor: contactor,\n      options: null, // Will be initialized in initContactor\n      currentDelay: 0,\n      centerDialogVisible: false,\n      avatarPolicyList: avatarPolicyList,\n      namePolicyList: namePolicyList,\n      isOnebot: contactor.platform === \"onebot\",\n\n      // Static config passed as props\n      llmProviders: providers,\n      toolCallModes: toolCallModes,\n      safetyParams: safetyParams,\n      safetySimpleValue: safetySimpleValue,\n      allLLMTools: allLLMTools, // This structure is passed to child\n      basicInfo: null,\n    };\n  },\n  computed: {\n    getDelayStatus() {\n      return this.currentDelay > 1000\n        ? \"high\"\n        : this.currentDelay > 500\n          ? \"mid\"\n          : this.currentDelay > 100\n            ? \"low\"\n            : \"ultra\";\n    },\n    getAvatarPolicyValue() {\n      return this.basicInfo.avatarPolicy === 1 ? \"\" : \"\";\n    },\n  },\n  watch: {\n    \"$route.params.id\"(newVal) {\n      const newId = parseInt(newVal);\n      this.activeContactor = client.getContactor(newId);\n      if (this.activeContactor) {\n        this.isOnebot = this.activeContactor.platform === \"onebot\";\n      }\n      this.initContactor();\n    },\n    options: {\n      handler(newOptions) {\n        if (newOptions && this.activeContactor) {\n          // Sync back to the source of truth\n          this.activeContactor.options = JSON.parse(JSON.stringify(newOptions));\n          client.setLocalStorage();\n        }\n      },\n      deep: true,\n    },\n    basicInfo: {\n      handler(newInfo) {\n        if (newInfo && this.activeContactor) {\n          // Sync back to the source of truth\n          this.activeContactor.name = newInfo.name;\n          this.activeContactor.avatar = newInfo.avatar;\n          this.activeContactor.namePolicy = newInfo.namePolicy;\n          this.activeContactor.avatarPolicy = newInfo.avatarPolicy;\n          this.activeContactor.priority = newInfo.priority ? 0 : 1;\n          client.setLocalStorage();\n        }\n      },\n      deep: true,\n    },\n  },\n  created() {\n    // Use created instead of beforeMount for data initialization\n    this.initContactor();\n  },\n  mounted() {\n    this.delayInterval = setInterval(() => {\n      this.currentDelay = client.socket.delay;\n    }, 3000);\n  },\n  beforeUnmount() {\n    if (this.delayInterval) {\n      clearInterval(this.delayInterval);\n    }\n  },\n  methods: {\n    initContactor() {\n      // Deep clone options to avoid direct mutation of contactor's options by child\n      // The watcher on `this.options` will handle persisting changes.\n      this.options = JSON.parse(JSON.stringify(this.activeContactor.options));\n\n      const { name, avatar, namePolicy, avatarPolicy, priority } =\n        this.activeContactor;\n      this.basicInfo = {\n        name,\n        avatar,\n        namePolicy,\n        avatarPolicy,\n        priority: priority === 1 ? false : true,\n      };\n\n      // If contactor platform is onebot, tool call related options might need to be forced\n      if (this.activeContactor.platform === \"onebot\") {\n        if (this.options.toolCallSettings) {\n          this.options.toolCallSettings.mode = \"none\";\n          this.options.toolCallSettings.tools = [];\n        }\n      }\n      // The child component `ContactorSettings` will use this.options\n      // to initialize its internal state.\n    },\n    handleUpdateOpenaiPresets(presets) {\n      if (this.options && this.options.presetSettings) {\n        this.options.presetSettings.history = presets;\n        // The watcher on `this.options` will trigger saving\n        this.$message({\n          message: \"\",\n          type: \"success\",\n        });\n      }\n    },\n    async delContactor() {\n      this.centerDialogVisible = false;\n      await client.rmContactor(this.activeContactor.id);\n      this.$router.push(\"/\");\n    },\n    handleProviderSwitched() {\n      // This event is specifically for actions parent needs to take,\n      // like reloading avatar, that are outside the 'options' object.\n      this.activeContactor.loadAvatar();\n      // The options object (including provider and default model)\n      // would have already been updated by the child component via v-model.\n    },\n\n    updateContactorName() {\n      if (this.basicInfo.namePolicy === 0) {\n        this.basicInfo.name = this.activeContactor.options.base.model;\n      }\n    },\n    updateContactorAvatar() {\n      const { avatarPolicy } = this.basicInfo;\n      this.activeContactor.avatarPolicy = avatarPolicy;\n      this.basicInfo.avatar = this.activeContactor.loadAvatar();\n    }\n  },\n};\n</script>\n\n<style>\n/* Copied from parent for .settings-block, .block-title etc. */\n.block-title {\n  font-size: 0.8rem;\n}\n.block-content {\n  margin-top: 0.5rem;\n  margin-bottom: 1rem;\n  width: 100%;\n  display: flex;\n  background-color: #fff;\n  min-height: 1rem;\n  border-radius: 0.5rem;\n  flex-direction: column;\n}\n.block-content:last-child {\n  margin-bottom: 2rem;\n}\n.block-content-item {\n  max-height: 50rem; /* Ensure this is sufficient for PresetsList */\n  overflow-y: auto;\n  transition: max-height 0.5s ease;\n  position: relative;\n  display: flex;\n  width: 100%;\n  justify-content: space-between;\n  flex-wrap: nowrap;\n}\n.block-content-item.parent-item {\n  flex-wrap: wrap;\n}\n.child-item {\n  width: calc(100% - 1rem);\n  padding-left: 1rem;\n}\n.item-hidden-content {\n  width: 100%;\n}\n/* Styles specific to settings can be moved here or kept in parent if generic enough */\n.settings-container {\n  width: 100%;\n}\n.base-info-provider {\n  /* Copied from parent, ensure it's styled correctly in context */\n  display: flex;\n  justify-content: flex-end;\n  align-items: center;\n  padding-right: 2rem;\n  margin-bottom: 1rem; /* Added margin for spacing */\n}\n\n.plugin-tools-container {\n  max-height: 20rem;\n  overflow-y: auto;\n  -webkit-overflow-scrolling: touch;\n}\n.block-content-item::after {\n  content: \"\";\n  position: absolute;\n  bottom: 0;\n  left: 5%;\n  width: 90%;\n  height: 1px;\n  background-color: rgba(145, 145, 145, 0.155);\n}\n.item-title {\n  font-size: 0.8rem;\n  margin-left: 1rem;\n  height: 2.5rem;\n  display: flex;\n  flex-grow: 1;\n  align-items: center;\n  justify-content: flex-start;\n  max-width: calc(100% - 5rem);\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n.item-content {\n  transform: scale(0.9);\n  flex-basis: 2rem;\n  display: flex;\n  align-items: center;\n  justify-content: flex-end;\n  margin-right: 1.5rem;\n}\n.item-content .el-input-number,\n.item-content .el-input,\n.item-content .el-slider,\n.item-content .el-select {\n  width: 10rem;\n}\n.sub-items {\n  width: 100%;\n  display: flex;\n  flex-direction: column;\n  padding-left: 0; /* Reset ul default padding */\n  list-style: none; /* Reset ul default list-style */\n}\n.extra-info-button.active {\n  transform: rotate(-90deg);\n}\n.item-content button {\n  background-color: transparent;\n  border: none; /* Ensure button is clean */\n  cursor: pointer; /* Add cursor pointer */\n  transition: transform 0.3s ease;\n}\n.block-content-item.hidden {\n  /* This style seems unused, but keeping for now */\n  min-height: 0px;\n  max-height: 0px;\n}\n/*  - Kept in parent as it's a general utility transition */\n.expand-slide-enter-active,\n.expand-slide-leave-active {\n  transition:\n    max-height 0.4s cubic-bezier(0.78, 0.14, 0.15, 0.86),\n    opacity 0.4s;\n}\n.expand-slide-enter-from,\n.expand-slide-leave-to {\n  max-height: 0;\n  opacity: 0;\n}\n.expand-slide-enter-to,\n.expand-slide-leave-from {\n  max-height: 20rem; /* Adjust if necessary for PresetsList or other content */\n  opacity: 1;\n}\n</style>\n\n<style scoped>\n/* Styles from original component that are general layout */\n#profile {\n  position: relative;\n  flex-grow: 1;\n  display: flex;\n  flex-direction: column;\n  justify-content: flex-start;\n  align-items: center;\n}\n/* .sub-items and other specific styles are now in ContactorSettings.vue or can be if specific to it */\n/* Keep .base-info-provider here if it's also used for other things, or move if only for provider select */\n/* Moved to child: .base-info-provider */\n\n.profile-container {\n  overflow-y: auto;\n  margin: 2rem 0rem 0rem 0rem;\n  width: calc(100% - 8rem);\n  min-width: 20rem;\n  max-width: 40rem;\n  display: flex;\n  flex-direction: column;\n}\n.base-info {\n  background-color: #fff;\n  border-radius: 0.5rem;\n  display: flex;\n  padding-bottom: 1rem;\n  border-bottom: 1px solid #88888888;\n  flex-wrap: wrap;\n  margin-bottom: 2rem; /* This was on base-info, now applies before info-blocks */\n}\n.base-info-avatar {\n  margin-top: 1rem;\n  margin-left: 1rem;\n  flex-basis: 5.5rem;\n  height: 5.5rem;\n}\n.base-info-avatar .el-image {\n  width: 100%;\n  height: 100%;\n  border-radius: 50%;\n}\n.base-info-content {\n  margin-left: 1.5rem;\n  margin-top: 1rem;\n  display: flex;\n  flex-direction: column;\n}\n.base-info-content .name {\n  font-size: 1.25rem;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  max-width: 15rem;\n}\n.base-info-content .id {\n  margin-top: 0.25rem;\n  font-size: 0.75rem;\n  color: dimgrey;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  max-width: 15rem;\n}\n.base-info-content .status {\n  margin-top: 0.25rem;\n}\n.info-blocks {\n  display: flex;\n  flex-direction: column;\n  justify-content: space-between;\n}\n.action-bar {\n  position: sticky;\n  background-color: #f2f2f2;\n  bottom: 0px;\n  left: 0px;\n  display: flex;\n  justify-content: space-around;\n  align-items: center;\n  height: 6rem;\n  width: 100%;\n  z-index: 2;\n}\n.profile-body {\n  position: relative;\n  overflow-y: auto;\n  flex-grow: 1;\n  background-color: #f2f2f2;\n}\n</style>\n\n<style scoped lang=\"sass\">\n/* SASS styles remain in parent */\n.delay-status\n  display: inline-block\n  width: 1rem\n  height: 1rem\n  border-radius: 50%\n  transform: translateY(.25rem)\n  margin-right: .25rem\n  &:hover + .delay-num\n    display: inline-block\n  &.ultra\n    background-color: rgb(53, 233, 146)\n  &.low\n    background-color: rgb(255, 204, 0)\n  &.mid\n    background-color: rgb(255, 102, 102)\n  &.high\n    background-color: #ccc\n</style>\n","<template>\n  <div id=\"settings-view\" :class=\"{ 'mobile-layout': isMobile }\">\n    <!--  -->\n    <div v-if=\"isMobile\" class=\"mobile-header\" :class=\"{ 'sub-page': isInSubPage(), 'main-page': !isInSubPage() }\">\n      <div class=\"mobile-header-content\" :class=\"{ 'sub-page': isInSubPage() }\">\n        <button class=\"back-button\" @click=\"handleBackToHome\" :title=\"getBackButtonTitle()\">\n          <!--  -->\n          <svg v-if=\"isInSubPage()\" width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\">\n            <path d=\"M19 12H5M12 19l-7-7 7-7\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"/>\n          </svg>\n          <!--  -->\n          <svg v-else width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\">\n            <path d=\"M18 6L6 18M6 6l12 12\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\"/>\n          </svg>\n        </button>\n        <h1 class=\"mobile-title\">{{ getMobileTitle() }}</h1>\n        <button v-if=\"showMobileMenu\" class=\"menu-button\" @click=\"toggleMobileMenu\">\n          <svg width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\">\n            <path d=\"M3 12h18M3 6h18M3 18h18\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\"/>\n          </svg>\n        </button>\n      </div>\n    </div>\n\n    <!--  -->\n    <el-alert\n      v-if=\"configStore.needRestart\"\n      type=\"warning\"\n      :closable=\"false\"\n      show-icon\n      class=\"restart-banner\"\n      :class=\"{ 'mobile': isMobile }\"\n    >\n      <template #title>\n        <div class=\"restart-banner-content\">\n          <span>{{ isMobile ? '' : '' }}</span>\n          <el-button\n            type=\"warning\"\n            :size=\"isMobile ? 'small' : 'small'\"\n            @click=\"handleRestartService\"\n          >\n            \n          </el-button>\n        </div>\n      </template>\n    </el-alert>\n\n    <!--  -->\n    <div v-if=\"isMobile\" class=\"mobile-menu-overlay\" :class=\"{ 'show': mobileMenuVisible }\" @click=\"closeMobileMenu\">\n      <div class=\"mobile-menu-drawer\" :class=\"{ 'show': mobileMenuVisible }\" @click.stop>\n        <div class=\"mobile-menu-header\">\n          <h2></h2>\n          <button class=\"close-button\" @click=\"closeMobileMenu\">\n            <svg width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\">\n              <path d=\"M18 6L6 18M6 6l12 12\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\"/>\n            </svg>\n          </button>\n        </div>\n        <div class=\"mobile-menu-content\">\n          <div\n            v-for=\"item in menuItems\"\n            :key=\"item.index\"\n            class=\"mobile-menu-item\"\n            :class=\"{ 'active': activeMenu === item.index }\"\n            @click=\"handleMobileMenuSelect(item.index)\"\n          >\n            <component :is=\"item.icon\" class=\"menu-icon\" />\n            <span>{{ item.label }}</span>\n          </div>\n          \n          <!--  -->\n          <div class=\"mobile-quick-actions\">\n            <div class=\"quick-action-item\" @click=\"handleReset\">\n              <span></span>\n            </div>\n            <div class=\"quick-action-item\" @click=\"handleResetCache\">\n              <span></span>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n\n    <!--  -->\n    <div class=\"settings-container\" :class=\"{ 'mobile': isMobile }\">\n      <!--  -  -->\n      <aside v-if=\"!isMobile\" class=\"settings-sidebar\">\n        <el-menu\n          :default-active=\"activeMenu\"\n          class=\"settings-menu\"\n          @select=\"handleMenuSelect\"\n        >\n          <el-menu-item\n            v-for=\"item in menuItems\"\n            :key=\"item.index\"\n            :index=\"item.index\"\n          >\n            <el-icon><component :is=\"item.icon\" /></el-icon>\n            <span>{{ item.label }}</span>\n          </el-menu-item>\n        </el-menu>\n\n        <!--  -->\n        <div class=\"quick-actions\">\n          <el-button type=\"info\" plain @click=\"handleReset\" style=\"width: 100%\">\n            \n          </el-button>\n          <el-button type=\"info\" plain @click=\"handleResetCache\" style=\"width: 100%\">\n            \n          </el-button>\n        </div>\n      </aside>\n\n      <!--  -->\n      <main class=\"settings-content\" :class=\"{ 'mobile': isMobile }\">\n        <!--  -->\n        <div class=\"content-header-spacer\"></div>\n        \n        <template v-if=\"forbidden\">\n          <div class=\"forbidden-container\" :class=\"{ 'mobile': isMobile }\">\n            <el-result\n              icon=\"error\"\n              title=\"\"\n              sub-title=\"\"\n            >\n              <template #extra>\n                <el-button type=\"primary\" @click=\"handleSwitchAccount\"></el-button>\n                <el-button @click=\"handleReturnHome\"></el-button>\n              </template>\n            </el-result>\n          </div>\n        </template>\n        <template v-else>\n          <ErrorBoundary\n            fallback-title=\"\"\n            fallback-message=\"\"\n          >\n            <router-view v-slot=\"{ Component }\">\n              <transition name=\"page-fade\" mode=\"out-in\">\n                <component :is=\"Component\" />\n              </transition>\n            </router-view>\n          </ErrorBoundary>\n        </template>\n      </main>\n    </div>\n  </div>\n</template>\n\n<script setup>\nimport ErrorBoundary from '@/components/settings/ErrorBoundary.vue';\nimport { client } from '@/lib/runtime.js';\nimport { useConfigStore } from '@/stores/configStore.js';\nimport {\n  ChatDotRound,\n  ChromeFilled,\n  Connection,\n  Document,\n  Grid,\n  Menu,\n  Monitor\n} from '@element-plus/icons-vue';\nimport { ElMessage, ElMessageBox } from 'element-plus';\nimport { computed, onMounted, onUnmounted, ref } from 'vue';\nimport { useRoute, useRouter } from 'vue-router';\n\nconst route = useRoute();\nconst router = useRouter();\nconst configStore = useConfigStore();\nconst forbidden = ref(false);\n\n// \nconst isMobile = ref(false);\nconst mobileMenuVisible = ref(false);\n\n// \nconst showMobileMenu = computed(() => {\n  // \n  return route.path === '/settings';\n});\n\n// \nconst menuItems = [\n  { index: 'overview', label: '', icon: Menu },\n  { index: 'llm-adapters', label: 'LLM ', icon: Connection },\n  { index: 'server', label: '', icon: Monitor },\n  { index: 'web', label: 'Web ', icon: ChromeFilled },\n  { index: 'onebot', label: 'OneBot ', icon: ChatDotRound },\n  { index: 'plugins', label: '', icon: Grid },\n  { index: 'presets', label: '', icon: Document },\n  { index: 'logs', label: '', icon: Document }\n];\n\n//  admin_code  /auth\nconst handleSwitchAccount = () => {\n  configStore.clearAdminCode();\n  router.push({ path: '/auth', query: { redirect: route.fullPath || route.path } });\n};\n\n// \nconst handleReturnHome = () => {\n  router.push('/');\n};\n\n// \nconst checkMobile = () => {\n  isMobile.value = window.innerWidth <= 768;\n};\n\n// \nconst activeMenu = computed(() => {\n  const path = route.path;\n  if (path.includes('llm-adapters')) return 'llm-adapters';\n  if (path.includes('server')) return 'server';\n  if (path.includes('web')) return 'web';\n  if (path.includes('onebot')) return 'onebot';\n  if (path.includes('plugins')) return 'plugins';\n  if (path.includes('presets')) return 'presets';\n  if (path.includes('logs')) return 'logs';\n  return 'overview';\n});\n\n// \nconst isInSubPage = () => {\n  const currentPath = route.path;\n  return currentPath !== '/settings' && currentPath.startsWith('/settings/');\n};\n\n// \nconst getBackButtonTitle = () => {\n  return isInSubPage() ? '' : '';\n};\n\n// \nconst getMobileTitle = () => {\n  const currentPath = route.path;\n  \n  // \"\"\n  if (currentPath === '/settings') {\n    return '';\n  }\n  \n  // \n  const currentItem = menuItems.find(item => item.index === activeMenu.value);\n  return currentItem ? currentItem.label : '';\n};\n\n// \nconst toggleMobileMenu = () => {\n  mobileMenuVisible.value = !mobileMenuVisible.value;\n};\n\nconst closeMobileMenu = () => {\n  mobileMenuVisible.value = false;\n};\n\nconst handleMobileMenuSelect = (index) => {\n  handleMenuSelect(index);\n  closeMobileMenu();\n};\n\nconst handleBackToHome = () => {\n  // \n  const currentPath = route.path;\n  \n  // \n  if (currentPath !== '/settings' && currentPath.startsWith('/settings/')) {\n    router.push('/settings');\n  } else {\n    // \n    router.push('/');\n  }\n};\n\n// \nconst handleMenuSelect = (index) => {\n  if (index === 'overview') {\n    router.push('/settings');\n  } else {\n    router.push(`/settings/${index}`);\n  }\n};\n\n// \nconst handleRestartService = async () => {\n  try {\n    await ElMessageBox.confirm(\n      '',\n      '',\n      {\n        confirmButtonText: '',\n        cancelButtonText: '',\n        type: 'warning'\n      }\n    );\n\n    ElMessage.info('');\n    // TODO:  API\n    // await configAPI.restartService();\n  } catch (error) {\n    // \n  }\n};\n\n// \nconst handleReset = async () => {\n  try {\n    await ElMessageBox.confirm(\n      '',\n      '',\n      {\n        confirmButtonText: '',\n        cancelButtonText: '',\n        type: 'warning'\n      }\n    );\n\n    const result = await client.reset();\n    if (result) {\n      ElMessage.success('');\n      setTimeout(() => {\n        window.location.reload();\n      }, 500);\n    }\n  } catch (error) {\n    if (error !== 'cancel') {\n      ElMessage.error('' + error.message);\n    }\n  }\n};\n\n// \nconst handleResetCache = async () => {\n  try {\n    await ElMessageBox.confirm(\n      '',\n      '',\n      {\n        confirmButtonText: '',\n        cancelButtonText: '',\n        type: 'warning'\n      }\n    );\n\n    await client.resetCache();\n    ElMessage.success('');\n    setTimeout(() => {\n      window.location.reload();\n    }, 500);\n  } catch (error) {\n    if (error !== 'cancel') {\n      ElMessage.error('' + error.message);\n    }\n  }\n};\n\n// \nonMounted(async () => {\n  // \n  checkMobile();\n  window.addEventListener('resize', checkMobile);\n  \n  // \n  if (configStore.isAuthenticated) {\n    try {\n      await configStore.fetchConfig();\n      // \n    } catch (error) {\n      // \n      forbidden.value = true;\n      console.warn('', error);\n    }\n  } else {\n    // \n    forbidden.value = true;\n  }\n});\n\nonUnmounted(() => {\n  window.removeEventListener('resize', checkMobile);\n});\n</script>\n\n<style scoped lang=\"scss\">\n// \n.page-fade-enter-active,\n.page-fade-leave-active {\n  transition: all 0.25s ease;\n}\n\n.page-fade-enter-from {\n  opacity: 0;\n  transform: translateX(10px);\n}\n\n.page-fade-leave-to {\n  opacity: 0;\n  transform: translateX(-10px);\n}\n\n#settings-view {\n  width: calc(100% - 3.8rem);\n  height: 100vh;\n  display: flex;\n  flex-direction: column;\n  background-color: #f2f3f5; // \n\n  &.mobile-layout {\n    width: 100%;\n    height: 100vh;\n    background-color: #f8f9fa;\n  }\n}\n\n// \n.mobile-header {\n  position: sticky;\n  top: 0;\n  z-index: 100;\n  background-color: #fff;\n  border-bottom: 1px solid #e4e7ed;\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06);\n}\n\n.mobile-header-content {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding: 12px 16px;\n  height: 56px;\n  box-sizing: border-box;\n}\n\n.back-button,\n.menu-button {\n  width: 40px;\n  height: 40px;\n  border: none;\n  background: none;\n  color: #606266;\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  border-radius: 8px;\n  transition: background-color 0.2s;\n\n  &:hover {\n    background-color: #f5f7fa;\n  }\n}\n\n.mobile-title {\n  font-size: 18px;\n  font-weight: 600;\n  color: #303133;\n  margin: 0;\n  flex: 1;\n  text-align: center;\n  transition: color 0.2s;\n}\n\n// \n.mobile-menu-overlay {\n  position: fixed;\n  top: 0;\n  left: 0;\n  width: 100vw;\n  height: 100vh;\n  background-color: rgba(0, 0, 0, 0.5);\n  z-index: 9999;\n  opacity: 0;\n  visibility: hidden;\n  transition: all 0.3s ease;\n\n  &.show {\n    opacity: 1;\n    visibility: visible;\n  }\n}\n\n.mobile-menu-drawer {\n  position: absolute;\n  top: 0;\n  right: 0;\n  width: 280px;\n  height: 100%;\n  background-color: #fff;\n  transform: translateX(100%);\n  transition: transform 0.3s ease;\n  display: flex;\n  flex-direction: column;\n\n  &.show {\n    transform: translateX(0);\n  }\n}\n\n.mobile-menu-header {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding: 16px 20px;\n  border-bottom: 1px solid #e4e7ed;\n\n  h2 {\n    margin: 0;\n    font-size: 18px;\n    font-weight: 600;\n    color: #303133;\n  }\n}\n\n.close-button {\n  width: 32px;\n  height: 32px;\n  border: none;\n  background: none;\n  color: #909399;\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  border-radius: 6px;\n  transition: background-color 0.2s;\n\n  &:hover {\n    background-color: #f5f7fa;\n  }\n}\n\n.mobile-menu-content {\n  flex: 1;\n  overflow-y: auto;\n  padding: 8px 0;\n}\n\n.mobile-menu-item {\n  display: flex;\n  align-items: center;\n  padding: 16px 20px;\n  cursor: pointer;\n  transition: background-color 0.2s;\n  color: #606266;\n\n  &:hover {\n    background-color: #f5f7fa;\n  }\n\n  &.active {\n    background-color: #ecf5ff;\n    color: #409eff;\n    font-weight: 500;\n  }\n\n  .menu-icon {\n    width: 20px;\n    height: 20px;\n    margin-right: 12px;\n  }\n\n  span {\n    font-size: 16px;\n  }\n}\n\n.mobile-quick-actions {\n  border-top: 1px solid #e4e7ed;\n  padding: 8px 0;\n  margin-top: 8px;\n}\n\n.quick-action-item {\n  display: flex;\n  align-items: center;\n  padding: 12px 20px;\n  cursor: pointer;\n  transition: background-color 0.2s;\n  color: #909399;\n  font-size: 14px;\n\n  &:hover {\n    background-color: #f5f7fa;\n  }\n}\n\n.restart-banner {\n  margin: 0;\n  border-radius: 0;\n  border: none;\n  border-bottom: 1px solid #e4e7ed;\n\n  &.mobile {\n    margin: 0;\n    border-radius: 0;\n  }\n\n  :deep(.el-alert__content) {\n    width: 100%;\n  }\n}\n\n.restart-banner-content {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  width: 100%;\n}\n\n.settings-container {\n  display: flex;\n  flex: 1;\n  overflow: hidden;\n  padding: 16px; // \n  gap: 16px;\n\n  &.mobile {\n    padding: 0;\n    gap: 0;\n    flex-direction: column;\n  }\n}\n\n.settings-sidebar {\n  width: 220px;\n  background: transparent; // \n  border-right: none; // \n  display: flex;\n  flex-direction: column;\n  overflow-y: auto;\n  position: relative;\n  z-index: 30;\n  padding-right: 8px;\n}\n\n.settings-menu {\n  flex: 1;\n  border: none;\n  background: transparent;\n  \n  :deep(.el-menu-item) {\n    height: 50px;\n    line-height: 50px;\n    margin-bottom: 4px;\n    border-radius: 8px; // \n    color: #606266;\n    \n    &:hover {\n      background-color: rgba(0, 0, 0, 0.04);\n    }\n    \n    &.is-active {\n      background-color: #fff; // \n      color: #409eff;\n      font-weight: 600;\n      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04); // \n    }\n\n    .el-icon {\n      font-size: 18px;\n    }\n  }\n}\n\n.quick-actions {\n  padding: 12px 0;\n  border-top: 1px solid rgba(0, 0, 0, 0.05);\n  display: flex;\n  flex-direction: column;\n  gap: 12px;\n\n  .el-button {\n    margin: 0;\n    border-radius: 8px;\n    height: 40px;\n    justify-content: flex-start;\n    padding-left: 20px;\n    border: none;\n    background: rgba(255, 255, 255, 0.6);\n    \n    &:hover {\n      background: #fff;\n    }\n  }\n}\n\n.settings-content {\n  flex: 1;\n  overflow-y: auto;\n  background-color: #fff; // \n  border-radius: 16px; // \n  box-shadow: 0 4px 16px rgba(0, 0, 0, 0.04); // \n  position: relative;\n  padding: 0; // padding\n\n  &.mobile {\n    border-radius: 0;\n    box-shadow: none;\n    background-color: #f8f9fa;\n  }\n}\n\n.forbidden-container {\n  padding: 40px;\n  max-width: 980px;\n  margin: 0 auto;\n  position: relative;\n  z-index: 10;\n  height: 100%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n\n  &.mobile {\n    padding: 20px;\n    max-width: 100%;\n  }\n}\n\n.content-header-spacer {\n  display: none; // \n}\n</style>\n\n// \n@media (max-width: 768px) {\n  #settings-view {\n    width: 100% !important;\n  }\n\n  .settings-sidebar {\n    display: none !important;\n  }\n\n  .restart-banner-content {\n    flex-direction: column;\n    gap: 8px;\n    align-items: flex-start;\n\n    span {\n      font-size: 14px;\n    }\n  }\n\n  .mobile-header {\n    display: block !important;\n  }\n\n  .settings-container {\n    padding: 0 !important;\n  }\n\n  .settings-content {\n    border-radius: 0 !important;\n    box-shadow: none !important;\n  }\n}\n\n// \n@media (min-width: 769px) {\n  .mobile-header,\n  .mobile-menu-overlay {\n    display: none !important;\n  }\n}\n\n// \n@media (min-width: 769px) and (max-width: 1024px) {\n  .settings-sidebar {\n    width: 180px;\n  }\n\n  .settings-menu {\n    :deep(.el-menu-item) {\n      span {\n        font-size: 14px;\n      }\n    }\n  }\n}\n// \n@media (max-width: 768px) {\n  .mobile-header {\n    // \n    &.sub-page {\n      .mobile-title {\n        color: #409eff;\n      }\n      \n      .back-button {\n        color: #409eff;\n        \n        &:hover {\n          background-color: #ecf5ff;\n        }\n      }\n    }\n    \n    // \n    &.main-page {\n      .back-button {\n        color: #909399;\n        \n        &:hover {\n          background-color: #f5f7fa;\n        }\n      }\n    }\n  }\n  \n  // \n  .mobile-header-content {\n    position: relative;\n    \n    &::after {\n      content: '';\n      position: absolute;\n      bottom: -1px;\n      left: 0;\n      right: 0;\n      height: 2px;\n      background: linear-gradient(90deg, transparent 0%, #409eff 50%, transparent 100%);\n      opacity: 0;\n      transition: opacity 0.3s;\n    }\n    \n    &.sub-page::after {\n      opacity: 1;\n    }\n  }\n}","<template>\n  <div class=\"auth-view\">\n    <div class=\"container\">\n      <div ref=\"iconContainer\" class=\"icon-container\">\n        <i class=\"iconfont ChatGPT\"></i>\n      </div>\n      <h1 class=\"title\"></h1>\n      <p class=\"hint\"></p>\n      <input\n        v-model=\"accessCode\"\n        type=\"password\"\n        placeholder=\"\"\n      />\n      <div class=\"controls\">\n        <button class=\"later\" @click=\"login()\"></button>\n        <button class=\"login\" @click=\"login(accessCode)\"></button>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup>\nimport { nextTick, onUnmounted, onMounted, ref } from \"vue\";\nimport router from \"@/router\";\nimport { client } from \"@/lib/runtime.js\";\nimport { ElMessage } from \"element-plus\";\nimport { useConfigStore } from '@/stores/configStore.js';\n\nconst configStore = useConfigStore();\n\nconst accessCode = ref();\nconst requesting = ref(false);\nconst iconContainer = ref();\n\nconst login = async (code) => {\n  console.log(\"login\");\n\n  // \n  await nextTick(() => iconContainer.value.classList.add(\"active\"));\n\n  if (requesting.value) {\n    return;\n  } else {\n    requesting.value = true;\n    try {\n      const result = await client.login(code);\n      if (result) {\n        ElMessage.success(\n          `${result.is_admin ? \"\" : \"\"}!`,\n        );\n\n        //  store localStorage\n        if (code && result.is_admin) {\n          configStore.setAdminCode(code);\n        }\n\n        // urlquery\n        if (router.currentRoute.value.query.redirect) {\n          router.push(router.currentRoute.value.query.redirect);\n        } else {\n          router.push(\"/\");\n        }\n      }\n    } catch (error) {\n      ElMessage.error(error);\n    } finally {\n      // \n      await nextTick(() => iconContainer.value.classList.remove(\"active\"));\n      requesting.value = false;\n    }\n  }\n};\n\n// \nfunction handleEnter(e) {\n  if (e.key === \"Enter\") {\n    login(accessCode.value);\n  }\n}\n\n// unmounted\nonUnmounted(() => {\n  console.log(\"unmounted\");\n  removeEventListener(\"keydown\", handleEnter); // \n});\n\nonMounted(() => {\n  addEventListener(\"keydown\", handleEnter);\n  // querykey\n  if (router.currentRoute.value.query.key) {\n    login(router.currentRoute.value.query.key);\n  }\n});\n</script>\n\n<style lang=\"sass\" scoped>\n$baseColor: #1d93ab\n\n.auth-view\n    background-color: white\n    flex-grow: 1\n    display: grid\n    place-items: center\n\n    .container\n        display: flex\n        flex-direction: column\n        align-items: center\n        width: 50%\n        margin: 0 auto\n        text-align: center\n        animation: fly-into 1s\n\n        @keyframes fly-into\n            from\n                transform: translateX(-150px)\n                opacity: 0\n            to\n                transform: translateX(0)\n                opacity: 1\n\n        .icon-container\n            transition: 1s linear\n\n            .iconfont.ChatGPT\n                font-size: 46px\n                border-radius: 10px\n\n            &.active\n                transform: rotate(180deg)\n                color: $baseColor\n\n        .title\n            white-space: nowrap\n            font-size: 50px\n            letter-spacing: 5px\n            color: black\n            margin: 25px\n\n        .hint\n            font-size: 15px\n            font-weight: 300\n\n        input\n            margin-top: 30px\n            border: 2px solid $baseColor\n            border-radius: 12px\n            width: 250px\n            height: 40px\n            padding: 0 10px\n            text-align: center\n            letter-spacing: 1px\n\n            &:focus\n                outline: 1px solid $baseColor\n\n                &::placeholder\n                    color: transparent\n\n            &::placeholder\n                text-align: center\n\n        .controls\n            display: flex\n            flex-direction: column\n            align-items: center\n\n            button\n                width: 10rem\n                margin-top: 20px\n                padding: 10px 15px\n                border-radius: 8px\n\n                &:hover\n                    box-shadow: 0 0 2px black\n\n            .later\n                background: transparent\n\n            .login\n                color: white\n                background: $baseColor\n</style>\n","/**\n *  API \n * \n */\n\nimport { configAPI } from './configApi.js';\n\nclass PresetsAPI {\n  constructor() {\n    this.configAPI = configAPI;\n  }\n\n  /**\n   * \n   * @param {object} params - \n   * @param {number} params.nums - \n   * @param {number} params.start - \n   * @param {string} params.keyword - \n   * @returns {Promise<object>} \n   */\n  async getPresets(params = {}) {\n    const queryString = new URLSearchParams(params).toString();\n    const endpoint = `/api/config/presets${queryString ? '?' + queryString : ''}`;\n    return this.configAPI.request(endpoint);\n  }\n\n  /**\n   * \n   * @param {string} presetId - ID\n   * @returns {Promise<object>} \n   */\n  async getPreset(presetId) {\n    return this.configAPI.request(`/api/config/presets/${encodeURIComponent(presetId)}`);\n  }\n\n  /**\n   * \n   * @param {object} data - \n   * @param {string} data.name - \n   * @param {Array} data.history - \n   * @param {string} data.opening - \n   * @param {Array} data.tools - \n   * @returns {Promise<object>} \n   */\n  async createPreset(data) {\n    return this.configAPI.request('/api/config/presets', {\n      method: 'POST',\n      body: JSON.stringify(data)\n    });\n  }\n\n  /**\n   * \n   * @param {string} presetId - ID\n   * @param {object} data - \n   * @returns {Promise<object>} \n   */\n  async updatePreset(presetId, data) {\n    return this.configAPI.request(`/api/config/presets/${encodeURIComponent(presetId)}`, {\n      method: 'PUT',\n      body: JSON.stringify(data)\n    });\n  }\n\n  /**\n   * \n   * @param {string} presetId - ID\n   * @returns {Promise<object>} \n   */\n  async deletePreset(presetId) {\n    return this.configAPI.request(`/api/config/presets/${encodeURIComponent(presetId)}`, {\n      method: 'DELETE'\n    });\n  }\n\n  /**\n   * \n   * @returns {Promise<object>} \n   */\n  async reloadPresets() {\n    return this.configAPI.request('/api/config/presets/reload', {\n      method: 'POST'\n    });\n  }\n\n  /**\n   * \n   * @param {File} file - JSON\n   * @returns {Promise<object>} \n   */\n  async importPreset(file) {\n    const formData = new FormData();\n    formData.append('file', file);\n\n    //  Content-Type \n    const headers = {\n      'X-Admin-Code': this.configAPI.adminCode\n    };\n\n    try {\n      const response = await fetch('/api/config/presets/import', {\n        method: 'POST',\n        headers,\n        body: formData\n      });\n\n      const data = await response.json();\n\n      if (!response.ok) {\n        // \n        if (response.status === 401 || response.status === 403) {\n          if (data.error === 'UNAUTHORIZED' || data.error === 'FORBIDDEN' || \n              data.message?.includes('') || data.message?.includes('') ||\n              data.message?.includes('')) {\n            this.configAPI.adminCode = '';\n            localStorage.removeItem('admin_code');\n          }\n        }\n        throw new Error(data.message || data.error || '');\n      }\n\n      if (data.code !== 0 && data.code !== undefined) {\n        throw new Error(data.message || '');\n      }\n\n      return data;\n    } catch (error) {\n      console.error(':', error);\n      throw error;\n    }\n  }\n\n  /**\n   * \n   * @param {string} presetId - ID\n   */\n  async exportPreset(presetId) {\n    try {\n      const headers = {\n        'X-Admin-Code': this.configAPI.adminCode\n      };\n\n      const response = await fetch(`/api/config/presets/${encodeURIComponent(presetId)}/export`, {\n        method: 'GET',\n        headers\n      });\n\n      if (!response.ok) {\n        const data = await response.json();\n        throw new Error(data.message || data.error || '');\n      }\n\n      // \n      const contentDisposition = response.headers.get('Content-Disposition');\n      let filename = `${presetId}.json`;\n      if (contentDisposition) {\n        const matches = contentDisposition.match(/filename[*]?=['\"]?([^'\";\\n]+)['\"]?/);\n        if (matches) {\n          filename = matches[1];\n        }\n      }\n\n      // \n      const blob = await response.blob();\n      const url = window.URL.createObjectURL(blob);\n      const a = document.createElement('a');\n      a.href = url;\n      a.download = filename;\n      document.body.appendChild(a); //  DOM \n      a.click();\n      document.body.removeChild(a); //  DOM\n      window.URL.revokeObjectURL(url);\n    } catch (error) {\n      console.error(':', error);\n      // \n      try {\n        console.warn('...');\n        const presetData = await this.getPreset(presetId);\n        const exportData = {\n          name: presetData.data.name,\n          category: presetData.data.category,\n          history: presetData.data.history,\n          opening: presetData.data.opening,\n          tools: presetData.data.tools\n        };\n        \n        const blob = new Blob([JSON.stringify(exportData, null, 2)], { type: 'application/json' });\n        const url = window.URL.createObjectURL(blob);\n        const a = document.createElement('a');\n        a.href = url;\n        a.download = `${presetId}.json`;\n        document.body.appendChild(a);\n        a.click();\n        document.body.removeChild(a);\n        window.URL.revokeObjectURL(url);\n      } catch (fallbackError) {\n        console.error(':', fallbackError);\n        throw error; // \n      }\n    }\n  }\n\n  /**\n   * \n   * @param {Array<string>} presetIds - ID\n   * @returns {Promise<Array>} \n   */\n  async batchDeletePresets(presetIds) {\n    const results = [];\n\n    for (const presetId of presetIds) {\n      try {\n        const result = await this.deletePreset(presetId);\n        results.push({ success: true, presetId, result });\n      } catch (error) {\n        results.push({ success: false, presetId, error: error.message });\n      }\n    }\n\n    return results;\n  }\n\n  /**\n   * \n   * @param {object} data - \n   * @returns {Promise<object>} \n   */\n  async validatePreset(data) {\n    return this.configAPI.request('/api/config/presets/validate', {\n      method: 'POST',\n      body: JSON.stringify(data)\n    });\n  }\n}\n\n// \nexport const presetsAPI = new PresetsAPI();","/**\n *  Store\n * \n *  Composition API \n */\n\nimport { presetsAPI } from '@/lib/presetsApi.js';\nimport { defineStore } from 'pinia';\nimport { computed, ref } from 'vue';\n\nexport const usePresetsStore = defineStore('presets', () => {\n  // ========== State ==========\n  \n  // \n  const presets = ref([]);\n  \n  //  API\n  const summary = ref({\n    totalCount: 0,\n    categoryCount: {\n      common: 0,\n      recommended: 0,\n      hidden: 0\n    },\n    sourceCount: {\n      'built-in': 0,\n      custom: 0\n    }\n  });\n  \n  // \n  const pagination = ref({\n    total: 0,\n    start: 0,\n    nums: 50,\n    hasMore: false\n  });\n  \n  // \n  const loading = ref(false);\n\n  // ========== Getters ==========\n  \n  /**\n   * \n   */\n  const allPresets = computed(() => {\n    const presetsArray = presets.value || [];\n    return presetsArray.map(preset => ({\n      ...preset,\n      id: preset.name //  name \n    }));\n  });\n\n  /**\n   *  API summary\n   */\n  const totalCount = computed(() => {\n    return summary.value?.totalCount || 0;\n  });\n\n  /**\n   *  API summary\n   */\n  const countByCategory = computed(() => {\n    return summary.value?.categoryCount || {\n      common: 0,\n      recommended: 0,\n      hidden: 0\n    };\n  });\n\n  /**\n   *  API summary\n   */\n  const countBySource = computed(() => {\n    return summary.value?.sourceCount || {\n      'built-in': 0,\n      custom: 0\n    };\n  });\n\n  /**\n   * \n   */\n  const presetsByCategory = computed(() => {\n    const grouped = { common: [], recommended: [], hidden: [] };\n    const presetsArray = presets.value || [];\n    presetsArray.forEach(preset => {\n      if (preset.category && grouped.hasOwnProperty(preset.category)) {\n        grouped[preset.category].push(preset);\n      }\n    });\n    return grouped;\n  });\n\n  // ========== Actions ==========\n  \n  /**\n   * \n   */\n  async function fetchPresets(params = {}, append = false) {\n    loading.value = true;\n    try {\n      const response = await presetsAPI.getPresets(params);\n      const data = response.data || {};\n      \n      // \n      if (append && params.start > 0) {\n        // \n        const newPresets = data.presets || [];\n        presets.value = [...presets.value, ...newPresets];\n      } else {\n        // \n        presets.value = data.presets || [];\n      }\n      \n      // \n      if (data.summary) {\n        summary.value = {\n          totalCount: data.summary.totalCount || 0,\n          categoryCount: data.summary.categoryCount || {\n            common: 0,\n            recommended: 0,\n            hidden: 0\n          },\n          sourceCount: data.summary.sourceCount || {\n            'built-in': 0,\n            custom: 0\n          }\n        };\n      }\n      \n      // \n      if (data.pagination) {\n        pagination.value = {\n          total: data.pagination.total || 0,\n          start: data.pagination.start || 0,\n          nums: data.pagination.nums || 50,\n          hasMore: data.pagination.hasMore || false\n        };\n      }\n      \n      return data;\n    } catch (error) {\n      console.error(':', error);\n      throw error;\n    } finally {\n      loading.value = false;\n    }\n  }\n\n  /**\n   * \n   */\n  async function getPreset(presetId) {\n    try {\n      const response = await presetsAPI.getPreset(presetId);\n      return response.data;\n    } catch (error) {\n      console.error(`: ${presetId}`, error);\n      throw error;\n    }\n  }\n\n  /**\n   * \n   */\n  async function createPreset(data) {\n    try {\n      const response = await presetsAPI.createPreset(data);\n      \n      // \n      await fetchPresets();\n      \n      return response.data;\n    } catch (error) {\n      console.error(':', error);\n      throw error;\n    }\n  }\n\n  /**\n   * \n   */\n  async function updatePreset(presetId, data) {\n    try {\n      const response = await presetsAPI.updatePreset(presetId, data);\n      \n      // \n      await fetchPresets();\n      \n      return response.data;\n    } catch (error) {\n      console.error(':', error);\n      throw error;\n    }\n  }\n\n  /**\n   * \n   */\n  async function deletePreset(presetId) {\n    try {\n      const response = await presetsAPI.deletePreset(presetId);\n      \n      // \n      const index = presets.value.findIndex(p => p.name === presetId);\n      if (index > -1) {\n        presets.value.splice(index, 1);\n      }\n      \n      return response.data;\n    } catch (error) {\n      console.error(':', error);\n      throw error;\n    }\n  }\n\n  /**\n   * \n   */\n  async function batchDeletePresets(presetIds) {\n    const results = [];\n    \n    for (const presetId of presetIds) {\n      try {\n        await deletePreset(presetId);\n        results.push({ success: true, presetId });\n      } catch (error) {\n        results.push({ success: false, presetId, error: error.message });\n      }\n    }\n    \n    return results;\n  }\n\n  /**\n   * \n   */\n  async function importPreset(file) {\n    try {\n      const response = await presetsAPI.importPreset(file);\n      \n      // \n      await fetchPresets();\n      \n      return response.data;\n    } catch (error) {\n      console.error(':', error);\n      throw error;\n    }\n  }\n\n  /**\n   * \n   */\n  async function exportPreset(presetId) {\n    try {\n      await presetsAPI.exportPreset(presetId);\n    } catch (error) {\n      console.error(':', error);\n      throw error;\n    }\n  }\n\n  /**\n   * \n   */\n  async function reloadPresets() {\n    try {\n      const response = await presetsAPI.reloadPresets();\n      \n      // \n      await fetchPresets();\n      \n      return response.data;\n    } catch (error) {\n      console.error(':', error);\n      throw error;\n    }\n  }\n\n  /**\n   * \n   */\n  function searchPresets(keyword) {\n    const presetsArray = presets.value || [];\n    if (!keyword) return presetsArray;\n\n    const lowerKeyword = keyword.toLowerCase();\n    return presetsArray.filter(preset => \n      preset.name?.toLowerCase().includes(lowerKeyword) ||\n      preset.opening?.toLowerCase().includes(lowerKeyword) ||\n      preset.history?.some(h => h.content?.toLowerCase().includes(lowerKeyword))\n    );\n  }\n\n  /**\n   * ID\n   */\n  function findPresetById(presetId) {\n    const presetsArray = allPresets.value || [];\n    return presetsArray.find(preset => preset.id === presetId);\n  }\n\n  /**\n   * \n   */\n  function findPresetByName(name) {\n    const presetsArray = allPresets.value || [];\n    return presetsArray.find(preset => preset.name === name);\n  }\n\n  // ==========  API ==========\n  \n  return {\n    // State\n    presets,\n    summary,\n    pagination,\n    loading,\n    \n    // Getters\n    allPresets,\n    totalCount,\n    countByCategory,\n    countBySource,\n    presetsByCategory,\n    \n    // Actions\n    fetchPresets,\n    getPreset,\n    createPreset,\n    updatePreset,\n    deletePreset,\n    batchDeletePresets,\n    importPreset,\n    exportPreset,\n    reloadPresets,\n    searchPresets,\n    findPresetById,\n    findPresetByName\n  };\n});","<template>\n  <div class=\"overview-view\">\n    <!--  -->\n    <div v-if=\"loading\" class=\"loading-container\">\n      <div class=\"stats-grid\">\n        <LoadingSkeleton v-for=\"i in 4\" :key=\"i\" type=\"stat-card\" is-card />\n      </div>\n      <el-card class=\"section-card\">\n        <LoadingSkeleton type=\"list\" :count=\"4\" />\n      </el-card>\n    </div>\n\n    <transition name=\"fade\" mode=\"out-in\">\n      <div v-if=\"!loading\" class=\"content-container\">\n        <!--  -->\n        <div class=\"overview-header\">\n          <div class=\"header-title\">\n            <h2></h2>\n            <span class=\"subtitle\"></span>\n          </div>\n          <div class=\"header-actions\">\n            <el-tooltip content=\"\" placement=\"bottom\">\n              <el-button circle :icon=\"Refresh\" @click=\"handleRefreshModels\" :loading=\"refreshing\" />\n            </el-tooltip>\n            <el-upload\n              :before-upload=\"handleImportConfig\"\n              :show-file-list=\"false\"\n              accept=\".json\"\n              style=\"display: inline-block; margin: 0 8px;\"\n            >\n              <el-tooltip content=\"\" placement=\"bottom\">\n                <el-button circle :icon=\"Upload\" />\n              </el-tooltip>\n            </el-upload>\n            <el-tooltip content=\"\" placement=\"bottom\">\n              <el-button circle :icon=\"Download\" @click=\"handleExportConfig\" />\n            </el-tooltip>\n            <el-tooltip content=\"\" placement=\"bottom\">\n              <el-button circle :icon=\"DocumentCopy\" @click=\"showCompare = true\" />\n            </el-tooltip>\n          </div>\n        </div>\n\n        <!--  -->\n        <div class=\"stats-grid\">\n          <el-card class=\"stat-card\">\n            <div class=\"stat-icon\" style=\"background-color: #409eff20;\">\n              <el-icon :size=\"32\" color=\"#409eff\"><Connection /></el-icon>\n            </div>\n            <div class=\"stat-content\">\n              <div class=\"stat-value\">{{ configStore.totalAdapters }}</div>\n              <div class=\"stat-label\"></div>\n            </div>\n          </el-card>\n\n          <el-card class=\"stat-card\">\n            <div class=\"stat-icon\" style=\"background-color: #67c23a20;\">\n              <el-icon :size=\"32\" color=\"#67c23a\"><CircleCheck /></el-icon>\n            </div>\n            <div class=\"stat-content\">\n              <div class=\"stat-value\">{{ configStore.enabledAdaptersCount }}</div>\n              <div class=\"stat-label\"></div>\n            </div>\n          </el-card>\n\n          <el-card class=\"stat-card\">\n            <div class=\"stat-icon\" style=\"background-color: #e6a23c20;\">\n              <el-icon :size=\"32\" color=\"#e6a23c\"><Grid /></el-icon>\n            </div>\n            <div class=\"stat-content\">\n              <div class=\"stat-value\">{{ configStore.totalModelsCount }}</div>\n              <div class=\"stat-label\"></div>\n            </div>\n          </el-card>\n\n          <el-card class=\"stat-card\">\n            <div class=\"stat-icon\" style=\"background-color: #f56c6c20;\">\n              <el-icon :size=\"32\" color=\"#f56c6c\"><Document /></el-icon>\n            </div>\n            <div class=\"stat-content\">\n              <div class=\"stat-value\">{{ presetsStore.totalCount }}</div>\n              <div class=\"stat-label\"></div>\n            </div>\n          </el-card>\n\n          <el-card class=\"stat-card\">\n            <div class=\"stat-icon\" :style=\"{\n              backgroundColor: systemStatus === 'normal' ? '#67c23a20' : '#f5672020'\n            }\">\n              <el-icon\n                :size=\"32\"\n                :color=\"systemStatus === 'normal' ? '#67c23a' : '#f56720'\"\n              >\n                <component :is=\"systemStatus === 'normal' ? SuccessFilled : WarningFilled\" />\n              </el-icon>\n            </div>\n            <div class=\"stat-content\">\n              <div class=\"stat-value\">{{ systemStatusText }}</div>\n              <div class=\"stat-label\"></div>\n            </div>\n          </el-card>\n        </div>\n\n        <!--  -->\n        <div class=\"section-container\">\n          <div class=\"section-header\">\n            <h3></h3>\n          </div>\n          <div class=\"quick-actions-grid\">\n            <div class=\"action-item\" @click=\"navigateTo('llm-adapters')\">\n              <div class=\"action-icon\" style=\"background: #ecf5ff; color: #409eff;\">\n                <el-icon><Connection /></el-icon>\n              </div>\n              <div class=\"action-info\">\n                <div class=\"action-title\">LLM </div>\n                <div class=\"action-desc\"></div>\n              </div>\n              <el-icon class=\"action-arrow\"><ArrowRight /></el-icon>\n            </div>\n            \n            <div class=\"action-item\" @click=\"navigateTo('server')\">\n              <div class=\"action-icon\" style=\"background: #f0f9eb; color: #67c23a;\">\n                <el-icon><Monitor /></el-icon>\n              </div>\n              <div class=\"action-info\">\n                <div class=\"action-title\"></div>\n                <div class=\"action-desc\"></div>\n              </div>\n              <el-icon class=\"action-arrow\"><ArrowRight /></el-icon>\n            </div>\n\n            <div class=\"action-item\" @click=\"navigateTo('web')\">\n              <div class=\"action-icon\" style=\"background: #fdf6ec; color: #e6a23c;\">\n                <el-icon><ChromeFilled /></el-icon>\n              </div>\n              <div class=\"action-info\">\n                <div class=\"action-title\">Web </div>\n                <div class=\"action-desc\"></div>\n              </div>\n              <el-icon class=\"action-arrow\"><ArrowRight /></el-icon>\n            </div>\n\n            <div class=\"action-item\" @click=\"navigateTo('onebot')\">\n              <div class=\"action-icon\" style=\"background: #f4f4f5; color: #909399;\">\n                <el-icon><ChatDotRound /></el-icon>\n              </div>\n              <div class=\"action-info\">\n                <div class=\"action-title\">OneBot </div>\n                <div class=\"action-desc\">QQ </div>\n              </div>\n              <el-icon class=\"action-arrow\"><ArrowRight /></el-icon>\n            </div>\n\n            <div class=\"action-item\" @click=\"navigateTo('presets')\">\n              <div class=\"action-icon\" style=\"background: #fef0f0; color: #f56c6c;\">\n                <el-icon><Document /></el-icon>\n              </div>\n              <div class=\"action-info\">\n                <div class=\"action-title\"></div>\n                <div class=\"action-desc\"></div>\n              </div>\n              <el-icon class=\"action-arrow\"><ArrowRight /></el-icon>\n            </div>\n          </div>\n        </div>\n\n    <!--  -->\n    <el-card class=\"section-card\" v-if=\"pendingItems.length > 0\">\n      <template #header>\n        <div class=\"card-header\">\n          <el-icon><Warning /></el-icon>\n          <span> ({{ pendingItems.length }})</span>\n        </div>\n      </template>\n      <div class=\"pending-items-list\">\n        <div\n          v-for=\"(item, index) in pendingItems\"\n          :key=\"index\"\n          class=\"pending-item\"\n        >\n          <el-alert\n            :type=\"item.type\"\n            :title=\"item.title\"\n            :closable=\"false\"\n          />\n          <el-button\n            v-if=\"item.action\"\n            type=\"primary\"\n            link\n            @click=\"item.action.handler\"\n          >\n            {{ item.action.text }}\n          </el-button>\n        </div>\n      </div>\n    </el-card>\n\n    <!--  -->\n    <el-card class=\"section-card\">\n      <template #header>\n        <div class=\"card-header\">\n          <el-icon><Connection /></el-icon>\n          <span></span>\n        </div>\n      </template>\n      <div class=\"adapters-overview\">\n        <div\n          v-for=\"type in allAdapterTypes\"\n          :key=\"type\"\n          class=\"adapter-type-section\"\n        >\n          <div class=\"adapter-type-header\">\n            <h3>{{ adapterTypeName(type) }}</h3>\n            <el-tag>{{ getAdapterInstanceCount(type) }} </el-tag>\n          </div>\n          <div v-if=\"getAdapterInstanceCount(type) === 0\" class=\"empty-state\">\n            \n          </div>\n          <div v-else class=\"adapter-list\">\n            <div\n              v-for=\"(adapter, index) in getAdapterInstances(type)\"\n              :key=\"index\"\n              class=\"adapter-item\"\n            >\n              <el-tag :type=\"adapter.enable ? 'success' : 'info'\" size=\"small\">\n                {{ adapter.enable ? '' : '' }}\n              </el-tag>\n              <span class=\"adapter-name\">{{ adapter.name || `${type}-${index + 1}` }}</span>\n              <span class=\"adapter-model\">{{ adapter.default_model }}</span>\n            </div>\n          </div>\n        </div>\n      </div>\n    </el-card>\n      </div>\n    </transition>\n\n    <!--  -->\n    <ConfigCompare v-model=\"showCompare\" />\n  </div>\n</template>\n\n<script setup>\nimport ConfigCompare from '@/components/settings/ConfigCompare.vue';\nimport LoadingSkeleton from '@/components/settings/LoadingSkeleton.vue';\nimport { useConfigStore } from '@/stores/configStore.js';\nimport { usePresetsStore } from '@/stores/presetsStore.js';\nimport {\n  ArrowRight,\n  ChatDotRound,\n  ChromeFilled,\n  CircleCheck,\n  Connection,\n  Document,\n  DocumentCopy,\n  Download,\n  Grid,\n  Monitor,\n  Refresh,\n  SuccessFilled,\n  Upload,\n  Warning,\n  WarningFilled\n} from '@element-plus/icons-vue';\nimport { ElMessage, ElMessageBox } from 'element-plus';\nimport { computed, onMounted, ref } from 'vue';\nimport { useRouter } from 'vue-router';\n\nconst router = useRouter();\nconst configStore = useConfigStore();\nconst presetsStore = usePresetsStore();\n\nconst loading = ref(true);\nconst refreshing = ref(false);\nconst showCompare = ref(false);\n\n// \nconst systemStatus = computed(() => {\n  if (configStore.needRestart) return 'warning';\n  \n  // \n  const hasDisabled = Object.values(configStore.adapters).some(instances =>\n    instances.some(adapter => !adapter.enable)\n  );\n  \n  return hasDisabled ? 'warning' : 'normal';\n});\n\nconst systemStatusText = computed(() => {\n  if (configStore.needRestart) return '';\n  return systemStatus.value === 'normal' ? '' : '';\n});\n\n// \nconst allAdapterTypes = computed(() => {\n  const typesFromApi = configStore?.adapterTypes?.types || [];\n  const typesFromConfig = Object.keys(configStore.adapters || {});\n  \n  //  API  API \n  const apiTypes = [...typesFromApi];\n  const configOnlyTypes = typesFromConfig.filter(type => !typesFromApi.includes(type));\n  \n  return [...apiTypes, ...configOnlyTypes];\n});\n\n// \nconst getAdapterInstanceCount = (type) => {\n  const instances = configStore.adapters?.[type] || [];\n  return instances.length;\n};\n\n// \nconst getAdapterInstances = (type) => {\n  return configStore.adapters?.[type] || [];\n};\n\n// \nconst pendingItems = computed(() => {\n  const items = [];\n  \n  // 1. \n  if (configStore.needRestart) {\n    items.push({\n      type: 'warning',\n      title: '',\n      action: {\n        text: '',\n        handler: () => router.push('/settings')\n      }\n    });\n  }\n  \n  // 2. \n  Object.entries(configStore.adapters).forEach(([type, instances]) => {\n    instances.forEach((adapter, index) => {\n      if (adapter.enable) {\n        const providerName = adapter.name || `${type}-${index + 1}`;\n        const models = configStore.models[providerName];\n        \n        if (!models || models.length === 0) {\n          items.push({\n            type: 'error',\n            title: `${providerName}  API Key `,\n            action: {\n              text: '',\n              handler: () => router.push('/settings/llm-adapters')\n            }\n          });\n        }\n      }\n    });\n  });\n  \n  // 3. \n  const disabledCount = Object.values(configStore.adapters)\n    .flat()\n    .filter(adapter => !adapter.enable).length;\n  \n  if (disabledCount > 0) {\n    items.push({\n      type: 'info',\n      title: ` ${disabledCount} `,\n      action: {\n        text: '',\n        handler: () => router.push('/settings/llm-adapters')\n      }\n    });\n  }\n  \n  // 4.  AuthView \n  \n  // 5.  OneBot \n  if (configStore.config?.onebot?.enable) {\n    const onebotConfig = configStore.config.onebot;\n    if (!onebotConfig.reverse_ws_url || !onebotConfig.bot_qq) {\n      items.push({\n        type: 'warning',\n        title: 'OneBot ',\n        action: {\n          text: '',\n          handler: () => router.push('/settings/onebot')\n        }\n      });\n    }\n  }\n  \n  return items;\n});\n\n// \nconst adapterTypeName = (type) => {\n  //  configStore  adapterTypes \n  if (!configStore || !configStore.adapterTypes) {\n    // \n    const names = {\n      openai: 'OpenAI',\n      gemini: 'Gemini',\n      vertex: 'Vertex AI',\n      deepseek: 'DeepSeek',\n      anthropic: 'Anthropic'\n    };\n    if (names[type]) return names[type];\n    if (!type) return '';\n    return type.charAt(0).toUpperCase() + type.slice(1);\n  }\n  \n  // \n  const adapterInfo = configStore.adapterTypes.adapters?.find(a => a.type === type);\n  if (adapterInfo?.name) {\n    return adapterInfo.name;\n  }\n  \n  // \n  const names = {\n    openai: 'OpenAI',\n    gemini: 'Gemini',\n    vertex: 'Vertex AI',\n    deepseek: 'DeepSeek',\n    anthropic: 'Anthropic'\n  };\n  if (names[type]) return names[type];\n  if (!type) return '';\n  return type.charAt(0).toUpperCase() + type.slice(1);\n};\n\n// \nconst handleRefreshModels = async () => {\n  refreshing.value = true;\n  try {\n    await configStore.refreshAllModels();\n    ElMessage.success('');\n  } catch (error) {\n    ElMessage.error('' + error.message);\n  } finally {\n    refreshing.value = false;\n  }\n};\n\n// \nconst handleExportConfig = async () => {\n  try {\n    const filename = `mio-chat-config-${new Date().toISOString().split('T')[0]}.json`;\n    await configStore.exportConfig(filename);\n    ElMessage.success('');\n  } catch (error) {\n    ElMessage.error('' + error.message);\n  }\n};\n\n// \nconst handleImportConfig = async (file) => {\n  try {\n    await ElMessageBox.confirm(\n      '',\n      '',\n      {\n        confirmButtonText: '',\n        cancelButtonText: '',\n        type: 'warning'\n      }\n    );\n\n    const configData = await configStore.importConfig(file);\n    \n    // \n    const validateResult = await configStore.validateConfig(configData);\n    if (!validateResult.valid) {\n      ElMessageBox.alert(\n        `\\n${validateResult.errors.join('\\n')}`,\n        '',\n        { type: 'error' }\n      );\n      return false;\n    }\n\n    // \n    await configStore.updateConfig(configData);\n    ElMessage.success('');\n    \n    // \n    await configStore.fetchConfig();\n  } catch (error) {\n    if (error !== 'cancel') {\n      ElMessage.error('' + error.message);\n    }\n  }\n  \n  return false; // \n};\n\n// \nconst navigateTo = (path) => {\n  router.push(`/settings/${path}`);\n};\n\n// \nonMounted(async () => {\n  loading.value = true;\n  try {\n    // \n    const promises = [];\n    \n    if (!configStore.config) {\n      promises.push(configStore.fetchConfig());\n    }\n    \n    if (!configStore.adapterTypes.types.length) {\n      promises.push(configStore.fetchAdapterTypes());\n    }\n    \n    // \n    promises.push(\n      presetsStore.fetchPresets().catch(error => {\n        console.warn(':', error);\n        // API\n      })\n    );\n    \n    await Promise.all(promises);\n    \n    // \n    await new Promise(resolve => setTimeout(resolve, 300));\n  } catch (error) {\n    ElMessage.error('' + error.message);\n  } finally {\n    loading.value = false;\n  }\n});\n</script>\n\n<style scoped lang=\"scss\">\n// \n.fade-enter-active,\n.fade-leave-active {\n  transition: opacity 0.3s ease;\n}\n\n.fade-enter-from,\n.fade-leave-to {\n  opacity: 0;\n}\n\n.overview-view {\n  padding: 24px;\n  max-width: 1400px;\n  margin: 0 auto;\n}\n\n.loading-container {\n  .stats-grid {\n    display: grid;\n    grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));\n    gap: 16px;\n    margin-bottom: 24px;\n  }\n\n  .section-card {\n    margin-bottom: 24px;\n  }\n}\n\n.content-container {\n  width: 100%;\n}\n\n.overview-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 24px;\n\n  .header-title {\n    h2 {\n      margin: 0;\n      font-size: 24px;\n      font-weight: 600;\n      color: #303133;\n    }\n    \n    .subtitle {\n      font-size: 14px;\n      color: #909399;\n      margin-top: 4px;\n      display: block;\n    }\n  }\n\n  .header-actions {\n    display: flex;\n    align-items: center;\n    gap: 8px;\n    \n    .el-button {\n      border: none;\n      background: transparent;\n      font-size: 18px;\n      color: #606266;\n      width: 40px;\n      height: 40px;\n      \n      &:hover {\n        background: rgba(0, 0, 0, 0.05);\n        color: #409eff;\n      }\n    }\n  }\n}\n\n.stats-grid {\n  display: grid;\n  grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));\n  gap: 20px;\n  margin-bottom: 32px;\n}\n\n.stat-card {\n  border: none;\n  transition: all 0.3s ease;\n  \n  &:hover {\n    transform: translateY(-4px);\n  }\n\n  :deep(.el-card__body) {\n    display: flex;\n    align-items: center;\n    gap: 16px;\n    padding: 20px;\n  }\n\n  .stat-icon {\n    width: 56px;\n    height: 56px;\n    border-radius: 12px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    flex-shrink: 0;\n  }\n\n  .stat-content {\n    flex: 1;\n  }\n\n  .stat-value {\n    font-size: 28px;\n    font-weight: 600;\n    color: #303133;\n    line-height: 1.2;\n    margin-bottom: 4px;\n  }\n\n  .stat-label {\n    font-size: 14px;\n    color: #909399;\n  }\n}\n\n.section-container {\n  margin-bottom: 32px;\n\n  .section-header {\n    margin-bottom: 16px;\n    \n    h3 {\n      margin: 0;\n      font-size: 18px;\n      font-weight: 600;\n      color: #303133;\n    }\n  }\n}\n\n.quick-actions-grid {\n  display: grid;\n  grid-template-columns: repeat(auto-fill, minmax(240px, 1fr));\n  gap: 16px;\n\n  .action-item {\n    display: flex;\n    align-items: center;\n    gap: 16px;\n    padding: 20px;\n    background: #f8f9fa;\n    border-radius: 12px;\n    cursor: pointer;\n    transition: all 0.3s ease;\n    border: 1px solid transparent;\n\n    &:hover {\n      background: #fff;\n      transform: translateY(-2px);\n      box-shadow: 0 8px 16px rgba(0, 0, 0, 0.05);\n      border-color: var(--el-color-primary-light-8);\n\n      .action-arrow {\n        opacity: 1;\n        transform: translateX(0);\n      }\n    }\n\n    .action-icon {\n      width: 48px;\n      height: 48px;\n      border-radius: 12px;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      font-size: 24px;\n    }\n\n    .action-info {\n      flex: 1;\n      \n      .action-title {\n        font-size: 16px;\n        font-weight: 600;\n        color: #303133;\n        margin-bottom: 4px;\n      }\n\n      .action-desc {\n        font-size: 12px;\n        color: #909399;\n      }\n    }\n\n    .action-arrow {\n      font-size: 16px;\n      color: #c0c4cc;\n      opacity: 0;\n      transform: translateX(-10px);\n      transition: all 0.3s ease;\n    }\n  }\n}\n\n.pending-items-list {\n  display: flex;\n  flex-direction: column;\n  gap: 12px;\n\n  .pending-item {\n    display: flex;\n    align-items: center;\n    gap: 12px;\n\n    .el-alert {\n      flex: 1;\n    }\n\n    .el-button {\n      flex-shrink: 0;\n    }\n  }\n}\n\n.adapters-overview {\n  display: flex;\n  flex-direction: column;\n  gap: 24px;\n}\n\n.adapter-type-section {\n  display: flex;\n  flex-direction: column;\n  \n  &:last-child {\n    padding-bottom: 24px;\n  }\n  \n  .adapter-type-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin-bottom: 12px;\n    padding-bottom: 8px;\n    border-bottom: 1px solid #e4e7ed;\n    flex-shrink: 0;\n    min-height: 32px; // \n\n    h3 {\n      margin: 0;\n      font-size: 16px;\n      font-weight: 600;\n      color: #303133;\n      line-height: 1.5;\n    }\n  }\n\n  .empty-state {\n    text-align: center;\n    padding: 32px;\n    color: #909399;\n    font-size: 14px;\n  }\n\n  .adapter-list {\n    display: flex;\n    flex-direction: column;\n    gap: 8px;\n  }\n\n  .adapter-item {\n    display: flex;\n    align-items: center;\n    gap: 12px;\n    padding: 12px;\n    background-color: #f5f7fa;\n    border-radius: 6px;\n    transition: background-color 0.2s;\n\n    &:hover {\n      background-color: #ecf5ff;\n    }\n\n    //  - \n    .el-tag {\n      flex-shrink: 0;\n      min-width: 60px;\n      text-align: center;\n    }\n\n    //  - \n    .adapter-name {\n      font-weight: 500;\n      color: #303133;\n      flex: 1;\n      min-width: 0; // \n      max-width: 150px;\n      overflow: hidden;\n      text-overflow: ellipsis;\n      white-space: nowrap;\n    }\n\n    //  - \n    .adapter-model {\n      flex-grow: 1;\n      color: #909399;\n      font-size: 13px;\n      flex-shrink: 0;\n      overflow: hidden;\n      text-overflow: ellipsis;\n      white-space: nowrap;\n      text-align: right;\n    }\n  }\n}\n\n// \n@media (max-width: 768px) {\n  .overview-view {\n    padding: 16px;\n  }\n  \n  // \n  .section-container {\n    display: none !important;\n  }\n  \n  // \n  .stats-grid {\n    grid-template-columns: repeat(2, 1fr);\n    gap: 12px;\n    \n    .stat-card {\n      .stat-icon {\n        width: 40px;\n        height: 40px;\n        \n        .el-icon {\n          font-size: 20px !important;\n        }\n      }\n      \n      .stat-content {\n        .stat-value {\n          font-size: 20px;\n        }\n        \n        .stat-label {\n          font-size: 12px;\n        }\n      }\n    }\n  }\n  \n  // \n  .overview-header {\n    flex-direction: column;\n    align-items: flex-start;\n    gap: 16px;\n    \n    .header-title {\n      .subtitle {\n        font-size: 13px;\n      }\n    }\n    \n    .header-actions {\n      align-self: flex-end;\n      \n      .el-button {\n        width: 36px;\n        height: 36px;\n      }\n    }\n  }\n  \n  // \n  .section-card {\n    margin-bottom: 16px;\n    \n    .el-card__header {\n      padding: 16px;\n    }\n    \n    .el-card__body {\n      padding: 16px;\n    }\n  }\n  \n  // \n  .adapters-overview {\n    .adapter-item {\n      padding: 10px;\n      gap: 8px;\n      \n      // \n      .el-tag {\n        min-width: 50px;\n        font-size: 11px;\n      }\n      \n      .adapter-name {\n        font-size: 14px;\n        max-width: 100px; // \n      }\n      \n      .adapter-model {\n        font-size: 12px;\n      }\n    }\n  }\n}\n</style>\n// \n@media (min-width: 769px) and (max-width: 1024px) {\n  .adapters-overview {\n    .adapter-item {\n      .adapter-name {\n        max-width: 120px;\n      }\n      \n      .adapter-model {\n        max-width: 100px;\n      }\n    }\n  }\n}\n\n// \n@media (max-width: 480px) {\n  .adapters-overview {\n    .adapter-item {\n      padding: 8px;\n      gap: 6px;\n      \n      .el-tag {\n        min-width: 45px;\n        font-size: 10px;\n        padding: 2px 6px;\n      }\n      \n      .adapter-name {\n        max-width: 80px;\n        font-size: 13px;\n      }\n      \n      .adapter-model {\n        max-width: 60px;\n        font-size: 11px;\n      }\n    }\n  }\n}","<template>\n  <div class=\"llm-adapters-view\">\n    <!--  -->\n    <div v-if=\"loading\" class=\"loading-container\">\n      <div class=\"skeleton-header\">\n        <div class=\"skeleton-title\"></div>\n        <div class=\"skeleton-actions\">\n          <div class=\"skeleton-button\" v-for=\"i in 3\" :key=\"i\"></div>\n        </div>\n      </div>\n      <div class=\"skeleton-table\">\n        <div class=\"skeleton-row\" v-for=\"i in 6\" :key=\"i\">\n          <div class=\"skeleton-cell\" v-for=\"j in 6\" :key=\"j\"></div>\n        </div>\n      </div>\n    </div>\n\n    <transition name=\"fade\" mode=\"out-in\">\n      <div v-if=\"!loading\" class=\"content-container\">\n        <!--  -->\n        <div class=\"page-header\" :class=\"{ 'mobile': isMobile }\">\n          <h1 v-if=\"!isMobile\">LLM </h1>\n          \n          <!--  -->\n          <div v-if=\"!isMobile\" class=\"header-actions\">\n            <el-button\n              v-if=\"configStore.selectedAdapters && configStore.selectedAdapters.length > 0\"\n              type=\"success\"\n              :icon=\"Check\"\n              @click=\"handleBatchEnable\"\n            >\n               ({{ configStore.selectedAdapters.length }})\n            </el-button>\n            <el-button\n              v-if=\"configStore.selectedAdapters && configStore.selectedAdapters.length > 0\"\n              type=\"warning\"\n              :icon=\"Close\"\n              @click=\"handleBatchDisable\"\n            >\n              \n            </el-button>\n            <el-button\n              v-if=\"configStore.selectedAdapters && configStore.selectedAdapters.length > 0\"\n              type=\"danger\"\n              :icon=\"Delete\"\n              @click=\"handleBatchDelete\"\n            >\n              \n            </el-button>\n            <el-button\n              type=\"primary\"\n              :icon=\"Refresh\"\n              :loading=\"refreshing\"\n              @click=\"handleRefreshAll\"\n            >\n              \n            </el-button>\n            <el-dropdown @command=\"handleAddAdapter\" trigger=\"click\">\n              <el-button type=\"primary\" :icon=\"Plus\">\n                 <el-icon class=\"el-icon--right\"><ArrowDown /></el-icon>\n              </el-button>\n              <template #dropdown>\n                <el-dropdown-menu>\n                  <el-dropdown-item\n                    v-for=\"type in adapterTypes\"\n                    :key=\"type\"\n                    :command=\"type\"\n                  >\n                    <el-icon><Connection /></el-icon>\n                    {{ formatTypeLabel(type) }}\n                  </el-dropdown-item>\n                </el-dropdown-menu>\n              </template>\n            </el-dropdown>\n          </div>\n\n          <!--  -->\n          <div v-if=\"isMobile\" class=\"mobile-actions\">\n            <el-button\n              type=\"primary\"\n              :icon=\"Refresh\"\n              :loading=\"refreshing\"\n              @click=\"handleRefreshAll\"\n              size=\"small\"\n            >\n              \n            </el-button>\n            <el-dropdown @command=\"handleAddAdapter\" trigger=\"click\">\n              <el-button type=\"primary\" :icon=\"Plus\" size=\"small\">\n                \n              </el-button>\n              <template #dropdown>\n                <el-dropdown-menu>\n                  <el-dropdown-item\n                    v-for=\"type in adapterTypes\"\n                    :key=\"type\"\n                    :command=\"type\"\n                  >\n                    <el-icon><Connection /></el-icon>\n                    {{ formatTypeLabel(type) }}\n                  </el-dropdown-item>\n                </el-dropdown-menu>\n              </template>\n            </el-dropdown>\n          </div>\n        </div>\n\n        <!--  -->\n        <div v-if=\"isMobile && configStore.selectedAdapters && configStore.selectedAdapters.length > 0\" class=\"mobile-batch-actions\">\n          <div class=\"batch-info\">\n             {{ configStore.selectedAdapters.length }} \n          </div>\n          <div class=\"batch-buttons\">\n            <el-button type=\"success\" size=\"small\" @click=\"handleBatchEnable\"></el-button>\n            <el-button type=\"warning\" size=\"small\" @click=\"handleBatchDisable\"></el-button>\n            <el-button type=\"danger\" size=\"small\" @click=\"handleBatchDelete\"></el-button>\n          </div>\n        </div>\n\n        <!--  -->\n        <div class=\"stats-bar\">\n          <div class=\"stat-item\">\n            <span class=\"stat-label\"></span>\n            <span class=\"stat-value\">{{ allAdapters.length }} </span>\n          </div>\n          <div class=\"stat-item\">\n            <span class=\"stat-label\"></span>\n            <span class=\"stat-value\">{{ enabledCount }} </span>\n          </div>\n          <div class=\"stat-item\">\n            <span class=\"stat-label\"></span>\n            <span class=\"stat-value\">{{ configStore.totalModelsCount }} </span>\n          </div>\n        </div>\n\n        <!--  -->\n        <div class=\"adapters-list\">\n          <div v-if=\"allAdapters.length === 0\" class=\"empty-state\">\n            <el-empty description=\"\">\n              <el-dropdown @command=\"handleAddAdapter\" trigger=\"click\">\n                <el-button type=\"primary\" :icon=\"Plus\">\n                  \n                </el-button>\n                <template #dropdown>\n                  <el-dropdown-menu>\n                    <el-dropdown-item\n                      v-for=\"type in adapterTypes\"\n                      :key=\"type\"\n                      :command=\"type\"\n                    >\n                      <el-icon><Connection /></el-icon>\n                      {{ formatTypeLabel(type) }}\n                    </el-dropdown-item>\n                  </el-dropdown-menu>\n                </template>\n              </el-dropdown>\n            </el-empty>\n          </div>\n\n          <el-table\n            v-else\n            :data=\"allAdapters\"\n            style=\"width: 100%\"\n            @selection-change=\"handleSelectionChange\"\n          >\n            <el-table-column type=\"selection\" width=\"55\" />\n            \n            <el-table-column label=\"\" width=\"120\">\n              <template #default=\"{ row }\">\n                <el-tag :type=\"getTypeTagType(row.type)\" effect=\"light\">\n                  {{ formatTypeLabel(row.type) }}\n                </el-tag>\n              </template>\n            </el-table-column>\n\n            <el-table-column label=\"\" min-width=\"150\">\n              <template #default=\"{ row }\">\n                <div class=\"adapter-name\">\n                  <span class=\"name\">{{ row.adapter.name || `${row.type}-${row.index + 1}` }}</span>\n                  <el-tag v-if=\"!row.adapter.enable\" type=\"info\" size=\"small\" effect=\"plain\">\n                    \n                  </el-tag>\n                </div>\n              </template>\n            </el-table-column>\n\n            <el-table-column label=\"\" min-width=\"200\">\n              <template #default=\"{ row }\">\n                <span class=\"model-name\">{{ row.adapter.default_model || '-' }}</span>\n              </template>\n            </el-table-column>\n\n            <el-table-column label=\"\" width=\"120\" align=\"center\">\n              <template #default=\"{ row }\">\n                <el-tag size=\"small\" :type=\"getModelCountType(row.modelCount)\" effect=\"plain\" round>\n                  {{ row.modelCount }} \n                </el-tag>\n              </template>\n            </el-table-column>\n\n            <el-table-column label=\"\" width=\"100\" align=\"center\">\n              <template #default=\"{ row }\">\n                <el-switch\n                  v-model=\"row.adapter.enable\"\n                  @change=\"handleToggle(row)\"\n                />\n              </template>\n            </el-table-column>\n\n            <el-table-column label=\"\" width=\"200\" align=\"center\">\n              <template #default=\"{ row }\">\n                <div class=\"action-buttons\">\n                  <el-button\n                    size=\"small\"\n                    type=\"primary\"\n                    text\n                    @click=\"handleEdit(row)\"\n                  >\n                    \n                  </el-button>\n                  <el-button\n                    size=\"small\"\n                    type=\"success\"\n                    text\n                    @click=\"handleRefresh(row)\"\n                  >\n                    \n                  </el-button>\n                  <el-button\n                    size=\"small\"\n                    type=\"danger\"\n                    text\n                    @click=\"handleDelete(row)\"\n                  >\n                    \n                  </el-button>\n                </div>\n              </template>\n            </el-table-column>\n          </el-table>\n        </div>\n      </div>\n    </transition>\n\n    <!--  -->\n    <adapter-editor\n      :visible=\"editorVisible\"\n      :mode=\"editorMode\"\n      :type=\"editorType\"\n      :adapter=\"editorAdapter\"\n      :index=\"editorIndex\"\n      @close=\"handleEditorClose\"\n      @submit=\"handleEditorSubmit\"\n    />\n  </div>\n</template>\n\n<script setup>\nimport AdapterEditor from '@/components/settings/AdapterEditor.vue';\nimport { useConfigStore } from '@/stores/configStore.js';\nimport {\n  ArrowDown,\n  Check,\n  Close,\n  Connection,\n  Delete,\n  Plus,\n  Refresh\n} from '@element-plus/icons-vue';\nimport { ElMessage, ElMessageBox } from 'element-plus';\nimport { computed, onMounted, onUnmounted, ref } from 'vue';\n\nconst configStore = useConfigStore();\n\nconst loading = ref(true);\nconst refreshing = ref(false);\nconst editorVisible = ref(false);\nconst editorMode = ref('add');\nconst editorType = ref('openai');\nconst editorAdapter = ref(null);\n\n// \nconst isMobile = ref(false);\n\nconst checkMobile = () => {\n  isMobile.value = window.innerWidth <= 768;\n};\nconst editorIndex = ref(-1);\n\n// \nconst adapterTypes = computed(() => {\n  return configStore?.adapterTypes?.types || [];\n});\n\n// \nconst allAdapters = computed(() => {\n  const adapters = [];\n  Object.entries(configStore.adapters).forEach(([type, instances]) => {\n    instances.forEach((adapter, index) => {\n      const providerName = adapter.name || `${type}-${index + 1}`;\n      const models = configStore.models[providerName] || [];\n      const modelCount = models.reduce((count, group) => {\n        return count + (group.models ? group.models.length : 0);\n      }, 0);\n      \n      adapters.push({\n        type,\n        index,\n        adapter,\n        providerName,\n        models,\n        modelCount\n      });\n    });\n  });\n  return adapters;\n});\n\n// \nconst enabledCount = computed(() => {\n  return allAdapters.value.filter(item => item.adapter.enable).length;\n});\n\n// \nconst getAdapterModels = (adapter, type, index) => {\n  const providerName = adapter.name || `${type}-${index + 1}`;\n  return configStore.models[providerName] || [];\n};\n\n// \nconst formatTypeLabel = (type) => {\n  //  configStore  adapterTypes \n  if (configStore?.adapterTypes?.adapters) {\n    // \n    const adapterInfo = configStore.adapterTypes.adapters.find(a => a.type === type);\n    if (adapterInfo?.name) {\n      return adapterInfo.name;\n    }\n  }\n  \n  // \n  const map = {\n    openai: 'OpenAI',\n    gemini: 'Gemini',\n    vertex: 'Vertex AI',\n    deepseek: 'DeepSeek',\n    anthropic: 'Anthropic'\n  };\n  if (map[type]) return map[type];\n  return type.charAt(0).toUpperCase() + type.slice(1);\n};\n\n// \nconst getTypeTagType = (type) => {\n  const map = {\n    openai: 'success',\n    gemini: 'warning',\n    vertex: 'info'\n  };\n  return map[type] || 'primary';\n};\n\n// \nconst getModelCountType = (count) => {\n  if (count === 0) return 'danger';\n  if (count < 5) return 'warning';\n  return 'success';\n};\n\n// \nconst handleAddAdapter = (type) => {\n  editorMode.value = 'add';\n  editorType.value = type;\n  editorAdapter.value = null;\n  editorIndex.value = -1;\n  editorVisible.value = true;\n};\n\n// \nconst handleEdit = (row) => {\n  const { type, index, adapter } = row;\n  editorMode.value = 'edit';\n  editorType.value = type;\n  editorAdapter.value = adapter;\n  editorIndex.value = index;\n  editorVisible.value = true;\n};\n\n// \nconst handleDelete = async (row) => {\n  const { type, index, adapter } = row;\n  const adapterName = adapter.name || `${type}-${index + 1}`;\n  \n  try {\n    await ElMessageBox.confirm(\n      ` \"${adapterName}\" `,\n      '',\n      {\n        confirmButtonText: '',\n        cancelButtonText: '',\n        type: 'warning'\n      }\n    );\n\n    await configStore.deleteAdapter(type, index);\n    ElMessage.success('');\n  } catch (error) {\n    if (error !== 'cancel') {\n      ElMessage.error('' + error.message);\n    }\n  }\n};\n\n// \nconst handleRefresh = async (row) => {\n  const { type, index } = row;\n  try {\n    await configStore.refreshAdapterModels(type, index);\n    ElMessage.success('');\n  } catch (error) {\n    ElMessage.error('' + error.message);\n  }\n};\n\n// /\nconst handleToggle = async (row) => {\n  const { type, index, adapter } = row;\n  const enable = adapter.enable;\n  \n  try {\n    //  enable \n    const updatedData = { ...adapter, enable };\n    await configStore.updateAdapter(type, index, updatedData);\n    ElMessage.success(enable ? '' : '');\n  } catch (error) {\n    // \n    adapter.enable = !enable;\n    ElMessage.error('' + error.message);\n  }\n};\n\n// \nconst handleSelectionChange = (selection) => {\n  // \n  configStore.clearAdapterSelection();\n  \n  // \n  selection.forEach(item => {\n    configStore.toggleAdapterSelection(item.type, item.index);\n  });\n};\n\n// \nconst handleRefreshAll = async () => {\n  refreshing.value = true;\n  try {\n    await configStore.refreshAllModels();\n    ElMessage.success('');\n  } catch (error) {\n    ElMessage.error('' + error.message);\n  } finally {\n    refreshing.value = false;\n  }\n};\n\n// \nconst handleBatchEnable = async () => {\n  if (!configStore.selectedAdapters || configStore.selectedAdapters.length === 0) {\n    ElMessage.warning('');\n    return;\n  }\n  \n  try {\n    const results = await configStore.batchToggleAdapters(\n      configStore.selectedAdapters,\n      true\n    );\n    \n    const successCount = results.filter(r => r.success).length;\n    ElMessage.success(` ${successCount} `);\n    configStore.clearAdapterSelection();\n  } catch (error) {\n    ElMessage.error('' + error.message);\n  }\n};\n\n// \nconst handleBatchDisable = async () => {\n  if (!configStore.selectedAdapters || configStore.selectedAdapters.length === 0) {\n    ElMessage.warning('');\n    return;\n  }\n  \n  try {\n    const results = await configStore.batchToggleAdapters(\n      configStore.selectedAdapters,\n      false\n    );\n    \n    const successCount = results.filter(r => r.success).length;\n    ElMessage.success(` ${successCount} `);\n    configStore.clearAdapterSelection();\n  } catch (error) {\n    ElMessage.error('' + error.message);\n  }\n};\n\n// \nconst handleBatchDelete = async () => {\n  if (!configStore.selectedAdapters || configStore.selectedAdapters.length === 0) {\n    ElMessage.warning('');\n    return;\n  }\n  \n  try {\n    await ElMessageBox.confirm(\n      ` ${configStore.selectedAdapters.length} `,\n      '',\n      {\n        confirmButtonText: '',\n        cancelButtonText: '',\n        type: 'warning'\n      }\n    );\n\n    const results = await configStore.batchDeleteAdapters(\n      configStore.selectedAdapters\n    );\n    \n    const successCount = results.filter(r => r.success).length;\n    ElMessage.success(` ${successCount} `);\n    configStore.clearAdapterSelection();\n  } catch (error) {\n    if (error !== 'cancel') {\n      ElMessage.error('' + error.message);\n    }\n  }\n};\n\n// \nconst handleEditorClose = () => {\n  editorVisible.value = false;\n};\n\n// \nconst handleEditorSubmit = async ({ type, index, data, mode }) => {\n  try {\n    if (mode === 'add') {\n      await configStore.addAdapter(type, data);\n      ElMessage.success('');\n    } else {\n      await configStore.updateAdapter(type, index, data);\n      ElMessage.success('');\n    }\n  } catch (error) {\n    ElMessage.error(mode === 'add' ? '' : '' + error.message);\n    throw error; // \n  }\n};\n\n// \nonMounted(async () => {\n  // \n  checkMobile();\n  window.addEventListener('resize', checkMobile);\n  \n  loading.value = true;\n  try {\n    // \n    const promises = [];\n    \n    if (!configStore.adapterTypes.types.length) {\n      promises.push(configStore.fetchAdapterTypes());\n    }\n    \n    if (!configStore.config) {\n      promises.push(configStore.fetchConfig());\n    }\n    \n    await Promise.all(promises);\n    await new Promise(resolve => setTimeout(resolve, 300));\n  } catch (error) {\n    ElMessage.error('' + error.message);\n  } finally {\n    loading.value = false;\n  }\n});\n\nonUnmounted(() => {\n  window.removeEventListener('resize', checkMobile);\n});\n</script>\n\n<style scoped lang=\"scss\">\n// \n.fade-enter-active,\n.fade-leave-active {\n  transition: opacity 0.3s ease;\n}\n\n.fade-enter-from,\n.fade-leave-to {\n  opacity: 0;\n}\n\n.llm-adapters-view {\n  padding: 24px;\n  max-width: 1400px;\n  margin: 0 auto;\n\n  @media (max-width: 768px) {\n    padding: 16px;\n    max-width: 100%;\n  }\n}\n\n.loading-container {\n  .skeleton-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin-bottom: 24px;\n\n    .skeleton-title {\n      width: 200px;\n      height: 32px;\n      border-radius: 4px;\n      background: linear-gradient(90deg, #f2f2f2 25%, #e6e6e6 50%, #f2f2f2 75%);\n      background-size: 200% 100%;\n      animation: skeleton-loading 1.5s ease-in-out infinite;\n    }\n\n    .skeleton-actions {\n      display: flex;\n      gap: 12px;\n\n      .skeleton-button {\n        width: 120px;\n        height: 32px;\n        border-radius: 4px;\n        background: linear-gradient(90deg, #f2f2f2 25%, #e6e6e6 50%, #f2f2f2 75%);\n        background-size: 200% 100%;\n        animation: skeleton-loading 1.5s ease-in-out infinite;\n      }\n    }\n  }\n\n  .skeleton-table {\n    border-radius: 8px;\n    overflow: hidden;\n    border: 1px solid #ebeef5;\n\n    .skeleton-row {\n      display: flex;\n      height: 60px;\n      border-bottom: 1px solid #ebeef5;\n\n      &:last-child {\n        border-bottom: none;\n      }\n\n      .skeleton-cell {\n        flex: 1;\n        margin: 12px;\n        border-radius: 4px;\n        background: linear-gradient(90deg, #f2f2f2 25%, #e6e6e6 50%, #f2f2f2 75%);\n        background-size: 200% 100%;\n        animation: skeleton-loading 1.5s ease-in-out infinite;\n\n        &:first-child {\n          flex: 0 0 60px;\n        }\n\n        &:nth-child(2) {\n          flex: 0 0 100px;\n        }\n\n        &:nth-child(3) {\n          flex: 2;\n        }\n\n        &:nth-child(4) {\n          flex: 2;\n        }\n\n        &:nth-child(5) {\n          flex: 0 0 100px;\n        }\n\n        &:last-child {\n          flex: 0 0 180px;\n        }\n      }\n    }\n  }\n}\n\n@keyframes skeleton-loading {\n  0% {\n    background-position: -200% 0;\n  }\n  100% {\n    background-position: 200% 0;\n  }\n}\n\n.content-container {\n  width: 100%;\n}\n\n.page-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 24px;\n\n  &.mobile {\n    margin-bottom: 16px;\n    justify-content: flex-end;\n  }\n\n  h1 {\n    margin: 0;\n    font-size: 24px;\n    font-weight: 600;\n    color: #303133;\n  }\n\n  .header-actions {\n    display: flex;\n    gap: 12px;\n  }\n\n  .mobile-actions {\n    display: flex;\n    gap: 8px;\n  }\n}\n\n// \n.mobile-batch-actions {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 12px 16px;\n  background: #ecf5ff;\n  border-radius: 8px;\n  margin-bottom: 16px;\n  border: 1px solid #b3d8ff;\n\n  .batch-info {\n    font-size: 14px;\n    color: #409eff;\n    font-weight: 500;\n  }\n\n  .batch-buttons {\n    display: flex;\n    gap: 8px;\n  }\n}\n\n.stats-bar {\n  display: flex;\n  gap: 24px;\n  padding: 16px 20px;\n  background: #f8f9fa;\n  border-radius: 8px;\n  margin-bottom: 20px;\n\n  @media (max-width: 768px) {\n    flex-direction: column;\n    gap: 12px;\n    padding: 12px 16px;\n    margin-bottom: 16px;\n  }\n\n  .stat-item {\n    display: flex;\n    align-items: center;\n    gap: 4px;\n\n    .stat-label {\n      font-size: 14px;\n      color: #606266;\n    }\n\n    .stat-value {\n      font-size: 14px;\n      font-weight: 600;\n      color: #303133;\n    }\n  }\n}\n\n.adapters-list {\n  background: white;\n  border-radius: 8px;\n  overflow: hidden;\n\n  .empty-state {\n    padding: 48px 0;\n    background: #f9fafc;\n  }\n\n  .adapter-name {\n    display: flex;\n    align-items: center;\n    gap: 8px;\n\n    .name {\n      font-weight: 500;\n      color: #303133;\n    }\n  }\n\n  .model-name {\n    font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;\n    font-size: 13px;\n    color: #606266;\n  }\n\n  .action-buttons {\n    display: flex;\n    gap: 8px;\n    justify-content: center;\n  }\n}\n\n// Element Plus \n:deep(.el-table) {\n  .el-table__header {\n    th {\n      background-color: #fafafa;\n      color: #606266;\n      font-weight: 600;\n    }\n  }\n\n  .el-table__row {\n    &:hover {\n      background-color: #f5f7fa;\n    }\n  }\n\n  .el-table__cell {\n    padding: 12px 0;\n  }\n}\n// \n@media (max-width: 768px) {\n  .page-header {\n    .header-actions {\n      display: none !important;\n    }\n  }\n\n  .stats-bar {\n    .stat-item {\n      .stat-label {\n        font-size: 13px;\n      }\n      .stat-value {\n        font-size: 14px;\n      }\n    }\n  }\n\n  .adapters-list {\n    .adapter-card {\n      margin-bottom: 12px;\n      \n      .card-header {\n        padding: 12px 16px;\n        \n        .adapter-title {\n          font-size: 16px;\n        }\n        \n        .adapter-actions {\n          gap: 8px;\n          \n          .el-button {\n            padding: 6px 12px;\n            font-size: 13px;\n          }\n        }\n      }\n      \n      .card-content {\n        padding: 12px 16px;\n        \n        .adapter-info {\n          .info-item {\n            margin-bottom: 8px;\n            \n            .info-label {\n              font-size: 13px;\n            }\n            \n            .info-value {\n              font-size: 14px;\n            }\n          }\n        }\n      }\n    }\n  }\n\n  .empty-state {\n    padding: 40px 20px;\n    \n    .el-empty {\n      :deep(.el-empty__description) {\n        font-size: 14px;\n      }\n    }\n  }\n}\n\n// \n@media (min-width: 769px) and (max-width: 1024px) {\n  .llm-adapters-view {\n    padding: 20px;\n  }\n  \n  .page-header {\n    .header-actions {\n      gap: 8px;\n      \n      .el-button {\n        padding: 8px 12px;\n        font-size: 13px;\n      }\n    }\n  }\n}\n</style>","<template>\n  <div class=\"server-config-view\">\n    <div class=\"page-header\">\n      <h1></h1>\n      <div class=\"header-actions\">\n        <el-button @click=\"handleReset\"></el-button>\n        <el-button\n          type=\"primary\"\n          :loading=\"saving\"\n          @click=\"handleSave\"\n        >\n          \n        </el-button>\n      </div>\n    </div>\n\n    <el-alert\n      type=\"warning\"\n      :closable=\"false\"\n      show-icon\n      style=\"margin-bottom: 24px;\"\n    >\n      <template #title>\n        \n      </template>\n    </el-alert>\n\n    <el-card>\n      <el-form\n        ref=\"formRef\"\n        :model=\"formData\"\n        :rules=\"rules\"\n        label-width=\"140px\"\n        label-position=\"left\"\n      >\n        <el-form-item label=\"\" prop=\"port\">\n          <el-input-number\n            v-model=\"formData.port\"\n            :min=\"1\"\n            :max=\"65535\"\n            :step=\"1\"\n            controls-position=\"right\"\n            style=\"width: 200px\"\n          />\n          <template #extra>\n            <span class=\"form-item-tip\">\n              1-65535 3080\n            </span>\n          </template>\n        </el-form-item>\n\n        <el-form-item label=\"\" prop=\"host\">\n          <el-input\n            v-model=\"formData.host\"\n            placeholder=\"0.0.0.0\"\n            style=\"width: 300px\"\n          />\n          <template #extra>\n            <span class=\"form-item-tip\">\n              0.0.0.0 \n            </span>\n          </template>\n        </el-form-item>\n\n        <el-form-item label=\"\" prop=\"max_rate_pre_min\">\n          <el-input-number\n            v-model=\"formData.max_rate_pre_min\"\n            :min=\"1\"\n            :max=\"10000\"\n            :step=\"10\"\n            controls-position=\"right\"\n            style=\"width: 200px\"\n          />\n          <span style=\"margin-left: 12px; color: #909399;\">/</span>\n          <template #extra>\n            <span class=\"form-item-tip\">\n              \n            </span>\n          </template>\n        </el-form-item>\n\n        <el-divider />\n\n        <el-form-item label=\"\" prop=\"debug\">\n          <el-switch\n            v-model=\"formData.debug\"\n            active-text=\"\"\n            inactive-text=\"\"\n          />\n          <template #extra>\n            <span class=\"form-item-tip\">\n              \n            </span>\n          </template>\n        </el-form-item>\n      </el-form>\n    </el-card>\n  </div>\n</template>\n\n<script setup>\nimport { ref, reactive, onMounted } from 'vue';\nimport { ElMessage, ElMessageBox } from 'element-plus';\nimport { useConfigStore } from '@/stores/configStore.js';\n\nconst configStore = useConfigStore();\nconst formRef = ref(null);\nconst saving = ref(false);\n\n// \nconst formData = reactive({\n  port: 3080,\n  host: '0.0.0.0',\n  max_rate_pre_min: 100,\n  debug: false\n});\n\n// \nconst originalData = reactive({});\n\n// \nconst rules = {\n  port: [\n    { required: true, message: '', trigger: 'blur' },\n    {\n      type: 'number',\n      min: 1,\n      max: 65535,\n      message: ' 1-65535 ',\n      trigger: 'blur'\n    }\n  ],\n  host: [\n    { required: true, message: '', trigger: 'blur' }\n  ],\n  max_rate_pre_min: [\n    { required: true, message: '', trigger: 'blur' },\n    {\n      type: 'number',\n      min: 1,\n      message: ' 0',\n      trigger: 'blur'\n    }\n  ]\n};\n\n// \nconst loadConfig = async () => {\n  try {\n    const serverConfig = configStore.config?.server || await configStore.fetchConfigSection('server');\n    const debugConfig = configStore.config?.debug ?? false;\n    \n    Object.assign(formData, {\n      port: serverConfig.port || 3080,\n      host: serverConfig.host || '0.0.0.0',\n      max_rate_pre_min: serverConfig.max_rate_pre_min || 100,\n      debug: debugConfig\n    });\n    \n    // \n    Object.assign(originalData, formData);\n  } catch (error) {\n    ElMessage.error('' + error.message);\n  }\n};\n\n// \nconst handleSave = async () => {\n  try {\n    await formRef.value.validate();\n    \n    await ElMessageBox.confirm(\n      '',\n      '',\n      {\n        confirmButtonText: '',\n        cancelButtonText: '',\n        type: 'warning'\n      }\n    );\n\n    saving.value = true;\n\n    //  server \n    await configStore.updateConfigSection('server', {\n      port: formData.port,\n      host: formData.host,\n      max_rate_pre_min: formData.max_rate_pre_min\n    });\n\n    //  debug \n    if (configStore.config) {\n      configStore.config.debug = formData.debug;\n    }\n\n    ElMessage.success('');\n    \n    // \n    Object.assign(originalData, formData);\n  } catch (error) {\n    if (error !== 'cancel') {\n      ElMessage.error('' + error.message);\n    }\n  } finally {\n    saving.value = false;\n  }\n};\n\n// \nconst handleReset = () => {\n  Object.assign(formData, originalData);\n  formRef.value?.clearValidate();\n  ElMessage.info('');\n};\n\n// \nonMounted(async () => {\n  if (!configStore.config) {\n    await configStore.fetchConfig();\n  }\n  await loadConfig();\n});\n</script>\n\n<style scoped lang=\"scss\">\n.server-config-view {\n  padding: 24px;\n  max-width: 900px;\n  margin: 0 auto;\n}\n\n.page-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 24px;\n\n  h1 {\n    margin: 0;\n    font-size: 24px;\n    font-weight: 600;\n    color: #303133;\n  }\n\n  .header-actions {\n    display: flex;\n    gap: 12px;\n  }\n}\n\n.form-item-tip {\n  color: #909399;\n  font-size: 12px;\n  line-height: 1.5;\n}\n\n:deep(.el-form-item) {\n  margin-bottom: 28px;\n}\n\n:deep(.el-form-item__extra) {\n  margin-top: 4px;\n}\n</style>\n","<template>\n  <div class=\"web-config-view\">\n    <div class=\"page-header\">\n      <h1>Web </h1>\n      <div class=\"header-actions\">\n        <el-button @click=\"handleReset\"></el-button>\n        <el-button\n          type=\"primary\"\n          :loading=\"saving\"\n          @click=\"handleSave\"\n        >\n          \n        </el-button>\n      </div>\n    </div>\n\n    <el-alert\n      type=\"warning\"\n      :closable=\"false\"\n      show-icon\n      style=\"margin-bottom: 24px;\"\n    >\n      <template #title>\n         Web \n      </template>\n    </el-alert>\n\n    <el-card>\n      <el-form\n        ref=\"formRef\"\n        :model=\"formData\"\n        :rules=\"rules\"\n        label-width=\"140px\"\n        label-position=\"left\"\n      >\n        <el-form-item label=\"\" prop=\"title\">\n          <el-input\n            v-model=\"formData.title\"\n            placeholder=\"MioChat\"\n            maxlength=\"50\"\n            show-word-limit\n            style=\"width: 400px\"\n          />\n          <template #extra>\n            <span class=\"form-item-tip\">\n              \n            </span>\n          </template>\n        </el-form-item>\n\n        <el-form-item label=\"\" prop=\"beian\">\n          <el-input\n            v-model=\"formData.beian\"\n            placeholder=\"\"\n            maxlength=\"100\"\n            show-word-limit\n            style=\"width: 400px\"\n          />\n          <template #extra>\n            <span class=\"form-item-tip\">\n              ICP12345678\n            </span>\n          </template>\n        </el-form-item>\n\n        <el-divider />\n\n        <el-form-item label=\"\" prop=\"admin_code\">\n          <el-input\n            v-model=\"formData.admin_code\"\n            :type=\"showAdminCode ? 'text' : 'password'\"\n            placeholder=\"\"\n            maxlength=\"50\"\n            show-word-limit\n            style=\"width: 400px\"\n          >\n            <template #append>\n              <el-button\n                :icon=\"showAdminCode ? View : Hide\"\n                @click=\"showAdminCode = !showAdminCode\"\n              />\n            </template>\n          </el-input>\n          <template #extra>\n            <span class=\"form-item-tip\">\n              \n            </span>\n          </template>\n        </el-form-item>\n\n        <el-form-item label=\"\" prop=\"user_code\">\n          <el-input\n            v-model=\"formData.user_code\"\n            :type=\"showUserCode ? 'text' : 'password'\"\n            placeholder=\"\"\n            maxlength=\"50\"\n            show-word-limit\n            style=\"width: 400px\"\n          >\n            <template #append>\n              <el-button\n                :icon=\"showUserCode ? View : Hide\"\n                @click=\"showUserCode = !showUserCode\"\n              />\n            </template>\n          </el-input>\n          <template #extra>\n            <span class=\"form-item-tip\">\n              \n            </span>\n          </template>\n        </el-form-item>\n\n        <el-divider />\n\n        <el-form-item label=\"\" prop=\"full_screen\">\n          <el-switch\n            v-model=\"formData.full_screen\"\n            active-text=\"\"\n            inactive-text=\"\"\n          />\n          <template #extra>\n            <span class=\"form-item-tip\">\n              \n            </span>\n          </template>\n        </el-form-item>\n      </el-form>\n    </el-card>\n  </div>\n</template>\n\n<script setup>\nimport { ref, reactive, onMounted } from 'vue';\nimport { ElMessage, ElMessageBox } from 'element-plus';\nimport { View, Hide } from '@element-plus/icons-vue';\nimport { useConfigStore } from '@/stores/configStore.js';\n\nconst configStore = useConfigStore();\nconst formRef = ref(null);\nconst saving = ref(false);\nconst showAdminCode = ref(false);\nconst showUserCode = ref(false);\n\n// \nconst formData = reactive({\n  title: 'MioChat',\n  beian: '',\n  admin_code: '',\n  user_code: '',\n  full_screen: true\n});\n\n// \nconst originalData = reactive({});\n\n// \nconst rules = {\n  title: [\n    { required: true, message: '', trigger: 'blur' }\n  ],\n  admin_code: [\n    { required: true, message: '', trigger: 'blur' },\n    { min: 6, message: ' 6 ', trigger: 'blur' }\n  ]\n};\n\n// \nconst loadConfig = async () => {\n  try {\n    const webConfig = configStore.config?.web || await configStore.fetchConfigSection('web');\n    \n    Object.assign(formData, {\n      title: webConfig.title || 'MioChat',\n      beian: webConfig.beian || '',\n      admin_code: webConfig.admin_code || '',\n      user_code: webConfig.user_code || '',\n      full_screen: webConfig.full_screen ?? true\n    });\n    \n    // \n    Object.assign(originalData, formData);\n  } catch (error) {\n    ElMessage.error('' + error.message);\n  }\n};\n\n// \nconst handleSave = async () => {\n  try {\n    await formRef.value.validate();\n    \n    await ElMessageBox.confirm(\n      ' Web ',\n      '',\n      {\n        confirmButtonText: '',\n        cancelButtonText: '',\n        type: 'warning'\n      }\n    );\n\n    saving.value = true;\n\n    await configStore.updateConfigSection('web', {\n      title: formData.title,\n      beian: formData.beian,\n      admin_code: formData.admin_code,\n      user_code: formData.user_code,\n      full_screen: formData.full_screen\n    });\n\n    ElMessage.success('');\n    \n    // \n    Object.assign(originalData, formData);\n  } catch (error) {\n    if (error !== 'cancel') {\n      ElMessage.error('' + error.message);\n    }\n  } finally {\n    saving.value = false;\n  }\n};\n\n// \nconst handleReset = () => {\n  Object.assign(formData, originalData);\n  formRef.value?.clearValidate();\n  ElMessage.info('');\n};\n\n// \nonMounted(async () => {\n  if (!configStore.config) {\n    await configStore.fetchConfig();\n  }\n  await loadConfig();\n});\n</script>\n\n<style scoped lang=\"scss\">\n.web-config-view {\n  padding: 24px;\n  max-width: 900px;\n  margin: 0 auto;\n}\n\n.page-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 24px;\n\n  h1 {\n    margin: 0;\n    font-size: 24px;\n    font-weight: 600;\n    color: #303133;\n  }\n\n  .header-actions {\n    display: flex;\n    gap: 12px;\n  }\n}\n\n.form-item-tip {\n  color: #909399;\n  font-size: 12px;\n  line-height: 1.5;\n}\n\n:deep(.el-form-item) {\n  margin-bottom: 28px;\n}\n\n:deep(.el-form-item__extra) {\n  margin-top: 4px;\n}\n</style>\n","<template>\n  <div class=\"onebot-config-view\">\n    <div class=\"page-header\">\n      <h1>OneBot </h1>\n      <div class=\"header-actions\">\n        <el-button @click=\"handleReset\"></el-button>\n        <el-button\n          type=\"primary\"\n          :loading=\"saving\"\n          @click=\"handleSave\"\n        >\n          \n        </el-button>\n      </div>\n    </div>\n\n    <el-alert\n      type=\"warning\"\n      :closable=\"false\"\n      show-icon\n      style=\"margin-bottom: 24px;\"\n    >\n      <template #title>\n         OneBot \n      </template>\n    </el-alert>\n\n    <el-card>\n      <el-form\n        ref=\"formRef\"\n        :model=\"formData\"\n        :rules=\"rules\"\n        label-width=\"160px\"\n        label-position=\"left\"\n      >\n        <el-form-item label=\" OneBot\" prop=\"enable\">\n          <el-switch\n            v-model=\"formData.enable\"\n            active-text=\"\"\n            inactive-text=\"\"\n          />\n          <template #extra>\n            <span class=\"form-item-tip\">\n               OneBot QQ \n            </span>\n          </template>\n        </el-form-item>\n\n        <template v-if=\"formData.enable\">\n          <el-divider content-position=\"left\"></el-divider>\n\n          <el-form-item label=\" WebSocket URL\" prop=\"reverse_ws_url\">\n            <el-input\n              v-model=\"formData.reverse_ws_url\"\n              placeholder=\"ws://localhost:2536/OneBotv11\"\n              style=\"width: 500px\"\n            />\n            <template #extra>\n              <span class=\"form-item-tip\">\n                OneBot  WebSocket  go-cqhttp\n              </span>\n            </template>\n          </el-form-item>\n\n          <el-form-item label=\"Access Token\" prop=\"token\">\n            <el-input\n              v-model=\"formData.token\"\n              :type=\"showToken ? 'text' : 'password'\"\n              placeholder=\" token \"\n              maxlength=\"100\"\n              show-word-limit\n              style=\"width: 500px\"\n            >\n              <template #append>\n                <el-button\n                  :icon=\"showToken ? View : Hide\"\n                  @click=\"showToken = !showToken\"\n                />\n              </template>\n            </el-input>\n            <template #extra>\n              <span class=\"form-item-tip\">\n                 OneBot  access_token \n              </span>\n            </template>\n          </el-form-item>\n\n          <el-divider content-position=\"left\"></el-divider>\n\n          <el-form-item label=\" QQ \" prop=\"bot_qq\">\n            <el-input\n              v-model=\"formData.bot_qq\"\n              placeholder=\"3038848622\"\n              maxlength=\"20\"\n              style=\"width: 300px\"\n            />\n            <template #extra>\n              <span class=\"form-item-tip\">\n                 QQ \n              </span>\n            </template>\n          </el-form-item>\n\n          <el-form-item label=\" QQ \" prop=\"admin_qq\">\n            <el-input\n              v-model=\"formData.admin_qq\"\n              placeholder=\"1099834705\"\n              maxlength=\"20\"\n              style=\"width: 300px\"\n            />\n            <template #extra>\n              <span class=\"form-item-tip\">\n                 QQ \n              </span>\n            </template>\n          </el-form-item>\n        </template>\n      </el-form>\n    </el-card>\n\n    <!--  -->\n    <el-card v-if=\"formData.enable\" style=\"margin-top: 16px;\">\n      <template #header>\n        <div class=\"card-header\">\n          <span></span>\n        </div>\n      </template>\n      <el-alert\n        type=\"info\"\n        :closable=\"false\"\n        show-icon\n      >\n        <template #title>\n          \n        </template>\n      </el-alert>\n    </el-card>\n  </div>\n</template>\n\n<script setup>\nimport { ref, reactive, onMounted } from 'vue';\nimport { ElMessage, ElMessageBox } from 'element-plus';\nimport { View, Hide } from '@element-plus/icons-vue';\nimport { useConfigStore } from '@/stores/configStore.js';\n\nconst configStore = useConfigStore();\nconst formRef = ref(null);\nconst saving = ref(false);\nconst showToken = ref(false);\n\n// \nconst formData = reactive({\n  enable: false,\n  reverse_ws_url: '',\n  token: '',\n  bot_qq: '',\n  admin_qq: ''\n});\n\n// \nconst originalData = reactive({});\n\n// \nconst rules = {\n  reverse_ws_url: [\n    {\n      validator: (rule, value, callback) => {\n        if (formData.enable && !value) {\n          callback(new Error(' WebSocket URL'));\n        } else if (value && !value.startsWith('ws://') && !value.startsWith('wss://')) {\n          callback(new Error('URL  ws://  wss:// '));\n        } else {\n          callback();\n        }\n      },\n      trigger: 'blur'\n    }\n  ],\n  bot_qq: [\n    {\n      validator: (rule, value, callback) => {\n        if (formData.enable && !value) {\n          callback(new Error(' QQ '));\n        } else if (value && !/^\\d+$/.test(value)) {\n          callback(new Error('QQ '));\n        } else {\n          callback();\n        }\n      },\n      trigger: 'blur'\n    }\n  ],\n  admin_qq: [\n    {\n      validator: (rule, value, callback) => {\n        if (value && !/^\\d+$/.test(value)) {\n          callback(new Error('QQ '));\n        } else {\n          callback();\n        }\n      },\n      trigger: 'blur'\n    }\n  ]\n};\n\n// \nconst loadConfig = async () => {\n  try {\n    const onebotConfig = configStore.config?.onebot || await configStore.fetchConfigSection('onebot');\n    \n    Object.assign(formData, {\n      enable: onebotConfig.enable ?? false,\n      reverse_ws_url: onebotConfig.reverse_ws_url || '',\n      token: onebotConfig.token || '',\n      bot_qq: onebotConfig.bot_qq || '',\n      admin_qq: onebotConfig.admin_qq || ''\n    });\n    \n    // \n    Object.assign(originalData, formData);\n  } catch (error) {\n    ElMessage.error('' + error.message);\n  }\n};\n\n// \nconst handleSave = async () => {\n  try {\n    await formRef.value.validate();\n    \n    await ElMessageBox.confirm(\n      ' OneBot ',\n      '',\n      {\n        confirmButtonText: '',\n        cancelButtonText: '',\n        type: 'warning'\n      }\n    );\n\n    saving.value = true;\n\n    await configStore.updateConfigSection('onebot', {\n      enable: formData.enable,\n      reverse_ws_url: formData.reverse_ws_url,\n      token: formData.token,\n      bot_qq: formData.bot_qq,\n      admin_qq: formData.admin_qq\n    });\n\n    ElMessage.success('');\n    \n    // \n    Object.assign(originalData, formData);\n  } catch (error) {\n    if (error !== 'cancel') {\n      ElMessage.error('' + error.message);\n    }\n  } finally {\n    saving.value = false;\n  }\n};\n\n// \nconst handleReset = () => {\n  Object.assign(formData, originalData);\n  formRef.value?.clearValidate();\n  ElMessage.info('');\n};\n\n// \nonMounted(async () => {\n  if (!configStore.config) {\n    await configStore.fetchConfig();\n  }\n  await loadConfig();\n});\n</script>\n\n<style scoped lang=\"scss\">\n.onebot-config-view {\n  padding: 24px;\n  max-width: 900px;\n  margin: 0 auto;\n}\n\n.page-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 24px;\n\n  h1 {\n    margin: 0;\n    font-size: 24px;\n    font-weight: 600;\n    color: #303133;\n  }\n\n  .header-actions {\n    display: flex;\n    gap: 12px;\n  }\n}\n\n.card-header {\n  font-weight: 600;\n  color: #303133;\n}\n\n.form-item-tip {\n  color: #909399;\n  font-size: 12px;\n  line-height: 1.5;\n}\n\n:deep(.el-form-item) {\n  margin-bottom: 28px;\n}\n\n:deep(.el-form-item__extra) {\n  margin-top: 4px;\n}\n\n:deep(.el-divider) {\n  margin: 24px 0 16px 0;\n}\n\n:deep(.el-divider__text) {\n  font-weight: 600;\n  color: #606266;\n}\n</style>\n","<template>\n  <div class=\"plugins-view\">\n    <!--  -->\n    <div v-if=\"loading\" class=\"loading-container\">\n      <div class=\"skeleton-header\">\n        <div class=\"skeleton-title\"></div>\n        <div class=\"skeleton-actions\">\n          <div class=\"skeleton-button\" v-for=\"i in 2\" :key=\"i\"></div>\n        </div>\n      </div>\n      <div class=\"plugins-grid\">\n        <LoadingSkeleton v-for=\"i in 6\" :key=\"i\" type=\"adapter-card\" is-card />\n      </div>\n    </div>\n\n    <transition name=\"fade\" mode=\"out-in\">\n      <div v-if=\"!loading\" class=\"content-container\">\n        <!--  -->\n        <div class=\"page-header\">\n          <h1></h1>\n          <div class=\"header-actions\">\n            <el-button\n              type=\"primary\"\n              :icon=\"Refresh\"\n              :loading=\"refreshing\"\n              @click=\"handleRefreshPlugins\"\n            >\n              \n            </el-button>\n            <el-button\n              type=\"success\"\n              :icon=\"RefreshRight\"\n              @click=\"handleReloadAll\"\n            >\n              \n            </el-button>\n          </div>\n        </div>\n\n        <!--  -->\n        <div class=\"stats-row\">\n          <el-card class=\"stat-card\">\n            <div class=\"stat-icon\" style=\"background-color: #409eff20;\">\n              <el-icon :size=\"24\" color=\"#409eff\"><Grid /></el-icon>\n            </div>\n            <div class=\"stat-content\">\n              <div class=\"stat-value\">{{ plugins.length }}</div>\n              <div class=\"stat-label\"></div>\n            </div>\n          </el-card>\n\n          <el-card class=\"stat-card\">\n            <div class=\"stat-icon\" style=\"background-color: #67c23a20;\">\n              <el-icon :size=\"24\" color=\"#67c23a\"><CircleCheck /></el-icon>\n            </div>\n            <div class=\"stat-content\">\n              <div class=\"stat-value\">{{ enabledCount }}</div>\n              <div class=\"stat-label\"></div>\n            </div>\n          </el-card>\n\n          <el-card class=\"stat-card\">\n            <div class=\"stat-icon\" style=\"background-color: #e6a23c20;\">\n              <el-icon :size=\"24\" color=\"#e6a23c\"><Tools /></el-icon>\n            </div>\n            <div class=\"stat-content\">\n              <div class=\"stat-value\">{{ totalToolsCount }}</div>\n              <div class=\"stat-label\"></div>\n            </div>\n          </el-card>\n\n          <el-card class=\"stat-card\">\n            <div class=\"stat-icon\" style=\"background-color: #90939920;\">\n              <el-icon :size=\"24\" color=\"#909399\"><Box /></el-icon>\n            </div>\n            <div class=\"stat-content\">\n              <div class=\"stat-value\">{{ customPluginsCount }}</div>\n              <div class=\"stat-label\"></div>\n            </div>\n          </el-card>\n        </div>\n\n        <!--  -->\n        <div class=\"plugins-list\">\n          <el-card\n            v-for=\"plugin in plugins\"\n            :key=\"plugin.name\"\n            class=\"plugin-card\"\n            :class=\"{ disabled: !plugin.enabled }\"\n          >\n            <div class=\"plugin-header\">\n              <div class=\"plugin-info\">\n                <div class=\"plugin-title-row\">\n                  <h3 class=\"plugin-name\">\n                    <el-tag\n                      v-if=\"plugin.type === 'custom'\"\n                      type=\"warning\"\n                      size=\"small\"\n                      style=\"margin-right: 8px;\"\n                    >\n                      \n                    </el-tag>\n                    {{ plugin.displayName }}\n                  </h3>\n                  <el-switch\n                    v-model=\"plugin.enabled\"\n                    @change=\"handleTogglePlugin(plugin)\"\n                    :loading=\"plugin.toggling\"\n                  />\n                </div>\n                <p class=\"plugin-description\">{{ plugin.description || '' }}</p>\n                <div class=\"plugin-meta\">\n                  <el-tag size=\"small\" type=\"info\">v{{ plugin.version }}</el-tag>\n                  <span class=\"meta-item\">\n                    <el-icon><User /></el-icon>\n                    {{ plugin.author }}\n                  </span>\n                  <span class=\"meta-item\">\n                    <el-icon><Tools /></el-icon>\n                    {{ plugin.toolCount }} \n                  </span>\n                  <el-tag\n                    v-if=\"plugin.hasConfig\"\n                    size=\"small\"\n                    type=\"success\"\n                  >\n                    <el-icon><Setting /></el-icon>\n                    \n                  </el-tag>\n                </div>\n              </div>\n            </div>\n\n            <div class=\"plugin-actions\">\n              <el-button\n                size=\"small\"\n                :icon=\"View\"\n                @click=\"handleViewPlugin(plugin)\"\n              >\n                \n              </el-button>\n              <el-button\n                v-if=\"plugin.hasConfig\"\n                size=\"small\"\n                :icon=\"Setting\"\n                @click=\"handleConfigPlugin(plugin)\"\n              >\n                \n              </el-button>\n              <el-button\n                size=\"small\"\n                type=\"primary\"\n                :icon=\"Refresh\"\n                :loading=\"plugin.reloading\"\n                @click=\"handleReloadPlugin(plugin)\"\n              >\n                \n              </el-button>\n            </div>\n          </el-card>\n        </div>\n      </div>\n    </transition>\n\n    <!--  -->\n    <el-dialog\n      v-model=\"detailDialogVisible\"\n      :title=\"`${currentPlugin?.displayName} - `\"\n      width=\"800px\"\n      destroy-on-close\n      class=\"config-dialog plugin-detail-dialog\"\n    >\n      <div class=\"dialog-content\">\n        <div v-if=\"currentPlugin\" class=\"plugin-detail\">\n        <el-descriptions :column=\"2\" border>\n          <el-descriptions-item label=\"\">\n            {{ currentPlugin.displayName }}\n          </el-descriptions-item>\n          <el-descriptions-item label=\"\">\n            {{ currentPlugin.version }}\n          </el-descriptions-item>\n          <el-descriptions-item label=\"\">\n            {{ currentPlugin.author }}\n          </el-descriptions-item>\n          <el-descriptions-item label=\"\">\n            <el-tag :type=\"currentPlugin.type === 'standard' ? 'success' : 'warning'\">\n              {{ currentPlugin.type === 'standard' ? '' : '' }}\n            </el-tag>\n          </el-descriptions-item>\n          <el-descriptions-item label=\"\">\n            <el-tag :type=\"currentPlugin.enabled ? 'success' : 'info'\">\n              {{ currentPlugin.enabled ? '' : '' }}\n            </el-tag>\n          </el-descriptions-item>\n          <el-descriptions-item label=\"\">\n            {{ currentPlugin.toolCount }}\n          </el-descriptions-item>\n          <el-descriptions-item label=\"\" :span=\"2\">\n            {{ currentPlugin.description || '' }}\n          </el-descriptions-item>\n        </el-descriptions>\n\n        <!--  -->\n        <div v-if=\"pluginTools.length > 0\" class=\"tools-section\">\n          <h4></h4>\n          <el-collapse v-model=\"activeCollapseNames\">\n            <el-collapse-item\n              v-for=\"group in pluginTools\"\n              :key=\"group.group\"\n              :name=\"group.group\"\n              :title=\"`${group.group} (${group.tools.length})`\"\n            >\n              <div\n                v-for=\"tool in group.tools\"\n                :key=\"tool.name\"\n                class=\"tool-item\"\n              >\n                <div class=\"tool-header\">\n                  <h5>{{ tool.name }}</h5>\n                  <el-button\n                    size=\"small\"\n                    type=\"primary\"\n                    :icon=\"Cpu\"\n                    @click=\"handleDebugTool(tool)\"\n                  >\n                    \n                  </el-button>\n                </div>\n                <p class=\"tool-description\">{{ tool.description }}</p>\n                <el-tag size=\"small\" type=\"info\">\n                  : {{ Object.keys(tool.parameters?.properties || {}).length }}\n                </el-tag>\n              </div>\n            </el-collapse-item>\n          </el-collapse>\n        </div>\n        </div>\n      </div>\n    </el-dialog>\n\n    <!--  -->\n    <el-dialog\n      v-model=\"configDialogVisible\"\n      :title=\"`${currentPlugin?.displayName} - `\"\n      width=\"700px\"\n      destroy-on-close\n      class=\"config-dialog plugin-config-dialog\"\n    >\n      <div class=\"dialog-content\">\n        <div class=\"config-editor\">\n          <el-alert\n            type=\"info\"\n            :closable=\"false\"\n            show-icon\n            style=\"margin-bottom: 16px;\"\n          >\n            <template #title>\n              \n            </template>\n          </el-alert>\n          \n          <el-input\n            v-model=\"configJsonStr\"\n            type=\"textarea\"\n            :rows=\"15\"\n            placeholder=\"JSON \"\n            class=\"config-textarea\"\n          />\n        </div>\n      </div>\n      \n      <template #footer>\n        <el-button @click=\"configDialogVisible = false\"></el-button>\n        <el-button\n          type=\"primary\"\n          :loading=\"savingConfig\"\n          @click=\"handleSaveConfig\"\n        >\n          \n        </el-button>\n      </template>\n    </el-dialog>\n\n    <!--  -->\n    <el-dialog\n      v-model=\"debugDialogVisible\"\n      :title=\"`: ${currentTool?.name}`\"\n      width=\"800px\"\n      destroy-on-close\n      class=\"debug-dialog\"\n    >\n      <div class=\"debug-container\" style=\"height: 60vh; overflow-y: auto;\">\n        <!--  -->\n        <el-card class=\"tool-info-card\" shadow=\"never\">\n          <div class=\"tool-info\">\n            <div class=\"info-row\">\n              <label></label>\n              <el-tag type=\"primary\">{{ currentTool?.name }}</el-tag>\n            </div>\n            <div class=\"info-row\">\n              <label></label>\n              <span>{{ currentTool?.description || '' }}</span>\n            </div>\n          </div>\n        </el-card>\n\n        <!--  -->\n        <el-card class=\"params-schema-card\" shadow=\"never\" v-if=\"currentTool?.parameters\">\n          <template #header>\n            <div class=\"card-header\">\n              <span></span>\n              <el-button\n                size=\"small\"\n                type=\"primary\"\n                text\n                @click=\"fillExampleParams\"\n              >\n                \n              </el-button>\n            </div>\n          </template>\n          \n          <div class=\"params-schema\">\n            <div\n              v-for=\"(prop, key) in currentTool?.parameters?.properties\"\n              :key=\"key\"\n              class=\"param-item\"\n            >\n              <div class=\"param-header\">\n                <span class=\"param-name\">\n                  {{ key }}\n                  <el-tag\n                    v-if=\"currentTool?.parameters?.required?.includes(key)\"\n                    type=\"danger\"\n                    size=\"small\"\n                    effect=\"plain\"\n                  >\n                    \n                  </el-tag>\n                  <el-tag\n                    v-else\n                    type=\"info\"\n                    size=\"small\"\n                    effect=\"plain\"\n                  >\n                    \n                  </el-tag>\n                </span>\n                <el-tag size=\"small\" type=\"info\">{{ prop.type }}</el-tag>\n              </div>\n              <div class=\"param-description\">{{ prop.description || '' }}</div>\n              <div v-if=\"prop.enum\" class=\"param-enum\">\n                : {{ prop.enum.join(', ') }}\n              </div>\n              <div v-if=\"prop.items\" class=\"param-items\">\n                : {{ prop.items.type }}\n              </div>\n            </div>\n          </div>\n        </el-card>\n\n        <!--  -->\n        <el-card class=\"params-input-card\" shadow=\"never\">\n          <template #header>\n            <div class=\"card-header\">\n              <span> (JSON )</span>\n              <el-button\n                size=\"small\"\n                type=\"warning\"\n                text\n                @click=\"debugParams = '{}'\"\n              >\n                \n              </el-button>\n            </div>\n          </template>\n          \n          <el-input\n            v-model=\"debugParams\"\n            type=\"textarea\"\n            :rows=\"6\"\n            placeholder=' JSON : {\"query\": \"test\", \"limit\": 10}'\n            class=\"params-textarea\"\n          />\n          \n          <div class=\"params-hint\">\n            <el-icon><InfoFilled /></el-icon>\n            :  JSON \n          </div>\n        </el-card>\n\n        <!--  -->\n        <div v-if=\"debugResult\" class=\"result-container\">\n          <el-card class=\"result-card\" shadow=\"never\">\n            <template #header>\n              <div class=\"card-header\">\n                <span></span>\n              </div>\n            </template>\n            \n            <div class=\"debug-result-wrapper\" :class=\"debugResult.success ? 'status-success' : 'status-error'\">\n              <div class=\"result-header\">\n                <div class=\"status-indicator\">\n                  <el-icon :size=\"18\" class=\"icon\">\n                    <CircleCheckFilled v-if=\"debugResult.success\" />\n                    <CircleCloseFilled v-else />\n                  </el-icon>\n                  <span class=\"status-text\">{{ debugResult.success ? '' : '' }}</span>\n                </div>\n                <div v-if=\"debugResult.success\" class=\"execution-meta\">\n                  <span class=\"meta-item\">: {{ debugResult.executionTime }}</span>\n                </div>\n              </div>\n\n              <div class=\"result-body\">\n                <template v-if=\"debugResult.success\">\n                  <div class=\"plugin-info-bar\">\n                    <span class=\"info-item\">\n                      <span class=\"label\">:</span>\n                      <span class=\"value\">{{ debugResult.pluginName }}</span>\n                    </span>\n                    <span class=\"divider\">|</span>\n                    <span class=\"info-item\">\n                      <span class=\"label\">:</span>\n                      <span class=\"value\">{{ debugResult.toolName }}</span>\n                    </span>\n                  </div>\n                  \n                  <div class=\"json-viewer-container\">\n                    <div class=\"viewer-label\"></div>\n                    <div class=\"json-content\">\n                      <pre>{{ JSON.stringify(debugResult.result, null, 2) }}</pre>\n                    </div>\n                  </div>\n                </template>\n\n                <template v-else>\n                  <div class=\"error-content\">\n                    <div class=\"error-message-box\">\n                      <el-icon class=\"error-icon\"><InfoFilled /></el-icon>\n                      <span class=\"message-text\">{{ debugResult.error?.message || '' }}</span>\n                    </div>\n                    <div v-if=\"debugResult.error?.stack\" class=\"error-stack\">\n                      <div class=\"stack-label\"></div>\n                      <pre class=\"stack-content\">{{ debugResult.error.stack }}</pre>\n                    </div>\n                  </div>\n                </template>\n              </div>\n            </div>\n          </el-card>\n        </div>\n      </div>\n\n      <template #footer>\n        <el-button @click=\"debugDialogVisible = false\"></el-button>\n        <el-button\n          type=\"primary\"\n          :icon=\"Cpu\"\n          :loading=\"debugging\"\n          @click=\"handleExecuteDebug\"\n        >\n          \n        </el-button>\n      </template>\n    </el-dialog>\n  </div>\n</template>\n\n<script setup>\nimport LoadingSkeleton from '@/components/settings/LoadingSkeleton.vue';\nimport { pluginAPI } from '@/lib/configApi.js';\nimport {\n  Box,\n  CircleCheck,\n  CircleCheckFilled,\n  CircleCloseFilled,\n  Cpu,\n  Grid,\n  InfoFilled,\n  Refresh,\n  RefreshRight,\n  Setting,\n  Tools,\n  User,\n  View\n} from '@element-plus/icons-vue';\nimport { ElMessage, ElMessageBox } from 'element-plus';\nimport { computed, onMounted, ref } from 'vue';\n\nconst loading = ref(false);\nconst refreshing = ref(false);\nconst plugins = ref([]);\nconst detailDialogVisible = ref(false);\nconst configDialogVisible = ref(false);\nconst debugDialogVisible = ref(false);\nconst currentPlugin = ref(null);\nconst currentTool = ref(null);\nconst pluginTools = ref([]);\nconst configJsonStr = ref('');\nconst savingConfig = ref(false);\nconst debugParams = ref('{}');\nconst debugResult = ref(null);\nconst debugging = ref(false);\nconst activeCollapseNames = ref([]);\n\n// \nconst enabledCount = computed(() => plugins.value.filter(p => p.enabled).length);\nconst totalToolsCount = computed(() => plugins.value.reduce((sum, p) => sum + p.toolCount, 0));\nconst customPluginsCount = computed(() => plugins.value.filter(p => p.type === 'custom').length);\n\n// \nconst loadPlugins = async () => {\n  loading.value = true;\n  try {\n    const result = await pluginAPI.listPlugins();\n    if (result.code === 0) {\n      plugins.value = result.data.plugins.map(p => ({\n        ...p,\n        reloading: false,\n        toggling: false\n      }));\n    } else {\n      ElMessage.error('' + result.message);\n    }\n  } catch (error) {\n    ElMessage.error('' + error.message);\n  } finally {\n    loading.value = false;\n  }\n};\n\n// \nconst handleRefreshPlugins = async () => {\n  refreshing.value = true;\n  try {\n    await loadPlugins();\n    ElMessage.success('');\n  } finally {\n    refreshing.value = false;\n  }\n};\n\n// \nconst handleReloadAll = async () => {\n  try {\n    await ElMessageBox.confirm(\n      '',\n      '',\n      {\n        confirmButtonText: '',\n        cancelButtonText: '',\n        type: 'warning'\n      }\n    );\n\n    const result = await pluginAPI.reloadAllPlugins();\n    if (result.code === 0) {\n      ElMessage.success(` ${result.data.successCount}/${result.data.totalCount}`);\n      await loadPlugins();\n    } else {\n      ElMessage.error('' + result.message);\n    }\n  } catch (error) {\n    if (error !== 'cancel') {\n      ElMessage.error('' + error.message);\n    }\n  }\n};\n\n// \nconst handleReloadPlugin = async (plugin) => {\n  plugin.reloading = true;\n  try {\n    const result = await pluginAPI.reloadPlugin(plugin.name);\n    if (result.code === 0) {\n      ElMessage.success(`${plugin.displayName} `);\n      await loadPlugins();\n    } else {\n      ElMessage.error('' + result.message);\n    }\n  } catch (error) {\n    ElMessage.error('' + error.message);\n  } finally {\n    plugin.reloading = false;\n  }\n};\n\n// \nconst handleTogglePlugin = async (plugin) => {\n  plugin.toggling = true;\n  try {\n    const result = await pluginAPI.togglePlugin(plugin.name, plugin.enabled);\n    if (result.code === 0) {\n      ElMessage.success(`${plugin.displayName} ${plugin.enabled ? '' : ''}`);\n    } else {\n      ElMessage.error('' + result.message);\n      plugin.enabled = !plugin.enabled; // \n    }\n  } catch (error) {\n    ElMessage.error('' + error.message);\n    plugin.enabled = !plugin.enabled; // \n  } finally {\n    plugin.toggling = false;\n  }\n};\n// \nconst handleViewPlugin = async (plugin) => {\n  currentPlugin.value = plugin;\n  detailDialogVisible.value = true;\n  \n  try {\n    const result = await pluginAPI.getPluginTools(plugin.name);\n    if (result.code === 0) {\n      pluginTools.value = result.data.tools;\n      // \n      activeCollapseNames.value = result.data.tools.map(g => g.group);\n    }\n  } catch (error) {\n    ElMessage.error('' + error.message);\n  }\n};\n\n// \nconst handleConfigPlugin = async (plugin) => {\n  currentPlugin.value = plugin;\n  \n  try {\n    const result = await pluginAPI.getPluginConfig(plugin.name);\n    if (result.code === 0) {\n      configJsonStr.value = JSON.stringify(result.data, null, 2);\n      configDialogVisible.value = true;\n    } else {\n      ElMessage.error('' + result.message);\n    }\n  } catch (error) {\n    ElMessage.error('' + error.message);\n  }\n};\n\n// \nconst handleSaveConfig = async () => {\n  try {\n    const config = JSON.parse(configJsonStr.value);\n    savingConfig.value = true;\n    \n    const result = await pluginAPI.updatePluginConfig(currentPlugin.value.name, config);\n    if (result.code === 0) {\n      ElMessage.success('');\n      configDialogVisible.value = false;\n      \n      // \n      ElMessageBox.confirm(\n        '',\n        '',\n        {\n          confirmButtonText: '',\n          cancelButtonText: '',\n          type: 'info'\n        }\n      ).then(async () => {\n        await handleReloadPlugin(currentPlugin.value);\n      }).catch(() => {});\n    } else {\n      ElMessage.error('' + result.message);\n    }\n  } catch (error) {\n    if (error instanceof SyntaxError) {\n      ElMessage.error('JSON ');\n    } else {\n      ElMessage.error('' + error.message);\n    }\n  } finally {\n    savingConfig.value = false;\n  }\n};\n\n// \nconst handleDebugTool = (tool) => {\n  currentTool.value = tool;\n  debugParams.value = '{}';\n  debugResult.value = null;\n  debugDialogVisible.value = true;\n};\n\n// \nconst fillExampleParams = () => {\n  if (!currentTool.value?.parameters?.properties) {\n    debugParams.value = '{}';\n    return;\n  }\n\n  const example = {};\n  const props = currentTool.value.parameters.properties;\n  \n  for (const [key, prop] of Object.entries(props)) {\n    // \n    switch (prop.type) {\n      case 'string':\n        if (prop.enum && prop.enum.length > 0) {\n          example[key] = prop.enum[0];\n        } else if (key.toLowerCase().includes('url')) {\n          example[key] = 'https://example.com';\n        } else if (key.toLowerCase().includes('path')) {\n          example[key] = '/path/to/file';\n        } else if (key.toLowerCase().includes('query') || key.toLowerCase().includes('search')) {\n          example[key] = '';\n        } else {\n          example[key] = '';\n        }\n        break;\n      case 'number':\n      case 'integer':\n        example[key] = prop.minimum || 0;\n        break;\n      case 'boolean':\n        example[key] = true;\n        break;\n      case 'array':\n        example[key] = [];\n        break;\n      case 'object':\n        example[key] = {};\n        break;\n      default:\n        example[key] = null;\n    }\n  }\n  \n  debugParams.value = JSON.stringify(example, null, 2);\n};\n\n// \nconst handleExecuteDebug = async () => {\n  try {\n    const params = JSON.parse(debugParams.value);\n    debugging.value = true;\n    debugResult.value = null;\n    \n    const result = await pluginAPI.debugTool(\n      currentPlugin.value.name,\n      currentTool.value.name,\n      params\n    );\n    \n    if (result.code === 0) {\n      debugResult.value = result.data;\n    } else {\n      ElMessage.error('' + result.message);\n    }\n  } catch (error) {\n    if (error instanceof SyntaxError) {\n      ElMessage.error(' JSON ');\n    } else {\n      ElMessage.error('' + error.message);\n    }\n  } finally {\n    debugging.value = false;\n  }\n};\n\n// \nonMounted(() => {\n  loadPlugins();\n});\n</script>\n\n<style scoped lang=\"scss\">\n.plugins-view {\n  width: 100%;\n  height: 100%;\n}\n\n.loading-container {\n  padding: 24px;\n}\n\n.skeleton-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 24px;\n\n  .skeleton-title {\n    width: 200px;\n    height: 32px;\n    background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);\n    background-size: 200% 100%;\n    animation: loading 1.5s ease-in-out infinite;\n    border-radius: 4px;\n  }\n\n  .skeleton-actions {\n    display: flex;\n    gap: 12px;\n\n    .skeleton-button {\n      width: 100px;\n      height: 32px;\n      background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);\n      background-size: 200% 100%;\n      animation: loading 1.5s ease-in-out infinite;\n      border-radius: 4px;\n    }\n  }\n}\n\n.plugins-grid {\n  display: grid;\n  grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));\n  gap: 16px;\n}\n\n.content-container {\n  padding: 24px;\n  animation: fadeIn 0.3s ease;\n}\n\n.page-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 24px;\n\n  h1 {\n    margin: 0;\n    font-size: 24px;\n    font-weight: 600;\n    color: #303133;\n  }\n\n  .header-actions {\n    display: flex;\n    gap: 12px;\n  }\n}\n\n.stats-row {\n  display: grid;\n  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));\n  gap: 16px;\n  margin-bottom: 24px;\n\n  .stat-card {\n    cursor: default;\n\n    :deep(.el-card__body) {\n      display: flex;\n      align-items: center;\n      gap: 16px;\n      padding: 20px;\n    }\n\n    .stat-icon {\n      width: 56px;\n      height: 56px;\n      border-radius: 12px;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n    }\n\n    .stat-content {\n      flex: 1;\n\n      .stat-value {\n        font-size: 28px;\n        font-weight: 600;\n        color: #303133;\n        line-height: 1;\n        margin-bottom: 8px;\n      }\n\n      .stat-label {\n        font-size: 14px;\n        color: #909399;\n      }\n    }\n  }\n}\n\n.plugins-list {\n  display: grid;\n  gap: 16px;\n\n  .plugin-card {\n    transition: all 0.3s ease;\n\n    &:hover {\n      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);\n    }\n\n    &.disabled {\n      opacity: 0.6;\n    }\n\n    :deep(.el-card__body) {\n      padding: 20px;\n    }\n\n    .plugin-header {\n      display: flex;\n      justify-content: space-between;\n      align-items: flex-start;\n      margin-bottom: 16px;\n\n      .plugin-info {\n        flex: 1;\n\n        .plugin-title-row {\n          display: flex;\n          justify-content: space-between;\n          align-items: center;\n          margin-bottom: 8px;\n\n          .plugin-name {\n            margin: 0;\n            font-size: 18px;\n            font-weight: 600;\n            color: #303133;\n            display: flex;\n            align-items: center;\n          }\n        }\n\n        .plugin-description {\n          margin: 0 0 12px 0;\n          font-size: 14px;\n          color: #606266;\n          line-height: 1.6;\n        }\n\n        .plugin-meta {\n          display: flex;\n          align-items: center;\n          gap: 12px;\n          flex-wrap: wrap;\n\n          .meta-item {\n            display: flex;\n            align-items: center;\n            gap: 4px;\n            font-size: 13px;\n            color: #909399;\n          }\n        }\n      }\n    }\n\n    .plugin-actions {\n      display: flex;\n      gap: 8px;\n      padding-top: 16px;\n      border-top: 1px solid #ebeef5;\n    }\n  }\n}\n\n.plugin-detail {\n  max-height: 70vh;\n  overflow-y: auto;\n  overflow-x: hidden;\n\n  // \n  &::-webkit-scrollbar {\n    width: 6px;\n  }\n\n  &::-webkit-scrollbar-track {\n    background: #f1f1f1;\n    border-radius: 3px;\n  }\n\n  &::-webkit-scrollbar-thumb {\n    background: #c1c1c1;\n    border-radius: 3px;\n\n    &:hover {\n      background: #a8a8a8;\n    }\n  }\n\n  .tools-section {\n    margin-top: 24px;\n\n    h4 {\n      margin: 0 0 16px 0;\n      font-size: 16px;\n      font-weight: 600;\n      color: #303133;\n    }\n\n    .tool-item {\n      padding: 12px;\n      border-bottom: 1px solid #ebeef5;\n\n      &:last-child {\n        border-bottom: none;\n      }\n\n      .tool-header {\n        display: flex;\n        justify-content: space-between;\n        align-items: center;\n        margin-bottom: 8px;\n\n        h5 {\n          margin: 0;\n          font-size: 14px;\n          font-weight: 600;\n          color: #303133;\n        }\n      }\n\n      .tool-description {\n        margin: 0 0 8px 0;\n        font-size: 13px;\n        color: #606266;\n      }\n    }\n  }\n}\n\n.config-editor {\n  .config-textarea {\n    font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;\n    font-size: 13px;\n  }\n}\n\n.dialog-content {\n  max-height: 60vh;\n  overflow-y: auto;\n  padding: 0;\n}\n\n.debug-dialog {\n  :deep(.el-dialog__body) {\n    padding: 0 !important;\n  }\n\n  :deep(.el-alert__content) {\n    flex-grow: 1;\n  }\n}\n\n.debug-container {\n  padding: 20px;\n}\n\n.result-container {\n  margin-top: 16px;\n}\n\n  .tool-info-card,\n  .params-schema-card,\n  .params-input-card {\n    margin-bottom: 16px;\n\n    &:last-child {\n      margin-bottom: 0;\n    }\n  }\n\n  .result-card {\n    margin-top: 16px;\n    margin-bottom: 0;\n  }\n\n  .card-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    font-weight: 600;\n    color: #303133;\n  }\n\n  .tool-info {\n    .info-row {\n      display: flex;\n      align-items: center;\n      gap: 12px;\n      margin-bottom: 12px;\n\n      &:last-child {\n        margin-bottom: 0;\n      }\n\n      label {\n        min-width: 80px;\n        font-weight: 600;\n        color: #606266;\n      }\n\n      span {\n        color: #303133;\n      }\n    }\n  }\n\n  .params-schema {\n    .param-item {\n      padding: 12px;\n      background: #f5f7fa;\n      border-radius: 4px;\n      margin-bottom: 12px;\n\n      &:last-child {\n        margin-bottom: 0;\n      }\n\n      .param-header {\n        display: flex;\n        justify-content: space-between;\n        align-items: center;\n        margin-bottom: 8px;\n\n        .param-name {\n          font-weight: 600;\n          color: #303133;\n          display: flex;\n          align-items: center;\n          gap: 8px;\n        }\n      }\n\n      .param-description {\n        font-size: 13px;\n        color: #606266;\n        margin-bottom: 4px;\n      }\n\n      .param-enum,\n      .param-items {\n        font-size: 12px;\n        color: #909399;\n        margin-top: 4px;\n      }\n    }\n  }\n\n  .params-textarea {\n    font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;\n    font-size: 13px;\n  }\n  .debug-result-wrapper {\n    border-radius: 8px;\n    overflow: hidden;\n    border: 1px solid;\n    transition: all 0.3s ease;\n\n    &.status-success {\n      border-color: #e1f3d8;\n      background-color: #f0f9eb;\n\n      .result-header {\n        background-color: #e1f3d8;\n        color: #67c23a;\n      }\n    }\n\n    &.status-error {\n      border-color: #fde2e2;\n      background-color: #fef0f0;\n\n      .result-header {\n        background-color: #fde2e2;\n        color: #f56c6c;\n      }\n    }\n\n    .result-header {\n      padding: 10px 16px;\n      display: flex;\n      justify-content: space-between;\n      align-items: center;\n      font-size: 14px;\n      font-weight: 600;\n\n      .status-indicator {\n        display: flex;\n        align-items: center;\n        gap: 8px;\n        \n        .icon {\n          display: flex;\n          align-items: center;\n        }\n      }\n\n      .execution-meta {\n        font-size: 12px;\n        opacity: 0.9;\n      }\n    }\n\n    .result-body {\n      padding: 16px;\n    }\n\n    .plugin-info-bar {\n      display: flex;\n      align-items: center;\n      gap: 12px;\n      margin-bottom: 12px;\n      font-size: 13px;\n      color: #606266;\n      padding-bottom: 12px;\n      border-bottom: 1px solid rgba(0, 0, 0, 0.05);\n\n      .info-item {\n        display: flex;\n        gap: 6px;\n\n        .label {\n          color: #909399;\n        }\n        \n        .value {\n          font-weight: 500;\n          color: #303133;\n        }\n      }\n\n      .divider {\n        color: #dcdfe6;\n      }\n    }\n\n    .json-viewer-container {\n      .viewer-label {\n        font-size: 12px;\n        color: #909399;\n        margin-bottom: 8px;\n      }\n\n      .json-content {\n        background-color: #ffffff;\n        border-radius: 4px;\n        border: 1px solid #dcdfe6;\n        padding: 12px;\n        \n        pre {\n          margin: 0;\n          font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;\n          font-size: 12px;\n          color: #303133;\n          white-space: pre-wrap;\n          word-break: break-all;\n          max-height: 300px;\n          overflow-y: auto;\n\n          &::-webkit-scrollbar {\n            width: 6px;\n            height: 6px;\n          }\n\n          &::-webkit-scrollbar-thumb {\n            background: #c0c4cc;\n            border-radius: 3px;\n          }\n        }\n      }\n    }\n\n    .error-content {\n      .error-message-box {\n        display: flex;\n        align-items: flex-start;\n        gap: 8px;\n        color: #f56c6c;\n        font-weight: 600;\n        margin-bottom: 16px;\n        font-size: 14px;\n        \n        .error-icon {\n          margin-top: 2px;\n        }\n      }\n\n      .error-stack {\n        .stack-label {\n          font-size: 12px;\n          color: #909399;\n          margin-bottom: 8px;\n        }\n\n        .stack-content {\n          margin: 0;\n          padding: 12px;\n          background-color: #fff;\n          border: 1px solid #fde2e2;\n          border-radius: 4px;\n          font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;\n          font-size: 11px;\n          color: #f56c6c;\n          overflow-x: auto;\n          white-space: pre;\n        }\n      }\n    }\n  }\n\n.fade-enter-active,\n.fade-leave-active {\n  transition: opacity 0.3s ease;\n}\n\n.fade-enter-from,\n.fade-leave-to {\n  opacity: 0;\n}\n\n@keyframes fadeIn {\n  from {\n    opacity: 0;\n    transform: translateY(10px);\n  }\n  to {\n    opacity: 1;\n    transform: translateY(0);\n  }\n}\n\n@keyframes loading {\n  0% {\n    background-position: 200% 0;\n  }\n  100% {\n    background-position: -200% 0;\n  }\n}\n</style>\n","<template>\n  <div class=\"presets-view\">\n    <!--  -->\n    <div v-if=\"loading\" class=\"loading-container\">\n      <div class=\"skeleton-header\">\n        <div class=\"skeleton-title\"></div>\n        <div class=\"skeleton-actions\">\n          <div class=\"skeleton-button\" v-for=\"i in 3\" :key=\"i\"></div>\n        </div>\n      </div>\n      <div class=\"skeleton-table\">\n        <div class=\"skeleton-row\" v-for=\"i in 6\" :key=\"i\">\n          <div class=\"skeleton-cell\" v-for=\"j in 5\" :key=\"j\"></div>\n        </div>\n      </div>\n    </div>\n\n    <transition name=\"fade\" mode=\"out-in\">\n      <div v-if=\"!loading\" class=\"content-container\">\n        <!--  -->\n        <div class=\"page-header\">\n          <h1></h1>\n          <div class=\"header-actions\">\n            <el-button\n              v-if=\"selectedPresets && selectedPresets.length > 0\"\n              type=\"danger\"\n              :icon=\"Delete\"\n              @click=\"handleBatchDelete\"\n            >\n               ({{ selectedPresets?.length || 0 }})\n            </el-button>\n            <el-button\n              type=\"primary\"\n              :icon=\"Refresh\"\n              :loading=\"refreshing\"\n              @click=\"handleRefresh\"\n            >\n              \n            </el-button>\n            <el-button\n              type=\"primary\"\n              :icon=\"Plus\"\n              @click=\"handleCreate\"\n            >\n              \n            </el-button>\n            <el-button\n              type=\"success\"\n              :icon=\"Upload\"\n              @click=\"handleImport\"\n            >\n              \n            </el-button>\n          </div>\n        </div>\n\n        <!--  -->\n        <div class=\"stats-bar\">\n          <div class=\"stat-item\">\n            <span class=\"stat-label\"></span>\n            <span class=\"stat-value\">{{ totalCount }} </span>\n          </div>\n          <div class=\"stat-item\">\n            <span class=\"stat-label\"></span>\n            <span class=\"stat-value\">{{ presetsStore.countByCategory.common }} </span>\n          </div>\n          <div class=\"stat-item\">\n            <span class=\"stat-label\"></span>\n            <span class=\"stat-value\">{{ presetsStore.countByCategory.recommended }} </span>\n          </div>\n          <div class=\"stat-item\">\n            <span class=\"stat-label\"></span>\n            <span class=\"stat-value\">{{ presetsStore.countByCategory.hidden }} </span>\n          </div>\n          <div class=\"stat-item\">\n            <span class=\"stat-label\"></span>\n            <span class=\"stat-value\">{{ presetsStore.countBySource['built-in'] }} </span>\n          </div>\n          <div class=\"stat-item\">\n            <span class=\"stat-label\"></span>\n            <span class=\"stat-value\">{{ presetsStore.countBySource.custom }} </span>\n          </div>\n        </div>\n\n        <!--  -->\n        <div class=\"search-filter-bar\">\n          <div class=\"search-section\">\n            <el-input\n              v-model=\"searchKeyword\"\n              placeholder=\"...\"\n              :prefix-icon=\"Search\"\n              clearable\n              @input=\"handleSearch\"\n              style=\"width: 300px\"\n            />\n          </div>\n          <div class=\"filter-section\">\n            <el-select\n              v-model=\"categoryFilter\"\n              placeholder=\"\"\n              clearable\n              style=\"width: 120px\"\n              @change=\"handleFilterChange\"\n            >\n              <el-option label=\"\" value=\"common\" />\n              <el-option label=\"\" value=\"recommended\" />\n              <el-option label=\"\" value=\"hidden\" />\n            </el-select>\n            <el-select\n              v-model=\"sourceFilter\"\n              placeholder=\"\"\n              clearable\n              style=\"width: 120px\"\n              @change=\"handleFilterChange\"\n            >\n              <el-option label=\"\" value=\"built-in\" />\n              <el-option label=\"\" value=\"custom\" />\n            </el-select>\n          </div>\n        </div>\n\n        <!--  -->\n        <div class=\"presets-list\">\n          <div v-if=\"(!displayedPresets || displayedPresets.length === 0) && !loading\" class=\"empty-state\">\n            <el-empty description=\"\">\n              <el-button type=\"primary\" :icon=\"Plus\" @click=\"handleCreate\">\n                \n              </el-button>\n            </el-empty>\n          </div>\n\n          <!--  -->\n          <div v-else class=\"presets-waterfall\" ref=\"waterfallRef\">\n            <preset-card\n              v-for=\"preset in displayedPresets\"\n              :key=\"getPresetId(preset)\"\n              :preset=\"preset\"\n              :selected=\"isPresetSelected(preset)\"\n              @select=\"(selected) => handlePresetSelect(getPresetId(preset), selected)\"\n              @edit=\"handleEdit\"\n              @delete=\"handleDelete\"\n              @export=\"handleExport\"\n            />\n          </div>\n\n          <!--  -->\n          <div v-if=\"shouldShowTrigger\" ref=\"loadTrigger\" class=\"load-trigger\">\n            <div v-if=\"loadingMore\" class=\"loading-more\">\n              <el-skeleton :rows=\"2\" animated />\n            </div>\n            <div v-else-if=\"loadError\" class=\"load-error\">\n              <el-result icon=\"warning\" title=\"\" sub-title=\"\">\n                <template #extra>\n                  <el-button type=\"primary\" @click=\"retryLoad\"></el-button>\n                </template>\n              </el-result>\n            </div>\n            <div v-else class=\"load-placeholder\">\n              <!--  Intersection Observer -->\n            </div>\n          </div>\n\n          <!--  -->\n          <div v-if=\"!hasMore && displayedPresets.length > 0\" class=\"no-more\">\n            <el-divider>\n              <span class=\"no-more-text\"></span>\n            </el-divider>\n          </div>\n\n          <!--  -->\n          <div v-if=\"loading\" class=\"loading-more\">\n            <el-skeleton :rows=\"3\" animated />\n          </div>\n        </div>\n      </div>\n    </transition>\n\n    <!--  -->\n    <preset-editor\n      :visible=\"editorVisible\"\n      :mode=\"editorMode\"\n      :preset=\"editorPreset\"\n      @close=\"handleEditorClose\"\n      @submit=\"handleEditorSubmit\"\n    />\n\n    <!--  -->\n    <input\n      ref=\"fileInput\"\n      type=\"file\"\n      accept=\".json\"\n      style=\"display: none\"\n      @change=\"handleFileSelect\"\n    />\n  </div>\n</template>\n\n<script setup>\nimport PresetCard from '@/components/settings/PresetCard.vue';\nimport PresetEditor from '@/components/settings/PresetEditor.vue';\nimport { usePresetsStore } from '@/stores/presetsStore.js';\nimport {\n  Delete,\n  Plus,\n  Refresh,\n  Search,\n  Upload\n} from '@element-plus/icons-vue';\nimport { ElMessage, ElMessageBox } from 'element-plus';\nimport { computed, nextTick, onMounted, onUnmounted, ref, watch } from 'vue';\n\nconst presetsStore = usePresetsStore();\n\nconst loading = ref(true);\nconst refreshing = ref(false);\nconst searchKeyword = ref('');\nconst categoryFilter = ref('');\nconst sourceFilter = ref('');\nconst selectedPresets = ref([]);\nconst editorVisible = ref(false);\nconst editorMode = ref('create');\nconst editorPreset = ref(null);\nconst fileInput = ref(null);\nconst waterfallRef = ref(null);\nconst loadTrigger = ref(null);\n\n// \nconst currentPage = ref(1);\nconst pageSize = ref(50); // \nconst hasMore = computed(() => presetsStore.pagination?.hasMore || false);\n\n// \nconst shouldShowTrigger = computed(() => {\n  return hasMore.value || loadingMore.value;\n});\nconst loadingMore = ref(false);\nconst loadError = ref(false);\n\n// \nconst allPresets = computed(() => presetsStore.allPresets || []);\nconst totalCount = computed(() => presetsStore.totalCount || 0);\n\n//  store \nconst displayedPresets = computed(() => {\n  return allPresets.value || [];\n});\n\n// ID\nconst getPresetId = (preset) => {\n  return preset.name; //  name \n};\n\n// \nconst isPresetSelected = (preset) => {\n  const presetId = getPresetId(preset);\n  return presetId && selectedPresets.value.includes(presetId);\n};\n\n// \nlet searchTimeout = null;\n\n// \nwatch([searchKeyword], () => {\n  // \n  if (searchTimeout) {\n    clearTimeout(searchTimeout);\n  }\n  searchTimeout = setTimeout(() => {\n    handleFilterChange();\n  }, 500); // 500ms \n});\n\n// \nwatch([categoryFilter, sourceFilter], () => {\n  handleFilterChange();\n});\n\n//  hasMore \nwatch(hasMore, (newHasMore, oldHasMore) => {\n  console.log('hasMore changed:', { newHasMore, oldHasMore });\n  if (!newHasMore) {\n    cleanupObserver();\n  } else if (newHasMore && !oldHasMore) {\n    // \n    nextTick(() => {\n      setupInfiniteScroll();\n    });\n  }\n});\n\n// \nconst handleFilterChange = async () => {\n  currentPage.value = 1;\n  cleanupObserver(); // \n  await fetchPresetsWithFilters();\n  //  DOM \n  await nextTick();\n  if (hasMore.value) {\n    setupInfiniteScroll();\n  }\n};\n\n// \nconst fetchPresetsWithFilters = async () => {\n  const params = {\n    start: 0,\n    nums: pageSize.value\n  };\n  \n  if (searchKeyword.value) {\n    params.keyword = searchKeyword.value;\n  }\n  \n  if (categoryFilter.value) {\n    params.category = categoryFilter.value;\n  }\n  \n  if (sourceFilter.value) {\n    params.source = sourceFilter.value;\n  }\n  \n  try {\n    await presetsStore.fetchPresets(params);\n  } catch (error) {\n    ElMessage.error('' + error.message);\n  }\n};\n\n// \nconst loadMore = async () => {\n  console.log('loadMore called', {\n    hasMore: hasMore.value,\n    loadingMore: loadingMore.value,\n    pagination: presetsStore.pagination\n  });\n  \n  if (hasMore.value && !loadingMore.value) {\n    loadingMore.value = true;\n    loadError.value = false;\n    \n    const params = {\n      start: presetsStore.pagination.start + presetsStore.pagination.nums,\n      nums: pageSize.value\n    };\n    \n    if (searchKeyword.value) {\n      params.keyword = searchKeyword.value;\n    }\n    \n    if (categoryFilter.value) {\n      params.category = categoryFilter.value;\n    }\n    \n    if (sourceFilter.value) {\n      params.source = sourceFilter.value;\n    }\n    \n    console.log('Loading more with params:', params);\n    \n    try {\n      await presetsStore.fetchPresets(params, true); //  append \n      console.log('Load more successful');\n    } catch (error) {\n      console.error('Load more failed:', error);\n      loadError.value = true;\n      ElMessage.error('' + error.message);\n    } finally {\n      loadingMore.value = false;\n    }\n  } else {\n    console.log('loadMore conditions not met', {\n      hasMore: hasMore.value,\n      loadingMore: loadingMore.value\n    });\n  }\n};\n\n// \nconst retryLoad = () => {\n  loadError.value = false;\n  loadMore();\n};\n\n// \nconst handlePresetSelect = (presetId, selected) => {\n  if (selected) {\n    if (!selectedPresets.value.includes(presetId)) {\n      selectedPresets.value.push(presetId);\n    }\n  } else {\n    const index = selectedPresets.value.indexOf(presetId);\n    if (index > -1) {\n      selectedPresets.value.splice(index, 1);\n    }\n  }\n};\n\n// \nconst handleSearch = () => {\n  //  watch  handleFilterChange\n};\n\n// \nconst handleRefresh = async () => {\n  refreshing.value = true;\n  try {\n    await presetsStore.fetchPresets();\n    ElMessage.success('');\n  } catch (error) {\n    ElMessage.error('' + error.message);\n  } finally {\n    refreshing.value = false;\n  }\n};\n\n// \nconst handleCreate = () => {\n  editorMode.value = 'create';\n  editorPreset.value = null;\n  editorVisible.value = true;\n};\n\n// \nconst handleEdit = (preset) => {\n  editorMode.value = 'edit';\n  editorPreset.value = preset;\n  editorVisible.value = true;\n};\n\n// \nconst handleDelete = async (preset) => {\n  try {\n    await ElMessageBox.confirm(\n      ` \"${preset.name}\" `,\n      '',\n      {\n        confirmButtonText: '',\n        cancelButtonText: '',\n        type: 'warning'\n      }\n    );\n\n    const presetId = preset.name;\n    if (!presetId) {\n      throw new Error('');\n    }\n    await presetsStore.deletePreset(presetId);\n    ElMessage.success('');\n  } catch (error) {\n    if (error !== 'cancel') {\n      ElMessage.error('' + error.message);\n    }\n  }\n};\n\n// \nconst handleBatchDelete = async () => {\n  try {\n    await ElMessageBox.confirm(\n      ` ${selectedPresets.value.length} `,\n      '',\n      {\n        confirmButtonText: '',\n        cancelButtonText: '',\n        type: 'warning'\n      }\n    );\n\n    const results = await presetsStore.batchDeletePresets(selectedPresets.value);\n    const successCount = results.filter(r => r.success).length;\n    ElMessage.success(` ${successCount} `);\n    selectedPresets.value = [];\n  } catch (error) {\n    if (error !== 'cancel') {\n      ElMessage.error('' + error.message);\n    }\n  }\n};\n\n// \nconst handleExport = async (preset) => {\n  try {\n    const presetId = preset.name;\n    if (!presetId) {\n      throw new Error('');\n    }\n    await presetsStore.exportPreset(presetId);\n    ElMessage.success('');\n  } catch (error) {\n    ElMessage.error('' + error.message);\n  }\n};\n\n// \nconst handleImport = () => {\n  fileInput.value?.click();\n};\n\n// \nconst handleFileSelect = async (event) => {\n  const file = event.target.files[0];\n  if (!file) return;\n\n  try {\n    await presetsStore.importPreset(file);\n    ElMessage.success('');\n    // \n    event.target.value = '';\n  } catch (error) {\n    ElMessage.error('' + error.message);\n  }\n};\n\n// \nconst handleEditorClose = () => {\n  editorVisible.value = false;\n};\n\n// \nconst handleEditorSubmit = async ({ data, mode }) => {\n  try {\n    if (mode === 'create') {\n      await presetsStore.createPreset(data);\n      ElMessage.success('');\n      // \n      editorVisible.value = false;\n    } else {\n      // \n      const presetId = editorPreset.value.name;\n      if (!presetId) {\n        ElMessage.error('');\n        return; // \n      }\n      await presetsStore.updatePreset(presetId, data);\n      ElMessage.success('');\n      // \n      editorVisible.value = false;\n    }\n  } catch (error) {\n    ElMessage.error(mode === 'create' ? '' : '' + error.message);\n    // toast\n  }\n};\n\n// Intersection Observer \nlet observer = null;\n\n// \nconst setupInfiniteScroll = () => {\n  console.log('setupInfiniteScroll called', {\n    loadTrigger: loadTrigger.value,\n    hasMore: hasMore.value,\n    loadingMore: loadingMore.value\n  });\n  \n  if (!loadTrigger.value) {\n    console.log('loadTrigger element not found');\n    return;\n  }\n\n  //  Intersection Observer\n  observer = new IntersectionObserver(\n    (entries) => {\n      const entry = entries[0];\n      console.log('Observer triggered', {\n        isIntersecting: entry.isIntersecting,\n        hasMore: hasMore.value,\n        loadingMore: loadingMore.value\n      });\n      \n      // \n      if (entry.isIntersecting && hasMore.value && !loadingMore.value) {\n        console.log('Loading more data...');\n        loadMore();\n      }\n    },\n    {\n      //  100px \n      rootMargin: '100px',\n      threshold: 0.1\n    }\n  );\n\n  observer.observe(loadTrigger.value);\n  console.log('Observer set up successfully');\n};\n\n// \nconst cleanupObserver = () => {\n  if (observer) {\n    observer.disconnect();\n    observer = null;\n  }\n};\n\n// \nonMounted(async () => {\n  loading.value = true;\n  try {\n    // \n    await fetchPresetsWithFilters();\n    await new Promise(resolve => setTimeout(resolve, 300));\n  } catch (error) {\n    ElMessage.error('' + error.message);\n  } finally {\n    loading.value = false;\n    // \n    await nextTick(); //  DOM \n    setupInfiniteScroll();\n  }\n});\n\n// \nonUnmounted(() => {\n  cleanupObserver();\n});\n</script>\n\n<style scoped lang=\"scss\">\n// \n.fade-enter-active,\n.fade-leave-active {\n  transition: opacity 0.3s ease;\n}\n\n.fade-enter-from,\n.fade-leave-to {\n  opacity: 0;\n}\n\n\n\n.presets-view {\n  padding: 24px;\n  max-width: 1400px;\n  margin: 0 auto;\n}\n\n.loading-container {\n  .skeleton-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin-bottom: 24px;\n\n    .skeleton-title {\n      width: 200px;\n      height: 32px;\n      border-radius: 4px;\n      background: linear-gradient(90deg, #f2f2f2 25%, #e6e6e6 50%, #f2f2f2 75%);\n      background-size: 200% 100%;\n      animation: skeleton-loading 1.5s ease-in-out infinite;\n    }\n\n    .skeleton-actions {\n      display: flex;\n      gap: 12px;\n\n      .skeleton-button {\n        width: 120px;\n        height: 32px;\n        border-radius: 4px;\n        background: linear-gradient(90deg, #f2f2f2 25%, #e6e6e6 50%, #f2f2f2 75%);\n        background-size: 200% 100%;\n        animation: skeleton-loading 1.5s ease-in-out infinite;\n      }\n    }\n  }\n\n  .skeleton-table {\n    border-radius: 8px;\n    overflow: hidden;\n    border: 1px solid #ebeef5;\n\n    .skeleton-row {\n      display: flex;\n      height: 120px;\n      border-bottom: 1px solid #ebeef5;\n\n      &:last-child {\n        border-bottom: none;\n      }\n\n      .skeleton-cell {\n        flex: 1;\n        margin: 12px;\n        border-radius: 4px;\n        background: linear-gradient(90deg, #f2f2f2 25%, #e6e6e6 50%, #f2f2f2 75%);\n        background-size: 200% 100%;\n        animation: skeleton-loading 1.5s ease-in-out infinite;\n      }\n    }\n  }\n}\n\n@keyframes skeleton-loading {\n  0% {\n    background-position: -200% 0;\n  }\n  100% {\n    background-position: 200% 0;\n  }\n}\n\n.content-container {\n  width: 100%;\n}\n\n.page-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 24px;\n\n  h1 {\n    margin: 0;\n    font-size: 24px;\n    font-weight: 600;\n    color: #303133;\n  }\n\n  .header-actions {\n    display: flex;\n    gap: 12px;\n  }\n}\n\n.stats-bar {\n  display: flex;\n  flex-wrap: wrap;\n  gap: 20px;\n  padding: 16px 20px;\n  background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);\n  border-radius: 12px;\n  margin-bottom: 24px;\n  border: 1px solid #e9ecef;\n\n  .stat-item {\n    display: flex;\n    align-items: center;\n    gap: 6px;\n    padding: 4px 8px;\n    border-radius: 6px;\n    background: rgba(255, 255, 255, 0.7);\n    transition: all 0.2s ease;\n\n    &:hover {\n      background: rgba(255, 255, 255, 0.9);\n      transform: translateY(-1px);\n    }\n\n    .stat-label {\n      font-size: 13px;\n      color: #606266;\n      font-weight: 500;\n    }\n\n    .stat-value {\n      font-size: 13px;\n      font-weight: 700;\n      color: #303133;\n    }\n  }\n\n  @media (max-width: 768px) {\n    gap: 12px;\n    \n    .stat-item {\n      flex: 1;\n      min-width: calc(50% - 6px);\n      justify-content: center;\n    }\n  }\n}\n\n.search-filter-bar {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 20px;\n  gap: 16px;\n\n  .search-section {\n    flex: 1;\n  }\n\n  .filter-section {\n    display: flex;\n    gap: 12px;\n  }\n\n  @media (max-width: 768px) {\n    flex-direction: column;\n    align-items: stretch;\n\n    .filter-section {\n      justify-content: flex-start;\n    }\n  }\n}\n\n.presets-list {\n  .empty-state {\n    padding: 48px 0;\n    background: #f9fafc;\n    border-radius: 8px;\n  }\n}\n\n.presets-waterfall {\n  display: grid;\n  grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));\n  gap: 16px;\n  margin-bottom: 24px;\n\n  @media (max-width: 768px) {\n    grid-template-columns: 1fr;\n  }\n\n  @media (min-width: 1200px) {\n    grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));\n  }\n}\n\n.load-trigger {\n  margin: 24px 0;\n  min-height: 50px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n\n  .load-placeholder {\n    width: 100%;\n    height: 20px;\n    background: rgba(64, 158, 255, 0.1); // \n    border: 1px dashed #409eff;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    font-size: 12px;\n    color: #409eff;\n    \n    &::after {\n      content: '';\n    }\n  }\n}\n\n.loading-more {\n  margin: 24px 0;\n  \n  :deep(.el-skeleton) {\n    .el-skeleton__item {\n      background: linear-gradient(90deg, #f2f2f2 25%, #e6e6e6 50%, #f2f2f2 75%);\n      background-size: 200% 100%;\n      animation: skeleton-loading 1.5s ease-in-out infinite;\n    }\n  }\n}\n\n.load-error {\n  margin: 24px 0;\n  \n  :deep(.el-result) {\n    padding: 20px;\n    \n    .el-result__icon {\n      margin-bottom: 12px;\n    }\n    \n    .el-result__title {\n      margin-bottom: 8px;\n      font-size: 16px;\n    }\n    \n    .el-result__subtitle {\n      margin-bottom: 16px;\n      font-size: 14px;\n    }\n  }\n}\n\n.no-more {\n  margin: 32px 0;\n  \n  .no-more-text {\n    color: #909399;\n    font-size: 14px;\n    padding: 0 16px;\n    background: #f5f7fa;\n  }\n  \n  :deep(.el-divider__text) {\n    background: #f5f7fa;\n  }\n}\n\n@keyframes skeleton-loading {\n  0% {\n    background-position: -200% 0;\n  }\n  100% {\n    background-position: 200% 0;\n  }\n}\n</style>","import { client } from '@/lib/runtime.js'\nimport { randomString } from '@/utils/generate.js'\nimport { onMounted, onUnmounted, ref } from 'vue'\n\nexport function useLogViewer() {\n  // \n  const logs = ref([])\n  const isSubscribed = ref(false)\n  const stats = ref(null)\n  \n  // \n  const socket = ref(client.socket)\n  const isConnected = ref(client.isConnected)\n  \n  const pendingRequests = new Map()\n\n  // \n  let logMessageHandler = null\n\n  // \n  const handleLogMessage = (data) => {\n    console.log(':', data)\n    const { request_id, type } = data\n\n    // ID\n    if (request_id && pendingRequests.has(request_id)) {\n      const resolver = pendingRequests.get(request_id)\n      pendingRequests.delete(request_id)\n      \n      // \n      if (type === 'subscribe' && data.success) {\n        isSubscribed.value = true\n        console.log('')\n      } else if (type === 'unsubscribe' && data.success) {\n        isSubscribed.value = false\n        console.log('')\n      }\n      \n      resolver(data)\n      return\n    }\n\n    // \n    switch (type) {\n      case 'SUBSCRIBED':\n        isSubscribed.value = true\n        console.log(':', data.data)\n        break\n        \n      case 'UNSUBSCRIBED':\n        isSubscribed.value = false\n        console.warn(' ')\n        console.log(':', data)\n        break\n        \n      case 'stream':\n        console.log(':', data.data)\n        addLog(data.data)\n        break\n        \n      case 'ERROR':\n        console.error('API:', data.error)\n        break\n        \n      default:\n        console.log(':', type, data)\n    }\n  }\n\n  // \n  const initLogListener = () => {\n    if (!socket.value || !socket.value.socket) {\n      console.log('Socket ...')\n      return\n    }\n\n    // \n    cleanupLogListener()\n\n    // \n    logMessageHandler = (message) => {\n      try {\n        const data = JSON.parse(message)\n        if (data.protocol === 'logs') {\n          console.log(':', data)\n          handleLogMessage(data)\n        }\n      } catch (error) {\n        console.error(':', error)\n      }\n    }\n\n    // \n    socket.value.socket.on('message', logMessageHandler)\n    console.log('')\n  }\n\n  // \n  const cleanupLogListener = () => {\n    if (socket.value && socket.value.socket && logMessageHandler) {\n      socket.value.socket.off('message', logMessageHandler)\n      console.log('')\n    }\n    logMessageHandler = null\n  }\n\n  // \n  const sendRequest = (type, data) => {\n    return new Promise((resolve, reject) => {\n      console.log(':', type, data)\n      console.log(':', isConnected.value)\n      console.log(' socket:', socket.value)\n      \n      // \n      if (!socket.value || !isConnected.value) {\n        console.warn('')\n        \n        // \n        setTimeout(() => {\n          if (type === 'subscribe') {\n            resolve({\n              success: true,\n              data: { message: '' }\n            })\n          } else if (type === 'unsubscribe') {\n            resolve({\n              success: true,\n              data: { message: '' }\n            })\n          } else {\n            resolve({\n              success: true,\n              data: { message: ` ${type} ` }\n            })\n          }\n        }, 500) // \n        return\n      }\n\n      const requestId = randomString(16)\n      pendingRequests.set(requestId, resolve)\n\n      // \n      setTimeout(() => {\n        if (pendingRequests.has(requestId)) {\n          pendingRequests.delete(requestId)\n          const error = new Error('')\n          console.error(':', requestId, type)\n          reject(error)\n        }\n      }, 30000)\n\n      const message = {\n        request_id: requestId,\n        protocol: 'logs',\n        type,\n        data\n      }\n\n      console.log(':', message)\n      socket.value.sendMessage(message)\n    })\n  }\n\n  // \n  const addLog = (log) => {\n    logs.value.push(log)\n    \n    // \n    if (logs.value.length > 2000) {\n      logs.value.splice(0, logs.value.length - 2000)\n    }\n  }\n\n  // \n  const subscribe = async (options = {}) => {\n    const defaultOptions = {\n      level: 'INFO',\n      modules: [],\n      realtime: true,\n      bufferSize: 1000,\n      sendHistory: true\n    }\n\n    try {\n      const response = await sendRequest('subscribe', { ...defaultOptions, ...options })\n      \n      // \n      if (response.success && (!socket.value || !isConnected.value)) {\n        isSubscribed.value = true\n        startMockLogStream()\n      }\n      //  handleLogMessage \n      \n      return response\n    } catch (error) {\n      console.error(':', error)\n      throw error\n    }\n  }\n\n  // \n  let mockLogInterval = null\n  \n  const startMockLogStream = () => {\n    console.log('')\n    let counter = 1\n    \n    mockLogInterval = setInterval(() => {\n      const mockLog = {\n        id: `mock_stream_${counter}`,\n        timestamp: new Date().toISOString(),\n        level: ['INFO', 'WARN', 'ERROR', 'DEBUG'][Math.floor(Math.random() * 4)],\n        module: ['llm', 'onebot', 'system'][Math.floor(Math.random() * 3)],\n        message: ` #${counter}`,\n        caller: `mock.js:${Math.floor(Math.random() * 100)}`,\n        ip: '127.0.0.1'\n      }\n      \n      addLog(mockLog)\n      counter++\n    }, 2000) // 2\n  }\n  \n  const stopMockLogStream = () => {\n    if (mockLogInterval) {\n      clearInterval(mockLogInterval)\n      mockLogInterval = null\n      console.log('')\n    }\n  }\n\n  // \n  const unsubscribe = async () => {\n    try {\n      const response = await sendRequest('unsubscribe', {})\n      \n      // \n      if (response.success && (!socket.value || !isConnected.value)) {\n        isSubscribed.value = false\n        stopMockLogStream()\n      }\n      //  handleLogMessage \n      \n      return response\n    } catch (error) {\n      console.error(':', error)\n      throw error\n    }\n  }\n\n  // \n  const search = async (query) => {\n    const response = await sendRequest('search', query)\n    return response\n  }\n\n  // \n  const exportLogs = async (options) => {\n    const response = await sendRequest('export', options)\n    return response\n  }\n\n\n\n  // \n  const updateConfig = async (type, value) => {\n    const response = await sendRequest('config', { type, value })\n    return response\n  }\n\n  // \n  const getStats = async () => {\n    try {\n      const response = await sendRequest('stats', {})\n      if (response.success) {\n        stats.value = response.data\n      }\n      return response\n    } catch (error) {\n      console.error(':', error)\n      return { success: false, error }\n    }\n  }\n\n  // \n  const clearLogs = () => {\n    logs.value = []\n  }\n\n\n\n  //  client socket \n  const setupSocketListeners = () => {\n    if (!client.socket) {\n      console.log('Client socket ')\n      return null\n    }\n    \n    // \n    const onConnect = (info) => {\n      console.log('Socket :', info)\n      isConnected.value = true\n      socket.value = client.socket\n      setTimeout(() => {\n        initLogListener()\n        // \n        if (isSubscribed.value) {\n          console.log('')\n          autoSubscribe()\n        }\n      }, 100)\n    }\n    \n    // \n    const onDisconnect = (reason) => {\n      console.warn('Socket :', reason)\n      isConnected.value = false\n      cleanupLogListener()\n      //  isSubscribed \n    }\n    \n    // \n    const onConnectError = (error) => {\n      console.log('Socket :', error)\n      isConnected.value = false\n      cleanupLogListener()\n    }\n    \n    //  client.socket\n    client.socket.on('connect', onConnect)\n    client.socket.on('disconnect', onDisconnect)\n    client.socket.on('connect_error', onConnectError)\n    \n    // \n    return () => {\n      if (client.socket) {\n        client.socket.off('connect', onConnect)\n        client.socket.off('disconnect', onDisconnect)\n        client.socket.off('connect_error', onConnectError)\n      }\n    }\n  }\n\n  // \n  const setupStatusPolling = () => {\n    let lastSocketId = socket.value ? socket.value.id : null\n    \n    const checkStatus = () => {\n      const currentConnected = client.isConnected\n      const currentSocket = client.socket\n      const currentSocketId = currentSocket ? currentSocket.id : null\n      \n      // \n      if (currentConnected !== isConnected.value) {\n        console.log(':', isConnected.value, '->', currentConnected)\n        isConnected.value = currentConnected\n        \n        if (currentConnected && currentSocket) {\n          socket.value = currentSocket\n          lastSocketId = currentSocketId\n          initLogListener()\n        } else {\n          socket.value = null\n          lastSocketId = null\n          cleanupLogListener()\n        }\n      }\n      \n      //  socket  ID \n      if (currentSocketId !== lastSocketId) {\n        console.log(' socket :', lastSocketId, '->', currentSocketId)\n        socket.value = currentSocket\n        lastSocketId = currentSocketId\n        \n        if (currentConnected && currentSocket) {\n          initLogListener()\n        } else {\n          cleanupLogListener()\n        }\n      }\n    }\n    \n    // 2\n    const interval = setInterval(checkStatus, 2000)\n    \n    return () => {\n      clearInterval(interval)\n    }\n  }\n\n  // \n  const addTestLogs = () => {\n    const testLogs = [\n      {\n        id: 'test_1',\n        timestamp: new Date(Date.now() - 60000).toISOString(),\n        level: 'INFO',\n        module: 'system',\n        message: '',\n        caller: 'main.js:1',\n        ip: '127.0.0.1'\n      },\n      {\n        id: 'test_2',\n        timestamp: new Date(Date.now() - 45000).toISOString(),\n        level: 'INFO',\n        module: 'llm',\n        message: 'OpenAI API ',\n        caller: 'openai.js:197',\n        ip: '127.0.0.1',\n        extra: {\n          type: 'json',\n          source: 'openai_api',\n          originalObject: {\n            request: {\n              model: 'gpt-4',\n              messages: [{ role: 'user', content: 'Hello world' }],\n              temperature: 0.7,\n              max_tokens: 1000\n            },\n            response: {\n              id: 'chatcmpl-123',\n              choices: [{ message: { role: 'assistant', content: 'Hello! How can I help you today?' } }],\n              usage: { prompt_tokens: 10, completion_tokens: 15, total_tokens: 25 }\n            }\n          }\n        }\n      },\n      {\n        id: 'test_3',\n        timestamp: new Date(Date.now() - 30000).toISOString(),\n        level: 'WARN',\n        module: 'llm',\n        message: 'API ',\n        caller: 'openai.js:123',\n        ip: '127.0.0.1'\n      },\n      {\n        id: 'test_4',\n        timestamp: new Date(Date.now() - 15000).toISOString(),\n        level: 'ERROR',\n        module: 'onebot',\n        message: 'OneBot ',\n        caller: 'onebot.js:45',\n        ip: '127.0.0.1',\n        extra: {\n          type: 'json',\n          error_code: 'CONNECTION_FAILED',\n          config: {\n            host: 'localhost',\n            port: 5700,\n            protocol: 'ws',\n            timeout: 5000\n          },\n          retry_info: ['attempt_1', 'attempt_2', 'attempt_3'],\n          originalObject: {\n            error: {\n              code: 'CONNECTION_FAILED',\n              message: ' OneBot ',\n              details: {\n                host: 'localhost',\n                port: 5700,\n                timeout: 5000,\n                retries: 3\n              }\n            }\n          }\n        }\n      },\n      {\n        id: 'test_5',\n        timestamp: new Date(Date.now() - 5000).toISOString(),\n        level: 'ERROR',\n        module: 'onebot',\n        message: '...',\n        caller: 'onebot.js:45',\n        ip: '127.0.0.1'\n      },\n      {\n        id: 'test_6',\n        timestamp: new Date().toISOString(),\n        level: 'ERROR',\n        module: 'system',\n        message: {\n          error: 'Database connection failed',\n          code: 'DB_CONN_ERROR',\n          details: {\n            host: 'localhost',\n            port: 5432,\n            database: 'mio_chat',\n            timeout: 5000\n          },\n          stack: 'Error: Connection timeout\\n    at Database.connect (db.js:45)\\n    at async main (index.js:12)'\n        },\n        caller: 'database.js:45',\n        ip: '127.0.0.1'\n      },\n      {\n        id: 'test_7',\n        timestamp: new Date(Date.now() + 1000).toISOString(),\n        level: 'WARN',\n        module: 'api',\n        message: ['Rate limit exceeded', 'Too many requests', { limit: 100, current: 150, resetTime: '2024-12-16T12:00:00Z' }],\n        caller: 'rateLimit.js:23',\n        ip: '127.0.0.1'\n      }\n    ]\n    \n    logs.value.push(...testLogs)\n    console.log(':', testLogs.length, '')\n  }\n\n  // \n  let cleanupSocketListeners = null\n  let cleanupStatusPolling = null\n\n  // \n  const autoSubscribe = async () => {\n    try {\n      console.log('...')\n      await subscribe({\n        level: 'INFO',\n        modules: [],\n        realtime: true,\n        bufferSize: 1000,\n        sendHistory: true\n      })\n      console.log('')\n    } catch (error) {\n      console.error(':', error)\n      // \n      if (!socket.value || !isConnected.value) {\n        console.log('')\n        isSubscribed.value = true\n        startMockLogStream()\n      }\n    }\n  }\n\n  // \n  onMounted(() => {\n    console.log('LogViewer ')\n    console.log('Client :', client.isConnected)\n    console.log('Client  socket:', client.socket)\n    \n    // \n    isConnected.value = client.isConnected\n    socket.value = client.socket\n    \n    //  socket \n    cleanupSocketListeners = setupSocketListeners()\n    \n    // \n    cleanupStatusPolling = setupStatusPolling()\n    \n    // \n    if (isConnected.value && socket.value) {\n      initLogListener()\n    }\n    \n    // \n    setTimeout(() => {\n      addTestLogs()\n    }, 1000)\n    \n    // \n    setTimeout(() => {\n      autoSubscribe()\n    }, 2000)\n  })\n\n  // \n  onUnmounted(async () => {\n    // \n    if (isSubscribed.value && (socket.value && isConnected.value)) {\n      try {\n        console.log('')\n        await unsubscribe()\n      } catch (error) {\n        console.error(':', error)\n      }\n    }\n    \n    // \n    cleanupLogListener()\n    \n    // \n    stopMockLogStream()\n    \n    //  socket \n    if (cleanupSocketListeners) {\n      cleanupSocketListeners()\n    }\n    \n    // \n    if (cleanupStatusPolling) {\n      cleanupStatusPolling()\n    }\n    \n    // \n    pendingRequests.clear()\n  })\n\n  return {\n    // \n    logs,\n    isConnected,\n    stats,\n    \n    // \n    search,\n    exportLogs,\n    updateConfig,\n    getStats,\n    clearLogs\n  }\n}","<template>\n  <div class=\"logs-view\">\n    <div class=\"logs-header\">\n      <h2></h2>\n      <p class=\"logs-description\"></p>\n    </div>\n\n    <!--  -->\n    <el-card class=\"connection-card\" shadow=\"never\">\n      <div class=\"connection-status\">\n        <div class=\"status-indicator\" :class=\"{ 'connected': isConnected, 'disconnected': !isConnected }\">\n          <div class=\"status-dot\"></div>\n          <span>{{ isConnected ? '' : '' }}</span>\n        </div>\n        <div class=\"connection-info\">\n          <span v-if=\"isConnected && stats\">\n            : {{ formatUptime(stats.service?.uptime) }} | \n            : {{ stats.service?.totalLogsSent || 0 }}\n          </span>\n          <span v-else-if=\"isConnected\">\n            ...\n          </span>\n          <span v-else>\n            \n          </span>\n        </div>\n      </div>\n      \n      <!--  -->\n      <div class=\"debug-info\" style=\"margin-top: 12px; font-size: 12px; color: #909399;\">\n        <div>: {{ isConnected ? ' ' : ' ' }}</div>\n        <div>: {{ logs.length }} </div>\n      </div>\n    </el-card>\n\n    <!--  -->\n    <el-card class=\"control-panel\" shadow=\"never\">\n      <div class=\"control-row\">\n        <div class=\"control-group\">\n          <el-button @click=\"clearLogs\" :disabled=\"logs.length === 0\">\n            \n          </el-button>\n          <el-button @click=\"exportLogs\" :disabled=\"logs.length === 0\">\n            \n          </el-button>\n        </div>\n        \n        <div class=\"filter-group\">\n          <el-select v-model=\"filterLevel\" placeholder=\"\" style=\"width: 120px\">\n            <el-option label=\"\" value=\"\"></el-option>\n            <el-option label=\"ERROR\" value=\"ERROR\"></el-option>\n            <el-option label=\"WARN\" value=\"WARN\"></el-option>\n            <el-option label=\"MARK\" value=\"MARK\"></el-option>\n            <el-option label=\"INFO\" value=\"INFO\"></el-option>\n            <el-option label=\"DEBUG\" value=\"DEBUG\"></el-option>\n          </el-select>\n          \n          <el-select v-model=\"filterModule\" placeholder=\"\" style=\"width: 120px\">\n            <el-option label=\"\" value=\"\"></el-option>\n            <el-option label=\"llm\" value=\"llm\"></el-option>\n            <el-option label=\"onebot\" value=\"onebot\"></el-option>\n            <el-option label=\"system\" value=\"system\"></el-option>\n          </el-select>\n          \n          <el-input\n            v-model=\"searchKeyword\"\n            placeholder=\"\"\n            style=\"width: 200px\"\n            clearable\n            @keyup.enter=\"performSearch\"\n          >\n            <template #append>\n              <el-button @click=\"performSearch\" :icon=\"Search\"></el-button>\n            </template>\n          </el-input>\n        </div>\n      </div>\n    </el-card>\n\n    <!--  -->\n    <el-card class=\"logs-container\" shadow=\"never\">\n      <div class=\"logs-header-row\">\n        <span class=\"logs-count\"> {{ filteredLogs.length }} </span>\n        <div class=\"logs-controls\">\n          <el-switch\n            v-model=\"autoScroll\"\n            active-text=\"\"\n            inactive-text=\"\"\n          />\n          <el-button \n            size=\"small\" \n            @click=\"scrollToBottom\"\n            :disabled=\"filteredLogs.length === 0\"\n          >\n            \n          </el-button>\n        </div>\n      </div>\n      \n      <div \n        ref=\"logsContainer\" \n        class=\"logs-list\"\n        @scroll=\"handleScroll\"\n      >\n        <div \n          v-for=\"log in filteredLogs\" \n          :key=\"log.id\"\n          class=\"log-item\"\n          :class=\"[`level-${log.level.toLowerCase()}`, { 'highlighted': log.highlighted }]\"\n        >\n          <div class=\"log-header\">\n            <span class=\"log-timestamp\">{{ formatTimestamp(log.timestamp) }}</span>\n            <span class=\"log-level\" :class=\"`level-${log.level.toLowerCase()}`\">{{ log.level }}</span>\n            <span class=\"log-module\">{{ log.module }}</span>\n            <span v-if=\"log.caller\" class=\"log-caller\">{{ log.caller }}</span>\n          </div>\n          <div class=\"log-message\">\n            <span v-if=\"log.extra?.type === 'json'\" class=\"json-message\" @click=\"openJsonDialog(log)\">\n              {{ getJsonSummary(log) }}\n              <el-icon class=\"json-expand-icon\"><View /></el-icon>\n            </span>\n            <span v-else-if=\"isObjectMessage(log.message)\" class=\"object-message\" @click=\"openObjectDialog(log)\">\n              {{ getObjectSummary(log.message) }}\n              <el-icon class=\"json-expand-icon\"><View /></el-icon>\n            </span>\n            <span v-else v-html=\"log.message\"></span>\n          </div>\n          <div v-if=\"log.extra && Object.keys(getDisplayExtra(log.extra)).length > 0\" class=\"log-extra\">\n            <el-tag \n              v-for=\"(value, key) in getDisplayExtra(log.extra)\" \n              :key=\"key\"\n              size=\"small\"\n              :type=\"isObjectValue(value) ? 'warning' : 'info'\"\n              class=\"log-extra-tag\"\n              :class=\"{ 'clickable': isObjectValue(value) }\"\n              :title=\"getTagTitle(key, value)\"\n              @click=\"isObjectValue(value) ? openExtraObjectDialog(key, value, log) : null\"\n            >\n              {{ key }}: {{ formatTagValue(value) }}\n            </el-tag>\n          </div>\n        </div>\n        \n        <div v-if=\"filteredLogs.length === 0\" class=\"empty-logs\">\n          <el-empty description=\"\" />\n        </div>\n      </div>\n    </el-card>\n\n    <!-- JSON  -->\n    <el-dialog \n      v-model=\"jsonDialogVisible\" \n      :title=\"getDialogTitle()\" \n      width=\"800px\" \n      class=\"json-dialog\"\n    >\n      <div class=\"json-content\">\n        <div class=\"json-header\">\n          <span class=\"json-timestamp\">{{ selectedLog?.timestamp }}</span>\n          <span class=\"json-level\" :class=\"`level-${selectedLog?.level?.toLowerCase()}`\">\n            {{ selectedLog?.level }}\n          </span>\n          <span class=\"json-module\">{{ selectedLog?.module }}</span>\n        </div>\n        <div class=\"json-body\">\n          <pre class=\"json-pre\">{{ formatJsonContent(selectedLog) }}</pre>\n        </div>\n      </div>\n      <template #footer>\n        <el-button @click=\"copyJsonContent\"></el-button>\n        <el-button type=\"primary\" @click=\"jsonDialogVisible = false\"></el-button>\n      </template>\n    </el-dialog>\n\n    <!--  -->\n    <el-dialog v-model=\"exportDialogVisible\" title=\"\" width=\"500px\">\n      <el-form :model=\"exportForm\" label-width=\"100px\">\n        <el-form-item label=\"\">\n          <el-radio-group v-model=\"exportForm.format\">\n            <el-radio label=\"json\">JSON</el-radio>\n            <el-radio label=\"csv\">CSV</el-radio>\n            <el-radio label=\"txt\">TXT</el-radio>\n          </el-radio-group>\n        </el-form-item>\n        \n        <el-form-item label=\"\">\n          <el-input-number \n            v-model=\"exportForm.maxRecords\" \n            :min=\"1\" \n            :max=\"50000\"\n            style=\"width: 100%\"\n          />\n        </el-form-item>\n        \n        <el-form-item label=\"\">\n          <el-switch v-model=\"exportForm.includeMetadata\" />\n        </el-form-item>\n      </el-form>\n      \n      <template #footer>\n        <el-button @click=\"exportDialogVisible = false\"></el-button>\n        <el-button type=\"primary\" @click=\"confirmExport\" :loading=\"exportLoading\">\n          \n        </el-button>\n      </template>\n    </el-dialog>\n  </div>\n</template>\n\n<script setup>\nimport { useLogViewer } from '@/composables/useLogViewer'\nimport { Search, View } from '@element-plus/icons-vue'\nimport { ElMessage, ElMessageBox } from 'element-plus'\nimport { computed, nextTick, onMounted, onUnmounted, ref, watch } from 'vue'\n\n//  composable\nconst {\n  logs,\n  isConnected,\n  stats,\n  search,\n  exportLogs: exportLogsData,\n  getStats,\n  clearLogs: clearLogsData\n} = useLogViewer()\n\n// \nconst filterLevel = ref('')\nconst filterModule = ref('')\nconst searchKeyword = ref('')\n\n// UI \nconst autoScroll = ref(true)\nconst logsContainer = ref(null)\nconst exportDialogVisible = ref(false)\nconst exportLoading = ref(false)\nconst jsonDialogVisible = ref(false)\nconst selectedLog = ref(null)\nconst extraObjectKey = ref(null)\n\n// \nconst exportForm = ref({\n  format: 'json',\n  maxRecords: 10000,\n  includeMetadata: true\n})\n\n// \nconst filteredLogs = computed(() => {\n  let filtered = logs.value\n\n  if (filterLevel.value) {\n    filtered = filtered.filter(log => log.level === filterLevel.value)\n  }\n\n  if (filterModule.value) {\n    filtered = filtered.filter(log => log.module === filterModule.value)\n  }\n\n  if (searchKeyword.value) {\n    const keyword = searchKeyword.value.toLowerCase()\n    filtered = filtered.filter(log => \n      log.message.toLowerCase().includes(keyword) ||\n      log.module.toLowerCase().includes(keyword) ||\n      (log.caller && log.caller.toLowerCase().includes(keyword))\n    )\n  }\n\n  return filtered\n})\n\n\n\n// \nconst clearLogs = async () => {\n  try {\n    await ElMessageBox.confirm('', '', {\n      type: 'warning'\n    })\n    clearLogsData()\n    ElMessage.success('')\n  } catch (error) {\n    // \n  }\n}\n\n// \nconst performSearch = async () => {\n  if (!searchKeyword.value.trim()) {\n    return\n  }\n\n  try {\n    const results = await search({\n      keyword: searchKeyword.value,\n      level: filterLevel.value || undefined,\n      modules: filterModule.value ? [filterModule.value] : [],\n      page: 1,\n      pageSize: 100\n    })\n    \n    if (results.success) {\n      ElMessage.success(` ${results.data.total} `)\n    }\n  } catch (error) {\n    ElMessage.error(': ' + error.message)\n  }\n}\n\n// \nconst exportLogs = () => {\n  exportDialogVisible.value = true\n}\n\n// \nconst confirmExport = async () => {\n  exportLoading.value = true\n  \n  try {\n    const result = await exportLogsData({\n      format: exportForm.value.format,\n      level: filterLevel.value || undefined,\n      modules: filterModule.value ? [filterModule.value] : [],\n      keyword: searchKeyword.value || undefined,\n      maxRecords: exportForm.value.maxRecords,\n      includeMetadata: exportForm.value.includeMetadata\n    })\n    \n    if (result.success) {\n      // \n      const blob = new Blob([result.data.data], {\n        type: getContentType(result.data.format)\n      })\n      \n      const url = URL.createObjectURL(blob)\n      const a = document.createElement('a')\n      a.href = url\n      a.download = `logs_${new Date().toISOString().slice(0, 19).replace(/:/g, '-')}.${result.data.format}`\n      a.click()\n      \n      URL.revokeObjectURL(url)\n      ElMessage.success('')\n      exportDialogVisible.value = false\n    }\n  } catch (error) {\n    ElMessage.error(': ' + error.message)\n  } finally {\n    exportLoading.value = false\n  }\n}\n\n// \nconst getContentType = (format) => {\n  const types = {\n    json: 'application/json',\n    csv: 'text/csv',\n    txt: 'text/plain'\n  }\n  return types[format] || 'text/plain'\n}\n\n// \nconst formatTimestamp = (timestamp) => {\n  return new Date(timestamp).toLocaleString('zh-CN', {\n    year: 'numeric',\n    month: '2-digit',\n    day: '2-digit',\n    hour: '2-digit',\n    minute: '2-digit',\n    second: '2-digit',\n    fractionalSecondDigits: 3\n  })\n}\n\n// \nconst formatUptime = (uptime) => {\n  if (!uptime) return ''\n  \n  const seconds = Math.floor(uptime / 1000)\n  const minutes = Math.floor(seconds / 60)\n  const hours = Math.floor(minutes / 60)\n  const days = Math.floor(hours / 24)\n  \n  if (days > 0) {\n    return `${days}${hours % 24}`\n  } else if (hours > 0) {\n    return `${hours}${minutes % 60}`\n  } else if (minutes > 0) {\n    return `${minutes}`\n  } else {\n    return `${seconds}`\n  }\n}\n\n// \nconst truncateText = (text, maxLength) => {\n  if (!text) return ''\n  const str = String(text)\n  if (str.length <= maxLength) return str\n  return str.substring(0, maxLength) + '...'\n}\n\n//  JSON \nconst getJsonSummary = (log) => {\n  try {\n    const jsonObj = log.extra?.originalObject\n    if (!jsonObj || typeof jsonObj !== 'object') {\n      return 'JSON: '\n    }\n    \n    const keys = Object.keys(jsonObj)\n    if (keys.length === 0) {\n      return 'JSON: {}'\n    } else if (keys.length === 1) {\n      return `JSON: { ${keys[0]}: ... }`\n    } else {\n      return `JSON: { ${keys[0]}, ${keys[1]}${keys.length > 2 ? `, +${keys.length - 2} more` : ''} }`\n    }\n  } catch (error) {\n    return 'JSON: '\n  }\n}\n\n//  JSON \nconst formatJsonContent = (log) => {\n  try {\n    const jsonObj = log.extra?.originalObject\n    if (!jsonObj) {\n      return ' JSON '\n    }\n    return JSON.stringify(jsonObj, null, 2)\n  } catch (error) {\n    return ''\n  }\n}\n\n//  JSON \nconst openJsonDialog = (log) => {\n  selectedLog.value = log\n  extraObjectKey.value = null //  extra \n  jsonDialogVisible.value = true\n}\n\n// \nconst getDialogTitle = () => {\n  if (extraObjectKey.value) {\n    return `Extra : ${extraObjectKey.value}`\n  }\n  \n  if (selectedLog.value?.extra?.type === 'json') {\n    return 'JSON '\n  }\n  \n  return ''\n}\n\n//  JSON \nconst copyJsonContent = async () => {\n  if (!selectedLog.value) return\n  \n  try {\n    const formattedJson = formatJsonContent(selectedLog.value)\n    await navigator.clipboard.writeText(formattedJson)\n    ElMessage.success('')\n  } catch (error) {\n    ElMessage.error(': ' + error.message)\n  }\n}\n\n//  message \nconst isObjectMessage = (message) => {\n  return typeof message === 'object' && message !== null\n}\n\n// \nconst getObjectSummary = (message) => {\n  try {\n    if (Array.isArray(message)) {\n      return `Array[${message.length}]: ${message.length > 0 ? JSON.stringify(message[0]).substring(0, 30) + '...' : 'empty'}`\n    }\n    \n    const keys = Object.keys(message)\n    if (keys.length === 0) {\n      return 'Object: {}'\n    } else if (keys.length === 1) {\n      return `Object: { ${keys[0]}: ... }`\n    } else {\n      return `Object: { ${keys[0]}, ${keys[1]}${keys.length > 2 ? `, +${keys.length - 2} more` : ''} }`\n    }\n  } catch (error) {\n    return 'Object: '\n  }\n}\n\n// \nconst openObjectDialog = (log) => {\n  //  log  message  originalObject\n  const tempLog = {\n    ...log,\n    extra: {\n      ...log.extra,\n      originalObject: log.message\n    }\n  }\n  selectedLog.value = tempLog\n  extraObjectKey.value = null //  extra \n  jsonDialogVisible.value = true\n}\n\n// \nconst isObjectValue = (value) => {\n  return typeof value === 'object' && value !== null\n}\n\n// \nconst formatTagValue = (value) => {\n  if (!isObjectValue(value)) {\n    return truncateText(String(value), 20)\n  }\n  \n  if (Array.isArray(value)) {\n    return `[${value.length} items]`\n  }\n  \n  const keys = Object.keys(value)\n  if (keys.length === 0) {\n    return '{}'\n  } else if (keys.length === 1) {\n    return `{${keys[0]}}`\n  } else {\n    return `{${keys.length} keys}`\n  }\n}\n\n//  title \nconst getTagTitle = (key, value) => {\n  if (!isObjectValue(value)) {\n    return `${key}: ${value}`\n  }\n  return `${key}: `\n}\n\n//  extra \nconst openExtraObjectDialog = (key, value, log) => {\n  //  log  extra  originalObject\n  const tempLog = {\n    ...log,\n    extra: {\n      ...log.extra,\n      originalObject: value\n    }\n  }\n  selectedLog.value = tempLog\n  \n  // \n  extraObjectKey.value = key\n  jsonDialogVisible.value = true\n}\n\n//  extra \nconst getDisplayExtra = (extra) => {\n  if (!extra) return {}\n  \n  const { type, originalObject, ...displayExtra } = extra\n  return displayExtra\n}\n\n// \nconst scrollToBottom = () => {\n  if (logsContainer.value) {\n    nextTick(() => {\n      logsContainer.value.scrollTop = logsContainer.value.scrollHeight\n    })\n  }\n}\n\n// \nconst handleScroll = () => {\n  if (!logsContainer.value || !autoScroll.value) return\n  \n  const { scrollTop, scrollHeight, clientHeight } = logsContainer.value\n  const isAtBottom = scrollTop + clientHeight >= scrollHeight - 10\n  \n  if (!isAtBottom) {\n    autoScroll.value = false\n  }\n}\n\n// \nwatch(filteredLogs, () => {\n  if (autoScroll.value) {\n    nextTick(() => {\n      scrollToBottom()\n    })\n  }\n}, { deep: true })\n\n// \nlet statsInterval = null\n\nonMounted(() => {\n  // 30\n  statsInterval = setInterval(() => {\n    if (isConnected.value) {\n      getStats()\n    }\n  }, 30000)\n  \n  // \n  if (isConnected.value) {\n    getStats()\n  }\n})\n\nonUnmounted(() => {\n  if (statsInterval) {\n    clearInterval(statsInterval)\n  }\n})\n</script>\n\n<style scoped lang=\"scss\">\n.logs-view {\n  height: calc(100vh - 120px); // \n  display: flex;\n  flex-direction: column;\n  padding: 24px;\n  max-width: 1200px;\n  margin: 0 auto;\n  box-sizing: border-box;\n}\n\n.logs-header {\n  margin-bottom: 24px;\n  \n  h2 {\n    margin: 0 0 8px 0;\n    font-size: 24px;\n    font-weight: 600;\n    color: #303133;\n  }\n  \n  .logs-description {\n    margin: 0;\n    color: #606266;\n    font-size: 14px;\n  }\n}\n\n.connection-card {\n  margin-bottom: 16px;\n  \n  :deep(.el-card__body) {\n    padding: 16px;\n  }\n}\n\n.connection-status {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n}\n\n.status-indicator {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  \n  .status-dot {\n    width: 8px;\n    height: 8px;\n    border-radius: 50%;\n    background-color: #f56c6c;\n  }\n  \n  span {\n    font-weight: 500;\n    color: #f56c6c;\n  }\n  \n  &.connected {\n    .status-dot {\n      background-color: #67c23a;\n    }\n    \n    span {\n      color: #67c23a;\n    }\n  }\n}\n\n.connection-info {\n  font-size: 14px;\n  color: #909399;\n}\n\n.control-panel {\n  margin-bottom: 16px;\n  \n  :deep(.el-card__body) {\n    padding: 16px;\n  }\n}\n\n.control-row {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  gap: 16px;\n  \n  @media (max-width: 768px) {\n    flex-direction: column;\n    align-items: stretch;\n    gap: 12px;\n  }\n}\n\n.control-group {\n  display: flex;\n  gap: 12px;\n  \n  @media (max-width: 768px) {\n    justify-content: center;\n  }\n}\n\n.filter-group {\n  display: flex;\n  gap: 12px;\n  align-items: center;\n  \n  @media (max-width: 768px) {\n    flex-wrap: wrap;\n    justify-content: center;\n  }\n}\n\n.logs-container {\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  min-height: 0; //  flex \n  \n  :deep(.el-card__body) {\n    padding: 0;\n    height: 100%;\n    display: flex;\n    flex-direction: column;\n  }\n}\n\n.logs-header-row {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 16px;\n  border-bottom: 1px solid #e4e7ed;\n  background-color: #fafafa;\n}\n\n.logs-count {\n  font-size: 14px;\n  color: #606266;\n  font-weight: 500;\n}\n\n.logs-controls {\n  display: flex;\n  align-items: center;\n  gap: 12px;\n}\n\n.logs-list {\n  flex: 1;\n  overflow-y: auto;\n  background-color: #fff;\n  min-height: 0; //  flex \n}\n\n.log-item {\n  padding: 12px 16px;\n  border-bottom: 1px solid #f0f0f0;\n  transition: background-color 0.2s;\n  \n  &:hover {\n    background-color: #fafafa;\n  }\n  \n  &.highlighted {\n    background-color: #fff7e6;\n    border-left: 3px solid #e6a23c;\n  }\n  \n  &.level-error {\n    border-left: 3px solid #f56c6c;\n  }\n  \n  &.level-warn {\n    border-left: 3px solid #e6a23c;\n  }\n  \n  &.level-info {\n    border-left: 3px solid #409eff;\n  }\n  \n  &.level-debug {\n    border-left: 3px solid #909399;\n  }\n  \n  &.level-mark {\n    border-left: 3px solid #67c23a;\n  }\n}\n\n.log-header {\n  display: flex;\n  align-items: center;\n  gap: 12px;\n  margin-bottom: 4px;\n  font-size: 12px;\n}\n\n.log-timestamp {\n  color: #909399;\n  font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;\n}\n\n.log-level {\n  padding: 2px 6px;\n  border-radius: 4px;\n  font-weight: 500;\n  font-size: 11px;\n  \n  &.level-error {\n    background-color: #fef0f0;\n    color: #f56c6c;\n  }\n  \n  &.level-warn {\n    background-color: #fdf6ec;\n    color: #e6a23c;\n  }\n  \n  &.level-info {\n    background-color: #ecf5ff;\n    color: #409eff;\n  }\n  \n  &.level-debug {\n    background-color: #f4f4f5;\n    color: #909399;\n  }\n  \n  &.level-mark {\n    background-color: #f0f9ff;\n    color: #67c23a;\n  }\n}\n\n.log-module {\n  background-color: #f0f0f0;\n  color: #606266;\n  padding: 2px 6px;\n  border-radius: 4px;\n  font-size: 11px;\n  font-weight: 500;\n}\n\n.log-caller {\n  color: #909399;\n  font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;\n}\n\n.log-message {\n  color: #303133;\n  line-height: 1.5;\n  word-break: break-word;\n  font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;\n  font-size: 13px;\n  \n  :deep(mark) {\n    background-color: #fff2cc;\n    color: #e6a23c;\n    padding: 1px 2px;\n    border-radius: 2px;\n  }\n}\n\n.json-message,\n.object-message {\n  cursor: pointer;\n  color: #409eff;\n  display: inline-flex;\n  align-items: center;\n  gap: 4px;\n  padding: 2px 6px;\n  border-radius: 4px;\n  transition: all 0.2s;\n  \n  &:hover {\n    background-color: #ecf5ff;\n    color: #337ecc;\n  }\n}\n\n.object-message {\n  color: #e6a23c; // \n  \n  &:hover {\n    background-color: #fdf6ec;\n    color: #cf9236;\n  }\n}\n\n.json-expand-icon {\n  font-size: 12px;\n  opacity: 0.7;\n}\n\n.log-extra {\n  margin-top: 8px;\n  display: flex;\n  flex-wrap: wrap;\n  gap: 4px;\n  max-width: 100%;\n  overflow: hidden;\n}\n\n.log-extra-tag {\n  max-width: 200px;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n  flex-shrink: 1;\n  \n  &.clickable {\n    cursor: pointer;\n    transition: all 0.2s;\n    \n    &:hover {\n      transform: translateY(-1px);\n      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);\n    }\n  }\n  \n  :deep(.el-tag__content) {\n    overflow: hidden;\n    text-overflow: ellipsis;\n    white-space: nowrap;\n    max-width: 100%;\n  }\n}\n\n.empty-logs {\n  height: 100%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n\n// JSON \n.json-dialog {\n  :deep(.el-dialog__body) {\n    padding: 0;\n  }\n}\n\n.json-content {\n  max-height: 600px;\n  overflow: hidden;\n  display: flex;\n  flex-direction: column;\n}\n\n.json-header {\n  display: flex;\n  align-items: center;\n  gap: 12px;\n  padding: 16px;\n  border-bottom: 1px solid #e4e7ed;\n  background-color: #fafafa;\n  font-size: 12px;\n}\n\n.json-timestamp {\n  color: #909399;\n  font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;\n}\n\n.json-level {\n  padding: 2px 6px;\n  border-radius: 4px;\n  font-weight: 500;\n  font-size: 11px;\n  \n  &.level-error {\n    background-color: #fef0f0;\n    color: #f56c6c;\n  }\n  \n  &.level-warn {\n    background-color: #fdf6ec;\n    color: #e6a23c;\n  }\n  \n  &.level-info {\n    background-color: #ecf5ff;\n    color: #409eff;\n  }\n  \n  &.level-debug {\n    background-color: #f4f4f5;\n    color: #909399;\n  }\n  \n  &.level-mark {\n    background-color: #f0f9ff;\n    color: #67c23a;\n  }\n}\n\n.json-module {\n  background-color: #f0f0f0;\n  color: #606266;\n  padding: 2px 6px;\n  border-radius: 4px;\n  font-size: 11px;\n  font-weight: 500;\n}\n\n.json-body {\n  flex: 1;\n  overflow: auto;\n  padding: 16px;\n}\n\n.json-pre {\n  margin: 0;\n  font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;\n  font-size: 13px;\n  line-height: 1.5;\n  color: #303133;\n  background-color: #f8f9fa;\n  padding: 16px;\n  border-radius: 6px;\n  border: 1px solid #e4e7ed;\n  white-space: pre-wrap;\n  word-break: break-word;\n}\n\n// \n@media (max-width: 768px) {\n  .logs-view {\n    padding: 16px;\n  }\n  \n  .logs-header-row {\n    flex-direction: column;\n    align-items: stretch;\n    gap: 12px;\n  }\n  \n  .logs-controls {\n    justify-content: center;\n  }\n  \n  .log-item {\n    padding: 8px 12px;\n  }\n  \n  .log-header {\n    flex-wrap: wrap;\n    gap: 8px;\n  }\n  \n  .log-message {\n    font-size: 12px;\n  }\n  \n  .json-dialog {\n    :deep(.el-dialog) {\n      width: 95% !important;\n      margin: 5vh auto;\n    }\n  }\n  \n  .json-content {\n    max-height: 70vh;\n  }\n  \n  .json-pre {\n    font-size: 12px;\n    padding: 12px;\n  }\n}\n</style>"],"file":"views-CO80yBqt.js"}