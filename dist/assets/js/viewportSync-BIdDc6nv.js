class e{constructor(){this.originalInnerHeight=window.innerHeight,this.isPatched=!1,this.isIOSDevice()&&window.visualViewport&&this.patchInnerHeight()}isIOSDevice(){return/iPad|iPhone|iPod/.test(navigator.userAgent)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}patchInnerHeight(){if(this.isPatched)return;if(this.originalBodyOffsetHeight=document.body?document.body.offsetHeight:0,this.originalDocumentHeight=document.documentElement?document.documentElement.scrollHeight:0,document.documentElement&&(this.originalGetBoundingClientRect=document.documentElement.getBoundingClientRect),Object.defineProperty(window,"innerHeight",{get:()=>window.visualViewport?window.visualViewport.height:this.originalInnerHeight,configurable:!0,enumerable:!0}),document.body&&Object.defineProperty(document.body,"offsetHeight",{get:()=>window.visualViewport?window.visualViewport.height:this.originalBodyOffsetHeight,configurable:!0}),document.documentElement){const e=document.documentElement;try{Object.defineProperty(e,"scrollHeight",{get:()=>window.visualViewport?window.visualViewport.height:this.originalDocumentHeight,configurable:!0})}catch(t){}try{Object.defineProperty(e,"clientHeight",{get:()=>window.visualViewport?window.visualViewport.height:this.originalDocumentHeight,configurable:!0})}catch(t){}try{Object.defineProperty(e,"offsetHeight",{get:()=>window.visualViewport?window.visualViewport.height:this.originalDocumentHeight,configurable:!0})}catch(t){}const i=e.getBoundingClientRect;e.getBoundingClientRect=function(){const e=i.call(this);return window.visualViewport?{...e,height:window.visualViewport.height,bottom:e.top+window.visualViewport.height}:e}}const e=()=>{const e=window.visualViewport.height;this.syncBodyHeight(e);const t=new Event("resize");window.dispatchEvent(t)};window.visualViewport.addEventListener("resize",e),window.visualViewport.addEventListener("scroll",e),this.syncBodyHeight(window.visualViewport.height),this.isPatched=!0}restore(){if(this.isPatched){if(Object.defineProperty(window,"innerHeight",{value:this.originalInnerHeight,writable:!1,configurable:!0,enumerable:!0}),document.body&&Object.defineProperty(document.body,"offsetHeight",{value:this.originalBodyOffsetHeight,writable:!1,configurable:!0}),document.documentElement){const t=document.documentElement;try{Object.defineProperty(t,"scrollHeight",{value:this.originalDocumentHeight,writable:!1,configurable:!0})}catch(e){}try{delete t.clientHeight}catch(e){}try{delete t.offsetHeight}catch(e){}this.originalGetBoundingClientRect&&(t.getBoundingClientRect=this.originalGetBoundingClientRect)}this.restoreBodyHeight(),this.isPatched=!1}}getOriginalInnerHeight(){return this.originalInnerHeight}getVisualViewportHeight(){return window.visualViewport?window.visualViewport.height:this.originalInnerHeight}getKeyboardHeight(){return this.originalInnerHeight-this.getVisualViewportHeight()}syncBodyHeight(e){document.documentElement&&(document.documentElement.style.height=`${e}px`,document.documentElement.style.maxHeight=`${e}px`),document.body&&(document.body.style.height=`${e}px`,document.body.style.maxHeight=`${e}px`,document.body.style.overflow="hidden");const t=document.getElementById("app");t&&(t.style.height=`${e}px`,t.style.maxHeight=`${e}px`),document.documentElement.style.setProperty("--viewport-height",`${e}px`),document.documentElement.style.setProperty("--keyboard-height",this.originalInnerHeight-e+"px")}restoreBodyHeight(){document.documentElement&&(document.documentElement.style.height="",document.documentElement.style.maxHeight=""),document.body&&(document.body.style.height="",document.body.style.maxHeight="",document.body.style.overflow="");const e=document.getElementById("app");e&&(e.style.height="",e.style.maxHeight="")}}const t=new e,i=new class{constructor(){this.isIOSDevice()&&this.init()}isIOSDevice(){return/iPad|iPhone|iPod/.test(navigator.userAgent)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}init(){this.processExistingInputs(),this.observeNewInputs(),this.bindFocusEvents()}processExistingInputs(){document.querySelectorAll('input, textarea, select, [contenteditable="true"]').forEach(e=>this.applyIOSFix(e))}applyIOSFix(e){if(!e)return;Object.entries({autocomplete:"off",autocorrect:"off",autocapitalize:"off",spellcheck:"false"}).forEach(([t,i])=>{e.setAttribute(t,i)});Object.entries({"-webkit-appearance":"none",appearance:"none",fontSize:"16px","-webkit-text-size-adjust":"100%","-webkit-touch-callout":"none","-webkit-user-select":"text","-webkit-user-modify":"read-write-plaintext-only"}).forEach(([t,i])=>{e.style.setProperty(t,i,"important")})}observeNewInputs(){new MutationObserver(e=>{e.forEach(e=>{e.addedNodes.forEach(e=>{if(e.nodeType===Node.ELEMENT_NODE){this.isInputElement(e)&&this.applyIOSFix(e);(e.querySelectorAll?e.querySelectorAll('input, textarea, select, [contenteditable="true"]'):[]).forEach(e=>this.applyIOSFix(e))}})})}).observe(document.body,{childList:!0,subtree:!0})}bindFocusEvents(){document.addEventListener("focusin",e=>{this.isInputElement(e.target)&&setTimeout(()=>{this.applyIOSFix(e.target)},0)})}isInputElement(e){if(!e||!e.tagName)return!1;return["INPUT","TEXTAREA","SELECT"].includes(e.tagName.toUpperCase())||"true"===e.contentEditable}};window.viewportSync=t,window.iosInputFixer=i;export{e as default};
//# sourceMappingURL=viewportSync-BIdDc6nv.js.map
