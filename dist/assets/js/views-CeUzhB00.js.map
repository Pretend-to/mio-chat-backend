{"version":3,"mappings":"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","names":["BlankView","__vitePreload","Promise","resolve","then","__VITE_PRELOAD__","router","createRouter","history","createWebHistory","routes","path","name","component","HomeView$1","children","ChatView$1","ProfileView$1","AuthView$1","SettingsView$1","redirect","OverviewView$1","LLMAdaptersView$1","ServerConfigView$1","WebConfigView$1","OnebotConfigView$1","PluginsView$1","beforeEach","async","to","client","everLogin","ElMessage","warning","query","fullPath","_hoisted_1","id","_hoisted_2","class","_hoisted_3","_hoisted_4","_hoisted_5","key","_hoisted_7","_hoisted_9","_hoisted_10","_hoisted_12","_hoisted_14","_hoisted_15","style","width","height","position","_hoisted_20","_hoisted_21","_hoisted_22","components","MdRenderer","ContextMenu","ForwardMsg","InputEditor","ToolCallBar","FileBlock","ReasonBlock","data","shareId","contactor","preview","scroll","currentUrl","window","location","href","params","URL","searchParams","has","get","currentId","parseInt","this","$route","getContactor","Error","e","defaultId","contactList","$router","push","activeContactor","showwindow","showemoji","userInput","extraOptions","wraperPresets","selectedOption","currentDelay","toupdate","seletedText","seletedImage","retryList","showMenu","menuTop","menuLeft","validMessageIndex","repliedMessageId","autoScroll","fullScreen","chatWindowRef","prevScrollTop","showRollDown","inputBarTop","clearMessageTip","loadingIcon","katexPlugin","mioPlugins","plugin","codeBlockPlugin","mermaidPlugin","cursorPlugin","options","shape","imageViewerPlugin","computed","getMenuStyle","innerWidth","basicHeight","top","bottom","innerHeight","left","getDelayStatus","activeMessageChain","presetSettings","opening","role","content","type","text","time","createTime","messageChain","watch","newVal","oldVal","initContactor","toButtom","oldId","oldContactor","disableContactor","mounted","document","addEventListener","$refs","chatWindow","scrollHandler","element","querySelector","pageHeight","offsetTop","loadOriginalContactors","$message","message","updated","length","beforeUnmount","removeEventListener","methods","handleMouseUp","selectedText","getSelection","toString","clicked","setTimeout","elm","getElementById","scrollTo","scrollHeight","behavior","scrollToBottom","cleanScreen","updateFirstMessage","setLocalStorage","emit","cleanHistory","i","splice","makeSystemMessage","delSystemMessage","index","firstMessageIndex","isValidInput","input","test","waiting","tolist","setModel","list","provider","model","base","loadAvatar","toimg","rect","getBoundingClientRect","html2canvas","windowHeight","canvas","img","toDataURL","link","createElement","download","click","share","shareResult","shareContactor","shareUrl","success","shareOrCopy","hasOpening","getFullMessages","showTime","thisTime","show","getShownTime","separateTextAndImages","markdownText","regex","matches","result","lastIndex","exec","textContent","slice","trim","file","getChatwindowScrollheight","scrollTop","clientHeight","active","on","$forceUpdate","messageId","rawMessage","getMessageById","includes","filter","item","forEach","platform","formatedMessage","loadName","off","getReplyText","find","String","imageLoaded","showMessageMenu","event","messageIndex","target","tagName","toLowerCase","imgSrc","src","preventDefault","clientY","clientX","currentSelectedText","toProfile","currentScrollTop","isScrollingDown","isScrollingUp","isAtBottom","getseletedMessage","handleMessageOption","option","webSend","targetIndex","validMessage","baseContainer","getBaseUserContainer","insertMessage","status","retryMessage","_openBlock","_createElementBlock","_createElementVNode","onClick","$options","args","_toDisplayString","$data","_normalizeClass","ref","_normalizeStyle","_createCommentVNode","_createVNode","_component_ContextMenu","onMessageOption","onClose","_Fragment","_renderList","ref_for","_hoisted_6","_hoisted_8","avatar","alt","_hoisted_11","title","_hoisted_13","onMouseup","onContextmenu","$event","elmIndex","_createBlock","_component_MdRenderer","md","theme","isStreaming","breaks","_hoisted_16","_component_ForwardMsg","messages","_component_FileBlock","_hoisted_17","_component_ReasonBlock","endTime","startTime","_hoisted_18","_cache","_component_ToolCallBar","_hoisted_19","_component_InputEditor","onStroge","onSetModel","onCleanScreen","onCleanHistory","onToButtom","created","friendlist","blankView","onPhone","pagePath","loaded","inited","_component_friendlist","_component_blankView","_component_router_view","_hoisted_23","_hoisted_24","_hoisted_25","ContactorSettings","toolCallModes","config","getToolCallModes","providers","getLLMProviders","safetyParams","getSafetySettingsParams","safetySimpleValue","Object","keys","map","value","label","allLLMTools","llmTools","toolsObject","toolsList","toolKey","enabled","tools","collapsed","centerDialogVisible","avatarPolicyList","namePolicyList","isOnebot","llmProviders","basicInfo","getAvatarPolicyValue","avatarPolicy","newId","handler","newOptions","JSON","parse","stringify","deep","newInfo","namePolicy","priority","delayInterval","setInterval","socket","delay","clearInterval","toolCallSettings","mode","handleUpdateOpenaiPresets","presets","delContactor","rmContactor","handleProviderSwitched","newProvider","getBaseInfoShownValue","updateContactorName","updateContactorAvatar","_component_el_image","_createTextVNode","_component_el_input","modelValue","disabled","_component_el_select","onChange","default","_withCtx","_component_el_option","_","_component_el_switch","_component_ContactorSettings","onProviderChanged","onUpdatePresets","_component_el_button","plain","_ctx","_component_el_dialog","center","footer","route","useRoute","useRouter","configStore","useConfigStore","forbidden","handleSwitchAccount","clearAdminCode","handleReturnHome","activeMenu","handleMenuSelect","handleRestartService","ElMessageBox","confirm","confirmButtonText","cancelButtonText","info","error","handleReset","reset","reload","handleResetCache","resetCache","onMounted","isAuthenticated","fetchConfig","accessCode","requesting","iconContainer","login","code","nextTick","classList","add","is_admin","setAdminCode","currentRoute","remove","handleEnter","onUnmounted","loading","refreshing","showCompare","systemStatus","needRestart","values","adapters","some","instances","adapter","enable","systemStatusText","pendingItems","items","action","entries","providerName","models","disabledCount","flat","onebot","onebotConfig","reverse_ws_url","bot_qq","adapterTypeName","openai","gemini","vertex","handleRefreshModels","refreshAllModels","handleExportConfig","filename","Date","toISOString","split","exportConfig","handleImportConfig","configData","importConfig","validateResult","validateConfig","valid","alert","errors","join","updateConfig","navigateTo","editorVisible","editorMode","editorType","editorAdapter","editorIndex","getAdapterModels","handleAddAdapter","handleEdit","handleDelete","deleteAdapter","handleRefresh","refreshAdapterModels","handleToggle","updatedData","updateAdapter","handleSelect","selected","toggleAdapterSelection","handleRefreshAll","handleBatchEnable","successCount","batchToggleAdapters","selectedAdapters","r","clearAdapterSelection","handleBatchDisable","handleBatchDelete","batchDeleteAdapters","handleEditorClose","handleEditorSubmit","addAdapter","formRef","saving","formData","reactive","port","host","max_rate_pre_min","debug","originalData","rules","required","trigger","min","max","handleSave","validate","updateConfigSection","assign","clearValidate","serverConfig","server","fetchConfigSection","debugConfig","loadConfig","showAdminCode","showUserCode","beian","admin_code","user_code","full_screen","webConfig","web","showToken","token","admin_qq","validator","rule","callback","startsWith","plugins","detailDialogVisible","configDialogVisible","debugDialogVisible","currentPlugin","currentTool","pluginTools","configJsonStr","savingConfig","debugParams","debugResult","debugging","activeCollapseNames","enabledCount","p","totalToolsCount","reduce","sum","toolCount","customPluginsCount","loadPlugins","pluginAPI","listPlugins","reloading","toggling","handleRefreshPlugins","handleReloadAll","reloadAllPlugins","totalCount","handleReloadPlugin","reloadPlugin","displayName","handleSaveConfig","updatePluginConfig","catch","SyntaxError","fillExampleParams","parameters","properties","example","props","prop","enum","minimum","handleExecuteDebug","debugTool","togglePlugin","getPluginTools","g","group","getPluginConfig","tool"],"ignoreList":[],"sources":["../../../src/router/index.js","../../../src/views/ChatView.vue","../../../src/views/BlankView.vue","../../../src/views/HomeView.vue","../../../src/views/ProfileView.vue","../../../src/views/SettingsView.vue","../../../src/views/AuthView.vue","../../../src/views/settings/OverviewView.vue","../../../src/views/settings/LLMAdaptersView.vue","../../../src/views/settings/ServerConfigView.vue","../../../src/views/settings/WebConfigView.vue","../../../src/views/settings/OnebotConfigView.vue","../../../src/views/settings/PluginsView.vue"],"sourcesContent":["import { createRouter, createWebHistory } from \"vue-router\";\nimport { client } from \"@/lib/runtime.js\";\nimport { ElMessage } from \"element-plus\";\nconst ChatView = () => import(\"../views/ChatView.vue\");\nconst HomeView = () => import(\"../views/HomeView.vue\");\nconst ProfileView = () => import(\"../views/ProfileView.vue\");\nconst SettingsView = () => import(\"../views/SettingsView.vue\");\nconst AuthView = () => import(\"../views/AuthView.vue\");\nconst BlankView = () => import(\"../views/BlankView.vue\");\n\nconst router = createRouter({\n  history: createWebHistory(import.meta.env.BASE_URL),\n  routes: [\n    {\n      path: \"/\",\n      name: \"home\",\n      component: HomeView,\n      children: [\n        {\n          path: \"/\",\n          name: \"blank\",\n          component: BlankView,\n        },\n        {\n          path: \"/contactors\",\n          name: \"contactors\",\n          component: BlankView,\n        },\n        {\n          path: \"/chat/:id\",\n          name: \"chat_view\",\n          component: ChatView,\n        },\n        {\n          path: \"/profile/:id\",\n          name: \"profile_view\",\n          component: ProfileView,\n        },\n      ],\n    },\n    {\n      path: \"/auth\",\n      name: \"auth\",\n      component: AuthView,\n    },\n    {\n      path: \"/settings\",\n      name: \"settings\",\n      component: SettingsView,\n      redirect: \"/settings\",\n      children: [\n        {\n          path: \"\",\n          name: \"settings_overview\",\n          component: () => import(\"../views/settings/OverviewView.vue\"),\n        },\n        {\n          path: \"llm-adapters\",\n          name: \"settings_llm_adapters\",\n          component: () => import(\"../views/settings/LLMAdaptersView.vue\"),\n        },\n        {\n          path: \"server\",\n          name: \"settings_server\",\n          component: () => import(\"../views/settings/ServerConfigView.vue\"),\n        },\n        {\n          path: \"web\",\n          name: \"settings_web\",\n          component: () => import(\"../views/settings/WebConfigView.vue\"),\n        },\n        {\n          path: \"onebot\",\n          name: \"settings_onebot\",\n          component: () => import(\"../views/settings/OnebotConfigView.vue\"),\n        },\n        {\n          path: \"plugins\",\n          name: \"settings_plugins\",\n          component: () => import(\"../views/settings/PluginsView.vue\"),\n        },\n      ],\n    },\n  ],\n});\n\nrouter.beforeEach(async (to) => {\n  const everLogin = client.everLogin();\n  if (\n    // 检查用户是否已登录\n    !everLogin &&\n    // ❗️ 避免无限重定向\n    to.name !== \"auth\"\n  ) {\n    console.log(\n      `everLogin: ${everLogin} to.name!== auth: ${to.name !== \"auth\"}`,\n    );\n    ElMessage.warning(\"请先登录\");\n    // 把原本要去的地址 完整的传递给 login?redirect=\n    const query = to.path === \"/settings\" ? null : { redirect: to.fullPath };\n    return { name: \"auth\", query };\n  }\n});\n\nexport default router;\n","<script>\nimport ForwardMsg from \"@/components/ForwardMsg.vue\";\nimport InputEditor from \"@/components/InputEditor.vue\";\nimport FileBlock from \"@/components/FileBlock.vue\";\nimport ToolCallBar from \"@/components/ToolCallBar.vue\";\nimport ReasonBlock from \"@/components/ReasonBlock.vue\";\nimport ContextMenu from \"@/components/ContextMenu.vue\";\nimport MdRenderer from \"mio-previewer\";\nimport { mermaidPlugin, codeBlockPlugin, cursorPlugin, imageViewerPlugin } from 'mio-previewer/plugins/custom';\nimport { katexPlugin } from 'mio-previewer/plugins/markdown-it';\nimport \"emoji-picker-element\";\nimport html2canvas from \"html2canvas\";\nimport { client } from \"@/lib/runtime.js\";\nimport { shareOrCopy } from \"@/utils/tools.js\";\n\nexport default {\n  components: {\n    MdRenderer,\n    ContextMenu,\n    ForwardMsg,\n    InputEditor,\n    ToolCallBar,\n    FileBlock,\n    ReasonBlock,\n  },\n  data() {\n    let preview = false;\n    let shareId = undefined;\n    let contactor = undefined;\n    let scroll = true;\n\n    // 获取当前页面的URL\n    const currentUrl = window.location.href;\n    // 创建一个URL对象\n    const url = new URL(currentUrl);\n    // 获取URL参数\n    const params = url.searchParams;\n    // 检查URL参数是否有preview参数\n    if (params.has(\"preview\")) {\n      if (params.get(\"preview\") === \"true\") {\n        preview = true;\n      }\n    }\n    // 检查URL参数是否有shareId参数\n    if (params.has(\"shareId\")) {\n      shareId = params.get(\"shareId\");\n    }\n    if (params.has(\"scroll\")) {\n      scroll = params.get(\"scroll\") || \"true\";\n    }\n\n    const currentId = parseInt(this.$route.params.id);\n    try {\n      contactor = client.getContactor(currentId);\n      if (!contactor) {\n        throw new Error(\"找不到联系人\");\n      }\n    } catch (e) {\n      const defaultId = client.contactList[0].id;\n      this.$router.push({\n        path: `/chat/${defaultId}`,\n        query: {\n          preview,\n          shareId,\n        },\n      });\n      contactor = client.getContactor(defaultId);\n    }\n    const mioPlugins = [{\n      plugin: codeBlockPlugin,\n    },\n    {\n      plugin: mermaidPlugin,\n    },\n    {\n      plugin: cursorPlugin,\n      options: {\n        shape: 'circle'\n      }\n    },\n    {\n      plugin: imageViewerPlugin,\n    }\n    ]\n\n    return {\n      scroll,\n      preview,\n      shareId,\n      activeContactor: contactor,\n      showwindow: true,\n      showemoji: false,\n      userInput: \"\",\n      client: client,\n      extraOptions: [],\n      wraperPresets: {},\n      selectedOption: null,\n      currentDelay: 0,\n      toupdate: false,\n      seletedText: \"\",\n      seletedImage: \"\",\n      retryList: [],\n      showMenu: false,\n      menuTop: 0,\n      menuLeft: 0,\n      validMessageIndex: -1,\n      repliedMessageId: -1,\n      autoScroll: false,\n      fullScreen: false,\n      chatWindowRef: null,\n      prevScrollTop: 0,\n      showRollDown: false,\n      inputBarTop: 0,\n      clearMessageTip: \"以上的对话记录已清除\",\n      loadingIcon: \"<span id='message-loading-icon'></span>\",\n      katexPlugin,\n      mioPlugins\n    };\n  },\n  computed: {\n    getMenuStyle() {\n      // 判断屏幕宽度是否小于768px\n      if (window.innerWidth < 768) {\n        const basicHeight = 160;\n        // 检查向上是否超出屏幕高度\n        if (this.menuTop - basicHeight < 0) {\n          return {\n            top: basicHeight + \"px\",\n          };\n        }\n        return {\n          bottom: window.innerHeight - this.menuTop + 16 + \"px\",\n        };\n      } else {\n        // 长度超出屏幕宽度，就向左移动\n        if (this.menuLeft + 110 > window.innerWidth) {\n          return {\n            top: this.menuTop + \"px\",\n            left: this.menuLeft - 110 + \"px\",\n          };\n        } else {\n          return {\n            top: this.menuTop + \"px\",\n            left: this.menuLeft + \"px\",\n          };\n        }\n      }\n    },\n    getDelayStatus() {\n      return this.currentDelay > 1000\n        ? \"high\"\n        : this.currentDelay > 500\n          ? \"mid\"\n          : this.currentDelay > 100\n            ? \"low\"\n            : \"ultra\";\n    },\n    activeMessageChain() {\n      return this.activeContactor.options.presetSettings?.opening\n        ? [\n          {\n            role: \"other\",\n            content: [\n              {\n                type: \"text\",\n                data: {\n                  text: this.activeContactor.options.presetSettings.opening,\n                },\n              },\n            ],\n            time: this.activeContactor.createTime,\n          },\n          ...this.activeContactor.messageChain,\n        ]\n        : this.activeContactor.messageChain;\n    },\n  },\n  watch: {\n    [\"$route.params.id\"](newVal, oldVal) {\n      const currentId = parseInt(newVal);\n      const contactor = client.getContactor(currentId);\n      this.activeContactor = contactor;\n      this.initContactor(this.activeContactor);\n      if (this.chatWindowRef) this.toButtom();\n      if (oldVal) {\n        const oldId = parseInt(oldVal);\n        const oldContactor = client.getContactor(oldId);\n        this.disableContactor(oldContactor);\n      }\n    },\n  },\n  async mounted() {\n    document.addEventListener(\"click\", () => {\n      this.showMenu = false;\n      this.seletedText = \"\";\n      this.seletedImage = \"\";\n      // if( this.showemoji) this.showemoji = false;\n    });\n    this.chatWindowRef = this.$refs.chatWindow;\n    this.chatWindowRef.addEventListener(\"scroll\", this.scrollHandler);\n    if (!this.preview && this.scroll) this.toButtom();\n    this.scroll = true;\n    this.initContactor(this.activeContactor);\n    this.fullScreen = this.client.fullScreen;\n    // setInterval(() => {\n    //   this.currentDelay = this.client.socket.delay;\n    // }, 3000);\n    // 获取.input-bar在页面中的高度，给inputBarTop赋值\n    const element = document.querySelector(\".input-bar\");\n    if (element) {\n      // 获取页面高度\n      const pageHeight = window.innerHeight;\n      this.inputBarTop = pageHeight - element.offsetTop;\n      console.log(this.inputBarTop);\n    }\n\n\n    if (this.shareId) {\n      const loadAble = await client.loadOriginalContactors(this.shareId);\n      if (loadAble) {\n        this.$router.push({\n          path: \"/chat/\" + this.shareId,\n          query: {\n            preview: this.preview,\n            scroll: false,\n          },\n        });\n      } else {\n        this.$message({\n          message: \"分享链接已失效\",\n          type: \"error\",\n        });\n      }\n    }\n  },\n  updated() {\n    if (this.toupdate && this.autoScroll && this.retryList.length === 0) {\n      this.toButtom();\n      this.toupdate = false;\n    }\n  },\n  beforeUnmount() {\n    // 移除事件监听\n    this.disableContactor(this.activeContactor);\n    this.chatWindowRef.removeEventListener(\"scroll\", this.scrollHandler);\n  },\n  methods: {\n    handleMouseUp() {\n      const selectedText = window.getSelection().toString();\n      if (selectedText) {\n        this.seletedText = selectedText;\n        console.log(\"选中的文本：\" + selectedText);\n      }\n    },\n    toButtom(clicked) {\n      setTimeout(() => {\n        const scrollToBottom = () => {\n          const elm =\n            this.chatWindowRef ||\n            document.getElementById(\"main-messages-window\");\n          if (!elm) return;\n\n          // 使用平滑滚动 or 立即滚动\n          elm.scrollTo({\n            top: elm.scrollHeight,\n            behavior: clicked ? \"smooth\" : \"instant\",\n          });\n        };\n        scrollToBottom();\n      }, 1);\n    },\n    cleanScreen() {\n      this.activeContactor.messageChain = [];\n      this.activeContactor.updateFirstMessage();\n      client.setLocalStorage(); //持久化存储\n      this.activeContactor.emit(\"updateMessageSummary\");\n\n      this.toupdate = true;\n      this.$message({ message: \"已清除会话记录\", type: \"success\" });\n    },\n    cleanHistory() {\n      this.activeContactor.updateFirstMessage();\n      this.$message({\n        message: \"上下文信息已清除，之后的请求将不再记录上文记录\",\n        type: \"success\",\n      });\n      // 先看看之前有没有清除提示\n      for (let i = this.activeContactor.messageChain.length - 1; i >= 0; i--) {\n        const message = this.activeContactor.messageChain[i];\n        // role 为 \"mio_system\"\n        if (\n          message.role === \"mio_system\" &&\n          message.content[0].type === \"text\" &&\n          message.content[0].data.text === this.clearMessageTip\n        ) {\n          this.activeContactor.messageChain.splice(i, 1);\n        }\n      }\n      this.activeContactor.makeSystemMessage(this.clearMessageTip);\n      // 持久化\n      client.setLocalStorage();\n    },\n\n    delSystemMessage(index) {\n      const message = this.activeContactor.messageChain[index];\n      // 判断是否是清除提示\n      if (\n        message.content[0].type === \"text\" &&\n        message.content[0].data.text === this.clearMessageTip\n      ) {\n        this.activeContactor.firstMessageIndex = 0;\n      }\n      this.activeContactor.messageChain.splice(index, 1);\n      // 持久化\n      client.setLocalStorage();\n    },\n\n    isValidInput(input) {\n      // 使用正则表达式检查用户输入是否只包含换行符和空格\n      const regex = /^[ \\n]+$/;\n      const result = !regex.test(input);\n      return result;\n    },\n    waiting() {\n      this.$message({ message: \"此功能尚未开放\", type: \"warning\" });\n    },\n\n    tolist() {\n      this.$router.push({ name: \"home\" });\n    },\n\n    async setModel(list) {\n      const provider = list[0];\n      const model = list[2];\n      this.activeContactor.options.provider = provider;\n      this.activeContactor.options.base.model = model;\n      this.activeContactor.loadAvatar();\n      await client.setLocalStorage(); //持久化存储\n    },\n    toimg() {\n      // 使用html2canvas把 this.chatWindowRef 渲染为图片\n      const rect = this.chatWindowRef.getBoundingClientRect();\n      rect.height = this.chatWindowRef.scrollHeight;\n\n      html2canvas(this.chatWindowRef, {\n        windowHeight: rect.height * 1.2,\n        width: rect.width,\n        // 例如: allowTaint: true, backgroundColor: null\n      }).then((canvas) => {\n        // 将canvas转换为图片\n        const img = canvas.toDataURL(\"image/png\");\n        // 创建一个a标签，并设置下载属性和下载链接\n        const link = document.createElement(\"a\");\n        link.download = \"chat.png\";\n        link.href = img;\n        // 模拟点击下载\n        link.click();\n      });\n    },\n    async share() {\n      const shareResult = await client.shareContactor(\n        this.activeContactor.id,\n      );\n      if (shareResult && shareResult.shareUrl) {\n        const { shareUrl } = shareResult;\n        // 首先尝试调用分享api\n        const { success, message } = shareOrCopy(shareUrl);\n        if (success) {\n          this.$message({\n            message: message,\n            type: \"success\",\n          });\n        } else {\n          this.$message({\n            message: message,\n            type: \"error\",\n          });\n        }\n      }\n    },\n    hasOpening() {\n      return this.activeContactor.options.presetSettings?.opening\n        ? true\n        : false;\n    },\n    getFullMessages() {\n      return this.hasOpening()\n        ? [\n          {\n            role: \"other\",\n            content: [\n              {\n                type: \"text\",\n                data: {\n                  text: this.activeContactor.options.presetSettings.opening,\n                },\n              },\n            ],\n            time: this.activeContactor.createTime,\n          },\n          ...this.activeContactor.messageChain,\n        ]\n        : this.activeContactor.messageChain;\n    },\n    showTime(index) {\n      const list = this.getFullMessages();\n      const thisTime = list[index].time;\n      if (index === 0) {\n        return {\n          show: true,\n          time: this.activeContactor.getShownTime(thisTime),\n        };\n      } else {\n        const earlyTime = list[index - 1].time;\n        if (thisTime - earlyTime > 600000) {\n          return {\n            show: true,\n            time: this.activeContactor.getShownTime(thisTime),\n          };\n        } else {\n          return {\n            show: false,\n            time: \"\",\n          };\n        }\n      }\n    },\n    separateTextAndImages(markdownText) {\n      // 使用正则表达式匹配Markdown图片格式\n      const regex = /!\\[([^\\]]*)\\]\\((.*)\\)/g;\n      let result = [];\n      let lastIndex = 0;\n\n      // 查找所有匹配的图片\n      let matches;\n      while ((matches = regex.exec(markdownText)) !== null) {\n        // 处理匹配到的文本部分\n        if (matches.index > lastIndex) {\n          const textContent = markdownText\n            .slice(lastIndex, matches.index)\n            .trim();\n          if (textContent) {\n            result.push({\n              type: \"text\",\n              data: {\n                text: textContent,\n              },\n            });\n          }\n        }\n\n        // 处理匹配到的图片部分\n        result.push({\n          type: \"image\",\n          data: {\n            // file: matches[2].length > 200 ? matches[2] : `/api/proxy?url=${matches[2]}`,\n            file: matches[2],\n          },\n        });\n\n        // 更新lastIndex到当前匹配结束的位置\n        lastIndex = regex.lastIndex;\n      }\n\n      // 处理最后一部分文本（如果有的话）\n      if (lastIndex < markdownText.length) {\n        const textContent = markdownText.slice(lastIndex).trim();\n        if (textContent) {\n          result.push({\n            type: \"text\",\n            data: {\n              text: textContent,\n            },\n          });\n        }\n      }\n\n      return result;\n    },\n\n    getChatwindowScrollheight() {\n      var scrollTop = this.chatWindowRef.scrollTop; // 当前滚动条的垂直位置\n      var clientHeight = this.chatWindowRef.clientHeight; // 可视区域高度\n      var scrollHeight = this.chatWindowRef.scrollHeight; // 内容总高度\n\n      // 计算滚动位置的实际像素长度\n      var scrollPercentage = scrollTop / (scrollHeight - clientHeight);\n      var height = scrollPercentage * scrollHeight;\n\n      return scrollHeight - height;\n    },\n\n    initContactor(contactor) {\n      contactor.active = true;\n\n      contactor.on(\"revMessage\", (message) => {\n        this.activeContactor.messageChain.push(message);\n        this.toupdate = true;\n      });\n      contactor.on(\"delMessage\", (index) => {\n        console.log(`删除消息${index}`);\n        // 从消息链中删除消息\n        this.activeContactor.messageChain.splice(index, 1);\n        this.toupdate = true;\n      });\n\n      contactor.on(\"updateMessage\", () => {\n        this.$forceUpdate();\n        this.toupdate = true;\n        client.setLocalStorage(); //持久化存储\n      });\n\n      contactor.on(`completeMessage`, async (e) => {\n        const messageId = e.messageId;\n        const rawMessage = this.activeContactor.getMessageById(messageId);\n\n        if (this.retryList.includes(messageId)) {\n          this.retryList = this.retryList.filter((item) => item !== messageId);\n        }\n\n        rawMessage.content.forEach((element, index) => {\n          if (\n            element.type === \"text\" &&\n            this.activeContactor.platform === \"onebot\"\n          ) {\n            const formatedMessage = this.separateTextAndImages(\n              element.data.text,\n            );\n            // 把 formatedMessage 里的元素展开到 index 这个位置\n            rawMessage.content.splice(index, 1, ...formatedMessage);\n          }\n        });\n\n        this.toupdate = true;\n        this.$forceUpdate();\n        this.activeContactor.loadName();\n        client.setLocalStorage(); //持久化存储\n        console.log(e);\n      });\n    },\n    disableContactor(contactor) {\n      if (contactor) {\n        contactor.active = false;\n        contactor.off(`updateMessage`);\n        contactor.off(`revMessage`);\n        contactor.off(`delMessage`);\n        contactor.off(`completeMessage`);\n      }\n    },\n    getReplyText(id) {\n      let content = \"\";\n      const message = this.activeContactor.messageChain.find(\n        (item) => item.id === id || String(item.id) === String(id),\n      );\n      if (message) {\n        message.content.forEach((element) => {\n          if (element.type === \"text\") {\n            content += element.data.text;\n          } else if (element.type === \"image\") {\n            content += \"[图片]\";\n          }\n        });\n        // if (content.length > 20) {\n        //   return `${content.substr(0, 20)}...`;\n        // } else {\n        //   return `${content}`;\n        // }\n        return content.trim().slice(0, 20);\n      } else {\n        console.log(\"用户引用的消息不存在\");\n        // 打印消息列表和索引的id\n        console.log(this.activeContactor.messageChain);\n        console.log(\"引用的消息id：\" + id);\n        return \"[消息已删除] \";\n      }\n    },\n    imageLoaded() {\n      this.scroll && this.toButtom();\n    },\n    showMessageMenu(event, messageIndex) {\n      // 确定右击的元素类型\n      if (event.target.tagName.toLowerCase() === \"img\") {\n        const imgElement = event.target;\n        const imgSrc = imgElement.src;\n        this.seletedImage = imgSrc;\n      } else {\n        console.log(\"用户右击了非图片元素\");\n      }\n      this.validMessageIndex =\n        this.activeContactor.platform === \"openai\" && this.hasOpening()\n          ? messageIndex - 1\n          : messageIndex;\n      event.preventDefault();\n      this.showMenu = true;\n      this.menuTop = event.clientY;\n      this.menuLeft = event.clientX;\n\n      const currentSelectedText = window.getSelection().toString();\n      if (currentSelectedText) {\n        this.seletedText = currentSelectedText;\n      } else {\n        this.seletedText = \"\";\n      }\n    },\n    toProfile() {\n      this.$router.push({\n        name: \"profile_view\",\n        params: {\n          id: this.activeContactor.id,\n        },\n      });\n      // 弹出维护提示\n      // this.$message({\n      //   message: \"此功能正在维护中\",\n      //   type: \"warning\",\n      // });\n    },\n    scrollHandler() {\n      // 获取当前的 scrollTop\n      const currentScrollTop = this.chatWindowRef.scrollTop;\n\n      // 判断滚动方向\n      // 如果当前 scrollTop 大于上一次的 scrollTop，说明是向下滑动\n      const isScrollingDown = currentScrollTop > this.prevScrollTop;\n      // 如果当前 scrollTop 小于上一次的 scrollTop，说明是向上滑动\n      const isScrollingUp = currentScrollTop < this.prevScrollTop;\n      // 如果相等，通常意味着没有实际的滚动位移，或者是一些内部事件\n\n      // 更新上一次的 scrollTop 为当前值，为下一次滚动做准备\n      this.prevScrollTop = currentScrollTop;\n\n      // --- 你原有的逻辑 (现在你可以根据需要使用 isScrollingDown 或 isScrollingUp) ---\n      this.showMenu = false; // 隐藏菜单\n      if (this.showemoji) this.showemoji = false; // 隐藏表情\n\n      const scrollHeight = this.getChatwindowScrollheight(); // 获取总滚动高度\n\n      this.autoScroll = scrollHeight > 100 ? false : true;\n\n      const isAtBottom = scrollHeight <= 200 - 1; // 留一个小的容差，避免浮点数问题\n\n      if (isScrollingDown && !this.autoScroll && !isAtBottom) {\n        this.showRollDown = true;\n      } else if (isScrollingUp || this.autoScroll || isAtBottom) {\n        this.showRollDown = false;\n      }\n    },\n    getseletedMessage() {\n      return this.activeContactor.messageChain[this.validMessageIndex];\n    },\n    handleMessageOption(option) {\n      const message = this.getseletedMessage();\n      switch (option) {\n        case \"retry\":\n          if (this.activeContactor.platform === \"onebot\") {\n            // 重新发送一样的消息\n            if (message.role === \"user\") {\n              this.activeContactor.webSend(message);\n            } else {\n              this.activeContactor.webSend({\n                ...message,\n                role: \"user\",\n              });\n            }\n            this.$message({ message: \"消息已重新发送\", type: \"success\" });\n          } else {\n            const targetIndex =\n              message.role === \"user\"\n                ? this.validMessageIndex + 1\n                : this.validMessageIndex;\n\n            let validMessage = this.activeContactor.messageChain[targetIndex];\n            if (!validMessage || validMessage.role !== \"other\") {\n              // 是用户发送且下一条消息被删除,先插入一条空消息\n              const baseContainer = this.activeContactor.getBaseUserContainer();\n              baseContainer.role = \"other\";\n              this.activeContactor.insertMessage(baseContainer, targetIndex);\n              validMessage = baseContainer;\n            }\n            if (validMessage.status === \"retrying\") {\n              this.$message({\n                message: \"该消息正在重试中\",\n                type: \"warning\",\n              });\n              return;\n            }\n            this.activeContactor.retryMessage(validMessage.id);\n            validMessage.status = \"retrying\";\n            this.retryList.push(validMessage.id);\n          }\n          this.toButtom();\n          break;\n        case \"reply\":\n          if (this.activeContactor.platform === \"onebot\") {\n            this.repliedMessageId = message.id;\n            this.$message({ message: \"已引用该消息\", type: \"success\" });\n          } else {\n            this.userInput +=\n              this.getReplyText(\n                this.activeContactor.messageChain[this.validMessageIndex].id,\n              ) + \"\\n\\n\";\n          }\n          break;\n        case \"delete\":\n          this.activeContactor.messageChain.splice(this.validMessageIndex, 1);\n          client.setLocalStorage();\n          break;\n        default:\n          break;\n      }\n    },\n  },\n};\n</script>\n\n<template>\n  <div id=\"chat-window\">\n    <div class=\"upside-bar\">\n      <div class=\"return\" @click=\"tolist()\">\n        <i class=\"iconfont icon-return\"></i>\n      </div>\n      <div class=\"name-area\" @click=\"toProfile\">\n        <div class=\"contactor-name\">{{ activeContactor.name }}</div>\n        <span :class=\"'delay-status ' + getDelayStatus\"></span>\n        <span class=\"delay-num\">当前延迟: {{ currentDelay }} ms</span>\n      </div>\n      <ul class=\"options\">\n        <li class=\"share\" @click=\"share()\">\n          <i class=\"iconfont icon-share\"></i>\n        </li>\n      </ul>\n    </div>\n    <div id=\"main-messages-window\" ref=\"chatWindow\" :class=\"{\n      'message-window': true,\n      preview: preview,\n    }\">\n      <div v-if=\"showRollDown\" id=\"roll-buttom-button\" :style=\"{ bottom: inputBarTop + 24 + 'px' }\"\n        @click=\"toButtom(true)\">\n        <i class=\"iconfont down1\"></i>\n      </div>\n      <ContextMenu v-show=\"showMenu\" type=\"message\" :message=\"getseletedMessage()\" :seleted-text :seleted-image\n        :style=\"getMenuStyle\" @message-option=\"handleMessageOption\" @close=\"showMenu = false\" />\n      <div v-for=\"(item, index) of activeMessageChain\" :key=\"`${activeContactor.id}-${item.id}`\" ref=\"message\"\n        class=\"message-container\">\n        <div v-if=\"showTime(index).show\" class=\"message-time\">\n          {{ showTime(index).time }}\n        </div>\n        <div :id=\"item.role\" class=\"message-body\">\n          <div v-if=\"item.role !== 'mio_system'\" class=\"avatar\">\n            <img v-if=\"item.role === 'other'\" :src=\"activeContactor.avatar\" :alt=\"activeContactor.name\"\n              @click=\"toProfile\" />\n            <img v-else :src=\"client.avatar\" :alt=\"client.name\" />\n          </div>\n          <div v-if=\"item.role !== 'mio_system'\" class=\"msg\">\n            <div class=\"wholename\">\n              <div v-if=\"\n                item.role === 'other' ? activeContactor.title : client.title\n              \" class=\"title\">\n                {{\n                  item.role === \"other\" ? activeContactor.title : client.title\n                }}\n              </div>\n              <div class=\"name\">\n                {{ item.role === \"other\" ? activeContactor.name : client.name }}\n              </div>\n            </div>\n            <div :class=\"['content', item.status]\" @mouseup=\"handleMouseUp\"\n              @contextmenu=\"showMessageMenu($event, index)\">\n              <div v-for=\"(element, elmIndex) of item.content\" :key=\"elmIndex\" class=\"inner-content\">\n                <MdRenderer v-if=\"element.type === 'text'\" :md=\"element.data.text\" :theme=\"'github'\" :isStreaming=\"['pending', 'retrying'].includes(item.status) &&\n                  item.content.length - 1 === elmIndex\n                  \" :custom-plugins=\"mioPlugins\" :markdown-it-plugins=\"[{ plugin: katexPlugin }]\"\n                  :markdown-it-options=\"{ breaks: activeContactor.platform === 'onebot' }\" />\n                <MdRenderer v-if=\"element.type === 'image'\" :md=\"`![image](${element.data.file})`\"\n                  :custom-plugins=\"mioPlugins\" :theme=\"'github'\" :key=\"element.data.file\" />\n                <div v-else-if=\"element.type === 'reply'\" class=\"reply-block\">\n                  {{ getReplyText(element.data.id) }}\n                </div>\n                <ForwardMsg v-else-if=\"element.type === 'nodes'\" :contactor=\"activeContactor\"\n                  :messages=\"element.data.messages\" />\n                <FileBlock v-else-if=\"element.type === 'file'\" :file-url=\"element.data.file\" />\n                <span v-else-if=\"element.type === 'at'\" />\n                <ReasonBlock v-else-if=\"element.type === 'reason'\" :end-time=\"element.data.endTime\"\n                  :start-time=\"element.data.startTime\" :content=\"element.data.text\" />\n                <div v-else-if=\"element.type === 'blank'\" class=\"blank-message\"\n                  style=\"width: 10rem; height: 28.8px; position: relative\">\n                  <span class=\"blank-loader\"></span>\n                </div>\n                <ToolCallBar v-else-if=\"element.type === 'tool_call'\" :tool-call=\"element.data\" />\n              </div>\n            </div>\n          </div>\n          <div v-else class=\"system-message\">\n            <div class=\"system-message-content\">\n              {{ item.content[0].data.text }}\n            </div>\n            <div class=\"system-message-button\">\n              <i class=\"iconfont close\" @click=\"delSystemMessage(index)\"></i>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n    <InputEditor ref=\"inputEditor\" :active-contactor :replied-message-id @stroge=\"client.setLocalStorage()\"\n      @set-model=\"setModel\" @clean-screen=\"cleanScreen\" @clean-history=\"cleanHistory\" @to-buttom=\"toButtom\" />\n  </div>\n</template>\n\n<style lang=\"sass\" scoped>\n$mobile: 600px\n$icon-hover: #09f\n\n.preview\n    position: fixed\n    top: 0\n    left: 0\n    width: 100vw\n    height: 100vh\n    z-index: 10000\n\n#chat-window\n    z-index: 1\n    min-width: 0.0625rem\n    position: relative\n    display: flex\n    flex-grow: 1\n    background-color: #f2f2f2\n    flex-direction: column\n\n    @media (max-width: $mobile)\n        height: 100%\n\n.upside-bar\n    flex-basis: 4rem\n    flex-shrink: 0\n    width: 100%\n    display: flex\n    align-items: flex-end\n    justify-content: flex-start\n    border-bottom: 0.0625rem solid #ebebeb\n    -webkit-app-region: drag\n\n    @media (max-width: $mobile)\n      position: fixed\n      height: 4rem\n      z-index: 1000\n      background-color: hsla(0, 0%, 100%, 0.8)\n      backdrop-filter: blur(0.5rem)\n\n    .return\n        display: none\n\n        &:hover\n            color: $icon-hover\n\n        @media (max-width: $mobile)\n            display: block\n            margin-left: 1rem\n            margin-bottom: .8rem\n\n    .name-area\n        cursor: pointer\n        position: relative\n        display: flex\n        align-items: center\n        flex-basis: 10rem\n        flex-grow: 1\n        justify-content: flex-start\n        margin: 0 0 .5rem 1rem\n\n        .contactor-name\n            text-overflow: ellipsis\n            white-space: nowrap\n            overflow: hidden\n            max-width: 10rem\n\n        .delay-status\n            width: .8rem\n            height: .8rem\n            border-radius: 50%\n            margin-left: .5rem\n            position: relative\n            top: .2rem\n\n            @media screen and (max-width: $mobile)\n              display: none\n\n\n            &:hover + .delay-num\n                display: inline-block\n\n            &.ultra\n                background-color: rgb(53, 233, 146)\n\n            &.low\n                background-color: rgb(255, 204, 0)\n\n            &.mid\n                background-color: rgb(255, 102, 102)\n\n            &.high\n                background-color: #ccc\n\n        .delay-num\n            display: none\n            position: absolute\n            font-size: 0.8rem\n            bottom: 0rem\n            background-color: #fff\n            border: 1px dashed #000\n            border-radius: 0.25rem\n            padding: 0.125rem 0.25rem\n            margin-left: 1rem\n            white-space: nowrap\n\n    .options\n        flex-basis: 10rem\n        display: flex\n        height: 2rem\n        flex-wrap: nowrap\n        flex-direction: row-reverse\n        align-items: flex-end\n        margin: 0 1rem .5rem 0\n\n        li\n            margin-left: 0.5rem\n            color: #000\n            font-weight: 580\n\n            &:hover\n              color: $icon-hover\n\n            i\n                font-size: 1.25rem\n\n\n.black-overlay\n    position: fixed\n    top: 0\n    left: 0\n    width: 100%\n    height: 100%\n    background-color: rgba(0, 0, 0, 0.4)\n    z-index: 1001\n/* z-index 属性设置元素的堆叠顺序。*/\n\n#roll-buttom-button\n    position: fixed\n    right: 0.5rem\n    cursor: pointer\n    display: flex\n    z-index: 1000\n    background-color: #fff\n    width: 4rem\n    height: 1.5rem\n    border-radius: 0.75rem\n    align-items: center\n    justify-content: center\n    box-shadow: 0 0 0.25rem rgba(0, 0, 0, 0.2)\n    transition: background-color 0.3s ease, transform 0.3s ease\n    &:hover\n        background-color: #f0f0f0\n        transform: scale(1.1)\n\n    &:hover\n        color: $icon-hover\n    i\n        font-size: 1rem\n\n#theimg\n    position: fixed\n    top: 50%\n    left: 50%\n    transform: translate(-50%, -50%)\n    max-height: 75%\n    max-width: 50%\n.inner-content\n  display: flex\n\n.background img\n    position: absolute\n    top: 50%\n    left: 50%\n    transform: translate(-50%, -50%)\n\n.message-body > .avatar\n  cursor: pointer\n  flex-basis: 2.65rem\n  min-width: 2.65rem\n  height: 2.65rem\n\n\n.avatar > img\n  width: 100%\n  height: 100%\n  border-radius: 50%\n\n\n.window-controls\n    display: flex\n    flex-basis: 100%\n\n    @media (max-width: $mobile)\n        display: none\n\n    .button\n        display: flex\n        justify-content: center\n        padding-top: 0.5rem\n        flex: 0 0 2rem\n\n        &:hover\n            background-color: rgb(231, 231, 231)\n\n        &#close:hover\n            background-color: rgb(255, 0, 0)\n            color: white\n\n\n.button#close:hover svg path\n    fill: #fff\n\n\n.voice-box\n    display: flex\n    width: 11.25rem\n    height: 1.5rem\n    margin: 0.25rem 0\n\n    .icon\n        flex-basis: 1.5rem\n        background-color: rgb(0, 0, 0)\n        display: flex\n        justify-content: center\n        align-items: center\n        border-radius: 50%\n\n    .wave\n        display: flex\n        justify-content: center\n        align-items: center\n        flex-grow: 1\n\n.wave svg\n    height: 1.25rem\n    width: 80%\n\n.loader\n    width: 0.625rem\n    padding: 0.25rem\n    aspect-ratio: 1\n    border-radius: 50%\n    background: rgb(0, 153, 255)\n    --_m: conic-gradient(#0000 10%, #000), linear-gradient(#000 0 0) content-box\n    -webkit-mask: var(--_m)\n    mask: var(--_m)\n    -webkit-mask-composite: source-out\n    mask-composite: subtract\n    animation: l3 1s infinite linear\n    position: absolute\n\n@keyframes move\n    0%\n        left: -20% // 开始位置\n    100%\n        left: 120% // 结束位置\n\n.blank-loader\n    width: 10%\n    height: 200%\n    position: absolute\n    background: linear-gradient(to right, rgb(255, 255, 255), rgb(0, 0, 0) 50%, transparent 50%, transparent)\n    top: -50%\n    transform: rotate(30deg)\n    filter: blur(5px)\n    animation: move 1s linear infinite // 每1s循环\n\n@keyframes l\n    to\n        transform: rotate(1turn)\n\n@media (max-width: 600px)\n    #chatwindow\n        height: 100%\n\n    .upsidebar\n        white-space: nowrap\n        max-width: 7rem\n        text-overflow: ellipsis\n        overflow: hidden\n        background: #00a8ff linear-gradient(to right, #00d2f8, #00a8ff)\n\n    .upsidebar *\n        color: white\n        fill: white\n\n    .delay-num\n        color: black\n\n    .window-controls\n        display: none\n\n    .name-area\n        padding-bottom: 0.25rem\n\n    .input-area\n        overflow-y: auto\n\n    .inputbar\n        flex-basis: 4rem\n\n    .delay-status\n        position: relative\n        top: -.2rem\n</style>\n","<template>\n  <div class=\"blank-view\">\n    <div class=\"upside-bar\">\n      <div class=\"options\"></div>\n    </div>\n  </div>\n</template>\n<script>\nimport { client } from \"@/lib/runtime.js\";\n\nexport default {\n  name: \"BlankView\",\n  data() {\n    return {\n      fullScreen: false,\n      client: client,\n    };\n  },\n  watch: {},\n  created() {\n    this.fullScreen = client.fullScreen;\n  },\n  methods: {\n    waiting() {\n      this.$message({ message: \"此功能尚未开放\", type: \"warning\" });\n    },\n  },\n};\n</script>\n<style lang=\"sass\" scoped>\n.blank-view\n  background-color: #f2f2f2\n  flex-grow: 1\n\n.upside-bar\n    flex-basis: 3.75rem\n    flex-shrink: 0\n    height: 3.75rem\n    width: 100%\n    display: flex\n    align-items: flex-end\n    flex-direction: row-reverse\n    justify-content: space-between\n\n    .options\n        flex-basis: 6rem\n        display: flex\n        height: 100%\n        width: 100%\n        flex-wrap: wrap\n        flex-direction: row-reverse\n</style>\n","<template>\n  <div v-if=\"!onPhone\" id=\"main\">\n    <friendlist></friendlist>\n    <router-view v-if=\"loaded\"></router-view>\n    <blankView v-else></blankView>\n  </div>\n  <div v-else-if=\"pagePath === '/'\" id=\"main-mobile\">\n    <friendlist v-if=\"loaded\"></friendlist>\n    <blankView v-else></blankView>\n  </div>\n  <div v-else id=\"main-mobile\" class=\"mobile-chat\">\n    <router-view v-if=\"loaded\"></router-view>\n    <blankView v-else></blankView>\n  </div>\n</template>\n\n<script>\nimport friendlist from \"@/components/FriendList.vue\";\nimport { client } from \"@/lib/runtime.js\";\nimport blankView from \"@/views/BlankView.vue\";\n\nexport default {\n  components: {\n    friendlist,\n    blankView,\n  },\n  data() {\n    const onPhone = window.innerWidth < 600;\n    return {\n      onPhone,\n      pagePath: this.$route.path,\n      loaded: false,\n    };\n  },\n  watch: {\n    $route: function (newVal) {\n      this.pagePath = newVal.path;\n    },\n  },\n  mounted() {\n    if (client.inited) {\n      this.loaded = true;\n    } else {\n      client.on(\n        \"loaded\",\n        () => {\n          this.loaded = true;\n        },\n        false,\n      );\n    }\n  },\n};\n</script>\n\n<style>\n#main {\n  background-color: rgb(255, 255, 255);\n  flex-grow: 1;\n  display: flex;\n  width: calc(100% - 4.5rem);\n  background-color: #f2f2f2;\n}\n\n#main > .profile-body {\n  margin-top: 4rem;\n}\n\n#main-mobile {\n  width: 100%;\n  max-height: calc(100vh - 4rem);\n  background-color: rgb(255, 255, 255);\n  flex-grow: 1;\n  display: flex;\n}\n\n.mobile-chat#main-mobile {\n  max-height: 100%;\n}\n</style>\n","<template>\n  <div class=\"profile-body\">\n    <div id=\"profile\">\n      <div class=\"profile-container\">\n        <div class=\"base-info\">\n          <div class=\"base-info-avatar\">\n            <el-image\n              :src=\"activeContactor.avatar\"\n              :preview-src-list=\"[activeContactor.avatar]\"\n            />\n          </div>\n          <div class=\"base-info-content\">\n            <div class=\"name\">{{ activeContactor.name }}</div>\n            <div class=\"id\">ID {{ activeContactor.id }}</div>\n            <div class=\"status\">\n              <span :class=\"'delay-status ' + getDelayStatus\"></span>\n              在线\n            </div>\n          </div>\n          <!-- LLM Provider select is now inside ContactorSettings -->\n        </div>\n\n        <div class=\"info-blocks\">\n          <div class=\"settings-block\">\n            <div class=\"block-title\">Bot 基本配置</div>\n            <div class=\"block-content\">\n              <div class=\"block-content-item\">\n                <div class=\"item-title\">昵称</div>\n                <div class=\"item-content\">\n                  <el-input\n                    v-model=\"basicInfo.name\"\n                    :disabled=\"basicInfo.namePolicy !== 1\"\n                  ></el-input>\n                </div>\n              </div>\n              <div class=\"block-content-item\">\n                <div class=\"item-title\">头像</div>\n                <div class=\"item-content\">\n                  <el-input \n                    v-if=\"basicInfo.avatarPolicy !== 1\"\n                    :value=\"'跟随模型'\"\n                    :disabled=\"true\"\n                  ></el-input>\n                  <el-input \n                    v-else\n                    v-model=\"basicInfo.avatar\"\n                    :disabled=\"isOnebot\"\n                  ></el-input>\n                </div>\n              </div>\n              <div v-if=\"!isOnebot\" class=\"block-content-item\">\n                <div class=\"item-title\">头像策略</div>\n                <div class=\"item-content\">\n                  <el-select v-model=\"basicInfo.avatarPolicy\"\n                  @change=\"updateContactorAvatar\"\n                  >\n                    <el-option\n                      v-for=\"item in avatarPolicyList\"\n                      :key=\"item.value\"\n                      :label=\"item.label\"\n                      :value=\"item.value\"\n                    />\n                  </el-select>\n                </div>\n              </div>\n              <div v-if=\"!isOnebot\" class=\"block-content-item\">\n                <div class=\"item-title\">昵称策略</div>\n                <div class=\"item-content\">\n                  <el-select\n                    v-model=\"basicInfo.namePolicy\"\n                    @change=\"updateContactorName\"\n                  >\n                    <el-option\n                      v-for=\"item in namePolicyList\"\n                      :key=\"item.value\"\n                      :label=\"item.label\"\n                      :value=\"item.value\"\n                    />\n                  </el-select>\n                </div>\n              </div>\n              <div class=\"block-content-item\">\n                <div class=\"item-title\">会话置顶</div>\n                <div class=\"item-content\">\n                  <el-switch v-model=\"basicInfo.priority\"> </el-switch>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n\n        <div class=\"info-blocks\">\n          <ContactorSettings\n            v-if=\"!isOnebot\"\n            v-model:model-value=\"options\"\n            :active-contactor-platform=\"activeContactor.platform\"\n            :llm-providers-list=\"llmProviders\"\n            :tool-call-modes-list=\"toolCallModes\"\n            :all-llm-tools-data=\"allLLMTools\"\n            :safety-settings-params=\"safetyParams\"\n            :safety-simple-value-options=\"safetySimpleValue\"\n            :presets-history-data=\"options.presetSettings?.history\"\n            @provider-changed=\"handleProviderSwitched\"\n            @update-presets=\"handleUpdateOpenaiPresets\"\n          />\n        </div>\n      </div>\n    </div>\n    <div class=\"action-bar\">\n      <el-button plain @click=\"$router.push(`/chat/${activeContactor.id}`)\">\n        发送消息\n      </el-button>\n      <el-button type=\"danger\" plain @click=\"centerDialogVisible = true\">\n        删除好友\n      </el-button>\n      <el-dialog v-model=\"centerDialogVisible\" title=\"警告\" width=\"300\" center>\n        <span> 确认要删除此好友吗？该操作不可逆。 </span>\n        <template #footer>\n          <div class=\"dialog-footer\">\n            <el-button @click=\"centerDialogVisible = false\">取消</el-button>\n            <el-button type=\"primary\" @click=\"delContactor\"> 确认 </el-button>\n          </div>\n        </template>\n      </el-dialog>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { client, config } from \"@/lib/runtime.js\";\nimport ContactorSettings from \"@/components/ContactorSettings.vue\"; // Import the new component\n\nexport default {\n  components: {\n    ContactorSettings, // Register the new component\n  },\n  data() {\n    const currentId = parseInt(this.$route.params.id);\n    const contactor = client.getContactor(currentId);\n\n    const toolCallModes = config.getToolCallModes();\n    const providers = config.getLLMProviders();\n    const safetyParams = config.getSafetySettingsParams();\n    const safetySimpleValue = Object.keys(safetyParams).map((key) => ({\n      value: key,\n      label: key,\n    }));\n\n    // Initial construction of allLLMTools remains here as it depends on global config\n    const allLLMTools = [];\n    for (const key in config.llmTools) {\n      const toolsObject = config.llmTools[key];\n      const toolsList = Object.keys(toolsObject).map((toolKey) => ({\n        enabled: false, // Initial state, child component will sync with options\n        ...toolsObject[toolKey],\n      }));\n      allLLMTools.push({\n        name: key,\n        tools: toolsList,\n        collapsed: true,\n      });\n    }\n    const avatarPolicyList = [\n      { value: 0, label: \"跟随模型\" },\n      { value: 1, label: \"自定义\" },\n    ];\n    const namePolicyList = [\n      { value: 0, label: \"跟随模型\" },\n      { value: 1, label: \"自定义\" },\n      { value: 2, label: \"对话摘要\" },\n    ];\n\n    return {\n      activeContactor: contactor,\n      options: null, // Will be initialized in initContactor\n      currentDelay: 0,\n      centerDialogVisible: false,\n      avatarPolicyList: avatarPolicyList,\n      namePolicyList: namePolicyList,\n      isOnebot: contactor.platform === \"onebot\",\n\n      // Static config passed as props\n      llmProviders: providers,\n      toolCallModes: toolCallModes,\n      safetyParams: safetyParams,\n      safetySimpleValue: safetySimpleValue,\n      allLLMTools: allLLMTools, // This structure is passed to child\n      basicInfo: null,\n    };\n  },\n  computed: {\n    getDelayStatus() {\n      return this.currentDelay > 1000\n        ? \"high\"\n        : this.currentDelay > 500\n          ? \"mid\"\n          : this.currentDelay > 100\n            ? \"low\"\n            : \"ultra\";\n    },\n    getAvatarPolicyValue() {\n      return this.basicInfo.avatarPolicy === 1 ? \"自定义\" : \"跟随模型\";\n    },\n  },\n  watch: {\n    \"$route.params.id\"(newVal) {\n      const newId = parseInt(newVal);\n      this.activeContactor = client.getContactor(newId);\n      if (this.activeContactor) {\n        this.isOnebot = this.activeContactor.platform === \"onebot\";\n      }\n      this.initContactor();\n    },\n    options: {\n      handler(newOptions) {\n        if (newOptions && this.activeContactor) {\n          // Sync back to the source of truth\n          this.activeContactor.options = JSON.parse(JSON.stringify(newOptions));\n          client.setLocalStorage();\n        }\n      },\n      deep: true,\n    },\n    basicInfo: {\n      handler(newInfo) {\n        if (newInfo && this.activeContactor) {\n          // Sync back to the source of truth\n          this.activeContactor.name = newInfo.name;\n          this.activeContactor.avatar = newInfo.avatar;\n          this.activeContactor.namePolicy = newInfo.namePolicy;\n          this.activeContactor.avatarPolicy = newInfo.avatarPolicy;\n          this.activeContactor.priority = newInfo.priority ? 0 : 1;\n          client.setLocalStorage();\n        }\n      },\n      deep: true,\n    },\n  },\n  created() {\n    // Use created instead of beforeMount for data initialization\n    this.initContactor();\n  },\n  mounted() {\n    this.delayInterval = setInterval(() => {\n      this.currentDelay = client.socket.delay;\n    }, 3000);\n  },\n  beforeUnmount() {\n    if (this.delayInterval) {\n      clearInterval(this.delayInterval);\n    }\n  },\n  methods: {\n    initContactor() {\n      // Deep clone options to avoid direct mutation of contactor's options by child\n      // The watcher on `this.options` will handle persisting changes.\n      this.options = JSON.parse(JSON.stringify(this.activeContactor.options));\n\n      const { name, avatar, namePolicy, avatarPolicy, priority } =\n        this.activeContactor;\n      this.basicInfo = {\n        name,\n        avatar,\n        namePolicy,\n        avatarPolicy,\n        priority: priority === 1 ? false : true,\n      };\n\n      // If contactor platform is onebot, tool call related options might need to be forced\n      if (this.activeContactor.platform === \"onebot\") {\n        if (this.options.toolCallSettings) {\n          this.options.toolCallSettings.mode = \"none\";\n          this.options.toolCallSettings.tools = [];\n        }\n      }\n      // The child component `ContactorSettings` will use this.options\n      // to initialize its internal state.\n    },\n    handleUpdateOpenaiPresets(presets) {\n      if (this.options && this.options.presetSettings) {\n        this.options.presetSettings.history = presets;\n        // The watcher on `this.options` will trigger saving\n        this.$message({\n          message: \"预设历史记录已更新\",\n          type: \"success\",\n        });\n      }\n    },\n    async delContactor() {\n      this.centerDialogVisible = false;\n      await client.rmContactor(this.activeContactor.id);\n      this.$router.push(\"/\");\n    },\n    handleProviderSwitched(newProvider) {\n      // This event is specifically for actions parent needs to take,\n      // like reloading avatar, that are outside the 'options' object.\n      this.activeContactor.loadAvatar();\n      // The options object (including provider and default model)\n      // would have already been updated by the child component via v-model.\n    },\n    getBaseInfoShownValue(value) {\n      const table = {};\n    },\n    updateContactorName() {\n      if (this.basicInfo.namePolicy === 0) {\n        this.basicInfo.name = this.activeContactor.options.base.model;\n      }\n    },\n    updateContactorAvatar() {\n      const { avatarPolicy } = this.basicInfo;\n      this.activeContactor.avatarPolicy = avatarPolicy;\n      this.basicInfo.avatar = this.activeContactor.loadAvatar();\n    }\n  },\n};\n</script>\n\n<style>\n/* Copied from parent for .settings-block, .block-title etc. */\n.block-title {\n  font-size: 0.8rem;\n}\n.block-content {\n  margin-top: 0.5rem;\n  margin-bottom: 1rem;\n  width: 100%;\n  display: flex;\n  background-color: #fff;\n  min-height: 1rem;\n  border-radius: 0.5rem;\n  flex-direction: column;\n}\n.block-content:last-child {\n  margin-bottom: 2rem;\n}\n.block-content-item {\n  max-height: 50rem; /* Ensure this is sufficient for PresetsList */\n  overflow-y: auto;\n  transition: max-height 0.5s ease;\n  position: relative;\n  display: flex;\n  width: 100%;\n  justify-content: space-between;\n  flex-wrap: nowrap;\n}\n.block-content-item.parent-item {\n  flex-wrap: wrap;\n}\n.child-item {\n  width: calc(100% - 1rem);\n  padding-left: 1rem;\n}\n.item-hidden-content {\n  width: 100%;\n}\n/* Styles specific to settings can be moved here or kept in parent if generic enough */\n.settings-container {\n  width: 100%;\n}\n.base-info-provider {\n  /* Copied from parent, ensure it's styled correctly in context */\n  display: flex;\n  justify-content: flex-end;\n  align-items: center;\n  padding-right: 2rem;\n  margin-bottom: 1rem; /* Added margin for spacing */\n}\n\n.plugin-tools-container {\n  max-height: 20rem;\n  overflow-y: auto;\n  -webkit-overflow-scrolling: touch;\n}\n.block-content-item::after {\n  content: \"\";\n  position: absolute;\n  bottom: 0;\n  left: 5%;\n  width: 90%;\n  height: 1px;\n  background-color: rgba(145, 145, 145, 0.155);\n}\n.item-title {\n  font-size: 0.8rem;\n  margin-left: 1rem;\n  height: 2.5rem;\n  display: flex;\n  flex-grow: 1;\n  align-items: center;\n  justify-content: flex-start;\n  max-width: calc(100% - 5rem);\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n.item-content {\n  transform: scale(0.9);\n  flex-basis: 2rem;\n  display: flex;\n  align-items: center;\n  justify-content: flex-end;\n  margin-right: 1.5rem;\n}\n.item-content .el-input-number,\n.item-content .el-input,\n.item-content .el-slider,\n.item-content .el-select {\n  width: 10rem;\n}\n.sub-items {\n  width: 100%;\n  display: flex;\n  flex-direction: column;\n  padding-left: 0; /* Reset ul default padding */\n  list-style: none; /* Reset ul default list-style */\n}\n.extra-info-button.active {\n  transform: rotate(-90deg);\n}\n.item-content button {\n  background-color: transparent;\n  border: none; /* Ensure button is clean */\n  cursor: pointer; /* Add cursor pointer */\n  transition: transform 0.3s ease;\n}\n.block-content-item.hidden {\n  /* This style seems unused, but keeping for now */\n  min-height: 0px;\n  max-height: 0px;\n}\n/* 自定义动画 - Kept in parent as it's a general utility transition */\n.expand-slide-enter-active,\n.expand-slide-leave-active {\n  transition:\n    max-height 0.4s cubic-bezier(0.78, 0.14, 0.15, 0.86),\n    opacity 0.4s;\n}\n.expand-slide-enter-from,\n.expand-slide-leave-to {\n  max-height: 0;\n  opacity: 0;\n}\n.expand-slide-enter-to,\n.expand-slide-leave-from {\n  max-height: 20rem; /* Adjust if necessary for PresetsList or other content */\n  opacity: 1;\n}\n</style>\n\n<style scoped>\n/* Styles from original component that are general layout */\n#profile {\n  position: relative;\n  flex-grow: 1;\n  display: flex;\n  flex-direction: column;\n  justify-content: flex-start;\n  align-items: center;\n}\n/* .sub-items and other specific styles are now in ContactorSettings.vue or can be if specific to it */\n/* Keep .base-info-provider here if it's also used for other things, or move if only for provider select */\n/* Moved to child: .base-info-provider */\n\n.profile-container {\n  overflow-y: auto;\n  margin: 2rem 0rem 0rem 0rem;\n  width: calc(100% - 8rem);\n  min-width: 20rem;\n  max-width: 40rem;\n  display: flex;\n  flex-direction: column;\n}\n.base-info {\n  background-color: #fff;\n  border-radius: 0.5rem;\n  display: flex;\n  padding-bottom: 1rem;\n  border-bottom: 1px solid #88888888;\n  flex-wrap: wrap;\n  margin-bottom: 2rem; /* This was on base-info, now applies before info-blocks */\n}\n.base-info-avatar {\n  margin-top: 1rem;\n  margin-left: 1rem;\n  flex-basis: 5.5rem;\n  height: 5.5rem;\n}\n.base-info-avatar .el-image {\n  width: 100%;\n  height: 100%;\n  border-radius: 50%;\n}\n.base-info-content {\n  margin-left: 1.5rem;\n  margin-top: 1rem;\n  display: flex;\n  flex-direction: column;\n}\n.base-info-content .name {\n  font-size: 1.25rem;\n}\n.base-info-content .id {\n  margin-top: 0.25rem;\n  font-size: 0.75rem;\n  color: dimgrey;\n}\n.base-info-content .status {\n  margin-top: 0.25rem;\n}\n.info-blocks {\n  display: flex;\n  flex-direction: column;\n  justify-content: space-between;\n}\n.action-bar {\n  position: sticky;\n  background-color: #f2f2f2;\n  bottom: 0px;\n  left: 0px;\n  display: flex;\n  justify-content: space-around;\n  align-items: center;\n  height: 6rem;\n  width: 100%;\n  z-index: 2;\n}\n.profile-body {\n  position: relative;\n  overflow-y: auto;\n  flex-grow: 1;\n  background-color: #f2f2f2;\n}\n</style>\n\n<style scoped lang=\"sass\">\n/* SASS styles remain in parent */\n.delay-status\n  display: inline-block\n  width: 1rem\n  height: 1rem\n  border-radius: 50%\n  transform: translateY(.25rem)\n  margin-right: .25rem\n  &:hover + .delay-num\n    display: inline-block\n  &.ultra\n    background-color: rgb(53, 233, 146)\n  &.low\n    background-color: rgb(255, 204, 0)\n  &.mid\n    background-color: rgb(255, 102, 102)\n  &.high\n    background-color: #ccc\n</style>\n","<template>\n  <div id=\"settings-view\">\n    <!-- 重启服务提示横幅 -->\n    <el-alert\n      v-if=\"configStore.needRestart\"\n      type=\"warning\"\n      :closable=\"false\"\n      show-icon\n      class=\"restart-banner\"\n    >\n      <template #title>\n        <div class=\"restart-banner-content\">\n          <span>配置已更改，需要重启服务才能生效</span>\n          <el-button\n            type=\"warning\"\n            size=\"small\"\n            @click=\"handleRestartService\"\n          >\n            重启服务\n          </el-button>\n        </div>\n      </template>\n    </el-alert>\n\n    <!-- 侧边导航 + 内容区域 -->\n    <div class=\"settings-container\">\n      <!-- 侧边导航 -->\n      <aside class=\"settings-sidebar\">\n        <el-menu\n          :default-active=\"activeMenu\"\n          class=\"settings-menu\"\n          @select=\"handleMenuSelect\"\n        >\n          <el-menu-item index=\"overview\">\n            <el-icon><Menu /></el-icon>\n            <span>概览</span>\n          </el-menu-item>\n          <el-menu-item index=\"llm-adapters\">\n            <el-icon><Connection /></el-icon>\n            <span>LLM 适配器</span>\n          </el-menu-item>\n          <el-menu-item index=\"server\">\n            <el-icon><Monitor /></el-icon>\n            <span>服务器配置</span>\n          </el-menu-item>\n          <el-menu-item index=\"web\">\n            <el-icon><ChromeFilled /></el-icon>\n            <span>Web 配置</span>\n          </el-menu-item>\n          <el-menu-item index=\"onebot\">\n            <el-icon><ChatDotRound /></el-icon>\n            <span>OneBot 配置</span>\n          </el-menu-item>\n          <el-menu-item index=\"plugins\">\n            <el-icon><Grid /></el-icon>\n            <span>插件管理</span>\n          </el-menu-item>\n        </el-menu>\n\n        <!-- 快捷操作 -->\n        <div class=\"quick-actions\">\n          <el-button type=\"info\" plain @click=\"handleReset\" style=\"width: 100%\">\n            重置全部\n          </el-button>\n          <el-button type=\"info\" plain @click=\"handleResetCache\" style=\"width: 100%\">\n            清理缓存\n          </el-button>\n        </div>\n      </aside>\n\n      <!-- 内容区域 -->\n      <main class=\"settings-content\">\n        <!-- 通用页面头部占位 -->\n        <div class=\"content-header-spacer\"></div>\n        \n        <template v-if=\"forbidden\">\n          <div class=\"forbidden-container\">\n            <el-result\n              icon=\"error\"\n              title=\"禁止访问\"\n              sub-title=\"当前访问码无权限或已失效，您无法访问配置管理页面。\"\n            >\n              <template #extra>\n                <el-button type=\"primary\" @click=\"handleSwitchAccount\">切换账号</el-button>\n                <el-button @click=\"handleReturnHome\">返回首页</el-button>\n              </template>\n            </el-result>\n          </div>\n        </template>\n        <template v-else>\n          <ErrorBoundary\n            fallback-title=\"页面加载失败\"\n            fallback-message=\"配置页面加载时发生错误，请刷新页面重试\"\n          >\n            <router-view v-slot=\"{ Component }\">\n              <transition name=\"page-fade\" mode=\"out-in\">\n                <component :is=\"Component\" />\n              </transition>\n            </router-view>\n          </ErrorBoundary>\n        </template>\n      </main>\n    </div>\n  </div>\n</template>\n\n<script setup>\nimport { ref, computed, onMounted } from 'vue';\nimport { useRoute, useRouter } from 'vue-router';\nimport { ElMessage, ElMessageBox } from 'element-plus';\nimport {\n  Menu,\n  Connection,\n  Monitor,\n  ChromeFilled,\n  ChatDotRound,\n  Grid\n} from '@element-plus/icons-vue';\nimport { useConfigStore } from '@/stores/configStore.js';\nimport { client } from '@/lib/runtime.js';\nimport ErrorBoundary from '@/components/settings/ErrorBoundary.vue';\n\nconst route = useRoute();\nconst router = useRouter();\nconst configStore = useConfigStore();\nconst forbidden = ref(false);\n\n// 操作：切换账号（清除 admin_code 并跳转到 /auth）\nconst handleSwitchAccount = () => {\n  configStore.clearAdminCode();\n  router.push({ path: '/auth', query: { redirect: route.fullPath || route.path } });\n};\n\n// 操作：返回首页\nconst handleReturnHome = () => {\n  router.push('/');\n};\n\n// 当前激活的菜单项\nconst activeMenu = computed(() => {\n  const path = route.path;\n  if (path.includes('llm-adapters')) return 'llm-adapters';\n  if (path.includes('server')) return 'server';\n  if (path.includes('web')) return 'web';\n  if (path.includes('onebot')) return 'onebot';\n  if (path.includes('plugins')) return 'plugins';\n  return 'overview';\n});\n\n// 菜单选择处理\nconst handleMenuSelect = (index) => {\n  if (index === 'overview') {\n    router.push('/settings');\n  } else {\n    router.push(`/settings/${index}`);\n  }\n};\n\n// 重启服务\nconst handleRestartService = async () => {\n  try {\n    await ElMessageBox.confirm(\n      '重启服务将断开所有连接，是否继续？',\n      '确认重启',\n      {\n        confirmButtonText: '确认',\n        cancelButtonText: '取消',\n        type: 'warning'\n      }\n    );\n\n    ElMessage.info('重启服务功能需要后端支持，暂未实现');\n    // TODO: 调用后端重启 API\n    // await configAPI.restartService();\n  } catch (error) {\n    // 用户取消\n  }\n};\n\n// 重置全部\nconst handleReset = async () => {\n  try {\n    await ElMessageBox.confirm(\n      '此操作将重置所有配置到默认状态，是否继续？',\n      '确认重置',\n      {\n        confirmButtonText: '确认',\n        cancelButtonText: '取消',\n        type: 'warning'\n      }\n    );\n\n    const result = await client.reset();\n    if (result) {\n      ElMessage.success('重置成功');\n      setTimeout(() => {\n        window.location.reload();\n      }, 500);\n    }\n  } catch (error) {\n    if (error !== 'cancel') {\n      ElMessage.error('重置失败：' + error.message);\n    }\n  }\n};\n\n// 清理缓存\nconst handleResetCache = async () => {\n  try {\n    await ElMessageBox.confirm(\n      '此操作将清理所有缓存数据，是否继续？',\n      '确认清理',\n      {\n        confirmButtonText: '确认',\n        cancelButtonText: '取消',\n        type: 'warning'\n      }\n    );\n\n    await client.resetCache();\n    ElMessage.success('清理缓存成功');\n    setTimeout(() => {\n      window.location.reload();\n    }, 500);\n  } catch (error) {\n    if (error !== 'cancel') {\n      ElMessage.error('清理缓存失败：' + error.message);\n    }\n  }\n};\n\n// 初始化\nonMounted(async () => {\n  // 如果有本地保存的访问码，直接用它去拉取配置以验证权限\n  if (configStore.isAuthenticated) {\n    try {\n      await configStore.fetchConfig();\n      // 验证通过，继续渲染\n    } catch (error) {\n      // 认证失败或无权限，展示禁止访问\n      forbidden.value = true;\n      console.warn('当前访问码无权限或已失效', error);\n    }\n  } else {\n    // 未登录不跳转，直接展示禁止访问（保留侧边栏可用）\n    forbidden.value = true;\n  }\n});\n</script>\n\n<style scoped lang=\"scss\">\n// 页面过渡动画\n.page-fade-enter-active,\n.page-fade-leave-active {\n  transition: all 0.25s ease;\n}\n\n.page-fade-enter-from {\n  opacity: 0;\n  transform: translateX(10px);\n}\n\n.page-fade-leave-to {\n  opacity: 0;\n  transform: translateX(-10px);\n}\n\n#settings-view {\n  width: 100%;\n  height: 100vh;\n  display: flex;\n  flex-direction: column;\n  background-color: #f2f3f5; // 更柔和的背景色\n}\n\n.restart-banner {\n  margin: 0;\n  border-radius: 0;\n  border: none;\n  border-bottom: 1px solid #e4e7ed;\n\n  :deep(.el-alert__content) {\n    width: 100%;\n  }\n}\n\n.restart-banner-content {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  width: 100%;\n}\n\n.settings-container {\n  display: flex;\n  flex: 1;\n  overflow: hidden;\n  padding: 16px; // 给整体加个内边距，制造悬浮感\n  gap: 16px;\n}\n\n.settings-sidebar {\n  width: 220px;\n  background: transparent; // 侧边栏背景透明\n  border-right: none; // 去掉分割线\n  display: flex;\n  flex-direction: column;\n  overflow-y: auto;\n  position: relative;\n  z-index: 30;\n  padding-right: 8px;\n}\n\n.settings-menu {\n  flex: 1;\n  border: none;\n  background: transparent;\n  \n  :deep(.el-menu-item) {\n    height: 50px;\n    line-height: 50px;\n    margin-bottom: 4px;\n    border-radius: 8px; // 菜单项圆角\n    color: #606266;\n    \n    &:hover {\n      background-color: rgba(0, 0, 0, 0.04);\n    }\n    \n    &.is-active {\n      background-color: #fff; // 选中项白色背景\n      color: #409eff;\n      font-weight: 600;\n      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04); // 选中项轻微投影\n    }\n\n    .el-icon {\n      font-size: 18px;\n    }\n  }\n}\n\n.quick-actions {\n  padding: 12px 0;\n  border-top: 1px solid rgba(0, 0, 0, 0.05);\n  display: flex;\n  flex-direction: column;\n  gap: 12px;\n\n  .el-button {\n    margin: 0;\n    border-radius: 8px;\n    height: 40px;\n    justify-content: flex-start;\n    padding-left: 20px;\n    border: none;\n    background: rgba(255, 255, 255, 0.6);\n    \n    &:hover {\n      background: #fff;\n    }\n  }\n}\n\n.settings-content {\n  flex: 1;\n  overflow-y: auto;\n  background-color: #fff; // 内容区白色背景\n  border-radius: 16px; // 内容区大圆角\n  box-shadow: 0 4px 16px rgba(0, 0, 0, 0.04); // 柔和投影\n  position: relative;\n  padding: 0; // 内容区内部padding由各页面自己控制，或者在这里统一加\n}\n\n.forbidden-container {\n  padding: 40px;\n  max-width: 980px;\n  margin: 0 auto;\n  position: relative;\n  z-index: 10;\n  height: 100%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n\n.content-header-spacer {\n  display: none; // 新布局不需要这个占位了\n}\n</style>\n","<template>\n  <div class=\"auth-view\">\n    <div class=\"container\">\n      <div ref=\"iconContainer\" class=\"icon-container\">\n        <i class=\"iconfont ChatGPT\"></i>\n      </div>\n      <h1 class=\"title\">登录验证</h1>\n      <p class=\"hint\">管理员开启了密码验证，请在下方填入访问码</p>\n      <input\n        v-model=\"accessCode\"\n        type=\"password\"\n        placeholder=\"在此处填写访问码\"\n      />\n      <div class=\"controls\">\n        <button class=\"later\" @click=\"login()\">游客登录</button>\n        <button class=\"login\" @click=\"login(accessCode)\">登录</button>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup>\nimport { nextTick, onUnmounted, onMounted, ref } from \"vue\";\nimport router from \"@/router\";\nimport { client } from \"@/lib/runtime.js\";\nimport { ElMessage } from \"element-plus\";\nimport { useConfigStore } from '@/stores/configStore.js';\n\nconst configStore = useConfigStore();\n\nconst accessCode = ref();\nconst requesting = ref(false);\nconst iconContainer = ref();\n\nconst login = async (code) => {\n  console.log(\"触发login了\");\n\n  // 激活图标\n  await nextTick(() => iconContainer.value.classList.add(\"active\"));\n\n  if (requesting.value) {\n    return;\n  } else {\n    requesting.value = true;\n    try {\n      const result = await client.login(code);\n      if (result) {\n        ElMessage.success(\n          `成功以${result.is_admin ? \"管理员身份\" : \"游客身份\"}登录，欢迎使用!`,\n        );\n\n        // 如果是使用访问码且为管理员，保存到 store（并存 localStorage）\n        if (code && result.is_admin) {\n          configStore.setAdminCode(code);\n        }\n\n        // 先看看url里有没有query\n        if (router.currentRoute.value.query.redirect) {\n          router.push(router.currentRoute.value.query.redirect);\n        } else {\n          router.push(\"/\");\n        }\n      }\n    } catch (error) {\n      ElMessage.error(error);\n    } finally {\n      // 移除激活图标\n      await nextTick(() => iconContainer.value.classList.remove(\"active\"));\n      requesting.value = false;\n    }\n  }\n};\n\n// 定义一个命名函数供事件监听和移除使用\nfunction handleEnter(e) {\n  if (e.key === \"Enter\") {\n    login(accessCode.value);\n  }\n}\n\n// 在unmounted时移除监听\nonUnmounted(() => {\n  console.log(\"unmounted\");\n  removeEventListener(\"keydown\", handleEnter); // 使用相同的函数引用进行移除\n});\n\nonMounted(() => {\n  addEventListener(\"keydown\", handleEnter);\n  // 看看query里有没有key\n  if (router.currentRoute.value.query.key) {\n    login(router.currentRoute.value.query.key);\n  }\n});\n</script>\n\n<style lang=\"sass\" scoped>\n$baseColor: #1d93ab\n\n.auth-view\n    background-color: white\n    flex-grow: 1\n    display: grid\n    place-items: center\n\n    .container\n        display: flex\n        flex-direction: column\n        align-items: center\n        width: 50%\n        margin: 0 auto\n        text-align: center\n        animation: fly-into 1s\n\n        @keyframes fly-into\n            from\n                transform: translateX(-150px)\n                opacity: 0\n            to\n                transform: translateX(0)\n                opacity: 1\n\n        .icon-container\n            transition: 1s linear\n\n            .iconfont.ChatGPT\n                font-size: 46px\n                border-radius: 10px\n\n            &.active\n                transform: rotate(180deg)\n                color: $baseColor\n\n        .title\n            white-space: nowrap\n            font-size: 50px\n            letter-spacing: 5px\n            color: black\n            margin: 25px\n\n        .hint\n            font-size: 15px\n            font-weight: 300\n\n        input\n            margin-top: 30px\n            border: 2px solid $baseColor\n            border-radius: 12px\n            width: 250px\n            height: 40px\n            padding: 0 10px\n            text-align: center\n            letter-spacing: 1px\n\n            &:focus\n                outline: 1px solid $baseColor\n\n                &::placeholder\n                    color: transparent\n\n            &::placeholder\n                text-align: center\n\n        .controls\n            display: flex\n            flex-direction: column\n            align-items: center\n\n            button\n                width: 10rem\n                margin-top: 20px\n                padding: 10px 15px\n                border-radius: 8px\n\n                &:hover\n                    box-shadow: 0 0 2px black\n\n            .later\n                background: transparent\n\n            .login\n                color: white\n                background: $baseColor\n</style>\n","<template>\n  <div class=\"overview-view\">\n    <!-- 加载骨架屏 -->\n    <div v-if=\"loading\" class=\"loading-container\">\n      <div class=\"stats-grid\">\n        <LoadingSkeleton v-for=\"i in 4\" :key=\"i\" type=\"stat-card\" is-card />\n      </div>\n      <el-card class=\"section-card\">\n        <LoadingSkeleton type=\"list\" :count=\"4\" />\n      </el-card>\n    </div>\n\n    <transition name=\"fade\" mode=\"out-in\">\n      <div v-if=\"!loading\" class=\"content-container\">\n        <!-- 顶部操作栏 -->\n        <div class=\"overview-header\">\n          <div class=\"header-title\">\n            <h2>概览</h2>\n            <span class=\"subtitle\">系统运行状态与快捷入口</span>\n          </div>\n          <div class=\"header-actions\">\n            <el-tooltip content=\"刷新模型列表\" placement=\"bottom\">\n              <el-button circle :icon=\"Refresh\" @click=\"handleRefreshModels\" :loading=\"refreshing\" />\n            </el-tooltip>\n            <el-upload\n              :before-upload=\"handleImportConfig\"\n              :show-file-list=\"false\"\n              accept=\".json\"\n              style=\"display: inline-block; margin: 0 8px;\"\n            >\n              <el-tooltip content=\"导入配置\" placement=\"bottom\">\n                <el-button circle :icon=\"Upload\" />\n              </el-tooltip>\n            </el-upload>\n            <el-tooltip content=\"导出配置\" placement=\"bottom\">\n              <el-button circle :icon=\"Download\" @click=\"handleExportConfig\" />\n            </el-tooltip>\n            <el-tooltip content=\"配置对比\" placement=\"bottom\">\n              <el-button circle :icon=\"DocumentCopy\" @click=\"showCompare = true\" />\n            </el-tooltip>\n          </div>\n        </div>\n\n        <!-- 统计信息卡片 -->\n        <div class=\"stats-grid\">\n          <el-card class=\"stat-card\">\n            <div class=\"stat-icon\" style=\"background-color: #409eff20;\">\n              <el-icon :size=\"32\" color=\"#409eff\"><Connection /></el-icon>\n            </div>\n            <div class=\"stat-content\">\n              <div class=\"stat-value\">{{ configStore.totalAdapters }}</div>\n              <div class=\"stat-label\">适配器总数</div>\n            </div>\n          </el-card>\n\n          <el-card class=\"stat-card\">\n            <div class=\"stat-icon\" style=\"background-color: #67c23a20;\">\n              <el-icon :size=\"32\" color=\"#67c23a\"><CircleCheck /></el-icon>\n            </div>\n            <div class=\"stat-content\">\n              <div class=\"stat-value\">{{ configStore.enabledAdaptersCount }}</div>\n              <div class=\"stat-label\">已启用</div>\n            </div>\n          </el-card>\n\n          <el-card class=\"stat-card\">\n            <div class=\"stat-icon\" style=\"background-color: #e6a23c20;\">\n              <el-icon :size=\"32\" color=\"#e6a23c\"><Grid /></el-icon>\n            </div>\n            <div class=\"stat-content\">\n              <div class=\"stat-value\">{{ configStore.totalModelsCount }}</div>\n              <div class=\"stat-label\">可用模型</div>\n            </div>\n          </el-card>\n\n          <el-card class=\"stat-card\">\n            <div class=\"stat-icon\" :style=\"{\n              backgroundColor: systemStatus === 'normal' ? '#67c23a20' : '#f5672020'\n            }\">\n              <el-icon\n                :size=\"32\"\n                :color=\"systemStatus === 'normal' ? '#67c23a' : '#f56720'\"\n              >\n                <component :is=\"systemStatus === 'normal' ? SuccessFilled : WarningFilled\" />\n              </el-icon>\n            </div>\n            <div class=\"stat-content\">\n              <div class=\"stat-value\">{{ systemStatusText }}</div>\n              <div class=\"stat-label\">系统状态</div>\n            </div>\n          </el-card>\n        </div>\n\n        <!-- 快速操作 -->\n        <div class=\"section-container\">\n          <div class=\"section-header\">\n            <h3>快速操作</h3>\n          </div>\n          <div class=\"quick-actions-grid\">\n            <div class=\"action-item\" @click=\"navigateTo('llm-adapters')\">\n              <div class=\"action-icon\" style=\"background: #ecf5ff; color: #409eff;\">\n                <el-icon><Connection /></el-icon>\n              </div>\n              <div class=\"action-info\">\n                <div class=\"action-title\">LLM 适配器</div>\n                <div class=\"action-desc\">管理模型与接口</div>\n              </div>\n              <el-icon class=\"action-arrow\"><ArrowRight /></el-icon>\n            </div>\n            \n            <div class=\"action-item\" @click=\"navigateTo('server')\">\n              <div class=\"action-icon\" style=\"background: #f0f9eb; color: #67c23a;\">\n                <el-icon><Monitor /></el-icon>\n              </div>\n              <div class=\"action-info\">\n                <div class=\"action-title\">服务器配置</div>\n                <div class=\"action-desc\">端口与网络设置</div>\n              </div>\n              <el-icon class=\"action-arrow\"><ArrowRight /></el-icon>\n            </div>\n\n            <div class=\"action-item\" @click=\"navigateTo('web')\">\n              <div class=\"action-icon\" style=\"background: #fdf6ec; color: #e6a23c;\">\n                <el-icon><ChromeFilled /></el-icon>\n              </div>\n              <div class=\"action-info\">\n                <div class=\"action-title\">Web 配置</div>\n                <div class=\"action-desc\">界面与显示选项</div>\n              </div>\n              <el-icon class=\"action-arrow\"><ArrowRight /></el-icon>\n            </div>\n\n            <div class=\"action-item\" @click=\"navigateTo('onebot')\">\n              <div class=\"action-icon\" style=\"background: #f4f4f5; color: #909399;\">\n                <el-icon><ChatDotRound /></el-icon>\n              </div>\n              <div class=\"action-info\">\n                <div class=\"action-title\">OneBot 配置</div>\n                <div class=\"action-desc\">QQ 机器人连接</div>\n              </div>\n              <el-icon class=\"action-arrow\"><ArrowRight /></el-icon>\n            </div>\n          </div>\n        </div>\n\n    <!-- 待处理事项 -->\n    <el-card class=\"section-card\" v-if=\"pendingItems.length > 0\">\n      <template #header>\n        <div class=\"card-header\">\n          <el-icon><Warning /></el-icon>\n          <span>待处理事项 ({{ pendingItems.length }})</span>\n        </div>\n      </template>\n      <div class=\"pending-items-list\">\n        <div\n          v-for=\"(item, index) in pendingItems\"\n          :key=\"index\"\n          class=\"pending-item\"\n        >\n          <el-alert\n            :type=\"item.type\"\n            :title=\"item.title\"\n            :closable=\"false\"\n          />\n          <el-button\n            v-if=\"item.action\"\n            type=\"primary\"\n            link\n            @click=\"item.action.handler\"\n          >\n            {{ item.action.text }}\n          </el-button>\n        </div>\n      </div>\n    </el-card>\n\n    <!-- 适配器概览 -->\n    <el-card class=\"section-card\">\n      <template #header>\n        <div class=\"card-header\">\n          <el-icon><Connection /></el-icon>\n          <span>适配器概览</span>\n        </div>\n      </template>\n      <div class=\"adapters-overview\">\n        <div\n          v-for=\"(instances, type) in configStore.adapters\"\n          :key=\"type\"\n          class=\"adapter-type-section\"\n        >\n          <div class=\"adapter-type-header\">\n            <h3>{{ adapterTypeName(type) }}</h3>\n            <el-tag>{{ instances.length }} 个实例</el-tag>\n          </div>\n          <div v-if=\"instances.length === 0\" class=\"empty-state\">\n            暂无实例\n          </div>\n          <div v-else class=\"adapter-list\">\n            <div\n              v-for=\"(adapter, index) in instances\"\n              :key=\"index\"\n              class=\"adapter-item\"\n            >\n              <el-tag :type=\"adapter.enable ? 'success' : 'info'\" size=\"small\">\n                {{ adapter.enable ? '已启用' : '已禁用' }}\n              </el-tag>\n              <span class=\"adapter-name\">{{ adapter.name || `${type}-${index + 1}` }}</span>\n              <span class=\"adapter-model\">{{ adapter.default_model }}</span>\n            </div>\n          </div>\n        </div>\n      </div>\n    </el-card>\n      </div>\n    </transition>\n\n    <!-- 配置对比对话框 -->\n    <ConfigCompare v-model=\"showCompare\" />\n  </div>\n</template>\n\n<script setup>\nimport { ref, computed, onMounted } from 'vue';\nimport { useRouter } from 'vue-router';\nimport { ElMessage, ElMessageBox } from 'element-plus';\nimport LoadingSkeleton from '@/components/settings/LoadingSkeleton.vue';\nimport {\n  Connection,\n  CircleCheck,\n  Grid,\n  SuccessFilled,\n  WarningFilled,\n  Refresh,\n  Download,\n  Upload,\n  DocumentCopy,\n  Pointer,\n  Monitor,\n  ChromeFilled,\n  ChatDotRound,\n  Warning,\n  ArrowRight\n} from '@element-plus/icons-vue';\nimport { useConfigStore } from '@/stores/configStore.js';\nimport ConfigCompare from '@/components/settings/ConfigCompare.vue';\n\nconst router = useRouter();\nconst configStore = useConfigStore();\n\nconst loading = ref(true);\nconst refreshing = ref(false);\nconst showCompare = ref(false);\n\n// 系统状态\nconst systemStatus = computed(() => {\n  if (configStore.needRestart) return 'warning';\n  \n  // 检查是否有禁用的适配器\n  const hasDisabled = Object.values(configStore.adapters).some(instances =>\n    instances.some(adapter => !adapter.enable)\n  );\n  \n  return hasDisabled ? 'warning' : 'normal';\n});\n\nconst systemStatusText = computed(() => {\n  if (configStore.needRestart) return '需要重启';\n  return systemStatus.value === 'normal' ? '正常' : '有警告';\n});\n\n// 待处理事项\nconst pendingItems = computed(() => {\n  const items = [];\n  \n  // 1. 需要重启服务\n  if (configStore.needRestart) {\n    items.push({\n      type: 'warning',\n      title: '配置已更改，需要重启服务才能生效',\n      action: {\n        text: '去重启',\n        handler: () => router.push('/settings')\n      }\n    });\n  }\n  \n  // 2. 检查是否有模型列表为空的适配器\n  Object.entries(configStore.adapters).forEach(([type, instances]) => {\n    instances.forEach((adapter, index) => {\n      if (adapter.enable) {\n        const providerName = adapter.name || `${type}-${index + 1}`;\n        const models = configStore.models[providerName];\n        \n        if (!models || models.length === 0) {\n          items.push({\n            type: 'error',\n            title: `${providerName} 实例模型列表为空，请检查 API Key 或网络连接`,\n            action: {\n              text: '去检查',\n              handler: () => router.push('/settings/llm-adapters')\n            }\n          });\n        }\n      }\n    });\n  });\n  \n  // 3. 检查是否有禁用的适配器\n  const disabledCount = Object.values(configStore.adapters)\n    .flat()\n    .filter(adapter => !adapter.enable).length;\n  \n  if (disabledCount > 0) {\n    items.push({\n      type: 'info',\n      title: `有 ${disabledCount} 个适配器处于禁用状态`,\n      action: {\n        text: '查看详情',\n        handler: () => router.push('/settings/llm-adapters')\n      }\n    });\n  }\n  \n  // 4. （已由 AuthView 负责）不再在管理页面重复提示管理员访问码\n  \n  // 5. 检查 OneBot 配置\n  if (configStore.config?.onebot?.enable) {\n    const onebotConfig = configStore.config.onebot;\n    if (!onebotConfig.reverse_ws_url || !onebotConfig.bot_qq) {\n      items.push({\n        type: 'warning',\n        title: 'OneBot 已启用但配置不完整',\n        action: {\n          text: '去完善',\n          handler: () => router.push('/settings/onebot')\n        }\n      });\n    }\n  }\n  \n  return items;\n});\n\n// 适配器类型名称\nconst adapterTypeName = (type) => {\n  const names = {\n    openai: 'OpenAI',\n    gemini: 'Gemini',\n    vertex: 'Vertex AI'\n  };\n  return names[type] || type;\n};\n\n// 刷新模型列表\nconst handleRefreshModels = async () => {\n  refreshing.value = true;\n  try {\n    await configStore.refreshAllModels();\n    ElMessage.success('模型列表刷新成功');\n  } catch (error) {\n    ElMessage.error('刷新失败：' + error.message);\n  } finally {\n    refreshing.value = false;\n  }\n};\n\n// 导出配置\nconst handleExportConfig = async () => {\n  try {\n    const filename = `mio-chat-config-${new Date().toISOString().split('T')[0]}.json`;\n    await configStore.exportConfig(filename);\n    ElMessage.success('配置导出成功');\n  } catch (error) {\n    ElMessage.error('导出失败：' + error.message);\n  }\n};\n\n// 导入配置\nconst handleImportConfig = async (file) => {\n  try {\n    await ElMessageBox.confirm(\n      '导入配置将覆盖当前所有配置，是否继续？',\n      '确认导入',\n      {\n        confirmButtonText: '导入',\n        cancelButtonText: '取消',\n        type: 'warning'\n      }\n    );\n\n    const configData = await configStore.importConfig(file);\n    \n    // 验证配置\n    const validateResult = await configStore.validateConfig(configData);\n    if (!validateResult.valid) {\n      ElMessageBox.alert(\n        `配置验证失败：\\n${validateResult.errors.join('\\n')}`,\n        '导入失败',\n        { type: 'error' }\n      );\n      return false;\n    }\n\n    // 更新配置\n    await configStore.updateConfig(configData);\n    ElMessage.success('配置导入成功，请重启服务使配置生效');\n    \n    // 重新加载配置\n    await configStore.fetchConfig();\n  } catch (error) {\n    if (error !== 'cancel') {\n      ElMessage.error('导入失败：' + error.message);\n    }\n  }\n  \n  return false; // 阻止自动上传\n};\n\n// 导航到指定页面\nconst navigateTo = (path) => {\n  router.push(`/settings/${path}`);\n};\n\n// 加载配置\nonMounted(async () => {\n  loading.value = true;\n  try {\n    if (!configStore.config) {\n      await configStore.fetchConfig();\n    }\n    // 模拟最小加载时间，提升用户体验\n    await new Promise(resolve => setTimeout(resolve, 300));\n  } catch (error) {\n    ElMessage.error('加载配置失败：' + error.message);\n  } finally {\n    loading.value = false;\n  }\n});\n</script>\n\n<style scoped lang=\"scss\">\n// 过渡动画\n.fade-enter-active,\n.fade-leave-active {\n  transition: opacity 0.3s ease;\n}\n\n.fade-enter-from,\n.fade-leave-to {\n  opacity: 0;\n}\n\n.overview-view {\n  padding: 24px;\n  max-width: 1400px;\n  margin: 0 auto;\n}\n\n.loading-container {\n  .stats-grid {\n    display: grid;\n    grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));\n    gap: 16px;\n    margin-bottom: 24px;\n  }\n\n  .section-card {\n    margin-bottom: 24px;\n  }\n}\n\n.content-container {\n  width: 100%;\n}\n\n.overview-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 24px;\n\n  .header-title {\n    h2 {\n      margin: 0;\n      font-size: 24px;\n      font-weight: 600;\n      color: #303133;\n    }\n    \n    .subtitle {\n      font-size: 14px;\n      color: #909399;\n      margin-top: 4px;\n      display: block;\n    }\n  }\n\n  .header-actions {\n    display: flex;\n    align-items: center;\n    gap: 8px;\n    \n    .el-button {\n      border: none;\n      background: transparent;\n      font-size: 18px;\n      color: #606266;\n      width: 40px;\n      height: 40px;\n      \n      &:hover {\n        background: rgba(0, 0, 0, 0.05);\n        color: #409eff;\n      }\n    }\n  }\n}\n\n.stats-grid {\n  display: grid;\n  grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));\n  gap: 20px;\n  margin-bottom: 32px;\n}\n\n.stat-card {\n  border: none;\n  transition: all 0.3s ease;\n  \n  &:hover {\n    transform: translateY(-4px);\n  }\n\n  :deep(.el-card__body) {\n    display: flex;\n    align-items: center;\n    gap: 16px;\n    padding: 20px;\n  }\n\n  .stat-icon {\n    width: 56px;\n    height: 56px;\n    border-radius: 12px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    flex-shrink: 0;\n  }\n\n  .stat-content {\n    flex: 1;\n  }\n\n  .stat-value {\n    font-size: 28px;\n    font-weight: 600;\n    color: #303133;\n    line-height: 1.2;\n    margin-bottom: 4px;\n  }\n\n  .stat-label {\n    font-size: 14px;\n    color: #909399;\n  }\n}\n\n.section-container {\n  margin-bottom: 32px;\n\n  .section-header {\n    margin-bottom: 16px;\n    \n    h3 {\n      margin: 0;\n      font-size: 18px;\n      font-weight: 600;\n      color: #303133;\n    }\n  }\n}\n\n.quick-actions-grid {\n  display: grid;\n  grid-template-columns: repeat(auto-fill, minmax(240px, 1fr));\n  gap: 16px;\n\n  .action-item {\n    display: flex;\n    align-items: center;\n    gap: 16px;\n    padding: 20px;\n    background: #f8f9fa;\n    border-radius: 12px;\n    cursor: pointer;\n    transition: all 0.3s ease;\n    border: 1px solid transparent;\n\n    &:hover {\n      background: #fff;\n      transform: translateY(-2px);\n      box-shadow: 0 8px 16px rgba(0, 0, 0, 0.05);\n      border-color: var(--el-color-primary-light-8);\n\n      .action-arrow {\n        opacity: 1;\n        transform: translateX(0);\n      }\n    }\n\n    .action-icon {\n      width: 48px;\n      height: 48px;\n      border-radius: 12px;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      font-size: 24px;\n    }\n\n    .action-info {\n      flex: 1;\n      \n      .action-title {\n        font-size: 16px;\n        font-weight: 600;\n        color: #303133;\n        margin-bottom: 4px;\n      }\n\n      .action-desc {\n        font-size: 12px;\n        color: #909399;\n      }\n    }\n\n    .action-arrow {\n      font-size: 16px;\n      color: #c0c4cc;\n      opacity: 0;\n      transform: translateX(-10px);\n      transition: all 0.3s ease;\n    }\n  }\n}\n\n.pending-items-list {\n  display: flex;\n  flex-direction: column;\n  gap: 12px;\n\n  .pending-item {\n    display: flex;\n    align-items: center;\n    gap: 12px;\n\n    .el-alert {\n      flex: 1;\n    }\n\n    .el-button {\n      flex-shrink: 0;\n    }\n  }\n}\n\n.adapters-overview {\n  display: flex;\n  flex-direction: column;\n  gap: 24px;\n}\n\n.adapter-type-section {\n  display: flex;\n  flex-direction: column;\n  \n  &:last-child {\n    padding-bottom: 24px;\n  }\n  \n  .adapter-type-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin-bottom: 12px;\n    padding-bottom: 8px;\n    border-bottom: 1px solid #e4e7ed;\n    flex-shrink: 0;\n    min-height: 32px; // 确保统一高度\n\n    h3 {\n      margin: 0;\n      font-size: 16px;\n      font-weight: 600;\n      color: #303133;\n      line-height: 1.5;\n    }\n  }\n\n  .empty-state {\n    text-align: center;\n    padding: 32px;\n    color: #909399;\n    font-size: 14px;\n  }\n\n  .adapter-list {\n    display: flex;\n    flex-direction: column;\n    gap: 8px;\n  }\n\n  .adapter-item {\n    display: flex;\n    align-items: center;\n    gap: 12px;\n    padding: 12px;\n    background-color: #f5f7fa;\n    border-radius: 6px;\n    transition: background-color 0.2s;\n\n    &:hover {\n      background-color: #ecf5ff;\n    }\n\n    .adapter-name {\n      font-weight: 500;\n      color: #303133;\n    }\n\n    .adapter-model {\n      margin-left: auto;\n      color: #909399;\n      font-size: 13px;\n    }\n  }\n}\n</style>\n","<template>\n  <div class=\"llm-adapters-view\">\n    <!-- 加载骨架屏 -->\n    <div v-if=\"loading\" class=\"loading-container\">\n      <div class=\"skeleton-header\">\n        <div class=\"skeleton-title\"></div>\n        <div class=\"skeleton-actions\">\n          <div class=\"skeleton-button\" v-for=\"i in 3\" :key=\"i\"></div>\n        </div>\n      </div>\n      <div class=\"adapters-grid\">\n        <LoadingSkeleton v-for=\"i in 6\" :key=\"i\" type=\"adapter-card\" is-card />\n      </div>\n    </div>\n\n    <transition name=\"fade\" mode=\"out-in\">\n      <div v-if=\"!loading\" class=\"content-container\">\n        <!-- 页面头部 -->\n        <div class=\"page-header\">\n      <h1>LLM 适配器管理</h1>\n      <div class=\"header-actions\">\n        <el-button\n          v-if=\"configStore.selectedAdapters.length > 0\"\n          type=\"success\"\n          :icon=\"Check\"\n          @click=\"handleBatchEnable\"\n        >\n          批量启用 ({{ configStore.selectedAdapters.length }})\n        </el-button>\n        <el-button\n          v-if=\"configStore.selectedAdapters.length > 0\"\n          type=\"warning\"\n          :icon=\"Close\"\n          @click=\"handleBatchDisable\"\n        >\n          批量禁用\n        </el-button>\n        <el-button\n          v-if=\"configStore.selectedAdapters.length > 0\"\n          type=\"danger\"\n          :icon=\"Delete\"\n          @click=\"handleBatchDelete\"\n        >\n          批量删除\n        </el-button>\n        <el-button\n          type=\"primary\"\n          :icon=\"Refresh\"\n          :loading=\"refreshing\"\n          @click=\"handleRefreshAll\"\n        >\n          刷新全部模型\n        </el-button>\n        <el-dropdown @command=\"handleAddAdapter\" trigger=\"click\">\n          <el-button type=\"primary\" :icon=\"Plus\">\n            添加适配器 <el-icon class=\"el-icon--right\"><arrow-down /></el-icon>\n          </el-button>\n          <template #dropdown>\n            <el-dropdown-menu>\n              <el-dropdown-item command=\"openai\">\n                <el-icon><Connection /></el-icon>\n                OpenAI\n              </el-dropdown-item>\n              <el-dropdown-item command=\"gemini\">\n                <el-icon><Connection /></el-icon>\n                Gemini\n              </el-dropdown-item>\n              <el-dropdown-item command=\"vertex\">\n                <el-icon><Connection /></el-icon>\n                Vertex AI\n              </el-dropdown-item>\n            </el-dropdown-menu>\n          </template>\n        </el-dropdown>\n      </div>\n    </div>\n\n    <!-- 适配器列表 -->\n    <div class=\"adapters-container\">\n      <!-- OpenAI -->\n      <div class=\"adapter-section\">\n        <div class=\"section-header\">\n          <div class=\"section-title\">\n            <h2>OpenAI</h2>\n            <el-tag>{{ configStore.adapters.openai.length }} 个实例</el-tag>\n          </div>\n          <el-button\n            text\n            type=\"primary\"\n            :icon=\"Plus\"\n            @click=\"handleAddAdapter('openai')\"\n          >\n            添加实例\n          </el-button>\n        </div>\n        \n        <div v-if=\"configStore.adapters.openai.length === 0\" class=\"empty-state\">\n          <el-empty description=\"暂无 OpenAI 实例\">\n            <el-button type=\"primary\" @click=\"handleAddAdapter('openai')\">\n              添加 OpenAI 实例\n            </el-button>\n          </el-empty>\n        </div>\n        \n        <div v-else class=\"adapters-grid\">\n          <adapter-card\n            v-for=\"(adapter, index) in configStore.adapters.openai\"\n            :key=\"`openai-${index}`\"\n            :adapter=\"adapter\"\n            type=\"openai\"\n            :index=\"index\"\n            :models=\"getAdapterModels(adapter, 'openai', index)\"\n            :selectable=\"true\"\n            :is-selected=\"configStore.isAdapterSelected('openai', index)\"\n            @edit=\"handleEdit\"\n            @delete=\"handleDelete\"\n            @refresh=\"handleRefresh\"\n            @toggle=\"handleToggle\"\n            @select=\"handleSelect\"\n          />\n        </div>\n      </div>\n\n      <!-- Gemini -->\n      <div class=\"adapter-section\">\n        <div class=\"section-header\">\n          <div class=\"section-title\">\n            <h2>Gemini</h2>\n            <el-tag>{{ configStore.adapters.gemini.length }} 个实例</el-tag>\n          </div>\n          <el-button\n            text\n            type=\"primary\"\n            :icon=\"Plus\"\n            @click=\"handleAddAdapter('gemini')\"\n          >\n            添加实例\n          </el-button>\n        </div>\n        \n        <div v-if=\"configStore.adapters.gemini.length === 0\" class=\"empty-state\">\n          <el-empty description=\"暂无 Gemini 实例\">\n            <el-button type=\"primary\" @click=\"handleAddAdapter('gemini')\">\n              添加 Gemini 实例\n            </el-button>\n          </el-empty>\n        </div>\n        \n        <div v-else class=\"adapters-grid\">\n          <adapter-card\n            v-for=\"(adapter, index) in configStore.adapters.gemini\"\n            :key=\"`gemini-${index}`\"\n            :adapter=\"adapter\"\n            type=\"gemini\"\n            :index=\"index\"\n            :models=\"getAdapterModels(adapter, 'gemini', index)\"\n            :selectable=\"true\"\n            :is-selected=\"configStore.isAdapterSelected('gemini', index)\"\n            @edit=\"handleEdit\"\n            @delete=\"handleDelete\"\n            @refresh=\"handleRefresh\"\n            @toggle=\"handleToggle\"\n            @select=\"handleSelect\"\n          />\n        </div>\n      </div>\n\n      <!-- Vertex AI -->\n      <div class=\"adapter-section\">\n        <div class=\"section-header\">\n          <div class=\"section-title\">\n            <h2>Vertex AI</h2>\n            <el-tag>{{ configStore.adapters.vertex.length }} 个实例</el-tag>\n          </div>\n          <el-button\n            text\n            type=\"primary\"\n            :icon=\"Plus\"\n            @click=\"handleAddAdapter('vertex')\"\n          >\n            添加实例\n          </el-button>\n        </div>\n        \n        <div v-if=\"configStore.adapters.vertex.length === 0\" class=\"empty-state\">\n          <el-empty description=\"暂无 Vertex AI 实例\">\n            <el-button type=\"primary\" @click=\"handleAddAdapter('vertex')\">\n              添加 Vertex AI 实例\n            </el-button>\n          </el-empty>\n        </div>\n        \n        <div v-else class=\"adapters-grid\">\n          <adapter-card\n            v-for=\"(adapter, index) in configStore.adapters.vertex\"\n            :key=\"`vertex-${index}`\"\n            :adapter=\"adapter\"\n            type=\"vertex\"\n            :index=\"index\"\n            :models=\"getAdapterModels(adapter, 'vertex', index)\"\n            :selectable=\"true\"\n            :is-selected=\"configStore.isAdapterSelected('vertex', index)\"\n            @edit=\"handleEdit\"\n            @delete=\"handleDelete\"\n            @refresh=\"handleRefresh\"\n            @toggle=\"handleToggle\"\n            @select=\"handleSelect\"\n          />\n        </div>\n      </div>\n    </div>\n      </div>\n    </transition>\n\n    <!-- 编辑器对话框 -->\n    <adapter-editor\n      :visible=\"editorVisible\"\n      :mode=\"editorMode\"\n      :type=\"editorType\"\n      :adapter=\"editorAdapter\"\n      :index=\"editorIndex\"\n      @close=\"handleEditorClose\"\n      @submit=\"handleEditorSubmit\"\n    />\n  </div>\n</template>\n\n<script setup>\nimport { ref, computed, onMounted } from 'vue';\nimport { ElMessage, ElMessageBox } from 'element-plus';\nimport {\n  Plus,\n  Refresh,\n  Delete,\n  Check,\n  Close,\n  Connection,\n  ArrowDown\n} from '@element-plus/icons-vue';\nimport { useConfigStore } from '@/stores/configStore.js';\nimport AdapterCard from '@/components/settings/AdapterCard.vue';\nimport AdapterEditor from '@/components/settings/AdapterEditor.vue';\nimport LoadingSkeleton from '@/components/settings/LoadingSkeleton.vue';\n\nconst configStore = useConfigStore();\n\nconst loading = ref(true);\nconst refreshing = ref(false);\nconst editorVisible = ref(false);\nconst editorMode = ref('add');\nconst editorType = ref('openai');\nconst editorAdapter = ref(null);\nconst editorIndex = ref(-1);\n\n// 获取适配器的模型列表\nconst getAdapterModels = (adapter, type, index) => {\n  const providerName = adapter.name || `${type}-${index + 1}`;\n  return configStore.models[providerName] || [];\n};\n\n// 添加适配器\nconst handleAddAdapter = (type) => {\n  editorMode.value = 'add';\n  editorType.value = type;\n  editorAdapter.value = null;\n  editorIndex.value = -1;\n  editorVisible.value = true;\n};\n\n// 编辑适配器\nconst handleEdit = ({ type, index, adapter }) => {\n  editorMode.value = 'edit';\n  editorType.value = type;\n  editorAdapter.value = adapter;\n  editorIndex.value = index;\n  editorVisible.value = true;\n};\n\n// 删除适配器\nconst handleDelete = async ({ type, index }) => {\n  try {\n    await configStore.deleteAdapter(type, index);\n    ElMessage.success('删除成功');\n  } catch (error) {\n    ElMessage.error('删除失败：' + error.message);\n  }\n};\n\n// 刷新单个适配器模型\nconst handleRefresh = async ({ type, index }) => {\n  try {\n    await configStore.refreshAdapterModels(type, index);\n    ElMessage.success('模型列表刷新成功');\n  } catch (error) {\n    ElMessage.error('刷新失败：' + error.message);\n  }\n};\n\n// 切换启用/禁用\nconst handleToggle = async ({ type, index, enable }) => {\n  try {\n    // 只更新 enable 字段\n    const updatedData = { enable };\n    await configStore.updateAdapter(type, index, updatedData);\n    ElMessage.success(enable ? '已启用' : '已禁用');\n  } catch (error) {\n    ElMessage.error('操作失败：' + error.message);\n  }\n};\n\n// 选择适配器\nconst handleSelect = ({ type, index, selected }) => {\n  configStore.toggleAdapterSelection(type, index);\n};\n\n// 刷新全部模型\nconst handleRefreshAll = async () => {\n  refreshing.value = true;\n  try {\n    await configStore.refreshAllModels();\n    ElMessage.success('所有模型列表刷新成功');\n  } catch (error) {\n    ElMessage.error('刷新失败：' + error.message);\n  } finally {\n    refreshing.value = false;\n  }\n};\n\n// 批量启用\nconst handleBatchEnable = async () => {\n  try {\n    const results = await configStore.batchToggleAdapters(\n      configStore.selectedAdapters,\n      true\n    );\n    \n    const successCount = results.filter(r => r.success).length;\n    ElMessage.success(`成功启用 ${successCount} 个适配器`);\n    configStore.clearAdapterSelection();\n  } catch (error) {\n    ElMessage.error('批量启用失败：' + error.message);\n  }\n};\n\n// 批量禁用\nconst handleBatchDisable = async () => {\n  try {\n    const results = await configStore.batchToggleAdapters(\n      configStore.selectedAdapters,\n      false\n    );\n    \n    const successCount = results.filter(r => r.success).length;\n    ElMessage.success(`成功禁用 ${successCount} 个适配器`);\n    configStore.clearAdapterSelection();\n  } catch (error) {\n    ElMessage.error('批量禁用失败：' + error.message);\n  }\n};\n\n// 批量删除\nconst handleBatchDelete = async () => {\n  try {\n    await ElMessageBox.confirm(\n      `确定要删除选中的 ${configStore.selectedAdapters.length} 个适配器吗？`,\n      '批量删除',\n      {\n        confirmButtonText: '删除',\n        cancelButtonText: '取消',\n        type: 'warning'\n      }\n    );\n\n    const results = await configStore.batchDeleteAdapters(\n      configStore.selectedAdapters\n    );\n    \n    const successCount = results.filter(r => r.success).length;\n    ElMessage.success(`成功删除 ${successCount} 个适配器`);\n    configStore.clearAdapterSelection();\n  } catch (error) {\n    if (error !== 'cancel') {\n      ElMessage.error('批量删除失败：' + error.message);\n    }\n  }\n};\n\n// 编辑器关闭\nconst handleEditorClose = () => {\n  editorVisible.value = false;\n};\n\n// 编辑器提交\nconst handleEditorSubmit = async ({ type, index, data, mode }) => {\n  try {\n    if (mode === 'add') {\n      await configStore.addAdapter(type, data);\n      ElMessage.success('添加成功');\n    } else {\n      await configStore.updateAdapter(type, index, data);\n      ElMessage.success('更新成功');\n    }\n  } catch (error) {\n    ElMessage.error(mode === 'add' ? '添加失败：' : '更新失败：' + error.message);\n    throw error; // 重新抛出错误，让编辑器保持打开\n  }\n};\n\n// 初始化\nonMounted(async () => {\n  loading.value = true;\n  try {\n    if (!configStore.config) {\n      await configStore.fetchConfig();\n    }\n    await new Promise(resolve => setTimeout(resolve, 300));\n  } catch (error) {\n    ElMessage.error('加载配置失败：' + error.message);\n  } finally {\n    loading.value = false;\n  }\n});\n</script>\n\n<style scoped lang=\"scss\">\n// 过渡动画\n.fade-enter-active,\n.fade-leave-active {\n  transition: opacity 0.3s ease;\n}\n\n.fade-enter-from,\n.fade-leave-to {\n  opacity: 0;\n}\n\n.llm-adapters-view {\n  padding: 24px;\n  max-width: 1400px;\n  margin: 0 auto;\n}\n\n.loading-container {\n  .skeleton-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin-bottom: 24px;\n\n    .skeleton-title {\n      width: 200px;\n      height: 32px;\n      border-radius: 4px;\n      background: linear-gradient(90deg, #f2f2f2 25%, #e6e6e6 50%, #f2f2f2 75%);\n      background-size: 200% 100%;\n      animation: skeleton-loading 1.5s ease-in-out infinite;\n    }\n\n    .skeleton-actions {\n      display: flex;\n      gap: 12px;\n\n      .skeleton-button {\n        width: 120px;\n        height: 32px;\n        border-radius: 4px;\n        background: linear-gradient(90deg, #f2f2f2 25%, #e6e6e6 50%, #f2f2f2 75%);\n        background-size: 200% 100%;\n        animation: skeleton-loading 1.5s ease-in-out infinite;\n      }\n    }\n  }\n\n  .adapters-grid {\n    display: grid;\n    grid-template-columns: repeat(auto-fill, minmax(380px, 1fr));\n    gap: 16px;\n  }\n}\n\n@keyframes skeleton-loading {\n  0% {\n    background-position: -200% 0;\n  }\n  100% {\n    background-position: 200% 0;\n  }\n}\n\n.content-container {\n  width: 100%;\n}\n\n.page-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 24px;\n\n  h1 {\n    margin: 0;\n    font-size: 24px;\n    font-weight: 600;\n    color: #303133;\n  }\n\n  .header-actions {\n    display: flex;\n    gap: 12px;\n  }\n}\n\n.adapters-container {\n  display: flex;\n  flex-direction: column;\n  gap: 32px;\n}\n\n.adapter-section {\n  .section-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin-bottom: 20px;\n    padding-bottom: 0;\n    border-bottom: none;\n\n    .section-title {\n      display: flex;\n      align-items: center;\n      gap: 12px;\n\n      h2 {\n        margin: 0;\n        font-size: 20px;\n        font-weight: 600;\n        color: #303133;\n      }\n    }\n  }\n\n  .empty-state {\n    padding: 48px 0;\n    background: #f9fafc;\n    border-radius: 16px;\n  }\n\n  .adapters-grid {\n    display: grid;\n    grid-template-columns: repeat(auto-fill, minmax(380px, 1fr));\n    gap: 24px;\n  }\n}\n</style>\n","<template>\n  <div class=\"server-config-view\">\n    <div class=\"page-header\">\n      <h1>服务器配置</h1>\n      <div class=\"header-actions\">\n        <el-button @click=\"handleReset\">重置</el-button>\n        <el-button\n          type=\"primary\"\n          :loading=\"saving\"\n          @click=\"handleSave\"\n        >\n          保存配置\n        </el-button>\n      </div>\n    </div>\n\n    <el-alert\n      type=\"warning\"\n      :closable=\"false\"\n      show-icon\n      style=\"margin-bottom: 24px;\"\n    >\n      <template #title>\n        修改服务器配置需要重启服务才能生效\n      </template>\n    </el-alert>\n\n    <el-card>\n      <el-form\n        ref=\"formRef\"\n        :model=\"formData\"\n        :rules=\"rules\"\n        label-width=\"140px\"\n        label-position=\"left\"\n      >\n        <el-form-item label=\"服务器端口\" prop=\"port\">\n          <el-input-number\n            v-model=\"formData.port\"\n            :min=\"1\"\n            :max=\"65535\"\n            :step=\"1\"\n            controls-position=\"right\"\n            style=\"width: 200px\"\n          />\n          <template #extra>\n            <span class=\"form-item-tip\">\n              服务器监听端口，范围：1-65535，默认 3080\n            </span>\n          </template>\n        </el-form-item>\n\n        <el-form-item label=\"服务器主机\" prop=\"host\">\n          <el-input\n            v-model=\"formData.host\"\n            placeholder=\"0.0.0.0\"\n            style=\"width: 300px\"\n          />\n          <template #extra>\n            <span class=\"form-item-tip\">\n              服务器绑定的主机地址，0.0.0.0 表示监听所有网卡\n            </span>\n          </template>\n        </el-form-item>\n\n        <el-form-item label=\"最大请求频率\" prop=\"max_rate_pre_min\">\n          <el-input-number\n            v-model=\"formData.max_rate_pre_min\"\n            :min=\"1\"\n            :max=\"10000\"\n            :step=\"10\"\n            controls-position=\"right\"\n            style=\"width: 200px\"\n          />\n          <span style=\"margin-left: 12px; color: #909399;\">次/分钟</span>\n          <template #extra>\n            <span class=\"form-item-tip\">\n              每个客户端每分钟允许的最大请求次数，用于限流保护\n            </span>\n          </template>\n        </el-form-item>\n\n        <el-divider />\n\n        <el-form-item label=\"调试模式\" prop=\"debug\">\n          <el-switch\n            v-model=\"formData.debug\"\n            active-text=\"开启\"\n            inactive-text=\"关闭\"\n          />\n          <template #extra>\n            <span class=\"form-item-tip\">\n              开启后将输出详细的调试信息，生产环境建议关闭\n            </span>\n          </template>\n        </el-form-item>\n      </el-form>\n    </el-card>\n  </div>\n</template>\n\n<script setup>\nimport { ref, reactive, onMounted } from 'vue';\nimport { ElMessage, ElMessageBox } from 'element-plus';\nimport { useConfigStore } from '@/stores/configStore.js';\n\nconst configStore = useConfigStore();\nconst formRef = ref(null);\nconst saving = ref(false);\n\n// 表单数据\nconst formData = reactive({\n  port: 3080,\n  host: '0.0.0.0',\n  max_rate_pre_min: 100,\n  debug: false\n});\n\n// 原始数据（用于重置）\nconst originalData = reactive({});\n\n// 验证规则\nconst rules = {\n  port: [\n    { required: true, message: '请输入服务器端口', trigger: 'blur' },\n    {\n      type: 'number',\n      min: 1,\n      max: 65535,\n      message: '端口范围必须在 1-65535 之间',\n      trigger: 'blur'\n    }\n  ],\n  host: [\n    { required: true, message: '请输入服务器主机', trigger: 'blur' }\n  ],\n  max_rate_pre_min: [\n    { required: true, message: '请输入最大请求频率', trigger: 'blur' },\n    {\n      type: 'number',\n      min: 1,\n      message: '最大请求频率必须大于 0',\n      trigger: 'blur'\n    }\n  ]\n};\n\n// 加载配置\nconst loadConfig = async () => {\n  try {\n    const serverConfig = configStore.config?.server || await configStore.fetchConfigSection('server');\n    const debugConfig = configStore.config?.debug ?? false;\n    \n    Object.assign(formData, {\n      port: serverConfig.port || 3080,\n      host: serverConfig.host || '0.0.0.0',\n      max_rate_pre_min: serverConfig.max_rate_pre_min || 100,\n      debug: debugConfig\n    });\n    \n    // 保存原始数据\n    Object.assign(originalData, formData);\n  } catch (error) {\n    ElMessage.error('加载配置失败：' + error.message);\n  }\n};\n\n// 保存配置\nconst handleSave = async () => {\n  try {\n    await formRef.value.validate();\n    \n    await ElMessageBox.confirm(\n      '修改服务器配置需要重启服务才能生效，是否继续？',\n      '确认保存',\n      {\n        confirmButtonText: '保存',\n        cancelButtonText: '取消',\n        type: 'warning'\n      }\n    );\n\n    saving.value = true;\n\n    // 更新 server 配置节点\n    await configStore.updateConfigSection('server', {\n      port: formData.port,\n      host: formData.host,\n      max_rate_pre_min: formData.max_rate_pre_min\n    });\n\n    // 更新 debug 配置（在根节点）\n    if (configStore.config) {\n      configStore.config.debug = formData.debug;\n    }\n\n    ElMessage.success('配置保存成功，请重启服务使配置生效');\n    \n    // 更新原始数据\n    Object.assign(originalData, formData);\n  } catch (error) {\n    if (error !== 'cancel') {\n      ElMessage.error('保存失败：' + error.message);\n    }\n  } finally {\n    saving.value = false;\n  }\n};\n\n// 重置配置\nconst handleReset = () => {\n  Object.assign(formData, originalData);\n  formRef.value?.clearValidate();\n  ElMessage.info('已重置为当前保存的配置');\n};\n\n// 初始化\nonMounted(async () => {\n  if (!configStore.config) {\n    await configStore.fetchConfig();\n  }\n  await loadConfig();\n});\n</script>\n\n<style scoped lang=\"scss\">\n.server-config-view {\n  padding: 24px;\n  max-width: 900px;\n  margin: 0 auto;\n}\n\n.page-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 24px;\n\n  h1 {\n    margin: 0;\n    font-size: 24px;\n    font-weight: 600;\n    color: #303133;\n  }\n\n  .header-actions {\n    display: flex;\n    gap: 12px;\n  }\n}\n\n.form-item-tip {\n  color: #909399;\n  font-size: 12px;\n  line-height: 1.5;\n}\n\n:deep(.el-form-item) {\n  margin-bottom: 28px;\n}\n\n:deep(.el-form-item__extra) {\n  margin-top: 4px;\n}\n</style>\n","<template>\n  <div class=\"web-config-view\">\n    <div class=\"page-header\">\n      <h1>Web 配置</h1>\n      <div class=\"header-actions\">\n        <el-button @click=\"handleReset\">重置</el-button>\n        <el-button\n          type=\"primary\"\n          :loading=\"saving\"\n          @click=\"handleSave\"\n        >\n          保存配置\n        </el-button>\n      </div>\n    </div>\n\n    <el-alert\n      type=\"warning\"\n      :closable=\"false\"\n      show-icon\n      style=\"margin-bottom: 24px;\"\n    >\n      <template #title>\n        修改 Web 配置需要重启服务才能生效\n      </template>\n    </el-alert>\n\n    <el-card>\n      <el-form\n        ref=\"formRef\"\n        :model=\"formData\"\n        :rules=\"rules\"\n        label-width=\"140px\"\n        label-position=\"left\"\n      >\n        <el-form-item label=\"网站标题\" prop=\"title\">\n          <el-input\n            v-model=\"formData.title\"\n            placeholder=\"MioChat\"\n            maxlength=\"50\"\n            show-word-limit\n            style=\"width: 400px\"\n          />\n          <template #extra>\n            <span class=\"form-item-tip\">\n              显示在浏览器标签页和页面顶部的标题\n            </span>\n          </template>\n        </el-form-item>\n\n        <el-form-item label=\"备案号\" prop=\"beian\">\n          <el-input\n            v-model=\"formData.beian\"\n            placeholder=\"留空则不显示\"\n            maxlength=\"100\"\n            show-word-limit\n            style=\"width: 400px\"\n          />\n          <template #extra>\n            <span class=\"form-item-tip\">\n              网站底部显示的备案信息，如：京ICP备12345678号\n            </span>\n          </template>\n        </el-form-item>\n\n        <el-divider />\n\n        <el-form-item label=\"管理员验证码\" prop=\"admin_code\">\n          <el-input\n            v-model=\"formData.admin_code\"\n            :type=\"showAdminCode ? 'text' : 'password'\"\n            placeholder=\"用于访问配置管理\"\n            maxlength=\"50\"\n            show-word-limit\n            style=\"width: 400px\"\n          >\n            <template #append>\n              <el-button\n                :icon=\"showAdminCode ? View : Hide\"\n                @click=\"showAdminCode = !showAdminCode\"\n              />\n            </template>\n          </el-input>\n          <template #extra>\n            <span class=\"form-item-tip\">\n              访问配置管理页面所需的验证码，请妥善保管\n            </span>\n          </template>\n        </el-form-item>\n\n        <el-form-item label=\"访客验证码\" prop=\"user_code\">\n          <el-input\n            v-model=\"formData.user_code\"\n            :type=\"showUserCode ? 'text' : 'password'\"\n            placeholder=\"留空则不需要验证码\"\n            maxlength=\"50\"\n            show-word-limit\n            style=\"width: 400px\"\n          >\n            <template #append>\n              <el-button\n                :icon=\"showUserCode ? View : Hide\"\n                @click=\"showUserCode = !showUserCode\"\n              />\n            </template>\n          </el-input>\n          <template #extra>\n            <span class=\"form-item-tip\">\n              访客访问聊天功能所需的验证码，留空则无需验证\n            </span>\n          </template>\n        </el-form-item>\n\n        <el-divider />\n\n        <el-form-item label=\"全屏模式\" prop=\"full_screen\">\n          <el-switch\n            v-model=\"formData.full_screen\"\n            active-text=\"开启\"\n            inactive-text=\"关闭\"\n          />\n          <template #extra>\n            <span class=\"form-item-tip\">\n              开启后界面将占据整个浏览器窗口\n            </span>\n          </template>\n        </el-form-item>\n      </el-form>\n    </el-card>\n  </div>\n</template>\n\n<script setup>\nimport { ref, reactive, onMounted } from 'vue';\nimport { ElMessage, ElMessageBox } from 'element-plus';\nimport { View, Hide } from '@element-plus/icons-vue';\nimport { useConfigStore } from '@/stores/configStore.js';\n\nconst configStore = useConfigStore();\nconst formRef = ref(null);\nconst saving = ref(false);\nconst showAdminCode = ref(false);\nconst showUserCode = ref(false);\n\n// 表单数据\nconst formData = reactive({\n  title: 'MioChat',\n  beian: '',\n  admin_code: '',\n  user_code: '',\n  full_screen: true\n});\n\n// 原始数据（用于重置）\nconst originalData = reactive({});\n\n// 验证规则\nconst rules = {\n  title: [\n    { required: true, message: '请输入网站标题', trigger: 'blur' }\n  ],\n  admin_code: [\n    { required: true, message: '请输入管理员验证码', trigger: 'blur' },\n    { min: 6, message: '验证码长度至少为 6 位', trigger: 'blur' }\n  ]\n};\n\n// 加载配置\nconst loadConfig = async () => {\n  try {\n    const webConfig = configStore.config?.web || await configStore.fetchConfigSection('web');\n    \n    Object.assign(formData, {\n      title: webConfig.title || 'MioChat',\n      beian: webConfig.beian || '',\n      admin_code: webConfig.admin_code || '',\n      user_code: webConfig.user_code || '',\n      full_screen: webConfig.full_screen ?? true\n    });\n    \n    // 保存原始数据\n    Object.assign(originalData, formData);\n  } catch (error) {\n    ElMessage.error('加载配置失败：' + error.message);\n  }\n};\n\n// 保存配置\nconst handleSave = async () => {\n  try {\n    await formRef.value.validate();\n    \n    await ElMessageBox.confirm(\n      '修改 Web 配置需要重启服务才能生效，是否继续？',\n      '确认保存',\n      {\n        confirmButtonText: '保存',\n        cancelButtonText: '取消',\n        type: 'warning'\n      }\n    );\n\n    saving.value = true;\n\n    await configStore.updateConfigSection('web', {\n      title: formData.title,\n      beian: formData.beian,\n      admin_code: formData.admin_code,\n      user_code: formData.user_code,\n      full_screen: formData.full_screen\n    });\n\n    ElMessage.success('配置保存成功，请重启服务使配置生效');\n    \n    // 更新原始数据\n    Object.assign(originalData, formData);\n  } catch (error) {\n    if (error !== 'cancel') {\n      ElMessage.error('保存失败：' + error.message);\n    }\n  } finally {\n    saving.value = false;\n  }\n};\n\n// 重置配置\nconst handleReset = () => {\n  Object.assign(formData, originalData);\n  formRef.value?.clearValidate();\n  ElMessage.info('已重置为当前保存的配置');\n};\n\n// 初始化\nonMounted(async () => {\n  if (!configStore.config) {\n    await configStore.fetchConfig();\n  }\n  await loadConfig();\n});\n</script>\n\n<style scoped lang=\"scss\">\n.web-config-view {\n  padding: 24px;\n  max-width: 900px;\n  margin: 0 auto;\n}\n\n.page-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 24px;\n\n  h1 {\n    margin: 0;\n    font-size: 24px;\n    font-weight: 600;\n    color: #303133;\n  }\n\n  .header-actions {\n    display: flex;\n    gap: 12px;\n  }\n}\n\n.form-item-tip {\n  color: #909399;\n  font-size: 12px;\n  line-height: 1.5;\n}\n\n:deep(.el-form-item) {\n  margin-bottom: 28px;\n}\n\n:deep(.el-form-item__extra) {\n  margin-top: 4px;\n}\n</style>\n","<template>\n  <div class=\"onebot-config-view\">\n    <div class=\"page-header\">\n      <h1>OneBot 配置</h1>\n      <div class=\"header-actions\">\n        <el-button @click=\"handleReset\">重置</el-button>\n        <el-button\n          type=\"primary\"\n          :loading=\"saving\"\n          @click=\"handleSave\"\n        >\n          保存配置\n        </el-button>\n      </div>\n    </div>\n\n    <el-alert\n      type=\"warning\"\n      :closable=\"false\"\n      show-icon\n      style=\"margin-bottom: 24px;\"\n    >\n      <template #title>\n        修改 OneBot 配置需要重启服务才能生效\n      </template>\n    </el-alert>\n\n    <el-card>\n      <el-form\n        ref=\"formRef\"\n        :model=\"formData\"\n        :rules=\"rules\"\n        label-width=\"160px\"\n        label-position=\"left\"\n      >\n        <el-form-item label=\"启用 OneBot\" prop=\"enable\">\n          <el-switch\n            v-model=\"formData.enable\"\n            active-text=\"启用\"\n            inactive-text=\"禁用\"\n          />\n          <template #extra>\n            <span class=\"form-item-tip\">\n              是否启用 OneBot 协议支持（QQ 机器人）\n            </span>\n          </template>\n        </el-form-item>\n\n        <template v-if=\"formData.enable\">\n          <el-divider content-position=\"left\">连接配置</el-divider>\n\n          <el-form-item label=\"反向 WebSocket URL\" prop=\"reverse_ws_url\">\n            <el-input\n              v-model=\"formData.reverse_ws_url\"\n              placeholder=\"ws://localhost:2536/OneBotv11\"\n              style=\"width: 500px\"\n            />\n            <template #extra>\n              <span class=\"form-item-tip\">\n                OneBot 实现端的反向 WebSocket 地址（如 go-cqhttp）\n              </span>\n            </template>\n          </el-form-item>\n\n          <el-form-item label=\"Access Token\" prop=\"token\">\n            <el-input\n              v-model=\"formData.token\"\n              :type=\"showToken ? 'text' : 'password'\"\n              placeholder=\"留空则不使用 token 验证\"\n              maxlength=\"100\"\n              show-word-limit\n              style=\"width: 500px\"\n            >\n              <template #append>\n                <el-button\n                  :icon=\"showToken ? View : Hide\"\n                  @click=\"showToken = !showToken\"\n                />\n              </template>\n            </el-input>\n            <template #extra>\n              <span class=\"form-item-tip\">\n                与 OneBot 实现端配置的 access_token 保持一致\n              </span>\n            </template>\n          </el-form-item>\n\n          <el-divider content-position=\"left\">机器人配置</el-divider>\n\n          <el-form-item label=\"机器人 QQ 号\" prop=\"bot_qq\">\n            <el-input\n              v-model=\"formData.bot_qq\"\n              placeholder=\"3038848622\"\n              maxlength=\"20\"\n              style=\"width: 300px\"\n            />\n            <template #extra>\n              <span class=\"form-item-tip\">\n                接入的 QQ 机器人账号\n              </span>\n            </template>\n          </el-form-item>\n\n          <el-form-item label=\"管理员 QQ 号\" prop=\"admin_qq\">\n            <el-input\n              v-model=\"formData.admin_qq\"\n              placeholder=\"1099834705\"\n              maxlength=\"20\"\n              style=\"width: 300px\"\n            />\n            <template #extra>\n              <span class=\"form-item-tip\">\n                机器人管理员的 QQ 号，拥有特殊权限\n              </span>\n            </template>\n          </el-form-item>\n        </template>\n      </el-form>\n    </el-card>\n\n    <!-- 连接状态（可选） -->\n    <el-card v-if=\"formData.enable\" style=\"margin-top: 16px;\">\n      <template #header>\n        <div class=\"card-header\">\n          <span>连接状态</span>\n        </div>\n      </template>\n      <el-alert\n        type=\"info\"\n        :closable=\"false\"\n        show-icon\n      >\n        <template #title>\n          连接状态监控功能需要后端支持，暂未实现\n        </template>\n      </el-alert>\n    </el-card>\n  </div>\n</template>\n\n<script setup>\nimport { ref, reactive, onMounted } from 'vue';\nimport { ElMessage, ElMessageBox } from 'element-plus';\nimport { View, Hide } from '@element-plus/icons-vue';\nimport { useConfigStore } from '@/stores/configStore.js';\n\nconst configStore = useConfigStore();\nconst formRef = ref(null);\nconst saving = ref(false);\nconst showToken = ref(false);\n\n// 表单数据\nconst formData = reactive({\n  enable: false,\n  reverse_ws_url: '',\n  token: '',\n  bot_qq: '',\n  admin_qq: ''\n});\n\n// 原始数据（用于重置）\nconst originalData = reactive({});\n\n// 验证规则\nconst rules = {\n  reverse_ws_url: [\n    {\n      validator: (rule, value, callback) => {\n        if (formData.enable && !value) {\n          callback(new Error('请输入反向 WebSocket URL'));\n        } else if (value && !value.startsWith('ws://') && !value.startsWith('wss://')) {\n          callback(new Error('URL 必须以 ws:// 或 wss:// 开头'));\n        } else {\n          callback();\n        }\n      },\n      trigger: 'blur'\n    }\n  ],\n  bot_qq: [\n    {\n      validator: (rule, value, callback) => {\n        if (formData.enable && !value) {\n          callback(new Error('请输入机器人 QQ 号'));\n        } else if (value && !/^\\d+$/.test(value)) {\n          callback(new Error('QQ 号必须为纯数字'));\n        } else {\n          callback();\n        }\n      },\n      trigger: 'blur'\n    }\n  ],\n  admin_qq: [\n    {\n      validator: (rule, value, callback) => {\n        if (value && !/^\\d+$/.test(value)) {\n          callback(new Error('QQ 号必须为纯数字'));\n        } else {\n          callback();\n        }\n      },\n      trigger: 'blur'\n    }\n  ]\n};\n\n// 加载配置\nconst loadConfig = async () => {\n  try {\n    const onebotConfig = configStore.config?.onebot || await configStore.fetchConfigSection('onebot');\n    \n    Object.assign(formData, {\n      enable: onebotConfig.enable ?? false,\n      reverse_ws_url: onebotConfig.reverse_ws_url || '',\n      token: onebotConfig.token || '',\n      bot_qq: onebotConfig.bot_qq || '',\n      admin_qq: onebotConfig.admin_qq || ''\n    });\n    \n    // 保存原始数据\n    Object.assign(originalData, formData);\n  } catch (error) {\n    ElMessage.error('加载配置失败：' + error.message);\n  }\n};\n\n// 保存配置\nconst handleSave = async () => {\n  try {\n    await formRef.value.validate();\n    \n    await ElMessageBox.confirm(\n      '修改 OneBot 配置需要重启服务才能生效，是否继续？',\n      '确认保存',\n      {\n        confirmButtonText: '保存',\n        cancelButtonText: '取消',\n        type: 'warning'\n      }\n    );\n\n    saving.value = true;\n\n    await configStore.updateConfigSection('onebot', {\n      enable: formData.enable,\n      reverse_ws_url: formData.reverse_ws_url,\n      token: formData.token,\n      bot_qq: formData.bot_qq,\n      admin_qq: formData.admin_qq\n    });\n\n    ElMessage.success('配置保存成功，请重启服务使配置生效');\n    \n    // 更新原始数据\n    Object.assign(originalData, formData);\n  } catch (error) {\n    if (error !== 'cancel') {\n      ElMessage.error('保存失败：' + error.message);\n    }\n  } finally {\n    saving.value = false;\n  }\n};\n\n// 重置配置\nconst handleReset = () => {\n  Object.assign(formData, originalData);\n  formRef.value?.clearValidate();\n  ElMessage.info('已重置为当前保存的配置');\n};\n\n// 初始化\nonMounted(async () => {\n  if (!configStore.config) {\n    await configStore.fetchConfig();\n  }\n  await loadConfig();\n});\n</script>\n\n<style scoped lang=\"scss\">\n.onebot-config-view {\n  padding: 24px;\n  max-width: 900px;\n  margin: 0 auto;\n}\n\n.page-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 24px;\n\n  h1 {\n    margin: 0;\n    font-size: 24px;\n    font-weight: 600;\n    color: #303133;\n  }\n\n  .header-actions {\n    display: flex;\n    gap: 12px;\n  }\n}\n\n.card-header {\n  font-weight: 600;\n  color: #303133;\n}\n\n.form-item-tip {\n  color: #909399;\n  font-size: 12px;\n  line-height: 1.5;\n}\n\n:deep(.el-form-item) {\n  margin-bottom: 28px;\n}\n\n:deep(.el-form-item__extra) {\n  margin-top: 4px;\n}\n\n:deep(.el-divider) {\n  margin: 24px 0 16px 0;\n}\n\n:deep(.el-divider__text) {\n  font-weight: 600;\n  color: #606266;\n}\n</style>\n","<template>\n  <div class=\"plugins-view\">\n    <!-- 加载骨架屏 -->\n    <div v-if=\"loading\" class=\"loading-container\">\n      <div class=\"skeleton-header\">\n        <div class=\"skeleton-title\"></div>\n        <div class=\"skeleton-actions\">\n          <div class=\"skeleton-button\" v-for=\"i in 2\" :key=\"i\"></div>\n        </div>\n      </div>\n      <div class=\"plugins-grid\">\n        <LoadingSkeleton v-for=\"i in 6\" :key=\"i\" type=\"adapter-card\" is-card />\n      </div>\n    </div>\n\n    <transition name=\"fade\" mode=\"out-in\">\n      <div v-if=\"!loading\" class=\"content-container\">\n        <!-- 页面头部 -->\n        <div class=\"page-header\">\n          <h1>插件管理</h1>\n          <div class=\"header-actions\">\n            <el-button\n              type=\"primary\"\n              :icon=\"Refresh\"\n              :loading=\"refreshing\"\n              @click=\"handleRefreshPlugins\"\n            >\n              刷新插件\n            </el-button>\n            <el-button\n              type=\"success\"\n              :icon=\"RefreshRight\"\n              @click=\"handleReloadAll\"\n            >\n              重载全部\n            </el-button>\n          </div>\n        </div>\n\n        <!-- 统计卡片 -->\n        <div class=\"stats-row\">\n          <el-card class=\"stat-card\">\n            <div class=\"stat-icon\" style=\"background-color: #409eff20;\">\n              <el-icon :size=\"24\" color=\"#409eff\"><Grid /></el-icon>\n            </div>\n            <div class=\"stat-content\">\n              <div class=\"stat-value\">{{ plugins.length }}</div>\n              <div class=\"stat-label\">插件总数</div>\n            </div>\n          </el-card>\n\n          <el-card class=\"stat-card\">\n            <div class=\"stat-icon\" style=\"background-color: #67c23a20;\">\n              <el-icon :size=\"24\" color=\"#67c23a\"><CircleCheck /></el-icon>\n            </div>\n            <div class=\"stat-content\">\n              <div class=\"stat-value\">{{ enabledCount }}</div>\n              <div class=\"stat-label\">已启用</div>\n            </div>\n          </el-card>\n\n          <el-card class=\"stat-card\">\n            <div class=\"stat-icon\" style=\"background-color: #e6a23c20;\">\n              <el-icon :size=\"24\" color=\"#e6a23c\"><Tools /></el-icon>\n            </div>\n            <div class=\"stat-content\">\n              <div class=\"stat-value\">{{ totalToolsCount }}</div>\n              <div class=\"stat-label\">工具总数</div>\n            </div>\n          </el-card>\n\n          <el-card class=\"stat-card\">\n            <div class=\"stat-icon\" style=\"background-color: #90939920;\">\n              <el-icon :size=\"24\" color=\"#909399\"><Box /></el-icon>\n            </div>\n            <div class=\"stat-content\">\n              <div class=\"stat-value\">{{ customPluginsCount }}</div>\n              <div class=\"stat-label\">自定义插件</div>\n            </div>\n          </el-card>\n        </div>\n\n        <!-- 插件列表 -->\n        <div class=\"plugins-list\">\n          <el-card\n            v-for=\"plugin in plugins\"\n            :key=\"plugin.name\"\n            class=\"plugin-card\"\n            :class=\"{ disabled: !plugin.enabled }\"\n          >\n            <div class=\"plugin-header\">\n              <div class=\"plugin-info\">\n                <div class=\"plugin-title-row\">\n                  <h3 class=\"plugin-name\">\n                    <el-tag\n                      v-if=\"plugin.type === 'custom'\"\n                      type=\"warning\"\n                      size=\"small\"\n                      style=\"margin-right: 8px;\"\n                    >\n                      自定义\n                    </el-tag>\n                    {{ plugin.displayName }}\n                  </h3>\n                  <el-switch\n                    v-model=\"plugin.enabled\"\n                    @change=\"handleTogglePlugin(plugin)\"\n                    :loading=\"plugin.toggling\"\n                  />\n                </div>\n                <p class=\"plugin-description\">{{ plugin.description || '暂无描述' }}</p>\n                <div class=\"plugin-meta\">\n                  <el-tag size=\"small\" type=\"info\">v{{ plugin.version }}</el-tag>\n                  <span class=\"meta-item\">\n                    <el-icon><User /></el-icon>\n                    {{ plugin.author }}\n                  </span>\n                  <span class=\"meta-item\">\n                    <el-icon><Tools /></el-icon>\n                    {{ plugin.toolCount }} 个工具\n                  </span>\n                  <el-tag\n                    v-if=\"plugin.hasConfig\"\n                    size=\"small\"\n                    type=\"success\"\n                  >\n                    <el-icon><Setting /></el-icon>\n                    可配置\n                  </el-tag>\n                </div>\n              </div>\n            </div>\n\n            <div class=\"plugin-actions\">\n              <el-button\n                size=\"small\"\n                :icon=\"View\"\n                @click=\"handleViewPlugin(plugin)\"\n              >\n                查看详情\n              </el-button>\n              <el-button\n                v-if=\"plugin.hasConfig\"\n                size=\"small\"\n                :icon=\"Setting\"\n                @click=\"handleConfigPlugin(plugin)\"\n              >\n                配置\n              </el-button>\n              <el-button\n                size=\"small\"\n                type=\"primary\"\n                :icon=\"Refresh\"\n                :loading=\"plugin.reloading\"\n                @click=\"handleReloadPlugin(plugin)\"\n              >\n                重载\n              </el-button>\n            </div>\n          </el-card>\n        </div>\n      </div>\n    </transition>\n\n    <!-- 插件详情对话框 -->\n    <el-dialog\n      v-model=\"detailDialogVisible\"\n      :title=\"`${currentPlugin?.displayName} - 详情`\"\n      width=\"800px\"\n      destroy-on-close\n    >\n      <div v-if=\"currentPlugin\" class=\"plugin-detail\">\n        <el-descriptions :column=\"2\" border>\n          <el-descriptions-item label=\"插件名称\">\n            {{ currentPlugin.displayName }}\n          </el-descriptions-item>\n          <el-descriptions-item label=\"版本\">\n            {{ currentPlugin.version }}\n          </el-descriptions-item>\n          <el-descriptions-item label=\"作者\">\n            {{ currentPlugin.author }}\n          </el-descriptions-item>\n          <el-descriptions-item label=\"类型\">\n            <el-tag :type=\"currentPlugin.type === 'standard' ? 'success' : 'warning'\">\n              {{ currentPlugin.type === 'standard' ? '标准插件' : '自定义插件' }}\n            </el-tag>\n          </el-descriptions-item>\n          <el-descriptions-item label=\"状态\">\n            <el-tag :type=\"currentPlugin.enabled ? 'success' : 'info'\">\n              {{ currentPlugin.enabled ? '已启用' : '已禁用' }}\n            </el-tag>\n          </el-descriptions-item>\n          <el-descriptions-item label=\"工具数量\">\n            {{ currentPlugin.toolCount }}\n          </el-descriptions-item>\n          <el-descriptions-item label=\"描述\" :span=\"2\">\n            {{ currentPlugin.description || '暂无描述' }}\n          </el-descriptions-item>\n        </el-descriptions>\n\n        <!-- 工具列表 -->\n        <div v-if=\"pluginTools.length > 0\" class=\"tools-section\">\n          <h4>提供的工具</h4>\n          <el-collapse v-model=\"activeCollapseNames\">\n            <el-collapse-item\n              v-for=\"group in pluginTools\"\n              :key=\"group.group\"\n              :name=\"group.group\"\n              :title=\"`${group.group} (${group.tools.length})`\"\n            >\n              <div\n                v-for=\"tool in group.tools\"\n                :key=\"tool.name\"\n                class=\"tool-item\"\n              >\n                <div class=\"tool-header\">\n                  <h5>{{ tool.name }}</h5>\n                  <el-button\n                    size=\"small\"\n                    type=\"primary\"\n                    :icon=\"Cpu\"\n                    @click=\"handleDebugTool(tool)\"\n                  >\n                    调试\n                  </el-button>\n                </div>\n                <p class=\"tool-description\">{{ tool.description }}</p>\n                <el-tag size=\"small\" type=\"info\">\n                  参数: {{ Object.keys(tool.parameters?.properties || {}).length }}\n                </el-tag>\n              </div>\n            </el-collapse-item>\n          </el-collapse>\n        </div>\n      </div>\n    </el-dialog>\n\n    <!-- 配置对话框 -->\n    <el-dialog\n      v-model=\"configDialogVisible\"\n      :title=\"`${currentPlugin?.displayName} - 配置`\"\n      width=\"700px\"\n      destroy-on-close\n    >\n      <div class=\"config-editor\">\n        <el-alert\n          type=\"info\"\n          :closable=\"false\"\n          show-icon\n          style=\"margin-bottom: 16px;\"\n        >\n          <template #title>\n            配置将自动保存并触发热更新\n          </template>\n        </el-alert>\n        \n        <el-input\n          v-model=\"configJsonStr\"\n          type=\"textarea\"\n          :rows=\"15\"\n          placeholder=\"JSON 配置\"\n          class=\"config-textarea\"\n        />\n      </div>\n      \n      <template #footer>\n        <el-button @click=\"configDialogVisible = false\">取消</el-button>\n        <el-button\n          type=\"primary\"\n          :loading=\"savingConfig\"\n          @click=\"handleSaveConfig\"\n        >\n          保存配置\n        </el-button>\n      </template>\n    </el-dialog>\n\n    <!-- 工具调试对话框 -->\n    <el-dialog\n      v-model=\"debugDialogVisible\"\n      :title=\"`调试工具: ${currentTool?.name}`\"\n      width=\"800px\"\n      destroy-on-close\n      class=\"debug-dialog\"\n    >\n      <div class=\"debug-container\" style=\"height: 60vh; overflow-y: auto;\">\n        <!-- 工具信息 -->\n        <el-card class=\"tool-info-card\" shadow=\"never\">\n          <div class=\"tool-info\">\n            <div class=\"info-row\">\n              <label>工具名称</label>\n              <el-tag type=\"primary\">{{ currentTool?.name }}</el-tag>\n            </div>\n            <div class=\"info-row\">\n              <label>描述</label>\n              <span>{{ currentTool?.description || '无描述' }}</span>\n            </div>\n          </div>\n        </el-card>\n\n        <!-- 参数说明 -->\n        <el-card class=\"params-schema-card\" shadow=\"never\" v-if=\"currentTool?.parameters\">\n          <template #header>\n            <div class=\"card-header\">\n              <span>参数说明</span>\n              <el-button\n                size=\"small\"\n                type=\"primary\"\n                text\n                @click=\"fillExampleParams\"\n              >\n                填充示例参数\n              </el-button>\n            </div>\n          </template>\n          \n          <div class=\"params-schema\">\n            <div\n              v-for=\"(prop, key) in currentTool?.parameters?.properties\"\n              :key=\"key\"\n              class=\"param-item\"\n            >\n              <div class=\"param-header\">\n                <span class=\"param-name\">\n                  {{ key }}\n                  <el-tag\n                    v-if=\"currentTool?.parameters?.required?.includes(key)\"\n                    type=\"danger\"\n                    size=\"small\"\n                    effect=\"plain\"\n                  >\n                    必需\n                  </el-tag>\n                  <el-tag\n                    v-else\n                    type=\"info\"\n                    size=\"small\"\n                    effect=\"plain\"\n                  >\n                    可选\n                  </el-tag>\n                </span>\n                <el-tag size=\"small\" type=\"info\">{{ prop.type }}</el-tag>\n              </div>\n              <div class=\"param-description\">{{ prop.description || '无描述' }}</div>\n              <div v-if=\"prop.enum\" class=\"param-enum\">\n                可选值: {{ prop.enum.join(', ') }}\n              </div>\n              <div v-if=\"prop.items\" class=\"param-items\">\n                数组项类型: {{ prop.items.type }}\n              </div>\n            </div>\n          </div>\n        </el-card>\n\n        <!-- 参数输入 -->\n        <el-card class=\"params-input-card\" shadow=\"never\">\n          <template #header>\n            <div class=\"card-header\">\n              <span>参数输入 (JSON 格式)</span>\n              <el-button\n                size=\"small\"\n                type=\"warning\"\n                text\n                @click=\"debugParams = '{}'\"\n              >\n                清空\n              </el-button>\n            </div>\n          </template>\n          \n          <el-input\n            v-model=\"debugParams\"\n            type=\"textarea\"\n            :rows=\"6\"\n            placeholder='请输入 JSON 格式的参数，例如: {\"query\": \"test\", \"limit\": 10}'\n            class=\"params-textarea\"\n          />\n          \n          <div class=\"params-hint\">\n            <el-icon><InfoFilled /></el-icon>\n            提示: 请确保输入的是有效的 JSON 格式，必需参数不能缺失\n          </div>\n        </el-card>\n\n        <!-- 执行结果 -->\n        <div v-if=\"debugResult\" class=\"result-container\">\n          <el-card class=\"result-card\" shadow=\"never\">\n            <template #header>\n              <div class=\"card-header\">\n                <span>执行结果</span>\n              </div>\n            </template>\n            \n            <div class=\"debug-result-wrapper\" :class=\"debugResult.success ? 'status-success' : 'status-error'\">\n              <div class=\"result-header\">\n                <div class=\"status-indicator\">\n                  <el-icon :size=\"18\" class=\"icon\">\n                    <CircleCheckFilled v-if=\"debugResult.success\" />\n                    <CircleCloseFilled v-else />\n                  </el-icon>\n                  <span class=\"status-text\">{{ debugResult.success ? '执行成功' : '执行失败' }}</span>\n                </div>\n                <div v-if=\"debugResult.success\" class=\"execution-meta\">\n                  <span class=\"meta-item\">耗时: {{ debugResult.executionTime }}</span>\n                </div>\n              </div>\n\n              <div class=\"result-body\">\n                <template v-if=\"debugResult.success\">\n                  <div class=\"plugin-info-bar\">\n                    <span class=\"info-item\">\n                      <span class=\"label\">插件:</span>\n                      <span class=\"value\">{{ debugResult.pluginName }}</span>\n                    </span>\n                    <span class=\"divider\">|</span>\n                    <span class=\"info-item\">\n                      <span class=\"label\">工具:</span>\n                      <span class=\"value\">{{ debugResult.toolName }}</span>\n                    </span>\n                  </div>\n                  \n                  <div class=\"json-viewer-container\">\n                    <div class=\"viewer-label\">返回结果</div>\n                    <div class=\"json-content\">\n                      <pre>{{ JSON.stringify(debugResult.result, null, 2) }}</pre>\n                    </div>\n                  </div>\n                </template>\n\n                <template v-else>\n                  <div class=\"error-content\">\n                    <div class=\"error-message-box\">\n                      <el-icon class=\"error-icon\"><InfoFilled /></el-icon>\n                      <span class=\"message-text\">{{ debugResult.error?.message || '未知错误' }}</span>\n                    </div>\n                    <div v-if=\"debugResult.error?.stack\" class=\"error-stack\">\n                      <div class=\"stack-label\">错误堆栈</div>\n                      <pre class=\"stack-content\">{{ debugResult.error.stack }}</pre>\n                    </div>\n                  </div>\n                </template>\n              </div>\n            </div>\n          </el-card>\n        </div>\n      </div>\n\n      <template #footer>\n        <el-button @click=\"debugDialogVisible = false\">关闭</el-button>\n        <el-button\n          type=\"primary\"\n          :icon=\"Cpu\"\n          :loading=\"debugging\"\n          @click=\"handleExecuteDebug\"\n        >\n          执行调试\n        </el-button>\n      </template>\n    </el-dialog>\n  </div>\n</template>\n\n<script setup>\nimport { ref, computed, onMounted } from 'vue';\nimport { ElMessage, ElMessageBox } from 'element-plus';\nimport {\n  Refresh,\n  RefreshRight,\n  Grid,\n  CircleCheck,\n  CircleCheckFilled,\n  CircleCloseFilled,\n  Tools,\n  Box,\n  User,\n  Setting,\n  View,\n  Cpu,\n  InfoFilled\n} from '@element-plus/icons-vue';\nimport LoadingSkeleton from '@/components/settings/LoadingSkeleton.vue';\nimport { pluginAPI } from '@/lib/configApi.js';\n\nconst loading = ref(false);\nconst refreshing = ref(false);\nconst plugins = ref([]);\nconst detailDialogVisible = ref(false);\nconst configDialogVisible = ref(false);\nconst debugDialogVisible = ref(false);\nconst currentPlugin = ref(null);\nconst currentTool = ref(null);\nconst pluginTools = ref([]);\nconst configJsonStr = ref('');\nconst savingConfig = ref(false);\nconst debugParams = ref('{}');\nconst debugResult = ref(null);\nconst debugging = ref(false);\nconst activeCollapseNames = ref([]);\n\n// 统计数据\nconst enabledCount = computed(() => plugins.value.filter(p => p.enabled).length);\nconst totalToolsCount = computed(() => plugins.value.reduce((sum, p) => sum + p.toolCount, 0));\nconst customPluginsCount = computed(() => plugins.value.filter(p => p.type === 'custom').length);\n\n// 加载插件列表\nconst loadPlugins = async () => {\n  loading.value = true;\n  try {\n    const result = await pluginAPI.listPlugins();\n    if (result.code === 0) {\n      plugins.value = result.data.plugins.map(p => ({\n        ...p,\n        reloading: false,\n        toggling: false\n      }));\n    } else {\n      ElMessage.error('加载插件列表失败：' + result.message);\n    }\n  } catch (error) {\n    ElMessage.error('加载插件列表失败：' + error.message);\n  } finally {\n    loading.value = false;\n  }\n};\n\n// 刷新插件\nconst handleRefreshPlugins = async () => {\n  refreshing.value = true;\n  try {\n    await loadPlugins();\n    ElMessage.success('刷新成功');\n  } finally {\n    refreshing.value = false;\n  }\n};\n\n// 重载所有插件\nconst handleReloadAll = async () => {\n  try {\n    await ElMessageBox.confirm(\n      '将重新加载所有插件的工具，是否继续？',\n      '确认重载',\n      {\n        confirmButtonText: '确认',\n        cancelButtonText: '取消',\n        type: 'warning'\n      }\n    );\n\n    const result = await pluginAPI.reloadAllPlugins();\n    if (result.code === 0) {\n      ElMessage.success(`重载完成：成功 ${result.data.successCount}/${result.data.totalCount}`);\n      await loadPlugins();\n    } else {\n      ElMessage.error('重载失败：' + result.message);\n    }\n  } catch (error) {\n    if (error !== 'cancel') {\n      ElMessage.error('重载失败：' + error.message);\n    }\n  }\n};\n\n// 重载单个插件\nconst handleReloadPlugin = async (plugin) => {\n  plugin.reloading = true;\n  try {\n    const result = await pluginAPI.reloadPlugin(plugin.name);\n    if (result.code === 0) {\n      ElMessage.success(`${plugin.displayName} 重载成功`);\n      await loadPlugins();\n    } else {\n      ElMessage.error('重载失败：' + result.message);\n    }\n  } catch (error) {\n    ElMessage.error('重载失败：' + error.message);\n  } finally {\n    plugin.reloading = false;\n  }\n};\n\n// 切换插件启用状态\nconst handleTogglePlugin = async (plugin) => {\n  plugin.toggling = true;\n  try {\n    const result = await pluginAPI.togglePlugin(plugin.name, plugin.enabled);\n    if (result.code === 0) {\n      ElMessage.success(`${plugin.displayName} 已${plugin.enabled ? '启用' : '禁用'}`);\n    } else {\n      ElMessage.error('操作失败：' + result.message);\n      plugin.enabled = !plugin.enabled; // 回滚\n    }\n  } catch (error) {\n    ElMessage.error('操作失败：' + error.message);\n    plugin.enabled = !plugin.enabled; // 回滚\n  } finally {\n    plugin.toggling = false;\n  }\n};\n// 查看插件详情\nconst handleViewPlugin = async (plugin) => {\n  currentPlugin.value = plugin;\n  detailDialogVisible.value = true;\n  \n  try {\n    const result = await pluginAPI.getPluginTools(plugin.name);\n    if (result.code === 0) {\n      pluginTools.value = result.data.tools;\n      // 默认展开所有分组\n      activeCollapseNames.value = result.data.tools.map(g => g.group);\n    }\n  } catch (error) {\n    ElMessage.error('加载工具列表失败：' + error.message);\n  }\n};\n\n// 配置插件\nconst handleConfigPlugin = async (plugin) => {\n  currentPlugin.value = plugin;\n  \n  try {\n    const result = await pluginAPI.getPluginConfig(plugin.name);\n    if (result.code === 0) {\n      configJsonStr.value = JSON.stringify(result.data, null, 2);\n      configDialogVisible.value = true;\n    } else {\n      ElMessage.error('加载配置失败：' + result.message);\n    }\n  } catch (error) {\n    ElMessage.error('加载配置失败：' + error.message);\n  }\n};\n\n// 保存配置\nconst handleSaveConfig = async () => {\n  try {\n    const config = JSON.parse(configJsonStr.value);\n    savingConfig.value = true;\n    \n    const result = await pluginAPI.updatePluginConfig(currentPlugin.value.name, config);\n    if (result.code === 0) {\n      ElMessage.success('配置保存成功');\n      configDialogVisible.value = false;\n      \n      // 提示用户可能需要重载插件\n      ElMessageBox.confirm(\n        '配置已更新，是否立即重载插件使配置生效？',\n        '提示',\n        {\n          confirmButtonText: '立即重载',\n          cancelButtonText: '稍后',\n          type: 'info'\n        }\n      ).then(async () => {\n        await handleReloadPlugin(currentPlugin.value);\n      }).catch(() => {});\n    } else {\n      ElMessage.error('保存失败：' + result.message);\n    }\n  } catch (error) {\n    if (error instanceof SyntaxError) {\n      ElMessage.error('JSON 格式错误');\n    } else {\n      ElMessage.error('保存失败：' + error.message);\n    }\n  } finally {\n    savingConfig.value = false;\n  }\n};\n\n// 调试工具\nconst handleDebugTool = (tool) => {\n  currentTool.value = tool;\n  debugParams.value = '{}';\n  debugResult.value = null;\n  debugDialogVisible.value = true;\n};\n\n// 填充示例参数\nconst fillExampleParams = () => {\n  if (!currentTool.value?.parameters?.properties) {\n    debugParams.value = '{}';\n    return;\n  }\n\n  const example = {};\n  const props = currentTool.value.parameters.properties;\n  \n  for (const [key, prop] of Object.entries(props)) {\n    // 根据类型生成示例值\n    switch (prop.type) {\n      case 'string':\n        if (prop.enum && prop.enum.length > 0) {\n          example[key] = prop.enum[0];\n        } else if (key.toLowerCase().includes('url')) {\n          example[key] = 'https://example.com';\n        } else if (key.toLowerCase().includes('path')) {\n          example[key] = '/path/to/file';\n        } else if (key.toLowerCase().includes('query') || key.toLowerCase().includes('search')) {\n          example[key] = '搜索关键词';\n        } else {\n          example[key] = '示例文本';\n        }\n        break;\n      case 'number':\n      case 'integer':\n        example[key] = prop.minimum || 0;\n        break;\n      case 'boolean':\n        example[key] = true;\n        break;\n      case 'array':\n        example[key] = [];\n        break;\n      case 'object':\n        example[key] = {};\n        break;\n      default:\n        example[key] = null;\n    }\n  }\n  \n  debugParams.value = JSON.stringify(example, null, 2);\n};\n\n// 执行调试\nconst handleExecuteDebug = async () => {\n  try {\n    const params = JSON.parse(debugParams.value);\n    debugging.value = true;\n    debugResult.value = null;\n    \n    const result = await pluginAPI.debugTool(\n      currentPlugin.value.name,\n      currentTool.value.name,\n      params\n    );\n    \n    if (result.code === 0) {\n      debugResult.value = result.data;\n    } else {\n      ElMessage.error('调试失败：' + result.message);\n    }\n  } catch (error) {\n    if (error instanceof SyntaxError) {\n      ElMessage.error('参数 JSON 格式错误');\n    } else {\n      ElMessage.error('调试失败：' + error.message);\n    }\n  } finally {\n    debugging.value = false;\n  }\n};\n\n// 初始化\nonMounted(() => {\n  loadPlugins();\n});\n</script>\n\n<style scoped lang=\"scss\">\n.plugins-view {\n  width: 100%;\n  height: 100%;\n}\n\n.loading-container {\n  padding: 24px;\n}\n\n.skeleton-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 24px;\n\n  .skeleton-title {\n    width: 200px;\n    height: 32px;\n    background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);\n    background-size: 200% 100%;\n    animation: loading 1.5s ease-in-out infinite;\n    border-radius: 4px;\n  }\n\n  .skeleton-actions {\n    display: flex;\n    gap: 12px;\n\n    .skeleton-button {\n      width: 100px;\n      height: 32px;\n      background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);\n      background-size: 200% 100%;\n      animation: loading 1.5s ease-in-out infinite;\n      border-radius: 4px;\n    }\n  }\n}\n\n.plugins-grid {\n  display: grid;\n  grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));\n  gap: 16px;\n}\n\n.content-container {\n  padding: 24px;\n  animation: fadeIn 0.3s ease;\n}\n\n.page-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 24px;\n\n  h1 {\n    margin: 0;\n    font-size: 24px;\n    font-weight: 600;\n    color: #303133;\n  }\n\n  .header-actions {\n    display: flex;\n    gap: 12px;\n  }\n}\n\n.stats-row {\n  display: grid;\n  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));\n  gap: 16px;\n  margin-bottom: 24px;\n\n  .stat-card {\n    cursor: default;\n\n    :deep(.el-card__body) {\n      display: flex;\n      align-items: center;\n      gap: 16px;\n      padding: 20px;\n    }\n\n    .stat-icon {\n      width: 56px;\n      height: 56px;\n      border-radius: 12px;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n    }\n\n    .stat-content {\n      flex: 1;\n\n      .stat-value {\n        font-size: 28px;\n        font-weight: 600;\n        color: #303133;\n        line-height: 1;\n        margin-bottom: 8px;\n      }\n\n      .stat-label {\n        font-size: 14px;\n        color: #909399;\n      }\n    }\n  }\n}\n\n.plugins-list {\n  display: grid;\n  gap: 16px;\n\n  .plugin-card {\n    transition: all 0.3s ease;\n\n    &:hover {\n      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);\n    }\n\n    &.disabled {\n      opacity: 0.6;\n    }\n\n    :deep(.el-card__body) {\n      padding: 20px;\n    }\n\n    .plugin-header {\n      display: flex;\n      justify-content: space-between;\n      align-items: flex-start;\n      margin-bottom: 16px;\n\n      .plugin-info {\n        flex: 1;\n\n        .plugin-title-row {\n          display: flex;\n          justify-content: space-between;\n          align-items: center;\n          margin-bottom: 8px;\n\n          .plugin-name {\n            margin: 0;\n            font-size: 18px;\n            font-weight: 600;\n            color: #303133;\n            display: flex;\n            align-items: center;\n          }\n        }\n\n        .plugin-description {\n          margin: 0 0 12px 0;\n          font-size: 14px;\n          color: #606266;\n          line-height: 1.6;\n        }\n\n        .plugin-meta {\n          display: flex;\n          align-items: center;\n          gap: 12px;\n          flex-wrap: wrap;\n\n          .meta-item {\n            display: flex;\n            align-items: center;\n            gap: 4px;\n            font-size: 13px;\n            color: #909399;\n          }\n        }\n      }\n    }\n\n    .plugin-actions {\n      display: flex;\n      gap: 8px;\n      padding-top: 16px;\n      border-top: 1px solid #ebeef5;\n    }\n  }\n}\n\n.plugin-detail {\n  max-height: 70vh;\n  overflow-y: auto;\n  overflow-x: hidden;\n\n  // 自定义滚动条样式\n  &::-webkit-scrollbar {\n    width: 6px;\n  }\n\n  &::-webkit-scrollbar-track {\n    background: #f1f1f1;\n    border-radius: 3px;\n  }\n\n  &::-webkit-scrollbar-thumb {\n    background: #c1c1c1;\n    border-radius: 3px;\n\n    &:hover {\n      background: #a8a8a8;\n    }\n  }\n\n  .tools-section {\n    margin-top: 24px;\n\n    h4 {\n      margin: 0 0 16px 0;\n      font-size: 16px;\n      font-weight: 600;\n      color: #303133;\n    }\n\n    .tool-item {\n      padding: 12px;\n      border-bottom: 1px solid #ebeef5;\n\n      &:last-child {\n        border-bottom: none;\n      }\n\n      .tool-header {\n        display: flex;\n        justify-content: space-between;\n        align-items: center;\n        margin-bottom: 8px;\n\n        h5 {\n          margin: 0;\n          font-size: 14px;\n          font-weight: 600;\n          color: #303133;\n        }\n      }\n\n      .tool-description {\n        margin: 0 0 8px 0;\n        font-size: 13px;\n        color: #606266;\n      }\n    }\n  }\n}\n\n.config-editor {\n  .config-textarea {\n    font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;\n    font-size: 13px;\n  }\n}\n\n.debug-dialog {\n  :deep(.el-dialog__body) {\n    padding: 0 !important;\n  }\n\n  :deep(.el-alert__content) {\n    flex-grow: 1;\n  }\n}\n\n.debug-container {\n  padding: 20px;\n}\n\n.result-container {\n  margin-top: 16px;\n}\n\n  .tool-info-card,\n  .params-schema-card,\n  .params-input-card {\n    margin-bottom: 16px;\n\n    &:last-child {\n      margin-bottom: 0;\n    }\n  }\n\n  .result-card {\n    margin-top: 16px;\n    margin-bottom: 0;\n  }\n\n  .card-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    font-weight: 600;\n    color: #303133;\n  }\n\n  .tool-info {\n    .info-row {\n      display: flex;\n      align-items: center;\n      gap: 12px;\n      margin-bottom: 12px;\n\n      &:last-child {\n        margin-bottom: 0;\n      }\n\n      label {\n        min-width: 80px;\n        font-weight: 600;\n        color: #606266;\n      }\n\n      span {\n        color: #303133;\n      }\n    }\n  }\n\n  .params-schema {\n    .param-item {\n      padding: 12px;\n      background: #f5f7fa;\n      border-radius: 4px;\n      margin-bottom: 12px;\n\n      &:last-child {\n        margin-bottom: 0;\n      }\n\n      .param-header {\n        display: flex;\n        justify-content: space-between;\n        align-items: center;\n        margin-bottom: 8px;\n\n        .param-name {\n          font-weight: 600;\n          color: #303133;\n          display: flex;\n          align-items: center;\n          gap: 8px;\n        }\n      }\n\n      .param-description {\n        font-size: 13px;\n        color: #606266;\n        margin-bottom: 4px;\n      }\n\n      .param-enum,\n      .param-items {\n        font-size: 12px;\n        color: #909399;\n        margin-top: 4px;\n      }\n    }\n  }\n\n  .params-textarea {\n    font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;\n    font-size: 13px;\n  }\n  .debug-result-wrapper {\n    border-radius: 8px;\n    overflow: hidden;\n    border: 1px solid;\n    transition: all 0.3s ease;\n\n    &.status-success {\n      border-color: #e1f3d8;\n      background-color: #f0f9eb;\n\n      .result-header {\n        background-color: #e1f3d8;\n        color: #67c23a;\n      }\n    }\n\n    &.status-error {\n      border-color: #fde2e2;\n      background-color: #fef0f0;\n\n      .result-header {\n        background-color: #fde2e2;\n        color: #f56c6c;\n      }\n    }\n\n    .result-header {\n      padding: 10px 16px;\n      display: flex;\n      justify-content: space-between;\n      align-items: center;\n      font-size: 14px;\n      font-weight: 600;\n\n      .status-indicator {\n        display: flex;\n        align-items: center;\n        gap: 8px;\n        \n        .icon {\n          display: flex;\n          align-items: center;\n        }\n      }\n\n      .execution-meta {\n        font-size: 12px;\n        opacity: 0.9;\n      }\n    }\n\n    .result-body {\n      padding: 16px;\n    }\n\n    .plugin-info-bar {\n      display: flex;\n      align-items: center;\n      gap: 12px;\n      margin-bottom: 12px;\n      font-size: 13px;\n      color: #606266;\n      padding-bottom: 12px;\n      border-bottom: 1px solid rgba(0, 0, 0, 0.05);\n\n      .info-item {\n        display: flex;\n        gap: 6px;\n\n        .label {\n          color: #909399;\n        }\n        \n        .value {\n          font-weight: 500;\n          color: #303133;\n        }\n      }\n\n      .divider {\n        color: #dcdfe6;\n      }\n    }\n\n    .json-viewer-container {\n      .viewer-label {\n        font-size: 12px;\n        color: #909399;\n        margin-bottom: 8px;\n      }\n\n      .json-content {\n        background-color: #ffffff;\n        border-radius: 4px;\n        border: 1px solid #dcdfe6;\n        padding: 12px;\n        \n        pre {\n          margin: 0;\n          font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;\n          font-size: 12px;\n          color: #303133;\n          white-space: pre-wrap;\n          word-break: break-all;\n          max-height: 300px;\n          overflow-y: auto;\n\n          &::-webkit-scrollbar {\n            width: 6px;\n            height: 6px;\n          }\n\n          &::-webkit-scrollbar-thumb {\n            background: #c0c4cc;\n            border-radius: 3px;\n          }\n        }\n      }\n    }\n\n    .error-content {\n      .error-message-box {\n        display: flex;\n        align-items: flex-start;\n        gap: 8px;\n        color: #f56c6c;\n        font-weight: 600;\n        margin-bottom: 16px;\n        font-size: 14px;\n        \n        .error-icon {\n          margin-top: 2px;\n        }\n      }\n\n      .error-stack {\n        .stack-label {\n          font-size: 12px;\n          color: #909399;\n          margin-bottom: 8px;\n        }\n\n        .stack-content {\n          margin: 0;\n          padding: 12px;\n          background-color: #fff;\n          border: 1px solid #fde2e2;\n          border-radius: 4px;\n          font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;\n          font-size: 11px;\n          color: #f56c6c;\n          overflow-x: auto;\n          white-space: pre;\n        }\n      }\n    }\n  }\n\n.fade-enter-active,\n.fade-leave-active {\n  transition: opacity 0.3s ease;\n}\n\n.fade-enter-from,\n.fade-leave-to {\n  opacity: 0;\n}\n\n@keyframes fadeIn {\n  from {\n    opacity: 0;\n    transform: translateY(10px);\n  }\n  to {\n    opacity: 1;\n    transform: translateY(0);\n  }\n}\n\n@keyframes loading {\n  0% {\n    background-position: 200% 0;\n  }\n  100% {\n    background-position: -200% 0;\n  }\n}\n</style>\n"],"file":"views-CeUzhB00.js"}