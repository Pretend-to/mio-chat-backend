import{c as e,_ as t,R as a,F as l,T as s,I as o,a as n,C as i,s as c,f as r,b as d,d as u,u as p,E as m,e as v,L as h,A as g,p as f}from"./components-yel-7Pg7.js";import{a as y,R as _,u as b,q as w,H as C,_ as k,b as x}from"./vendor_editor_preview-u-Wqm63M.js";import"./vendor_emoji-C7BQ2utN.js";import{$ as S}from"./vendor_misc-BTiB9Zt4.js";import{aX as V,aY as T,c as O,a as P,e as M,t as I,n as L,b as $,w as j,j as q,v as A,f as B,F as R,d as U,o as E,g as z,q as D,i as W,k as N,l as Q,aZ as H,m as J,p as F,u as G,s as X,a3 as Y,G as Z,av as K,Z as ee,r as te}from"./vendor_vue-DjqW6Aqw.js";import{E as ae,m as le,c as se,b as oe,d as ne,e as ie,g as ce,a as re,r as de,f as ue,i as pe,j as me,k as ve,n as he,w as ge,o as fe,q as ye,t as _e,x as be,y as we,p as Ce,z as ke,v as xe,h as Se,A as Ve,B as Te,C as Oe,D as Pe,F as Me,G as Ie,H as Le,I as $e,J as je}from"./vendor_element_plus-Cf_BinKz.js";const qe=()=>y(()=>Promise.resolve().then(()=>rt),void 0),Ae=V({history:T("/"),routes:[{path:"/",name:"home",component:()=>y(()=>Promise.resolve().then(()=>vt),void 0),children:[{path:"/",name:"blank",component:qe},{path:"/contactors",name:"contactors",component:qe},{path:"/chat/:id",name:"chat_view",component:()=>y(()=>Promise.resolve().then(()=>nt),void 0)},{path:"/profile/:id",name:"profile_view",component:()=>y(()=>Promise.resolve().then(()=>zt),void 0)}]},{path:"/auth",name:"auth",component:()=>y(()=>Promise.resolve().then(()=>ta),void 0)},{path:"/settings",name:"settings",component:()=>y(()=>Promise.resolve().then(()=>Xt),void 0),redirect:"/settings",children:[{path:"",name:"settings_overview",component:()=>y(()=>Promise.resolve().then(()=>Aa),void 0)},{path:"llm-adapters",name:"settings_llm_adapters",component:()=>y(()=>Promise.resolve().then(()=>ol),void 0)},{path:"server",name:"settings_server",component:()=>y(()=>Promise.resolve().then(()=>dl),void 0)},{path:"web",name:"settings_web",component:()=>y(()=>Promise.resolve().then(()=>hl),void 0)},{path:"onebot",name:"settings_onebot",component:()=>y(()=>Promise.resolve().then(()=>bl),void 0)},{path:"plugins",name:"settings_plugins",component:()=>y(()=>Promise.resolve().then(()=>As),void 0)}]}]});Ae.beforeEach(async t=>{if(!e.everLogin()&&"auth"!==t.name){ae.warning("请先登录");return{name:"auth",query:"/settings"===t.path?null:{redirect:t.fullPath}}}});const Be={id:"chat-window"},Re={class:"upside-bar"},Ue={class:"contactor-name"},Ee={class:"delay-num"},ze={class:"options"},De={key:0,class:"message-time"},We=["id"],Ne={key:0,class:"avatar"},Qe=["src","alt"],He=["src","alt"],Je={key:1,class:"msg"},Fe={class:"wholename"},Ge={key:0,class:"title"},Xe={class:"name"},Ye=["onContextmenu"],Ze={key:2,class:"reply-block"},Ke={key:5},et={key:7,class:"blank-message",style:{width:"10rem",height:"28.8px",position:"relative"}},tt={key:2,class:"system-message"},at={class:"system-message-content"},lt={class:"system-message-button"},st=["onClick"];const ot=t({components:{MdRenderer:_,ContextMenu:i,ForwardMsg:n,InputEditor:o,ToolCallBar:s,FileBlock:l,ReasonBlock:a},data(){let t,a,l=!1,s=!0;const o=window.location.href,n=new URL(o).searchParams;n.has("preview")&&"true"===n.get("preview")&&(l=!0),n.has("shareId")&&(t=n.get("shareId")),n.has("scroll")&&(s=n.get("scroll")||"true");const i=parseInt(this.$route.params.id);try{if(a=e.getContactor(i),!a)throw new Error("找不到联系人")}catch(c){const s=e.contactList[0].id;this.$router.push({path:`/chat/${s}`,query:{preview:l,shareId:t}}),a=e.getContactor(s)}return{scroll:s,preview:l,shareId:t,activeContactor:a,showwindow:!0,showemoji:!1,userInput:"",client:e,extraOptions:[],wraperPresets:{},selectedOption:null,currentDelay:0,toupdate:!1,seletedText:"",seletedImage:"",retryList:[],showMenu:!1,menuTop:0,menuLeft:0,validMessageIndex:-1,repliedMessageId:-1,autoScroll:!1,fullScreen:!1,chatWindowRef:null,prevScrollTop:0,showRollDown:!1,inputBarTop:0,clearMessageTip:"以上的对话记录已清除",loadingIcon:"<span id='message-loading-icon'></span>",katexPlugin:x,mioPlugins:[{plugin:b},{plugin:w},{plugin:C,options:{shape:"circle"}},{plugin:k}]}},computed:{getMenuStyle(){if(window.innerWidth<768){const e=160;return this.menuTop-e<0?{top:e+"px"}:{bottom:window.innerHeight-this.menuTop+16+"px"}}return this.menuLeft+110>window.innerWidth?{top:this.menuTop+"px",left:this.menuLeft-110+"px"}:{top:this.menuTop+"px",left:this.menuLeft+"px"}},getDelayStatus(){return this.currentDelay>1e3?"high":this.currentDelay>500?"mid":this.currentDelay>100?"low":"ultra"},activeMessageChain(){return this.activeContactor.options.presetSettings?.opening?[{role:"other",content:[{type:"text",data:{text:this.activeContactor.options.presetSettings.opening}}],time:this.activeContactor.createTime},...this.activeContactor.messageChain]:this.activeContactor.messageChain}},watch:{"$route.params.id"(t,a){const l=parseInt(t),s=e.getContactor(l);if(this.activeContactor=s,this.initContactor(this.activeContactor),this.chatWindowRef&&this.toButtom(),a){const t=parseInt(a),l=e.getContactor(t);this.disableContactor(l)}}},async mounted(){document.addEventListener("click",()=>{this.showMenu=!1,this.seletedText="",this.seletedImage=""}),this.chatWindowRef=this.$refs.chatWindow,this.chatWindowRef.addEventListener("scroll",this.scrollHandler),!this.preview&&this.scroll&&this.toButtom(),this.scroll=!0,this.initContactor(this.activeContactor),this.fullScreen=this.client.fullScreen;const t=document.querySelector(".input-bar");if(t){const e=window.innerHeight;this.inputBarTop=e-t.offsetTop}if(this.shareId){await e.loadOriginalContactors(this.shareId)?this.$router.push({path:"/chat/"+this.shareId,query:{preview:this.preview,scroll:!1}}):this.$message({message:"分享链接已失效",type:"error"})}},updated(){this.toupdate&&this.autoScroll&&0===this.retryList.length&&(this.toButtom(),this.toupdate=!1)},beforeUnmount(){this.disableContactor(this.activeContactor),this.chatWindowRef.removeEventListener("scroll",this.scrollHandler)},methods:{handleMouseUp(){const e=window.getSelection().toString();e&&(this.seletedText=e)},toButtom(e){setTimeout(()=>{(()=>{const t=this.chatWindowRef||document.getElementById("main-messages-window");t&&t.scrollTo({top:t.scrollHeight,behavior:e?"smooth":"instant"})})()},1)},cleanScreen(){this.activeContactor.messageChain=[],this.activeContactor.updateFirstMessage(),e.setLocalStorage(),this.activeContactor.emit("updateMessageSummary"),this.toupdate=!0,this.$message({message:"已清除会话记录",type:"success"})},cleanHistory(){this.activeContactor.updateFirstMessage(),this.$message({message:"上下文信息已清除，之后的请求将不再记录上文记录",type:"success"});for(let e=this.activeContactor.messageChain.length-1;e>=0;e--){const t=this.activeContactor.messageChain[e];"mio_system"===t.role&&"text"===t.content[0].type&&t.content[0].data.text===this.clearMessageTip&&this.activeContactor.messageChain.splice(e,1)}this.activeContactor.makeSystemMessage(this.clearMessageTip),e.setLocalStorage()},delSystemMessage(t){const a=this.activeContactor.messageChain[t];"text"===a.content[0].type&&a.content[0].data.text===this.clearMessageTip&&(this.activeContactor.firstMessageIndex=0),this.activeContactor.messageChain.splice(t,1),e.setLocalStorage()},isValidInput:e=>!/^[ \n]+$/.test(e),waiting(){this.$message({message:"此功能尚未开放",type:"warning"})},tolist(){this.$router.push({name:"home"})},async setModel(t){const a=t[0],l=t[2];this.activeContactor.options.provider=a,this.activeContactor.options.base.model=l,this.activeContactor.loadAvatar(),await e.setLocalStorage()},toimg(){const e=this.chatWindowRef.getBoundingClientRect();e.height=this.chatWindowRef.scrollHeight,S(this.chatWindowRef,{windowHeight:1.2*e.height,width:e.width}).then(e=>{const t=e.toDataURL("image/png"),a=document.createElement("a");a.download="chat.png",a.href=t,a.click()})},async share(){const t=await e.shareContactor(this.activeContactor.id);if(t&&t.shareUrl){const{shareUrl:e}=t,{success:a,message:l}=c(e);a?this.$message({message:l,type:"success"}):this.$message({message:l,type:"error"})}},hasOpening(){return!!this.activeContactor.options.presetSettings?.opening},getFullMessages(){return this.hasOpening()?[{role:"other",content:[{type:"text",data:{text:this.activeContactor.options.presetSettings.opening}}],time:this.activeContactor.createTime},...this.activeContactor.messageChain]:this.activeContactor.messageChain},showTime(e){const t=this.getFullMessages(),a=t[e].time;if(0===e)return{show:!0,time:this.activeContactor.getShownTime(a)};return a-t[e-1].time>6e5?{show:!0,time:this.activeContactor.getShownTime(a)}:{show:!1,time:""}},separateTextAndImages(e){const t=/!\[([^\]]*)\]\((.*)\)/g;let a,l=[],s=0;for(;null!==(a=t.exec(e));){if(a.index>s){const t=e.slice(s,a.index).trim();t&&l.push({type:"text",data:{text:t}})}l.push({type:"image",data:{file:a[2]}}),s=t.lastIndex}if(s<e.length){const t=e.slice(s).trim();t&&l.push({type:"text",data:{text:t}})}return l},getChatwindowScrollheight(){var e=this.chatWindowRef.scrollTop,t=this.chatWindowRef.clientHeight,a=this.chatWindowRef.scrollHeight;return a-e/(a-t)*a},initContactor(t){t.active=!0,t.on("revMessage",e=>{this.activeContactor.messageChain.push(e),this.toupdate=!0}),t.on("delMessage",e=>{this.activeContactor.messageChain.splice(e,1),this.toupdate=!0}),t.on("updateMessage",()=>{this.$forceUpdate(),this.toupdate=!0,e.setLocalStorage()}),t.on("completeMessage",async t=>{const a=t.messageId,l=this.activeContactor.getMessageById(a);this.retryList.includes(a)&&(this.retryList=this.retryList.filter(e=>e!==a)),l.content.forEach((e,t)=>{if("text"===e.type&&"onebot"===this.activeContactor.platform){const a=this.separateTextAndImages(e.data.text);l.content.splice(t,1,...a)}}),this.toupdate=!0,this.$forceUpdate(),this.activeContactor.loadName(),e.setLocalStorage()})},disableContactor(e){e&&(e.active=!1,e.off("updateMessage"),e.off("revMessage"),e.off("delMessage"),e.off("completeMessage"))},getReplyText(e){let t="";const a=this.activeContactor.messageChain.find(t=>t.id===e||String(t.id)===String(e));return a?(a.content.forEach(e=>{"text"===e.type?t+=e.data.text:"image"===e.type&&(t+="[图片]")}),t.trim().slice(0,20)):"[消息已删除] "},imageLoaded(){this.scroll&&this.toButtom()},showMessageMenu(e,t){if("img"===e.target.tagName.toLowerCase()){const t=e.target.src;this.seletedImage=t}this.validMessageIndex="openai"===this.activeContactor.platform&&this.hasOpening()?t-1:t,e.preventDefault(),this.showMenu=!0,this.menuTop=e.clientY,this.menuLeft=e.clientX;const a=window.getSelection().toString();this.seletedText=a||""},toProfile(){this.$router.push({name:"profile_view",params:{id:this.activeContactor.id}})},scrollHandler(){const e=this.chatWindowRef.scrollTop,t=e>this.prevScrollTop,a=e<this.prevScrollTop;this.prevScrollTop=e,this.showMenu=!1,this.showemoji&&(this.showemoji=!1);const l=this.getChatwindowScrollheight();this.autoScroll=!(l>100);const s=l<=199;!t||this.autoScroll||s?(a||this.autoScroll||s)&&(this.showRollDown=!1):this.showRollDown=!0},getseletedMessage(){return this.activeContactor.messageChain[this.validMessageIndex]},handleMessageOption(t){const a=this.getseletedMessage();switch(t){case"retry":if("onebot"===this.activeContactor.platform)"user"===a.role?this.activeContactor.webSend(a):this.activeContactor.webSend({...a,role:"user"}),this.$message({message:"消息已重新发送",type:"success"});else{const e="user"===a.role?this.validMessageIndex+1:this.validMessageIndex;let t=this.activeContactor.messageChain[e];if(!t||"other"!==t.role){const a=this.activeContactor.getBaseUserContainer();a.role="other",this.activeContactor.insertMessage(a,e),t=a}if("retrying"===t.status)return void this.$message({message:"该消息正在重试中",type:"warning"});this.activeContactor.retryMessage(t.id),t.status="retrying",this.retryList.push(t.id)}this.toButtom();break;case"reply":"onebot"===this.activeContactor.platform?(this.repliedMessageId=a.id,this.$message({message:"已引用该消息",type:"success"})):this.userInput+=this.getReplyText(this.activeContactor.messageChain[this.validMessageIndex].id)+"\n\n";break;case"delete":this.activeContactor.messageChain.splice(this.validMessageIndex,1),e.setLocalStorage()}}}},[["render",function(e,t,a,l,s,o){const n=B("ContextMenu"),i=B("MdRenderer"),c=B("ForwardMsg"),r=B("FileBlock"),d=B("ReasonBlock"),u=B("ToolCallBar"),p=B("InputEditor");return E(),O("div",Be,[P("div",Re,[P("div",{class:"return",onClick:t[0]||(t[0]=e=>o.tolist())},t[8]||(t[8]=[P("i",{class:"iconfont icon-return"},null,-1)])),P("div",{class:"name-area",onClick:t[1]||(t[1]=(...e)=>o.toProfile&&o.toProfile(...e))},[P("div",Ue,I(s.activeContactor.name),1),P("span",{class:L("delay-status "+o.getDelayStatus)},null,2),P("span",Ee,"当前延迟: "+I(s.currentDelay)+" ms",1)]),P("ul",ze,[P("li",{class:"share",onClick:t[2]||(t[2]=e=>o.share())},t[9]||(t[9]=[P("i",{class:"iconfont icon-share"},null,-1)]))])]),P("div",{id:"main-messages-window",ref:"chatWindow",class:L({"message-window":!0,preview:s.preview})},[s.showRollDown?(E(),O("div",{key:0,id:"roll-buttom-button",style:q({bottom:s.inputBarTop+24+"px"}),onClick:t[3]||(t[3]=e=>o.toButtom(!0))},t[10]||(t[10]=[P("i",{class:"iconfont down1"},null,-1)]),4)):$("",!0),j(M(n,{type:"message",message:o.getseletedMessage(),"seleted-text":s.seletedText,"seleted-image":s.seletedImage,style:q(o.getMenuStyle),onMessageOption:o.handleMessageOption,onClose:t[4]||(t[4]=e=>s.showMenu=!1)},null,8,["message","seleted-text","seleted-image","style","onMessageOption"]),[[A,s.showMenu]]),(E(!0),O(R,null,U(o.activeMessageChain,(e,a)=>(E(),O("div",{key:`${s.activeContactor.id}-${e.id}`,ref_for:!0,ref:"message",class:"message-container"},[o.showTime(a).show?(E(),O("div",De,I(o.showTime(a).time),1)):$("",!0),P("div",{id:e.role,class:"message-body"},["mio_system"!==e.role?(E(),O("div",Ne,["other"===e.role?(E(),O("img",{key:0,src:s.activeContactor.avatar,alt:s.activeContactor.name,onClick:t[5]||(t[5]=(...e)=>o.toProfile&&o.toProfile(...e))},null,8,Qe)):(E(),O("img",{key:1,src:s.client.avatar,alt:s.client.name},null,8,He))])):$("",!0),"mio_system"!==e.role?(E(),O("div",Je,[P("div",Fe,[("other"===e.role?s.activeContactor.title:s.client.title)?(E(),O("div",Ge,I("other"===e.role?s.activeContactor.title:s.client.title),1)):$("",!0),P("div",Xe,I("other"===e.role?s.activeContactor.name:s.client.name),1)]),P("div",{class:L(["content",e.status]),onMouseup:t[6]||(t[6]=(...e)=>o.handleMouseUp&&o.handleMouseUp(...e)),onContextmenu:e=>o.showMessageMenu(e,a)},[(E(!0),O(R,null,U(e.content,(a,l)=>(E(),O("div",{key:l,class:"inner-content"},["text"===a.type?(E(),z(i,{key:0,md:a.data.text,theme:"github",isStreaming:["pending","retrying"].includes(e.status)&&e.content.length-1===l,"custom-plugins":s.mioPlugins,"markdown-it-plugins":[{plugin:s.katexPlugin}],"markdown-it-options":{breaks:"onebot"===s.activeContactor.platform}},null,8,["md","isStreaming","custom-plugins","markdown-it-plugins","markdown-it-options"])):$("",!0),"image"===a.type?(E(),z(i,{md:`![image](${a.data.file})`,"custom-plugins":s.mioPlugins,theme:"github",key:a.data.file},null,8,["md","custom-plugins"])):"reply"===a.type?(E(),O("div",Ze,I(o.getReplyText(a.data.id)),1)):"nodes"===a.type?(E(),z(c,{key:3,contactor:s.activeContactor,messages:a.data.messages},null,8,["contactor","messages"])):"file"===a.type?(E(),z(r,{key:4,"file-url":a.data.file},null,8,["file-url"])):"at"===a.type?(E(),O("span",Ke)):"reason"===a.type?(E(),z(d,{key:6,"end-time":a.data.endTime,"start-time":a.data.startTime,content:a.data.text},null,8,["end-time","start-time","content"])):"blank"===a.type?(E(),O("div",et,t[11]||(t[11]=[P("span",{class:"blank-loader"},null,-1)]))):"tool_call"===a.type?(E(),z(u,{key:8,"tool-call":a.data},null,8,["tool-call"])):$("",!0)]))),128))],42,Ye)])):(E(),O("div",tt,[P("div",at,I(e.content[0].data.text),1),P("div",lt,[P("i",{class:"iconfont close",onClick:e=>o.delSystemMessage(a)},null,8,st)])]))],8,We)]))),128))],2),M(p,{ref:"inputEditor","active-contactor":s.activeContactor,"replied-message-id":s.repliedMessageId,onStroge:t[7]||(t[7]=e=>s.client.setLocalStorage()),onSetModel:o.setModel,onCleanScreen:o.cleanScreen,onCleanHistory:o.cleanHistory,onToButtom:o.toButtom},null,8,["active-contactor","replied-message-id","onSetModel","onCleanScreen","onCleanHistory","onToButtom"])])}],["__scopeId","data-v-f6edf145"]]),nt=Object.freeze(Object.defineProperty({__proto__:null,default:ot},Symbol.toStringTag,{value:"Module"})),it={class:"blank-view"};const ct=t({name:"BlankView",data:()=>({fullScreen:!1,client:e}),watch:{},created(){this.fullScreen=e.fullScreen},methods:{waiting(){this.$message({message:"此功能尚未开放",type:"warning"})}}},[["render",function(e,t,a,l,s,o){return E(),O("div",it,t[0]||(t[0]=[P("div",{class:"upside-bar"},[P("div",{class:"options"})],-1)]))}],["__scopeId","data-v-29ea73df"]]),rt=Object.freeze(Object.defineProperty({__proto__:null,default:ct},Symbol.toStringTag,{value:"Module"})),dt={key:0,id:"main"},ut={key:1,id:"main-mobile"},pt={key:2,id:"main-mobile",class:"mobile-chat"};const mt=t({components:{friendlist:r,blankView:ct},data(){return{onPhone:window.innerWidth<600,pagePath:this.$route.path,loaded:!1}},watch:{$route:function(e){this.pagePath=e.path}},mounted(){e.inited?this.loaded=!0:e.on("loaded",()=>{this.loaded=!0},!1)}},[["render",function(e,t,a,l,s,o){const n=B("friendlist"),i=B("router-view"),c=B("blankView");return s.onPhone?"/"===s.pagePath?(E(),O("div",ut,[s.loaded?(E(),z(n,{key:0})):(E(),z(c,{key:1}))])):(E(),O("div",pt,[s.loaded?(E(),z(i,{key:0})):(E(),z(c,{key:1}))])):(E(),O("div",dt,[M(n),s.loaded?(E(),z(i,{key:0})):(E(),z(c,{key:1}))]))}]]),vt=Object.freeze(Object.defineProperty({__proto__:null,default:mt},Symbol.toStringTag,{value:"Module"})),ht={class:"profile-body"},gt={id:"profile"},ft={class:"profile-container"},yt={class:"base-info"},_t={class:"base-info-avatar"},bt={class:"base-info-content"},wt={class:"name"},Ct={class:"id"},kt={class:"status"},xt={class:"info-blocks"},St={class:"settings-block"},Vt={class:"block-content"},Tt={class:"block-content-item"},Ot={class:"item-content"},Pt={class:"block-content-item"},Mt={class:"item-content"},It={key:0,class:"block-content-item"},Lt={class:"item-content"},$t={key:1,class:"block-content-item"},jt={class:"item-content"},qt={class:"block-content-item"},At={class:"item-content"},Bt={class:"info-blocks"},Rt={class:"action-bar"},Ut={class:"dialog-footer"};const Et=t({components:{ContactorSettings:d},data(){const t=parseInt(this.$route.params.id),a=e.getContactor(t),l=u.getToolCallModes(),s=u.getLLMProviders(),o=u.getSafetySettingsParams(),n=Object.keys(o).map(e=>({value:e,label:e})),i=[];for(const e in u.llmTools){const t=u.llmTools[e],a=Object.keys(t).map(e=>({enabled:!1,...t[e]}));i.push({name:e,tools:a,collapsed:!0})}return{activeContactor:a,options:null,currentDelay:0,centerDialogVisible:!1,avatarPolicyList:[{value:0,label:"跟随模型"},{value:1,label:"自定义"}],namePolicyList:[{value:0,label:"跟随模型"},{value:1,label:"自定义"},{value:2,label:"对话摘要"}],isOnebot:"onebot"===a.platform,llmProviders:s,toolCallModes:l,safetyParams:o,safetySimpleValue:n,allLLMTools:i,basicInfo:null}},computed:{getDelayStatus(){return this.currentDelay>1e3?"high":this.currentDelay>500?"mid":this.currentDelay>100?"low":"ultra"},getAvatarPolicyValue(){return 1===this.basicInfo.avatarPolicy?"自定义":"跟随模型"}},watch:{"$route.params.id"(t){const a=parseInt(t);this.activeContactor=e.getContactor(a),this.activeContactor&&(this.isOnebot="onebot"===this.activeContactor.platform),this.initContactor()},options:{handler(t){t&&this.activeContactor&&(this.activeContactor.options=JSON.parse(JSON.stringify(t)),e.setLocalStorage())},deep:!0},basicInfo:{handler(t){t&&this.activeContactor&&(this.activeContactor.name=t.name,this.activeContactor.avatar=t.avatar,this.activeContactor.namePolicy=t.namePolicy,this.activeContactor.avatarPolicy=t.avatarPolicy,this.activeContactor.priority=t.priority?0:1,e.setLocalStorage())},deep:!0}},created(){this.initContactor()},mounted(){this.delayInterval=setInterval(()=>{this.currentDelay=e.socket.delay},3e3)},beforeUnmount(){this.delayInterval&&clearInterval(this.delayInterval)},methods:{initContactor(){this.options=JSON.parse(JSON.stringify(this.activeContactor.options));const{name:e,avatar:t,namePolicy:a,avatarPolicy:l,priority:s}=this.activeContactor;this.basicInfo={name:e,avatar:t,namePolicy:a,avatarPolicy:l,priority:1!==s},"onebot"===this.activeContactor.platform&&this.options.toolCallSettings&&(this.options.toolCallSettings.mode="none",this.options.toolCallSettings.tools=[])},handleUpdateOpenaiPresets(e){this.options&&this.options.presetSettings&&(this.options.presetSettings.history=e,this.$message({message:"预设历史记录已更新",type:"success"}))},async delContactor(){this.centerDialogVisible=!1,await e.rmContactor(this.activeContactor.id),this.$router.push("/")},handleProviderSwitched(){this.activeContactor.loadAvatar()},updateContactorName(){0===this.basicInfo.namePolicy&&(this.basicInfo.name=this.activeContactor.options.base.model)},updateContactorAvatar(){const{avatarPolicy:e}=this.basicInfo;this.activeContactor.avatarPolicy=e,this.basicInfo.avatar=this.activeContactor.loadAvatar()}}},[["render",function(e,t,a,l,s,o){const n=B("el-image"),i=B("el-input"),c=B("el-option"),r=B("el-select"),d=B("el-switch"),u=B("ContactorSettings"),p=B("el-button"),m=B("el-dialog");return E(),O("div",ht,[P("div",gt,[P("div",ft,[P("div",yt,[P("div",_t,[M(n,{src:s.activeContactor.avatar,"preview-src-list":[s.activeContactor.avatar]},null,8,["src","preview-src-list"])]),P("div",bt,[P("div",wt,I(s.activeContactor.name),1),P("div",Ct,"ID "+I(s.activeContactor.id),1),P("div",kt,[P("span",{class:L("delay-status "+o.getDelayStatus)},null,2),t[10]||(t[10]=D(" 在线 "))])])]),P("div",xt,[P("div",St,[t[16]||(t[16]=P("div",{class:"block-title"},"Bot 基本配置",-1)),P("div",Vt,[P("div",Tt,[t[11]||(t[11]=P("div",{class:"contactor-name item-title"},"昵称",-1)),P("div",Ot,[M(i,{modelValue:s.basicInfo.name,"onUpdate:modelValue":t[0]||(t[0]=e=>s.basicInfo.name=e),disabled:1!==s.basicInfo.namePolicy},null,8,["modelValue","disabled"])])]),P("div",Pt,[t[12]||(t[12]=P("div",{class:"item-title"},"头像",-1)),P("div",Mt,[1!==s.basicInfo.avatarPolicy?(E(),z(i,{key:0,value:"跟随模型",disabled:!0})):(E(),z(i,{key:1,modelValue:s.basicInfo.avatar,"onUpdate:modelValue":t[1]||(t[1]=e=>s.basicInfo.avatar=e),disabled:s.isOnebot},null,8,["modelValue","disabled"]))])]),s.isOnebot?$("",!0):(E(),O("div",It,[t[13]||(t[13]=P("div",{class:"item-title"},"头像策略",-1)),P("div",Lt,[M(r,{modelValue:s.basicInfo.avatarPolicy,"onUpdate:modelValue":t[2]||(t[2]=e=>s.basicInfo.avatarPolicy=e),onChange:o.updateContactorAvatar},{default:W(()=>[(E(!0),O(R,null,U(s.avatarPolicyList,e=>(E(),z(c,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","onChange"])])])),s.isOnebot?$("",!0):(E(),O("div",$t,[t[14]||(t[14]=P("div",{class:"item-title"},"昵称策略",-1)),P("div",jt,[M(r,{modelValue:s.basicInfo.namePolicy,"onUpdate:modelValue":t[3]||(t[3]=e=>s.basicInfo.namePolicy=e),onChange:o.updateContactorName},{default:W(()=>[(E(!0),O(R,null,U(s.namePolicyList,e=>(E(),z(c,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","onChange"])])])),P("div",qt,[t[15]||(t[15]=P("div",{class:"item-title"},"会话置顶",-1)),P("div",At,[M(d,{modelValue:s.basicInfo.priority,"onUpdate:modelValue":t[4]||(t[4]=e=>s.basicInfo.priority=e)},null,8,["modelValue"])])])])])]),P("div",Bt,[s.isOnebot?$("",!0):(E(),z(u,{key:0,"model-value":s.options,"onUpdate:modelValue":t[5]||(t[5]=e=>s.options=e),"active-contactor-platform":s.activeContactor.platform,"llm-providers-list":s.llmProviders,"tool-call-modes-list":s.toolCallModes,"all-llm-tools-data":s.allLLMTools,"safety-settings-params":s.safetyParams,"safety-simple-value-options":s.safetySimpleValue,"presets-history-data":s.options.presetSettings?.history,onProviderChanged:o.handleProviderSwitched,onUpdatePresets:o.handleUpdateOpenaiPresets},null,8,["model-value","active-contactor-platform","llm-providers-list","tool-call-modes-list","all-llm-tools-data","safety-settings-params","safety-simple-value-options","presets-history-data","onProviderChanged","onUpdatePresets"]))])])]),P("div",Rt,[M(p,{plain:"",onClick:t[6]||(t[6]=t=>e.$router.push(`/chat/${s.activeContactor.id}`))},{default:W(()=>t[17]||(t[17]=[D(" 发送消息 ")])),_:1}),M(p,{type:"danger",plain:"",onClick:t[7]||(t[7]=e=>s.centerDialogVisible=!0)},{default:W(()=>t[18]||(t[18]=[D(" 删除好友 ")])),_:1}),M(m,{modelValue:s.centerDialogVisible,"onUpdate:modelValue":t[9]||(t[9]=e=>s.centerDialogVisible=e),title:"警告",width:"300",center:""},{footer:W(()=>[P("div",Ut,[M(p,{onClick:t[8]||(t[8]=e=>s.centerDialogVisible=!1)},{default:W(()=>t[19]||(t[19]=[D("取消")])),_:1}),M(p,{type:"primary",onClick:o.delContactor},{default:W(()=>t[20]||(t[20]=[D(" 确认 ")])),_:1},8,["onClick"])])]),default:W(()=>[t[21]||(t[21]=P("span",null," 确认要删除此好友吗？该操作不可逆。 ",-1))]),_:1},8,["modelValue"])])])}],["__scopeId","data-v-ca99e8ee"]]),zt=Object.freeze(Object.defineProperty({__proto__:null,default:Et},Symbol.toStringTag,{value:"Module"})),Dt={id:"settings-view"},Wt={class:"restart-banner-content"},Nt={class:"settings-container"},Qt={class:"settings-sidebar"},Ht={class:"quick-actions"},Jt={class:"settings-content"},Ft={key:0,class:"forbidden-container"},Gt=t({__name:"SettingsView",setup(t){const a=H(),l=G(),s=p(),o=N(!1),n=()=>{s.clearAdminCode(),l.push({path:"/auth",query:{redirect:a.fullPath||a.path}})},i=()=>{l.push("/")},c=Q(()=>{const e=a.path;return e.includes("llm-adapters")?"llm-adapters":e.includes("server")?"server":e.includes("web")?"web":e.includes("onebot")?"onebot":e.includes("plugins")?"plugins":"overview"}),r=e=>{"overview"===e?l.push("/settings"):l.push(`/settings/${e}`)},d=async()=>{try{await re.confirm("重启服务将断开所有连接，是否继续？","确认重启",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}),ae.info("重启服务功能需要后端支持，暂未实现")}catch(e){}},u=async()=>{try{await re.confirm("此操作将重置所有配置到默认状态，是否继续？","确认重置",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"});await e.reset()&&(ae.success("重置成功"),setTimeout(()=>{window.location.reload()},500))}catch(t){"cancel"!==t&&ae.error("重置失败："+t.message)}},v=async()=>{try{await re.confirm("此操作将清理所有缓存数据，是否继续？","确认清理",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}),await e.resetCache(),ae.success("清理缓存成功"),setTimeout(()=>{window.location.reload()},500)}catch(t){"cancel"!==t&&ae.error("清理缓存失败："+t.message)}};return J(async()=>{if(s.isAuthenticated)try{await s.fetchConfig()}catch(e){o.value=!0}else o.value=!0}),(e,t)=>{const a=B("el-button"),l=B("el-alert"),p=B("el-icon"),h=B("el-menu-item"),g=B("el-menu"),f=B("el-result"),y=B("router-view");return E(),O("div",Dt,[F(s).needRestart?(E(),z(l,{key:0,type:"warning",closable:!1,"show-icon":"",class:"restart-banner"},{title:W(()=>[P("div",Wt,[t[1]||(t[1]=P("span",null,"配置已更改，需要重启服务才能生效",-1)),M(a,{type:"warning",size:"small",onClick:d},{default:W(()=>t[0]||(t[0]=[D(" 重启服务 ")])),_:1})])]),_:1})):$("",!0),P("div",Nt,[P("aside",Qt,[M(g,{"default-active":c.value,class:"settings-menu",onSelect:r},{default:W(()=>[M(h,{index:"overview"},{default:W(()=>[M(p,null,{default:W(()=>[M(F(le))]),_:1}),t[2]||(t[2]=P("span",null,"概览",-1))]),_:1}),M(h,{index:"llm-adapters"},{default:W(()=>[M(p,null,{default:W(()=>[M(F(se))]),_:1}),t[3]||(t[3]=P("span",null,"LLM 适配器",-1))]),_:1}),M(h,{index:"server"},{default:W(()=>[M(p,null,{default:W(()=>[M(F(oe))]),_:1}),t[4]||(t[4]=P("span",null,"服务器配置",-1))]),_:1}),M(h,{index:"web"},{default:W(()=>[M(p,null,{default:W(()=>[M(F(ne))]),_:1}),t[5]||(t[5]=P("span",null,"Web 配置",-1))]),_:1}),M(h,{index:"onebot"},{default:W(()=>[M(p,null,{default:W(()=>[M(F(ie))]),_:1}),t[6]||(t[6]=P("span",null,"OneBot 配置",-1))]),_:1}),M(h,{index:"plugins"},{default:W(()=>[M(p,null,{default:W(()=>[M(F(ce))]),_:1}),t[7]||(t[7]=P("span",null,"插件管理",-1))]),_:1})]),_:1},8,["default-active"]),P("div",Ht,[M(a,{type:"info",plain:"",onClick:u,style:{width:"100%"}},{default:W(()=>t[8]||(t[8]=[D(" 重置全部 ")])),_:1}),M(a,{type:"info",plain:"",onClick:v,style:{width:"100%"}},{default:W(()=>t[9]||(t[9]=[D(" 清理缓存 ")])),_:1})])]),P("main",Jt,[t[12]||(t[12]=P("div",{class:"content-header-spacer"},null,-1)),o.value?(E(),O("div",Ft,[M(f,{icon:"error",title:"禁止访问","sub-title":"当前访问码无权限或已失效，您无法访问配置管理页面。"},{extra:W(()=>[M(a,{type:"primary",onClick:n},{default:W(()=>t[10]||(t[10]=[D("切换账号")])),_:1}),M(a,{onClick:i},{default:W(()=>t[11]||(t[11]=[D("返回首页")])),_:1})]),_:1})])):(E(),z(m,{key:1,"fallback-title":"页面加载失败","fallback-message":"配置页面加载时发生错误，请刷新页面重试"},{default:W(()=>[M(y,null,{default:W(({Component:e})=>[M(X,{name:"page-fade",mode:"out-in"},{default:W(()=>[(E(),z(Y(e)))]),_:2},1024)]),_:1})]),_:1}))])])])}}},[["__scopeId","data-v-729b624d"]]),Xt=Object.freeze(Object.defineProperty({__proto__:null,default:Gt},Symbol.toStringTag,{value:"Module"})),Yt={class:"auth-view"},Zt={class:"container"},Kt={class:"controls"},ea=t({__name:"AuthView",setup(t){const a=p(),l=N(),s=N(!1),o=N(),n=async t=>{if(await ee(()=>o.value.classList.add("active")),!s.value){s.value=!0;try{const l=await e.login(t);l&&(ae.success(`成功以${l.is_admin?"管理员身份":"游客身份"}登录，欢迎使用!`),t&&l.is_admin&&a.setAdminCode(t),Ae.currentRoute.value.query.redirect?Ae.push(Ae.currentRoute.value.query.redirect):Ae.push("/"))}catch(l){ae.error(l)}finally{await ee(()=>o.value.classList.remove("active")),s.value=!1}}};function i(e){"Enter"===e.key&&n(l.value)}return Z(()=>{removeEventListener("keydown",i)}),J(()=>{addEventListener("keydown",i),Ae.currentRoute.value.query.key&&n(Ae.currentRoute.value.query.key)}),(e,t)=>(E(),O("div",Yt,[P("div",Zt,[P("div",{ref_key:"iconContainer",ref:o,class:"icon-container"},t[3]||(t[3]=[P("i",{class:"iconfont ChatGPT"},null,-1)]),512),t[4]||(t[4]=P("h1",{class:"title"},"登录验证",-1)),t[5]||(t[5]=P("p",{class:"hint"},"管理员开启了密码验证，请在下方填入访问码",-1)),j(P("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>l.value=e),type:"password",placeholder:"在此处填写访问码"},null,512),[[K,l.value]]),P("div",Kt,[P("button",{class:"later",onClick:t[1]||(t[1]=e=>n())},"游客登录"),P("button",{class:"login",onClick:t[2]||(t[2]=e=>n(l.value))},"登录")])])]))}},[["__scopeId","data-v-c7b24051"]]),ta=Object.freeze(Object.defineProperty({__proto__:null,default:ea},Symbol.toStringTag,{value:"Module"})),aa={class:"overview-view"},la={key:0,class:"loading-container"},sa={class:"stats-grid"},oa={key:0,class:"content-container"},na={class:"overview-header"},ia={class:"header-actions"},ca={class:"stats-grid"},ra={class:"stat-icon",style:{"background-color":"#409eff20"}},da={class:"stat-content"},ua={class:"stat-value"},pa={class:"stat-icon",style:{"background-color":"#67c23a20"}},ma={class:"stat-content"},va={class:"stat-value"},ha={class:"stat-icon",style:{"background-color":"#e6a23c20"}},ga={class:"stat-content"},fa={class:"stat-value"},ya={class:"stat-content"},_a={class:"stat-value"},ba={class:"section-container"},wa={class:"quick-actions-grid"},Ca={class:"action-icon",style:{background:"#ecf5ff",color:"#409eff"}},ka={class:"action-icon",style:{background:"#f0f9eb",color:"#67c23a"}},xa={class:"action-icon",style:{background:"#fdf6ec",color:"#e6a23c"}},Sa={class:"action-icon",style:{background:"#f4f4f5",color:"#909399"}},Va={class:"card-header"},Ta={class:"pending-items-list"},Oa={class:"card-header"},Pa={class:"adapters-overview"},Ma={class:"adapter-type-header"},Ia={key:0,class:"empty-state"},La={key:1,class:"adapter-list"},$a={class:"adapter-name"},ja={class:"adapter-model"},qa=t({__name:"OverviewView",setup(e){const t=G(),a=p(),l=N(!0),s=N(!1),o=N(!1),n=Q(()=>{if(a.needRestart)return"warning";return Object.values(a.adapters).some(e=>e.some(e=>!e.enable))?"warning":"normal"}),i=Q(()=>a.needRestart?"需要重启":"normal"===n.value?"正常":"有警告"),c=Q(()=>{const e=[];a.needRestart&&e.push({type:"warning",title:"配置已更改，需要重启服务才能生效",action:{text:"去重启",handler:()=>t.push("/settings")}}),Object.entries(a.adapters).forEach(([l,s])=>{s.forEach((s,o)=>{if(s.enable){const n=s.name||`${l}-${o+1}`,i=a.models[n];i&&0!==i.length||e.push({type:"error",title:`${n} 实例模型列表为空，请检查 API Key 或网络连接`,action:{text:"去检查",handler:()=>t.push("/settings/llm-adapters")}})}})});const l=Object.values(a.adapters).flat().filter(e=>!e.enable).length;if(l>0&&e.push({type:"info",title:`有 ${l} 个适配器处于禁用状态`,action:{text:"查看详情",handler:()=>t.push("/settings/llm-adapters")}}),a.config?.onebot?.enable){const l=a.config.onebot;l.reverse_ws_url&&l.bot_qq||e.push({type:"warning",title:"OneBot 已启用但配置不完整",action:{text:"去完善",handler:()=>t.push("/settings/onebot")}})}return e}),r=e=>{const t={openai:"OpenAI",gemini:"Gemini",vertex:"Vertex AI"};return t[e]?t[e]:e?e.charAt(0).toUpperCase()+e.slice(1):""},d=async()=>{s.value=!0;try{await a.refreshAllModels(),ae.success("模型列表刷新成功")}catch(e){ae.error("刷新失败："+e.message)}finally{s.value=!1}},u=async()=>{try{const e=`mio-chat-config-${(new Date).toISOString().split("T")[0]}.json`;await a.exportConfig(e),ae.success("配置导出成功")}catch(e){ae.error("导出失败："+e.message)}},m=async e=>{try{await re.confirm("导入配置将覆盖当前所有配置，是否继续？","确认导入",{confirmButtonText:"导入",cancelButtonText:"取消",type:"warning"});const t=await a.importConfig(e),l=await a.validateConfig(t);if(!l.valid)return re.alert(`配置验证失败：\n${l.errors.join("\n")}`,"导入失败",{type:"error"}),!1;await a.updateConfig(t),ae.success("配置导入成功，请重启服务使配置生效"),await a.fetchConfig()}catch(t){"cancel"!==t&&ae.error("导入失败："+t.message)}return!1},g=e=>{t.push(`/settings/${e}`)};return J(async()=>{l.value=!0;try{a.config||await a.fetchConfig(),await new Promise(e=>setTimeout(e,300))}catch(e){ae.error("加载配置失败："+e.message)}finally{l.value=!1}}),(e,t)=>{const p=B("el-card"),f=B("el-button"),y=B("el-tooltip"),_=B("el-upload"),b=B("el-icon"),w=B("el-alert"),C=B("el-tag");return E(),O("div",aa,[l.value?(E(),O("div",la,[P("div",sa,[(E(),O(R,null,U(4,e=>M(h,{key:e,type:"stat-card","is-card":""})),64))]),M(p,{class:"section-card"},{default:W(()=>[M(h,{type:"list",count:4})]),_:1})])):$("",!0),M(X,{name:"fade",mode:"out-in"},{default:W(()=>[l.value?$("",!0):(E(),O("div",oa,[P("div",na,[t[6]||(t[6]=P("div",{class:"header-title"},[P("h2",null,"概览"),P("span",{class:"subtitle"},"系统运行状态与快捷入口")],-1)),P("div",ia,[M(y,{content:"刷新模型列表",placement:"bottom"},{default:W(()=>[M(f,{circle:"",icon:F(de),onClick:d,loading:s.value},null,8,["icon","loading"])]),_:1}),M(_,{"before-upload":m,"show-file-list":!1,accept:".json",style:{display:"inline-block",margin:"0 8px"}},{default:W(()=>[M(y,{content:"导入配置",placement:"bottom"},{default:W(()=>[M(f,{circle:"",icon:F(ue)},null,8,["icon"])]),_:1})]),_:1}),M(y,{content:"导出配置",placement:"bottom"},{default:W(()=>[M(f,{circle:"",icon:F(pe),onClick:u},null,8,["icon"])]),_:1}),M(y,{content:"配置对比",placement:"bottom"},{default:W(()=>[M(f,{circle:"",icon:F(me),onClick:t[0]||(t[0]=e=>o.value=!0)},null,8,["icon"])]),_:1})])]),P("div",ca,[M(p,{class:"stat-card"},{default:W(()=>[P("div",ra,[M(b,{size:32,color:"#409eff"},{default:W(()=>[M(F(se))]),_:1})]),P("div",da,[P("div",ua,I(F(a).totalAdapters),1),t[7]||(t[7]=P("div",{class:"stat-label"},"适配器总数",-1))])]),_:1}),M(p,{class:"stat-card"},{default:W(()=>[P("div",pa,[M(b,{size:32,color:"#67c23a"},{default:W(()=>[M(F(ve))]),_:1})]),P("div",ma,[P("div",va,I(F(a).enabledAdaptersCount),1),t[8]||(t[8]=P("div",{class:"stat-label"},"已启用",-1))])]),_:1}),M(p,{class:"stat-card"},{default:W(()=>[P("div",ha,[M(b,{size:32,color:"#e6a23c"},{default:W(()=>[M(F(ce))]),_:1})]),P("div",ga,[P("div",fa,I(F(a).totalModelsCount),1),t[9]||(t[9]=P("div",{class:"stat-label"},"可用模型",-1))])]),_:1}),M(p,{class:"stat-card"},{default:W(()=>[P("div",{class:"stat-icon",style:q({backgroundColor:"normal"===n.value?"#67c23a20":"#f5672020"})},[M(b,{size:32,color:"normal"===n.value?"#67c23a":"#f56720"},{default:W(()=>[(E(),z(Y("normal"===n.value?F(he):F(ge))))]),_:1},8,["color"])],4),P("div",ya,[P("div",_a,I(i.value),1),t[10]||(t[10]=P("div",{class:"stat-label"},"系统状态",-1))])]),_:1})]),P("div",ba,[t[15]||(t[15]=P("div",{class:"section-header"},[P("h3",null,"快速操作")],-1)),P("div",wa,[P("div",{class:"action-item",onClick:t[1]||(t[1]=e=>g("llm-adapters"))},[P("div",Ca,[M(b,null,{default:W(()=>[M(F(se))]),_:1})]),t[11]||(t[11]=P("div",{class:"action-info"},[P("div",{class:"action-title"},"LLM 适配器"),P("div",{class:"action-desc"},"管理模型与接口")],-1)),M(b,{class:"action-arrow"},{default:W(()=>[M(F(fe))]),_:1})]),P("div",{class:"action-item",onClick:t[2]||(t[2]=e=>g("server"))},[P("div",ka,[M(b,null,{default:W(()=>[M(F(oe))]),_:1})]),t[12]||(t[12]=P("div",{class:"action-info"},[P("div",{class:"action-title"},"服务器配置"),P("div",{class:"action-desc"},"端口与网络设置")],-1)),M(b,{class:"action-arrow"},{default:W(()=>[M(F(fe))]),_:1})]),P("div",{class:"action-item",onClick:t[3]||(t[3]=e=>g("web"))},[P("div",xa,[M(b,null,{default:W(()=>[M(F(ne))]),_:1})]),t[13]||(t[13]=P("div",{class:"action-info"},[P("div",{class:"action-title"},"Web 配置"),P("div",{class:"action-desc"},"界面与显示选项")],-1)),M(b,{class:"action-arrow"},{default:W(()=>[M(F(fe))]),_:1})]),P("div",{class:"action-item",onClick:t[4]||(t[4]=e=>g("onebot"))},[P("div",Sa,[M(b,null,{default:W(()=>[M(F(ie))]),_:1})]),t[14]||(t[14]=P("div",{class:"action-info"},[P("div",{class:"action-title"},"OneBot 配置"),P("div",{class:"action-desc"},"QQ 机器人连接")],-1)),M(b,{class:"action-arrow"},{default:W(()=>[M(F(fe))]),_:1})])])]),c.value.length>0?(E(),z(p,{key:0,class:"section-card"},{header:W(()=>[P("div",Va,[M(b,null,{default:W(()=>[M(F(ye))]),_:1}),P("span",null,"待处理事项 ("+I(c.value.length)+")",1)])]),default:W(()=>[P("div",Ta,[(E(!0),O(R,null,U(c.value,(e,t)=>(E(),O("div",{key:t,class:"pending-item"},[M(w,{type:e.type,title:e.title,closable:!1},null,8,["type","title"]),e.action?(E(),z(f,{key:0,type:"primary",link:"",onClick:e.action.handler},{default:W(()=>[D(I(e.action.text),1)]),_:2},1032,["onClick"])):$("",!0)]))),128))])]),_:1})):$("",!0),M(p,{class:"section-card"},{header:W(()=>[P("div",Oa,[M(b,null,{default:W(()=>[M(F(se))]),_:1}),t[16]||(t[16]=P("span",null,"适配器概览",-1))])]),default:W(()=>[P("div",Pa,[(E(!0),O(R,null,U(F(a).adapters,(e,t)=>(E(),O("div",{key:t,class:"adapter-type-section"},[P("div",Ma,[P("h3",null,I(r(t)),1),M(C,null,{default:W(()=>[D(I(e.length)+" 个实例",1)]),_:2},1024)]),0===e.length?(E(),O("div",Ia," 暂无实例 ")):(E(),O("div",La,[(E(!0),O(R,null,U(e,(e,a)=>(E(),O("div",{key:a,class:"adapter-item"},[M(C,{type:e.enable?"success":"info",size:"small"},{default:W(()=>[D(I(e.enable?"已启用":"已禁用"),1)]),_:2},1032,["type"]),P("span",$a,I(e.name||`${t}-${a+1}`),1),P("span",ja,I(e.default_model),1)]))),128))]))]))),128))])]),_:1})]))]),_:1}),M(v,{modelValue:o.value,"onUpdate:modelValue":t[5]||(t[5]=e=>o.value=e)},null,8,["modelValue"])])}}},[["__scopeId","data-v-51164508"]]),Aa=Object.freeze(Object.defineProperty({__proto__:null,default:qa},Symbol.toStringTag,{value:"Module"})),Ba={class:"llm-adapters-view"},Ra={key:0,class:"loading-container"},Ua={class:"skeleton-header"},Ea={class:"skeleton-actions"},za={class:"skeleton-table"},Da={key:0,class:"content-container"},Wa={class:"page-header"},Na={class:"header-actions"},Qa={class:"stats-bar"},Ha={class:"stat-item"},Ja={class:"stat-value"},Fa={class:"stat-item"},Ga={class:"stat-value"},Xa={class:"stat-item"},Ya={class:"stat-value"},Za={class:"adapters-list"},Ka={key:0,class:"empty-state"},el={class:"adapter-name"},tl={class:"name"},al={class:"model-name"},ll={class:"action-buttons"},sl=t({__name:"LLMAdaptersView",setup(e){const t=p(),a=N(!0),l=N(!1),s=N(!1),o=N("add"),n=N("openai"),i=N(null),c=N(-1),r=Q(()=>Object.keys(t.adapters)),d=Q(()=>{const e=[];return Object.entries(t.adapters).forEach(([a,l])=>{l.forEach((l,s)=>{const o=l.name||`${a}-${s+1}`,n=t.models[o]||[],i=n.reduce((e,t)=>e+(t.models?t.models.length:0),0);e.push({type:a,index:s,adapter:l,providerName:o,models:n,modelCount:i})})}),e}),u=Q(()=>d.value.filter(e=>e.adapter.enable).length),m=e=>{const t={openai:"OpenAI",gemini:"Gemini",vertex:"Vertex AI"};return t[e]?t[e]:e.charAt(0).toUpperCase()+e.slice(1)},v=e=>{o.value="add",n.value=e,i.value=null,c.value=-1,s.value=!0},h=e=>{t.clearAdapterSelection(),e.forEach(e=>{t.toggleAdapterSelection(e.type,e.index)})},f=async()=>{l.value=!0;try{await t.refreshAllModels(),ae.success("所有模型列表刷新成功")}catch(e){ae.error("刷新失败："+e.message)}finally{l.value=!1}},y=async()=>{try{const e=(await t.batchToggleAdapters(t.selectedAdapters,!0)).filter(e=>e.success).length;ae.success(`成功启用 ${e} 个适配器`),t.clearAdapterSelection()}catch(e){ae.error("批量启用失败："+e.message)}},_=async()=>{try{const e=(await t.batchToggleAdapters(t.selectedAdapters,!1)).filter(e=>e.success).length;ae.success(`成功禁用 ${e} 个适配器`),t.clearAdapterSelection()}catch(e){ae.error("批量禁用失败："+e.message)}},b=async()=>{try{await re.confirm(`确定要删除选中的 ${t.selectedAdapters.length} 个适配器吗？`,"批量删除",{confirmButtonText:"删除",cancelButtonText:"取消",type:"warning"});const e=(await t.batchDeleteAdapters(t.selectedAdapters)).filter(e=>e.success).length;ae.success(`成功删除 ${e} 个适配器`),t.clearAdapterSelection()}catch(e){"cancel"!==e&&ae.error("批量删除失败："+e.message)}},w=()=>{s.value=!1},C=async({type:e,index:a,data:l,mode:s})=>{try{"add"===s?(await t.addAdapter(e,l),ae.success("添加成功")):(await t.updateAdapter(e,a,l),ae.success("更新成功"))}catch(o){throw ae.error("add"===s?"添加失败：":"更新失败："+o.message),o}};return J(async()=>{a.value=!0;try{t.config||await t.fetchConfig(),await new Promise(e=>setTimeout(e,300))}catch(e){ae.error("加载配置失败："+e.message)}finally{a.value=!1}}),(e,p)=>{const k=B("el-button"),x=B("el-icon"),S=B("el-dropdown-item"),V=B("el-dropdown-menu"),T=B("el-dropdown"),L=B("el-empty"),j=B("el-table-column"),q=B("el-tag"),A=B("el-switch"),N=B("el-table");return E(),O("div",Ba,[a.value?(E(),O("div",Ra,[P("div",Ua,[p[0]||(p[0]=P("div",{class:"skeleton-title"},null,-1)),P("div",Ea,[(E(),O(R,null,U(3,e=>P("div",{class:"skeleton-button",key:e})),64))])]),P("div",za,[(E(),O(R,null,U(6,e=>P("div",{class:"skeleton-row",key:e},[(E(),O(R,null,U(6,e=>P("div",{class:"skeleton-cell",key:e})),64))])),64))])])):$("",!0),M(X,{name:"fade",mode:"out-in"},{default:W(()=>[a.value?$("",!0):(E(),O("div",Da,[P("div",Wa,[p[5]||(p[5]=P("h1",null,"LLM 适配器管理",-1)),P("div",Na,[F(t).selectedAdapters.length>0?(E(),z(k,{key:0,type:"success",icon:F(_e),onClick:y},{default:W(()=>[D(" 批量启用 ("+I(F(t).selectedAdapters.length)+") ",1)]),_:1},8,["icon"])):$("",!0),F(t).selectedAdapters.length>0?(E(),z(k,{key:1,type:"warning",icon:F(be),onClick:_},{default:W(()=>p[1]||(p[1]=[D(" 批量禁用 ")])),_:1},8,["icon"])):$("",!0),F(t).selectedAdapters.length>0?(E(),z(k,{key:2,type:"danger",icon:F(we),onClick:b},{default:W(()=>p[2]||(p[2]=[D(" 批量删除 ")])),_:1},8,["icon"])):$("",!0),M(k,{type:"primary",icon:F(de),loading:l.value,onClick:f},{default:W(()=>p[3]||(p[3]=[D(" 刷新全部模型 ")])),_:1},8,["icon","loading"]),M(T,{onCommand:v,trigger:"click"},{dropdown:W(()=>[M(V,null,{default:W(()=>[(E(!0),O(R,null,U(r.value,e=>(E(),z(S,{key:e,command:e},{default:W(()=>[M(x,null,{default:W(()=>[M(F(se))]),_:1}),D(" "+I(m(e)),1)]),_:2},1032,["command"]))),128))]),_:1})]),default:W(()=>[M(k,{type:"primary",icon:F(Ce)},{default:W(()=>[p[4]||(p[4]=D(" 添加适配器 ")),M(x,{class:"el-icon--right"},{default:W(()=>[M(F(ke))]),_:1})]),_:1},8,["icon"])]),_:1})])]),P("div",Qa,[P("div",Ha,[p[6]||(p[6]=P("span",{class:"stat-label"},"总计：",-1)),P("span",Ja,I(d.value.length)+" 个实例",1)]),P("div",Fa,[p[7]||(p[7]=P("span",{class:"stat-label"},"已启用：",-1)),P("span",Ga,I(u.value)+" 个",1)]),P("div",Xa,[p[8]||(p[8]=P("span",{class:"stat-label"},"总模型数：",-1)),P("span",Ya,I(F(t).totalModelsCount)+" 个",1)])]),P("div",Za,[0===d.value.length?(E(),O("div",Ka,[M(L,{description:"暂无适配器实例"},{default:W(()=>[M(T,{onCommand:v,trigger:"click"},{dropdown:W(()=>[M(V,null,{default:W(()=>[(E(!0),O(R,null,U(r.value,e=>(E(),z(S,{key:e,command:e},{default:W(()=>[M(x,null,{default:W(()=>[M(F(se))]),_:1}),D(" "+I(m(e)),1)]),_:2},1032,["command"]))),128))]),_:1})]),default:W(()=>[M(k,{type:"primary",icon:F(Ce)},{default:W(()=>p[9]||(p[9]=[D(" 添加适配器 ")])),_:1},8,["icon"])]),_:1})]),_:1})])):(E(),z(N,{key:1,data:d.value,style:{width:"100%"},onSelectionChange:h},{default:W(()=>[M(j,{type:"selection",width:"55"}),M(j,{label:"类型",width:"120"},{default:W(({row:e})=>{return[M(q,{type:(t=e.type,{openai:"success",gemini:"warning",vertex:"info"}[t]||"primary"),effect:"light"},{default:W(()=>[D(I(m(e.type)),1)]),_:2},1032,["type"])];var t}),_:1}),M(j,{label:"名称","min-width":"150"},{default:W(({row:e})=>[P("div",el,[P("span",tl,I(e.adapter.name||`${e.type}-${e.index+1}`),1),e.adapter.enable?$("",!0):(E(),z(q,{key:0,type:"info",size:"small",effect:"plain"},{default:W(()=>p[10]||(p[10]=[D(" 已禁用 ")])),_:1}))])]),_:1}),M(j,{label:"默认模型","min-width":"200"},{default:W(({row:e})=>[P("span",al,I(e.adapter.default_model||"-"),1)]),_:1}),M(j,{label:"可用模型",width:"120",align:"center"},{default:W(({row:e})=>{return[M(q,{size:"small",type:(t=e.modelCount,0===t?"danger":t<5?"warning":"success"),effect:"plain",round:""},{default:W(()=>[D(I(e.modelCount)+" 个 ",1)]),_:2},1032,["type"])];var t}),_:1}),M(j,{label:"状态",width:"100",align:"center"},{default:W(({row:e})=>[M(A,{modelValue:e.adapter.enable,"onUpdate:modelValue":t=>e.adapter.enable=t,onChange:a=>(async e=>{const{type:a,index:l,adapter:s}=e,o=s.enable;try{const e={...s,enable:o};await t.updateAdapter(a,l,e),ae.success(o?"已启用":"已禁用")}catch(n){s.enable=!o,ae.error("操作失败："+n.message)}})(e)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),M(j,{label:"操作",width:"200",align:"center"},{default:W(({row:e})=>[P("div",ll,[M(k,{size:"small",type:"primary",text:"",onClick:t=>(e=>{const{type:t,index:a,adapter:l}=e;o.value="edit",n.value=t,i.value=l,c.value=a,s.value=!0})(e)},{default:W(()=>p[11]||(p[11]=[D(" 编辑 ")])),_:2},1032,["onClick"]),M(k,{size:"small",type:"success",text:"",onClick:a=>(async e=>{const{type:a,index:l}=e;try{await t.refreshAdapterModels(a,l),ae.success("模型列表刷新成功")}catch(s){ae.error("刷新失败："+s.message)}})(e)},{default:W(()=>p[12]||(p[12]=[D(" 刷新 ")])),_:2},1032,["onClick"]),M(k,{size:"small",type:"danger",text:"",onClick:a=>(async e=>{const{type:a,index:l,adapter:s}=e,o=s.name||`${a}-${l+1}`;try{await re.confirm(`确定要删除适配器 "${o}" 吗？`,"删除确认",{confirmButtonText:"删除",cancelButtonText:"取消",type:"warning"}),await t.deleteAdapter(a,l),ae.success("删除成功")}catch(n){"cancel"!==n&&ae.error("删除失败："+n.message)}})(e)},{default:W(()=>p[13]||(p[13]=[D(" 删除 ")])),_:2},1032,["onClick"])])]),_:1})]),_:1},8,["data"]))])]))]),_:1}),M(g,{visible:s.value,mode:o.value,type:n.value,adapter:i.value,index:c.value,onClose:w,onSubmit:C},null,8,["visible","mode","type","adapter","index"])])}}},[["__scopeId","data-v-f36b807d"]]),ol=Object.freeze(Object.defineProperty({__proto__:null,default:sl},Symbol.toStringTag,{value:"Module"})),nl={class:"server-config-view"},il={class:"page-header"},cl={class:"header-actions"},rl=t({__name:"ServerConfigView",setup(e){const t=p(),a=N(null),l=N(!1),s=te({port:3080,host:"0.0.0.0",max_rate_pre_min:100,debug:!1}),o=te({}),n={port:[{required:!0,message:"请输入服务器端口",trigger:"blur"},{type:"number",min:1,max:65535,message:"端口范围必须在 1-65535 之间",trigger:"blur"}],host:[{required:!0,message:"请输入服务器主机",trigger:"blur"}],max_rate_pre_min:[{required:!0,message:"请输入最大请求频率",trigger:"blur"},{type:"number",min:1,message:"最大请求频率必须大于 0",trigger:"blur"}]},i=async()=>{try{await a.value.validate(),await re.confirm("修改服务器配置需要重启服务才能生效，是否继续？","确认保存",{confirmButtonText:"保存",cancelButtonText:"取消",type:"warning"}),l.value=!0,await t.updateConfigSection("server",{port:s.port,host:s.host,max_rate_pre_min:s.max_rate_pre_min}),t.config&&(t.config.debug=s.debug),ae.success("配置保存成功，请重启服务使配置生效"),Object.assign(o,s)}catch(e){"cancel"!==e&&ae.error("保存失败："+e.message)}finally{l.value=!1}},c=()=>{Object.assign(s,o),a.value?.clearValidate(),ae.info("已重置为当前保存的配置")};return J(async()=>{t.config||await t.fetchConfig(),await(async()=>{try{const e=t.config?.server||await t.fetchConfigSection("server"),a=t.config?.debug??!1;Object.assign(s,{port:e.port||3080,host:e.host||"0.0.0.0",max_rate_pre_min:e.max_rate_pre_min||100,debug:a}),Object.assign(o,s)}catch(e){ae.error("加载配置失败："+e.message)}})()}),(e,t)=>{const o=B("el-button"),r=B("el-alert"),d=B("el-input-number"),u=B("el-form-item"),p=B("el-input"),m=B("el-divider"),v=B("el-switch"),h=B("el-form"),g=B("el-card");return E(),O("div",nl,[P("div",il,[t[6]||(t[6]=P("h1",null,"服务器配置",-1)),P("div",cl,[M(o,{onClick:c},{default:W(()=>t[4]||(t[4]=[D("重置")])),_:1}),M(o,{type:"primary",loading:l.value,onClick:i},{default:W(()=>t[5]||(t[5]=[D(" 保存配置 ")])),_:1},8,["loading"])])]),M(r,{type:"warning",closable:!1,"show-icon":"",style:{"margin-bottom":"24px"}},{title:W(()=>t[7]||(t[7]=[D(" 修改服务器配置需要重启服务才能生效 ")])),_:1}),M(g,null,{default:W(()=>[M(h,{ref_key:"formRef",ref:a,model:s,rules:n,"label-width":"140px","label-position":"left"},{default:W(()=>[M(u,{label:"服务器端口",prop:"port"},{extra:W(()=>t[8]||(t[8]=[P("span",{class:"form-item-tip"}," 服务器监听端口，范围：1-65535，默认 3080 ",-1)])),default:W(()=>[M(d,{modelValue:s.port,"onUpdate:modelValue":t[0]||(t[0]=e=>s.port=e),min:1,max:65535,step:1,"controls-position":"right",style:{width:"200px"}},null,8,["modelValue"])]),_:1}),M(u,{label:"服务器主机",prop:"host"},{extra:W(()=>t[9]||(t[9]=[P("span",{class:"form-item-tip"}," 服务器绑定的主机地址，0.0.0.0 表示监听所有网卡 ",-1)])),default:W(()=>[M(p,{modelValue:s.host,"onUpdate:modelValue":t[1]||(t[1]=e=>s.host=e),placeholder:"0.0.0.0",style:{width:"300px"}},null,8,["modelValue"])]),_:1}),M(u,{label:"最大请求频率",prop:"max_rate_pre_min"},{extra:W(()=>t[10]||(t[10]=[P("span",{class:"form-item-tip"}," 每个客户端每分钟允许的最大请求次数，用于限流保护 ",-1)])),default:W(()=>[M(d,{modelValue:s.max_rate_pre_min,"onUpdate:modelValue":t[2]||(t[2]=e=>s.max_rate_pre_min=e),min:1,max:1e4,step:10,"controls-position":"right",style:{width:"200px"}},null,8,["modelValue"]),t[11]||(t[11]=P("span",{style:{"margin-left":"12px",color:"#909399"}},"次/分钟",-1))]),_:1}),M(m),M(u,{label:"调试模式",prop:"debug"},{extra:W(()=>t[12]||(t[12]=[P("span",{class:"form-item-tip"}," 开启后将输出详细的调试信息，生产环境建议关闭 ",-1)])),default:W(()=>[M(v,{modelValue:s.debug,"onUpdate:modelValue":t[3]||(t[3]=e=>s.debug=e),"active-text":"开启","inactive-text":"关闭"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1})])}}},[["__scopeId","data-v-b03648f6"]]),dl=Object.freeze(Object.defineProperty({__proto__:null,default:rl},Symbol.toStringTag,{value:"Module"})),ul={class:"web-config-view"},pl={class:"page-header"},ml={class:"header-actions"},vl=t({__name:"WebConfigView",setup(e){const t=p(),a=N(null),l=N(!1),s=N(!1),o=N(!1),n=te({title:"MioChat",beian:"",admin_code:"",user_code:"",full_screen:!0}),i=te({}),c={title:[{required:!0,message:"请输入网站标题",trigger:"blur"}],admin_code:[{required:!0,message:"请输入管理员验证码",trigger:"blur"},{min:6,message:"验证码长度至少为 6 位",trigger:"blur"}]},r=async()=>{try{await a.value.validate(),await re.confirm("修改 Web 配置需要重启服务才能生效，是否继续？","确认保存",{confirmButtonText:"保存",cancelButtonText:"取消",type:"warning"}),l.value=!0,await t.updateConfigSection("web",{title:n.title,beian:n.beian,admin_code:n.admin_code,user_code:n.user_code,full_screen:n.full_screen}),ae.success("配置保存成功，请重启服务使配置生效"),Object.assign(i,n)}catch(e){"cancel"!==e&&ae.error("保存失败："+e.message)}finally{l.value=!1}},d=()=>{Object.assign(n,i),a.value?.clearValidate(),ae.info("已重置为当前保存的配置")};return J(async()=>{t.config||await t.fetchConfig(),await(async()=>{try{const e=t.config?.web||await t.fetchConfigSection("web");Object.assign(n,{title:e.title||"MioChat",beian:e.beian||"",admin_code:e.admin_code||"",user_code:e.user_code||"",full_screen:e.full_screen??!0}),Object.assign(i,n)}catch(e){ae.error("加载配置失败："+e.message)}})()}),(e,t)=>{const i=B("el-button"),u=B("el-alert"),p=B("el-input"),m=B("el-form-item"),v=B("el-divider"),h=B("el-switch"),g=B("el-form"),f=B("el-card");return E(),O("div",ul,[P("div",pl,[t[9]||(t[9]=P("h1",null,"Web 配置",-1)),P("div",ml,[M(i,{onClick:d},{default:W(()=>t[7]||(t[7]=[D("重置")])),_:1}),M(i,{type:"primary",loading:l.value,onClick:r},{default:W(()=>t[8]||(t[8]=[D(" 保存配置 ")])),_:1},8,["loading"])])]),M(u,{type:"warning",closable:!1,"show-icon":"",style:{"margin-bottom":"24px"}},{title:W(()=>t[10]||(t[10]=[D(" 修改 Web 配置需要重启服务才能生效 ")])),_:1}),M(f,null,{default:W(()=>[M(g,{ref_key:"formRef",ref:a,model:n,rules:c,"label-width":"140px","label-position":"left"},{default:W(()=>[M(m,{label:"网站标题",prop:"title"},{extra:W(()=>t[11]||(t[11]=[P("span",{class:"form-item-tip"}," 显示在浏览器标签页和页面顶部的标题 ",-1)])),default:W(()=>[M(p,{modelValue:n.title,"onUpdate:modelValue":t[0]||(t[0]=e=>n.title=e),placeholder:"MioChat",maxlength:"50","show-word-limit":"",style:{width:"400px"}},null,8,["modelValue"])]),_:1}),M(m,{label:"备案号",prop:"beian"},{extra:W(()=>t[12]||(t[12]=[P("span",{class:"form-item-tip"}," 网站底部显示的备案信息，如：京ICP备12345678号 ",-1)])),default:W(()=>[M(p,{modelValue:n.beian,"onUpdate:modelValue":t[1]||(t[1]=e=>n.beian=e),placeholder:"留空则不显示",maxlength:"100","show-word-limit":"",style:{width:"400px"}},null,8,["modelValue"])]),_:1}),M(v),M(m,{label:"管理员验证码",prop:"admin_code"},{extra:W(()=>t[13]||(t[13]=[P("span",{class:"form-item-tip"}," 访问配置管理页面所需的验证码，请妥善保管 ",-1)])),default:W(()=>[M(p,{modelValue:n.admin_code,"onUpdate:modelValue":t[3]||(t[3]=e=>n.admin_code=e),type:s.value?"text":"password",placeholder:"用于访问配置管理",maxlength:"50","show-word-limit":"",style:{width:"400px"}},{append:W(()=>[M(i,{icon:s.value?F(xe):F(Se),onClick:t[2]||(t[2]=e=>s.value=!s.value)},null,8,["icon"])]),_:1},8,["modelValue","type"])]),_:1}),M(m,{label:"访客验证码",prop:"user_code"},{extra:W(()=>t[14]||(t[14]=[P("span",{class:"form-item-tip"}," 访客访问聊天功能所需的验证码，留空则无需验证 ",-1)])),default:W(()=>[M(p,{modelValue:n.user_code,"onUpdate:modelValue":t[5]||(t[5]=e=>n.user_code=e),type:o.value?"text":"password",placeholder:"留空则不需要验证码",maxlength:"50","show-word-limit":"",style:{width:"400px"}},{append:W(()=>[M(i,{icon:o.value?F(xe):F(Se),onClick:t[4]||(t[4]=e=>o.value=!o.value)},null,8,["icon"])]),_:1},8,["modelValue","type"])]),_:1}),M(v),M(m,{label:"全屏模式",prop:"full_screen"},{extra:W(()=>t[15]||(t[15]=[P("span",{class:"form-item-tip"}," 开启后界面将占据整个浏览器窗口 ",-1)])),default:W(()=>[M(h,{modelValue:n.full_screen,"onUpdate:modelValue":t[6]||(t[6]=e=>n.full_screen=e),"active-text":"开启","inactive-text":"关闭"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1})])}}},[["__scopeId","data-v-de858999"]]),hl=Object.freeze(Object.defineProperty({__proto__:null,default:vl},Symbol.toStringTag,{value:"Module"})),gl={class:"onebot-config-view"},fl={class:"page-header"},yl={class:"header-actions"},_l=t({__name:"OnebotConfigView",setup(e){const t=p(),a=N(null),l=N(!1),s=N(!1),o=te({enable:!1,reverse_ws_url:"",token:"",bot_qq:"",admin_qq:""}),n=te({}),i={reverse_ws_url:[{validator:(e,t,a)=>{o.enable&&!t?a(new Error("请输入反向 WebSocket URL")):!t||t.startsWith("ws://")||t.startsWith("wss://")?a():a(new Error("URL 必须以 ws:// 或 wss:// 开头"))},trigger:"blur"}],bot_qq:[{validator:(e,t,a)=>{o.enable&&!t?a(new Error("请输入机器人 QQ 号")):t&&!/^\d+$/.test(t)?a(new Error("QQ 号必须为纯数字")):a()},trigger:"blur"}],admin_qq:[{validator:(e,t,a)=>{t&&!/^\d+$/.test(t)?a(new Error("QQ 号必须为纯数字")):a()},trigger:"blur"}]},c=async()=>{try{await a.value.validate(),await re.confirm("修改 OneBot 配置需要重启服务才能生效，是否继续？","确认保存",{confirmButtonText:"保存",cancelButtonText:"取消",type:"warning"}),l.value=!0,await t.updateConfigSection("onebot",{enable:o.enable,reverse_ws_url:o.reverse_ws_url,token:o.token,bot_qq:o.bot_qq,admin_qq:o.admin_qq}),ae.success("配置保存成功，请重启服务使配置生效"),Object.assign(n,o)}catch(e){"cancel"!==e&&ae.error("保存失败："+e.message)}finally{l.value=!1}},r=()=>{Object.assign(o,n),a.value?.clearValidate(),ae.info("已重置为当前保存的配置")};return J(async()=>{t.config||await t.fetchConfig(),await(async()=>{try{const e=t.config?.onebot||await t.fetchConfigSection("onebot");Object.assign(o,{enable:e.enable??!1,reverse_ws_url:e.reverse_ws_url||"",token:e.token||"",bot_qq:e.bot_qq||"",admin_qq:e.admin_qq||""}),Object.assign(n,o)}catch(e){ae.error("加载配置失败："+e.message)}})()}),(e,t)=>{const n=B("el-button"),d=B("el-alert"),u=B("el-switch"),p=B("el-form-item"),m=B("el-divider"),v=B("el-input"),h=B("el-form"),g=B("el-card");return E(),O("div",gl,[P("div",fl,[t[8]||(t[8]=P("h1",null,"OneBot 配置",-1)),P("div",yl,[M(n,{onClick:r},{default:W(()=>t[6]||(t[6]=[D("重置")])),_:1}),M(n,{type:"primary",loading:l.value,onClick:c},{default:W(()=>t[7]||(t[7]=[D(" 保存配置 ")])),_:1},8,["loading"])])]),M(d,{type:"warning",closable:!1,"show-icon":"",style:{"margin-bottom":"24px"}},{title:W(()=>t[9]||(t[9]=[D(" 修改 OneBot 配置需要重启服务才能生效 ")])),_:1}),M(g,null,{default:W(()=>[M(h,{ref_key:"formRef",ref:a,model:o,rules:i,"label-width":"160px","label-position":"left"},{default:W(()=>[M(p,{label:"启用 OneBot",prop:"enable"},{extra:W(()=>t[10]||(t[10]=[P("span",{class:"form-item-tip"}," 是否启用 OneBot 协议支持（QQ 机器人） ",-1)])),default:W(()=>[M(u,{modelValue:o.enable,"onUpdate:modelValue":t[0]||(t[0]=e=>o.enable=e),"active-text":"启用","inactive-text":"禁用"},null,8,["modelValue"])]),_:1}),o.enable?(E(),O(R,{key:0},[M(m,{"content-position":"left"},{default:W(()=>t[11]||(t[11]=[D("连接配置")])),_:1}),M(p,{label:"反向 WebSocket URL",prop:"reverse_ws_url"},{extra:W(()=>t[12]||(t[12]=[P("span",{class:"form-item-tip"}," OneBot 实现端的反向 WebSocket 地址（如 go-cqhttp） ",-1)])),default:W(()=>[M(v,{modelValue:o.reverse_ws_url,"onUpdate:modelValue":t[1]||(t[1]=e=>o.reverse_ws_url=e),placeholder:"ws://localhost:2536/OneBotv11",style:{width:"500px"}},null,8,["modelValue"])]),_:1}),M(p,{label:"Access Token",prop:"token"},{extra:W(()=>t[13]||(t[13]=[P("span",{class:"form-item-tip"}," 与 OneBot 实现端配置的 access_token 保持一致 ",-1)])),default:W(()=>[M(v,{modelValue:o.token,"onUpdate:modelValue":t[3]||(t[3]=e=>o.token=e),type:s.value?"text":"password",placeholder:"留空则不使用 token 验证",maxlength:"100","show-word-limit":"",style:{width:"500px"}},{append:W(()=>[M(n,{icon:s.value?F(xe):F(Se),onClick:t[2]||(t[2]=e=>s.value=!s.value)},null,8,["icon"])]),_:1},8,["modelValue","type"])]),_:1}),M(m,{"content-position":"left"},{default:W(()=>t[14]||(t[14]=[D("机器人配置")])),_:1}),M(p,{label:"机器人 QQ 号",prop:"bot_qq"},{extra:W(()=>t[15]||(t[15]=[P("span",{class:"form-item-tip"}," 接入的 QQ 机器人账号 ",-1)])),default:W(()=>[M(v,{modelValue:o.bot_qq,"onUpdate:modelValue":t[4]||(t[4]=e=>o.bot_qq=e),placeholder:"3038848622",maxlength:"20",style:{width:"300px"}},null,8,["modelValue"])]),_:1}),M(p,{label:"管理员 QQ 号",prop:"admin_qq"},{extra:W(()=>t[16]||(t[16]=[P("span",{class:"form-item-tip"}," 机器人管理员的 QQ 号，拥有特殊权限 ",-1)])),default:W(()=>[M(v,{modelValue:o.admin_qq,"onUpdate:modelValue":t[5]||(t[5]=e=>o.admin_qq=e),placeholder:"1099834705",maxlength:"20",style:{width:"300px"}},null,8,["modelValue"])]),_:1})],64)):$("",!0)]),_:1},8,["model"])]),_:1}),o.enable?(E(),z(g,{key:0,style:{"margin-top":"16px"}},{header:W(()=>t[17]||(t[17]=[P("div",{class:"card-header"},[P("span",null,"连接状态")],-1)])),default:W(()=>[M(d,{type:"info",closable:!1,"show-icon":""},{title:W(()=>t[18]||(t[18]=[D(" 连接状态监控功能需要后端支持，暂未实现 ")])),_:1})]),_:1})):$("",!0)])}}},[["__scopeId","data-v-72597df4"]]),bl=Object.freeze(Object.defineProperty({__proto__:null,default:_l},Symbol.toStringTag,{value:"Module"})),wl={class:"plugins-view"},Cl={key:0,class:"loading-container"},kl={class:"skeleton-header"},xl={class:"skeleton-actions"},Sl={class:"plugins-grid"},Vl={key:0,class:"content-container"},Tl={class:"page-header"},Ol={class:"header-actions"},Pl={class:"stats-row"},Ml={class:"stat-icon",style:{"background-color":"#409eff20"}},Il={class:"stat-content"},Ll={class:"stat-value"},$l={class:"stat-icon",style:{"background-color":"#67c23a20"}},jl={class:"stat-content"},ql={class:"stat-value"},Al={class:"stat-icon",style:{"background-color":"#e6a23c20"}},Bl={class:"stat-content"},Rl={class:"stat-value"},Ul={class:"stat-icon",style:{"background-color":"#90939920"}},El={class:"stat-content"},zl={class:"stat-value"},Dl={class:"plugins-list"},Wl={class:"plugin-header"},Nl={class:"plugin-info"},Ql={class:"plugin-title-row"},Hl={class:"plugin-name"},Jl={class:"plugin-description"},Fl={class:"plugin-meta"},Gl={class:"meta-item"},Xl={class:"meta-item"},Yl={class:"plugin-actions"},Zl={key:0,class:"plugin-detail"},Kl={key:0,class:"tools-section"},es={class:"tool-header"},ts={class:"tool-description"},as={class:"config-editor"},ls={class:"debug-container",style:{height:"60vh","overflow-y":"auto"}},ss={class:"tool-info"},os={class:"info-row"},ns={class:"info-row"},is={class:"card-header"},cs={class:"params-schema"},rs={class:"param-header"},ds={class:"param-name"},us={class:"param-description"},ps={key:0,class:"param-enum"},ms={key:1,class:"param-items"},vs={class:"card-header"},hs={class:"params-hint"},gs={key:1,class:"result-container"},fs={class:"result-header"},ys={class:"status-indicator"},_s={class:"status-text"},bs={key:0,class:"execution-meta"},ws={class:"meta-item"},Cs={class:"result-body"},ks={class:"plugin-info-bar"},xs={class:"info-item"},Ss={class:"value"},Vs={class:"info-item"},Ts={class:"value"},Os={class:"json-viewer-container"},Ps={class:"json-content"},Ms={key:1,class:"error-content"},Is={class:"error-message-box"},Ls={class:"message-text"},$s={key:0,class:"error-stack"},js={class:"stack-content"},qs=t({__name:"PluginsView",setup(e){const t=N(!1),a=N(!1),l=N([]),s=N(!1),o=N(!1),n=N(!1),i=N(null),c=N(null),r=N([]),d=N(""),u=N(!1),p=N("{}"),m=N(null),v=N(!1),g=N([]),y=Q(()=>l.value.filter(e=>e.enabled).length),_=Q(()=>l.value.reduce((e,t)=>e+t.toolCount,0)),b=Q(()=>l.value.filter(e=>"custom"===e.type).length),w=async()=>{t.value=!0;try{const e=await f.listPlugins();0===e.code?l.value=e.data.plugins.map(e=>({...e,reloading:!1,toggling:!1})):ae.error("加载插件列表失败："+e.message)}catch(e){ae.error("加载插件列表失败："+e.message)}finally{t.value=!1}},C=async()=>{a.value=!0;try{await w(),ae.success("刷新成功")}finally{a.value=!1}},k=async()=>{try{await re.confirm("将重新加载所有插件的工具，是否继续？","确认重载",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"});const e=await f.reloadAllPlugins();0===e.code?(ae.success(`重载完成：成功 ${e.data.successCount}/${e.data.totalCount}`),await w()):ae.error("重载失败："+e.message)}catch(e){"cancel"!==e&&ae.error("重载失败："+e.message)}},x=async e=>{e.reloading=!0;try{const t=await f.reloadPlugin(e.name);0===t.code?(ae.success(`${e.displayName} 重载成功`),await w()):ae.error("重载失败："+t.message)}catch(t){ae.error("重载失败："+t.message)}finally{e.reloading=!1}},S=async()=>{try{const e=JSON.parse(d.value);u.value=!0;const t=await f.updatePluginConfig(i.value.name,e);0===t.code?(ae.success("配置保存成功"),o.value=!1,re.confirm("配置已更新，是否立即重载插件使配置生效？","提示",{confirmButtonText:"立即重载",cancelButtonText:"稍后",type:"info"}).then(async()=>{await x(i.value)}).catch(()=>{})):ae.error("保存失败："+t.message)}catch(e){e instanceof SyntaxError?ae.error("JSON 格式错误"):ae.error("保存失败："+e.message)}finally{u.value=!1}},V=()=>{if(!c.value?.parameters?.properties)return void(p.value="{}");const e={},t=c.value.parameters.properties;for(const[a,l]of Object.entries(t))switch(l.type){case"string":l.enum&&l.enum.length>0?e[a]=l.enum[0]:a.toLowerCase().includes("url")?e[a]="https://example.com":a.toLowerCase().includes("path")?e[a]="/path/to/file":a.toLowerCase().includes("query")||a.toLowerCase().includes("search")?e[a]="搜索关键词":e[a]="示例文本";break;case"number":case"integer":e[a]=l.minimum||0;break;case"boolean":e[a]=!0;break;case"array":e[a]=[];break;case"object":e[a]={};break;default:e[a]=null}p.value=JSON.stringify(e,null,2)},T=async()=>{try{const e=JSON.parse(p.value);v.value=!0,m.value=null;const t=await f.debugTool(i.value.name,c.value.name,e);0===t.code?m.value=t.data:ae.error("调试失败："+t.message)}catch(e){e instanceof SyntaxError?ae.error("参数 JSON 格式错误"):ae.error("调试失败："+e.message)}finally{v.value=!1}};return J(()=>{w()}),(e,w)=>{const j=B("el-button"),q=B("el-icon"),A=B("el-card"),N=B("el-tag"),Q=B("el-switch"),H=B("el-descriptions-item"),J=B("el-descriptions"),G=B("el-collapse-item"),Y=B("el-collapse"),Z=B("el-dialog"),K=B("el-alert"),ee=B("el-input");return E(),O("div",wl,[t.value?(E(),O("div",Cl,[P("div",kl,[w[9]||(w[9]=P("div",{class:"skeleton-title"},null,-1)),P("div",xl,[(E(),O(R,null,U(2,e=>P("div",{class:"skeleton-button",key:e})),64))])]),P("div",Sl,[(E(),O(R,null,U(6,e=>M(h,{key:e,type:"adapter-card","is-card":""})),64))])])):$("",!0),M(X,{name:"fade",mode:"out-in"},{default:W(()=>[t.value?$("",!0):(E(),O("div",Vl,[P("div",Tl,[w[12]||(w[12]=P("h1",null,"插件管理",-1)),P("div",Ol,[M(j,{type:"primary",icon:F(de),loading:a.value,onClick:C},{default:W(()=>w[10]||(w[10]=[D(" 刷新插件 ")])),_:1},8,["icon","loading"]),M(j,{type:"success",icon:F(Ve),onClick:k},{default:W(()=>w[11]||(w[11]=[D(" 重载全部 ")])),_:1},8,["icon"])])]),P("div",Pl,[M(A,{class:"stat-card"},{default:W(()=>[P("div",Ml,[M(q,{size:24,color:"#409eff"},{default:W(()=>[M(F(ce))]),_:1})]),P("div",Il,[P("div",Ll,I(l.value.length),1),w[13]||(w[13]=P("div",{class:"stat-label"},"插件总数",-1))])]),_:1}),M(A,{class:"stat-card"},{default:W(()=>[P("div",$l,[M(q,{size:24,color:"#67c23a"},{default:W(()=>[M(F(ve))]),_:1})]),P("div",jl,[P("div",ql,I(y.value),1),w[14]||(w[14]=P("div",{class:"stat-label"},"已启用",-1))])]),_:1}),M(A,{class:"stat-card"},{default:W(()=>[P("div",Al,[M(q,{size:24,color:"#e6a23c"},{default:W(()=>[M(F(Te))]),_:1})]),P("div",Bl,[P("div",Rl,I(_.value),1),w[15]||(w[15]=P("div",{class:"stat-label"},"工具总数",-1))])]),_:1}),M(A,{class:"stat-card"},{default:W(()=>[P("div",Ul,[M(q,{size:24,color:"#909399"},{default:W(()=>[M(F(Oe))]),_:1})]),P("div",El,[P("div",zl,I(b.value),1),w[16]||(w[16]=P("div",{class:"stat-label"},"自定义插件",-1))])]),_:1})]),P("div",Dl,[(E(!0),O(R,null,U(l.value,e=>(E(),z(A,{key:e.name,class:L(["plugin-card",{disabled:!e.enabled}])},{default:W(()=>[P("div",Wl,[P("div",Nl,[P("div",Ql,[P("h3",Hl,["custom"===e.type?(E(),z(N,{key:0,type:"warning",size:"small",style:{"margin-right":"8px"}},{default:W(()=>w[17]||(w[17]=[D(" 自定义 ")])),_:1})):$("",!0),D(" "+I(e.displayName),1)]),M(Q,{modelValue:e.enabled,"onUpdate:modelValue":t=>e.enabled=t,onChange:t=>(async e=>{e.toggling=!0;try{const t=await f.togglePlugin(e.name,e.enabled);0===t.code?ae.success(`${e.displayName} 已${e.enabled?"启用":"禁用"}`):(ae.error("操作失败："+t.message),e.enabled=!e.enabled)}catch(t){ae.error("操作失败："+t.message),e.enabled=!e.enabled}finally{e.toggling=!1}})(e),loading:e.toggling},null,8,["modelValue","onUpdate:modelValue","onChange","loading"])]),P("p",Jl,I(e.description||"暂无描述"),1),P("div",Fl,[M(N,{size:"small",type:"info"},{default:W(()=>[D("v"+I(e.version),1)]),_:2},1024),P("span",Gl,[M(q,null,{default:W(()=>[M(F(Pe))]),_:1}),D(" "+I(e.author),1)]),P("span",Xl,[M(q,null,{default:W(()=>[M(F(Te))]),_:1}),D(" "+I(e.toolCount)+" 个工具 ",1)]),e.hasConfig?(E(),z(N,{key:0,size:"small",type:"success"},{default:W(()=>[M(q,null,{default:W(()=>[M(F(Me))]),_:1}),w[18]||(w[18]=D(" 可配置 "))]),_:1})):$("",!0)])])]),P("div",Yl,[M(j,{size:"small",icon:F(xe),onClick:t=>(async e=>{i.value=e,s.value=!0;try{const t=await f.getPluginTools(e.name);0===t.code&&(r.value=t.data.tools,g.value=t.data.tools.map(e=>e.group))}catch(t){ae.error("加载工具列表失败："+t.message)}})(e)},{default:W(()=>w[19]||(w[19]=[D(" 查看详情 ")])),_:2},1032,["icon","onClick"]),e.hasConfig?(E(),z(j,{key:0,size:"small",icon:F(Me),onClick:t=>(async e=>{i.value=e;try{const t=await f.getPluginConfig(e.name);0===t.code?(d.value=JSON.stringify(t.data,null,2),o.value=!0):ae.error("加载配置失败："+t.message)}catch(t){ae.error("加载配置失败："+t.message)}})(e)},{default:W(()=>w[20]||(w[20]=[D(" 配置 ")])),_:2},1032,["icon","onClick"])):$("",!0),M(j,{size:"small",type:"primary",icon:F(de),loading:e.reloading,onClick:t=>x(e)},{default:W(()=>w[21]||(w[21]=[D(" 重载 ")])),_:2},1032,["icon","loading","onClick"])])]),_:2},1032,["class"]))),128))])]))]),_:1}),M(Z,{modelValue:s.value,"onUpdate:modelValue":w[1]||(w[1]=e=>s.value=e),title:`${i.value?.displayName} - 详情`,width:"800px","destroy-on-close":""},{default:W(()=>[i.value?(E(),O("div",Zl,[M(J,{column:2,border:""},{default:W(()=>[M(H,{label:"插件名称"},{default:W(()=>[D(I(i.value.displayName),1)]),_:1}),M(H,{label:"版本"},{default:W(()=>[D(I(i.value.version),1)]),_:1}),M(H,{label:"作者"},{default:W(()=>[D(I(i.value.author),1)]),_:1}),M(H,{label:"类型"},{default:W(()=>[M(N,{type:"standard"===i.value.type?"success":"warning"},{default:W(()=>[D(I("standard"===i.value.type?"标准插件":"自定义插件"),1)]),_:1},8,["type"])]),_:1}),M(H,{label:"状态"},{default:W(()=>[M(N,{type:i.value.enabled?"success":"info"},{default:W(()=>[D(I(i.value.enabled?"已启用":"已禁用"),1)]),_:1},8,["type"])]),_:1}),M(H,{label:"工具数量"},{default:W(()=>[D(I(i.value.toolCount),1)]),_:1}),M(H,{label:"描述",span:2},{default:W(()=>[D(I(i.value.description||"暂无描述"),1)]),_:1})]),_:1}),r.value.length>0?(E(),O("div",Kl,[w[23]||(w[23]=P("h4",null,"提供的工具",-1)),M(Y,{modelValue:g.value,"onUpdate:modelValue":w[0]||(w[0]=e=>g.value=e)},{default:W(()=>[(E(!0),O(R,null,U(r.value,e=>(E(),z(G,{key:e.group,name:e.group,title:`${e.group} (${e.tools.length})`},{default:W(()=>[(E(!0),O(R,null,U(e.tools,e=>(E(),O("div",{key:e.name,class:"tool-item"},[P("div",es,[P("h5",null,I(e.name),1),M(j,{size:"small",type:"primary",icon:F(Ie),onClick:t=>(e=>{c.value=e,p.value="{}",m.value=null,n.value=!0})(e)},{default:W(()=>w[22]||(w[22]=[D(" 调试 ")])),_:2},1032,["icon","onClick"])]),P("p",ts,I(e.description),1),M(N,{size:"small",type:"info"},{default:W(()=>[D(" 参数: "+I(Object.keys(e.parameters?.properties||{}).length),1)]),_:2},1024)]))),128))]),_:2},1032,["name","title"]))),128))]),_:1},8,["modelValue"])])):$("",!0)])):$("",!0)]),_:1},8,["modelValue","title"]),M(Z,{modelValue:o.value,"onUpdate:modelValue":w[4]||(w[4]=e=>o.value=e),title:`${i.value?.displayName} - 配置`,width:"700px","destroy-on-close":""},{footer:W(()=>[M(j,{onClick:w[3]||(w[3]=e=>o.value=!1)},{default:W(()=>w[25]||(w[25]=[D("取消")])),_:1}),M(j,{type:"primary",loading:u.value,onClick:S},{default:W(()=>w[26]||(w[26]=[D(" 保存配置 ")])),_:1},8,["loading"])]),default:W(()=>[P("div",as,[M(K,{type:"info",closable:!1,"show-icon":"",style:{"margin-bottom":"16px"}},{title:W(()=>w[24]||(w[24]=[D(" 配置将自动保存并触发热更新 ")])),_:1}),M(ee,{modelValue:d.value,"onUpdate:modelValue":w[2]||(w[2]=e=>d.value=e),type:"textarea",rows:15,placeholder:"JSON 配置",class:"config-textarea"},null,8,["modelValue"])])]),_:1},8,["modelValue","title"]),M(Z,{modelValue:n.value,"onUpdate:modelValue":w[8]||(w[8]=e=>n.value=e),title:`调试工具: ${c.value?.name}`,width:"800px","destroy-on-close":"",class:"debug-dialog"},{footer:W(()=>[M(j,{onClick:w[7]||(w[7]=e=>n.value=!1)},{default:W(()=>w[42]||(w[42]=[D("关闭")])),_:1}),M(j,{type:"primary",icon:F(Ie),loading:v.value,onClick:T},{default:W(()=>w[43]||(w[43]=[D(" 执行调试 ")])),_:1},8,["icon","loading"])]),default:W(()=>[P("div",ls,[M(A,{class:"tool-info-card",shadow:"never"},{default:W(()=>[P("div",ss,[P("div",os,[w[27]||(w[27]=P("label",null,"工具名称",-1)),M(N,{type:"primary"},{default:W(()=>[D(I(c.value?.name),1)]),_:1})]),P("div",ns,[w[28]||(w[28]=P("label",null,"描述",-1)),P("span",null,I(c.value?.description||"无描述"),1)])])]),_:1}),c.value?.parameters?(E(),z(A,{key:0,class:"params-schema-card",shadow:"never"},{header:W(()=>[P("div",is,[w[30]||(w[30]=P("span",null,"参数说明",-1)),M(j,{size:"small",type:"primary",text:"",onClick:V},{default:W(()=>w[29]||(w[29]=[D(" 填充示例参数 ")])),_:1})])]),default:W(()=>[P("div",cs,[(E(!0),O(R,null,U(c.value?.parameters?.properties,(e,t)=>(E(),O("div",{key:t,class:"param-item"},[P("div",rs,[P("span",ds,[D(I(t)+" ",1),c.value?.parameters?.required?.includes(t)?(E(),z(N,{key:0,type:"danger",size:"small",effect:"plain"},{default:W(()=>w[31]||(w[31]=[D(" 必需 ")])),_:1})):(E(),z(N,{key:1,type:"info",size:"small",effect:"plain"},{default:W(()=>w[32]||(w[32]=[D(" 可选 ")])),_:1}))]),M(N,{size:"small",type:"info"},{default:W(()=>[D(I(e.type),1)]),_:2},1024)]),P("div",us,I(e.description||"无描述"),1),e.enum?(E(),O("div",ps," 可选值: "+I(e.enum.join(", ")),1)):$("",!0),e.items?(E(),O("div",ms," 数组项类型: "+I(e.items.type),1)):$("",!0)]))),128))])]),_:1})):$("",!0),M(A,{class:"params-input-card",shadow:"never"},{header:W(()=>[P("div",vs,[w[34]||(w[34]=P("span",null,"参数输入 (JSON 格式)",-1)),M(j,{size:"small",type:"warning",text:"",onClick:w[5]||(w[5]=e=>p.value="{}")},{default:W(()=>w[33]||(w[33]=[D(" 清空 ")])),_:1})])]),default:W(()=>[M(ee,{modelValue:p.value,"onUpdate:modelValue":w[6]||(w[6]=e=>p.value=e),type:"textarea",rows:6,placeholder:'请输入 JSON 格式的参数，例如: {"query": "test", "limit": 10}',class:"params-textarea"},null,8,["modelValue"]),P("div",hs,[M(q,null,{default:W(()=>[M(F(Le))]),_:1}),w[35]||(w[35]=D(" 提示: 请确保输入的是有效的 JSON 格式，必需参数不能缺失 "))])]),_:1}),m.value?(E(),O("div",gs,[M(A,{class:"result-card",shadow:"never"},{header:W(()=>w[36]||(w[36]=[P("div",{class:"card-header"},[P("span",null,"执行结果")],-1)])),default:W(()=>[P("div",{class:L(["debug-result-wrapper",m.value.success?"status-success":"status-error"])},[P("div",fs,[P("div",ys,[M(q,{size:18,class:"icon"},{default:W(()=>[m.value.success?(E(),z(F($e),{key:0})):(E(),z(F(je),{key:1}))]),_:1}),P("span",_s,I(m.value.success?"执行成功":"执行失败"),1)]),m.value.success?(E(),O("div",bs,[P("span",ws,"耗时: "+I(m.value.executionTime),1)])):$("",!0)]),P("div",Cs,[m.value.success?(E(),O(R,{key:0},[P("div",ks,[P("span",xs,[w[37]||(w[37]=P("span",{class:"label"},"插件:",-1)),P("span",Ss,I(m.value.pluginName),1)]),w[39]||(w[39]=P("span",{class:"divider"},"|",-1)),P("span",Vs,[w[38]||(w[38]=P("span",{class:"label"},"工具:",-1)),P("span",Ts,I(m.value.toolName),1)])]),P("div",Os,[w[40]||(w[40]=P("div",{class:"viewer-label"},"返回结果",-1)),P("div",Ps,[P("pre",null,I(JSON.stringify(m.value.result,null,2)),1)])])],64)):(E(),O("div",Ms,[P("div",Is,[M(q,{class:"error-icon"},{default:W(()=>[M(F(Le))]),_:1}),P("span",Ls,I(m.value.error?.message||"未知错误"),1)]),m.value.error?.stack?(E(),O("div",$s,[w[41]||(w[41]=P("div",{class:"stack-label"},"错误堆栈",-1)),P("pre",js,I(m.value.error.stack),1)])):$("",!0)]))])],2)]),_:1})])):$("",!0)])]),_:1},8,["modelValue","title"])])}}},[["__scopeId","data-v-42837a0b"]]),As=Object.freeze(Object.defineProperty({__proto__:null,default:qs},Symbol.toStringTag,{value:"Module"}));export{Ae as r};
//# sourceMappingURL=views-B_MntzMo.js.map
