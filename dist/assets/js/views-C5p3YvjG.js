import{_ as e,C as t,F as s,I as a,T as o,a as i,R as n,c as l,f as r,P as c,b as d}from"./components-CNHNNXCd.js";import{M as h,b as p,o as u,c as m,a as g,t as v,n as y,w,v as C,h as f,i as _,F as b,d as k,f as S,e as x,m as T,p as M,E as I,l as L,k as O,q as V,s as R,u as D,j as P,x as $}from"./vue-vendor-C9tKH67p.js";import{h as E,_ as B}from"./vendor-BDDHlY_N.js";import"./emoji-BVjhSaBE.js";const U={id:"chat-window"},A={class:"upside-bar"},j={class:"contactor-name"},W={class:"delay-num"},H={class:"options"},q={key:0,class:"message-time"},z=["id"],F={key:0,class:"avatar"},N=["src","alt"],K=["src","alt"],G={key:1,class:"msg"},J={class:"wholename"},X={key:0,class:"title"},Y={class:"name"},Q=["onContextmenu"],Z={key:5},ee={key:7,class:"blank-message",style:{width:"10rem",height:"28.8px",position:"relative"}},te={key:2,class:"system-message"};const se=e({components:{MdPreview:h,ContextMenu:t,ForwardMsg:s,InputEditor:a,ToolCallBar:o,FileBlock:i,ReasonBlock:n},data(){let e,t,s=!1,a=!0;const o=window.location.href,i=new URL(o).searchParams;i.has("preview")&&(s=!0),i.has("shareId")&&(e=i.get("shareId")),i.has("scroll")&&(a="true"===i.get("scroll"));const n=parseInt(this.$route.params.id);try{if(t=l.getContactor(n),!t)throw new Error("找不到联系人")}catch(r){const a=l.contactList[0].id;this.$router.push({path:`/chat/${a}`,query:{preview:s,shareId:e}}),t=l.getContactor(a)}return{scroll:a,preview:s,shareId:e,activeContactor:t,showwindow:!0,showemoji:!1,userInput:"",client:l,extraOptions:[],wraperPresets:{},selectedOption:null,currentDelay:0,toupdate:!1,seletedText:"",seletedImage:"",retryList:[],showMenu:!1,menuTop:0,menuLeft:0,validMessageIndex:-1,repliedMessageId:-1,autoScroll:!1,fullScreen:!1,chatWindowRef:null}},computed:{getMenuStyle(){return this.menuLeft+110>window.innerWidth?{top:this.menuTop+"px",left:this.menuLeft-110+"px"}:{top:this.menuTop+"px",left:this.menuLeft+"px"}},getDelayStatus(){return this.currentDelay>1e3?"high":this.currentDelay>500?"mid":this.currentDelay>100?"low":"ultra"},activeMessageChain(){return this.activeContactor.options.opening?[{role:"other",content:[{type:"text",data:{text:this.activeContactor.options.opening}}],time:this.activeContactor.createTime},...this.activeContactor.messageChain]:this.activeContactor.messageChain}},watch:{"$route.params.id"(e,t){const s=parseInt(e),a=l.getContactor(s);if(this.activeContactor=a,this.initContactor(this.activeContactor),this.chatWindowRef&&this.toButtom(),t){const e=parseInt(t),s=l.getContactor(e);this.disableContactor(s)}}},async mounted(){if(document.addEventListener("click",(()=>{this.showMenu=!1,this.seletedText="",this.seletedImage=""})),this.chatWindowRef=this.$refs.chatWindow,this.chatWindowRef.addEventListener("scroll",this.scrollHandler),!this.preview&&this.scroll&&this.toButtom(),this.scroll=!0,this.initContactor(this.activeContactor),this.fullScreen=this.client.fullScreen,setInterval((()=>{this.currentDelay=this.client.socket.delay}),3e3),this.shareId){await l.loadOriginalContactors(this.shareId)?this.$router.push({path:"/chat/"+this.shareId,query:{preview:this.preview,scroll:!1}}):this.$message({message:"分享链接已失效",type:"error"})}},updated(){this.toupdate&&this.autoScroll&&0===this.retryList.length&&(this.toButtom(),this.toupdate=!1)},beforeUnmount(){this.disableContactor(this.activeContactor),this.chatWindowRef.removeEventListener("scroll",this.scrollHandler)},methods:{handleMouseUp(){const e=window.getSelection().toString();e&&(this.seletedText=e)},toButtom(e){setTimeout((()=>{if(this.chatWindowRef)this.chatWindowRef.scrollTop=this.chatWindowRef.scrollHeight;else{const e=document.getElementById("main-messages-window");e.scrollTop=e.scrollHeight}e&&this.$message("已滑至底部")}),20)},cleanScreen(){this.activeContactor.messageChain=[],this.activeContactor.updateFirstMessage(),l.setLocalStorage(),this.activeContactor.emit("updateMessageSummary"),this.toupdate=!0,this.$message({message:"已清除会话记录",type:"success"})},cleanHistory(){this.activeContactor.updateFirstMessage(),this.$message({message:"上下文信息已清除，之后的请求将不再记录上文记录",type:"success"})},isValidInput:e=>!/^[ \n]+$/.test(e),waiting(){this.$message({message:"此功能尚未开放",type:"warning"})},tolist(){this.$router.push({name:"home"})},async setModel(e){this.activeContactor.options.model=e,this.activeContactor.title=e,this.activeContactor.loadAvatar(),await l.setLocalStorage()},toimg(){const e=this.chatWindowRef.getBoundingClientRect();e.height=this.chatWindowRef.scrollHeight,E(this.chatWindowRef,{windowHeight:1.2*e.height,width:e.width}).then((e=>{const t=e.toDataURL("image/png"),s=document.createElement("a");s.download="chat.png",s.href=t,s.click()}))},async share(){await l.shareContactor(this.activeContactor.id)?this.$message({message:"分享链接已复制",type:"success"}):this.$message({message:"分享失败",type:"error"})},hasOpening(){return!!this.activeContactor.options.opening},getFullMessages(){return this.hasOpening()?[{role:"other",content:[{type:"text",data:{text:this.activeContactor.options.opening}}],time:this.activeContactor.createTime},...this.activeContactor.messageChain]:this.activeContactor.messageChain},showTime(e){const t=this.getFullMessages(),s=t[e].time;if(0===e)return{show:!0,time:this.activeContactor.getShownTime(s)};return s-t[e-1].time>6e5?{show:!0,time:this.activeContactor.getShownTime(s)}:{show:!1,time:""}},separateTextAndImages(e){const t=/!\[([^\]]*)\]\((.*)\)/g;let s,a=[],o=0;for(;null!==(s=t.exec(e));){if(s.index>o){const t=e.slice(o,s.index).trim();t&&a.push({type:"text",data:{text:t}})}a.push({type:"image",data:{file:s[2]}}),o=t.lastIndex}if(o<e.length){const t=e.slice(o).trim();t&&a.push({type:"text",data:{text:t}})}return a},getChatwindowScrollheight(){var e=this.chatWindowRef.scrollTop,t=this.chatWindowRef.clientHeight,s=this.chatWindowRef.scrollHeight;return s-e/(s-t)*s},initContactor(e){e.active=!0,e.on("revMessage",(e=>{this.activeContactor.messageChain.push(e),this.toupdate=!0})),e.on("delMessage",(e=>{this.activeContactor.messageChain.splice(e,1),this.toupdate=!0})),e.on("updateMessage",(()=>{this.$forceUpdate(),this.toupdate=!0})),e.on("completeMessage",(async e=>{const t=e.messageId,s=this.activeContactor.getMessageById(t);"retrying"===s.status&&(this.retryList=this.retryList.filter((e=>e!==t))),s.status="completed",e.error?s.content=[{type:"text",data:{text:e.text}}]:s.content.forEach(((e,t)=>{if("text"===e.type&&"onebot"===this.activeContactor.platform){const a=this.separateTextAndImages(e.data.text);s.content.splice(t,1,...a)}})),this.toupdate=!0,this.activeContactor.loadName(),l.setLocalStorage()}))},disableContactor(e){e&&(e.active=!1,e.off("updateMessage"),e.off("revMessage"),e.off("delMessage"),e.off("completeMessage"))},getReplyText(e){let t="";const s=this.activeContactor.messageChain.find((t=>t.id===e));if(s)return s.content.forEach((e=>{"text"===e.type?t+=e.data.text:"image"===e.type&&(t+="[图片]")})),t.length>20?`> ${t.substr(0,20)}...`:`> ${t}`},showMessageMenu(e,t){if("img"===e.target.tagName.toLowerCase()){const t=e.target.src;this.seletedImage=t}this.validMessageIndex="openai"===this.activeContactor.platform&&this.hasOpening()?t-1:t,e.preventDefault(),this.showMenu=!0,this.menuTop=e.clientY,this.menuLeft=e.clientX;const s=window.getSelection().toString();this.seletedText=s||""},scrollHandler(){this.showMenu=!1,this.showemoji&&(this.showemoji=!1);const e=this.getChatwindowScrollheight();this.autoScroll=!(e>300)},getseletedMessage(){return this.activeContactor.messageChain[this.validMessageIndex]},handleMessageOption(e){const t=this.getseletedMessage();switch(e){case"retry":"onebot"===this.activeContactor.platform?("user"===t.role?this.activeContactor.webSend(t):this.activeContactor.webSend({...t,role:"user"}),this.$message({message:"消息已重新发送",type:"success"})):(t.role,this.validMessageIndex,t.role,this.activeContactor.retryMessage(t.id),t.status="retrying",this.retryList.push(t.id)),this.toButtom();break;case"reply":"onebot"===this.activeContactor.platform?(this.repliedMessageId=t.id,this.$message({message:"已引用该消息",type:"success"})):this.userInput+=this.getReplyText(this.activeContactor.messageChain[this.validMessageIndex].id)+"\n\n";break;case"delete":this.activeContactor.messageChain.splice(this.validMessageIndex,1),l.setLocalStorage()}}}},[["render",function(e,t,s,a,o,i){const n=p("ContextMenu"),l=p("MdPreview"),r=p("el-image"),c=p("ForwardMsg"),d=p("FileBlock"),h=p("ReasonBlock"),T=p("ToolCallBar"),M=p("InputEditor");return u(),m("div",U,[g("div",A,[g("div",{class:"return",onClick:t[0]||(t[0]=e=>i.tolist())},t[7]||(t[7]=[g("i",{class:"iconfont icon-return"},null,-1)])),g("div",{class:"name-area",onClick:t[1]||(t[1]=t=>e.$router.push(`/profile/${o.activeContactor.id}`))},[g("div",j,v(o.activeContactor.name),1),g("span",{class:y("delay-status "+i.getDelayStatus)},null,2),g("span",W,"当前延迟: "+v(o.currentDelay)+" ms",1)]),g("ul",H,[g("li",{class:"share",onClick:t[2]||(t[2]=e=>i.share())},t[8]||(t[8]=[g("i",{class:"iconfont icon-share"},null,-1)]))])]),g("div",{id:"main-messages-window",ref:"chatWindow",class:y({"message-window":!0,preview:o.preview})},[w(f(n,{type:"message",message:i.getseletedMessage(),"seleted-text":o.seletedText,"seleted-image":o.seletedImage,style:_(i.getMenuStyle),onMessageOption:i.handleMessageOption,onClose:t[3]||(t[3]=e=>o.showMenu=!1)},null,8,["message","seleted-text","seleted-image","style","onMessageOption"]),[[C,o.showMenu]]),(u(!0),m(b,null,k(i.activeMessageChain,((s,a)=>(u(),m("div",{key:`${o.activeContactor.id}-${s.id}`,ref_for:!0,ref:"message",class:"message-container"},[i.showTime(a).show?(u(),m("div",q,v(i.showTime(a).time),1)):S("",!0),g("div",{id:s.role,class:"message-body"},["mio_system"!==s.role?(u(),m("div",F,["other"===s.role?(u(),m("img",{key:0,src:o.activeContactor.avatar,alt:o.activeContactor.name,onClick:t[4]||(t[4]=t=>e.$router.push(`/profile/${o.activeContactor.id}`))},null,8,N)):(u(),m("img",{key:1,src:o.client.avatar,alt:o.client.name},null,8,K))])):S("",!0),"mio_system"!==s.role?(u(),m("div",G,[g("div",J,[("other"===s.role?o.activeContactor.title:o.client.title)?(u(),m("div",X,v("other"===s.role?o.activeContactor.title:o.client.title),1)):S("",!0),g("div",Y,v("other"===s.role?o.activeContactor.name:o.client.name),1)]),g("div",{class:"content",onMouseup:t[5]||(t[5]=(...e)=>i.handleMouseUp&&i.handleMouseUp(...e)),onContextmenu:e=>i.showMessageMenu(e,a)},[(u(!0),m(b,null,k(s.content,((e,s)=>(u(),m("div",{key:s,class:"inner-content"},["text"===e.type?(u(),x(l,{key:0,"no-img-zoom-in":!1,"preview-theme":"github","code-foldable":!1,"model-value":e.data.text},null,8,["model-value"])):"image"===e.type?(u(),x(r,{key:`${o.activeContactor.id}-${a}-${s}-${e.data.file}`,src:e.data.file,"zoom-rate":1.2,"max-scale":7,"min-scale":.2,"preview-src-list":[e.data.file],"initial-index":4,loading:"lazy",fit:"contain"},null,8,["src","preview-src-list"])):"reply"===e.type?(u(),x(l,{key:2,"preview-theme":"github","model-value":i.getReplyText(e.data.id)},null,8,["model-value"])):"nodes"===e.type?(u(),x(c,{key:3,contactor:o.activeContactor,messages:e.data.messages},null,8,["contactor","messages"])):"file"===e.type?(u(),x(d,{key:4,"file-url":e.data.file},null,8,["file-url"])):"at"===e.type?(u(),m("span",Z)):"reason"===e.type?(u(),x(h,{key:6,"end-time":e.data.endTime,"start-time":e.data.startTime,content:e.data.text},null,8,["end-time","start-time","content"])):"blank"===e.type?(u(),m("div",ee,t[9]||(t[9]=[g("span",{class:"blank-loader"},null,-1)]))):"tool_call"===e.type?(u(),x(T,{key:8,"tool-call":e.data},null,8,["tool-call"])):(u(),x(l,{key:9,"preview-theme":"github","model-value":"未知的消息类型：\n```\n"+JSON.stringify(e,null,2)+"\n```"},null,8,["model-value"]))])))),128))],40,Q)])):(u(),m("div",te,v(s.content[0].data.text),1))],8,z)])))),128))],2),f(M,{ref:"inputEditor","active-contactor":o.activeContactor,"replied-message-id":o.repliedMessageId,onStroge:t[6]||(t[6]=e=>o.client.setLocalStorage()),onSetModel:i.setModel,onCleanScreen:i.cleanScreen,onCleanHistory:i.cleanHistory,onToButtom:i.toButtom},null,8,["active-contactor","replied-message-id","onSetModel","onCleanScreen","onCleanHistory","onToButtom"])])}],["__scopeId","data-v-b3047f76"]]),ae=T({history:M("/"),routes:[{path:"/",name:"home",component:()=>B((()=>Promise.resolve().then((()=>he))),void 0),children:[{path:"/",name:"blank",component:()=>B((()=>Promise.resolve().then((()=>ne))),void 0)},{path:"/contactors",name:"contactors",component:()=>B((()=>Promise.resolve().then((()=>ne))),void 0)},{path:"/chat/:id",name:"chat_view",component:se},{path:"/profile/:id",name:"profile_view",component:()=>B((()=>Promise.resolve().then((()=>Ae))),void 0)}]},{path:"/auth",name:"auth",component:()=>B((()=>Promise.resolve().then((()=>ze))),void 0)},{path:"/settings",name:"settings",component:()=>B((()=>Promise.resolve().then((()=>Ke))),void 0)}]});ae.beforeEach((async e=>{let t=l.everLogin;if(t||(t=await l.getLoginHistory()),!t&&"auth"!==e.name){I.warning("请先登录");return{name:"auth",query:"/settings"===e.path?null:{redirect:e.fullPath}}}}));const oe={class:"blank-view"};const ie=e({name:"BlankView",data:()=>({fullScreen:!1,client:l}),watch:{},created(){this.fullScreen=l.fullScreen},methods:{waiting(){this.$message({message:"此功能尚未开放",type:"warning"})}}},[["render",function(e,t,s,a,o,i){return u(),m("div",oe,t[0]||(t[0]=[g("div",{class:"upside-bar"},[g("div",{class:"options"})],-1)]))}],["__scopeId","data-v-29ea73df"]]),ne=Object.freeze(Object.defineProperty({__proto__:null,default:ie},Symbol.toStringTag,{value:"Module"})),le={key:0,id:"main"},re={key:1,id:"main-mobile"},ce={key:2,id:"main-mobile",class:"mobile-chat"};const de=e({components:{friendlist:r,blankView:ie},data(){return{onPhone:window.innerWidth<600,pagePath:this.$route.path,loaded:!1}},watch:{$route:function(e){this.pagePath=e.path}},mounted(){l.inited?this.loaded=!0:l.on("loaded",(()=>{this.loaded=!0}),!1)}},[["render",function(e,t,s,a,o,i){const n=p("friendlist"),l=p("router-view"),r=p("blankView");return o.onPhone?"/"===o.pagePath?(u(),m("div",re,[o.loaded?(u(),x(n,{key:0})):(u(),x(r,{key:1}))])):(u(),m("div",ce,[o.loaded?(u(),x(l,{key:0})):(u(),x(r,{key:1}))])):(u(),m("div",le,[f(n),o.loaded?(u(),x(l,{key:0})):(u(),x(r,{key:1}))]))}]]),he=Object.freeze(Object.defineProperty({__proto__:null,default:de},Symbol.toStringTag,{value:"Module"})),pe={class:"profile-body"},ue={id:"profile"},me={class:"profile-container"},ge={class:"base-info"},ve={class:"base-info-avatar"},ye={class:"base-info-content"},we={class:"name"},Ce={class:"id"},fe={class:"status"},_e={class:"info-blocks"},be={key:0,class:"openai-settings"},ke={class:"block-content"},Se={class:"item-title"},xe={class:"item-content"},Te={class:"block-content"},Me={class:"block-content-item"},Ie={class:"item-content"},Le={class:"block-content"},Oe={class:"block-content-item"},Ve={class:"item-content"},Re={id:"tools-list"},De=["title"],Pe={class:"item-title"},$e={class:"item-content"},Ee={class:"action-bar"},Be={class:"dialog-footer"};const Ue=e({components:{PresetsList:c},data(){const e=parseInt(this.$route.params.id),t=l.getContactor(e);return{activeContactor:t,openaiSettings:this.getShownOpenAISettings(t.options),currentDelay:0,centerDialogVisible:!1,sliderTypeARange:[0,2,.1],sliderTypeBRange:[0,1,.1],sliderTypeCRange:[-2,2,.1],showPresetsDetail:!1,showToolsDetail:!1,presetHistory:t.options.history,openaiTools:d.openaiTools,toolsList:[]}},computed:{getDelayStatus(){return this.currentDelay>1e3?"high":this.currentDelay>500?"mid":this.currentDelay>100?"low":"ultra"}},watch:{"$route.params.id"(e){this.activeContactor=l.getContactor(e),this.initContactor()}},mounted(){this.initContactor(),setInterval((()=>{this.currentDelay=l.socket.delay}),3e3)},methods:{handleToolConfig(){this.activeContactor.options.tools=this.toolsList.filter((e=>e.enabled)).map((e=>e.name)),l.setLocalStorage()},initContactor(){"openai"==this.activeContactor.platform&&(this.openaiSettings=this.getShownOpenAISettings(this.activeContactor.options),this.presetHistory=this.activeContactor.options.history,this.loadToolsList())},loadToolsList(){const e=this.activeContactor.options.tools;this.toolsList=this.openaiTools.map((t=>({name:t.name,description:t.description,enabled:e.includes(t.name)})))},async updateOpenaiPresets(e){this.activeContactor.options.history=e,await l.setLocalStorage(),this.$message({message:"预设历史记录已更新",type:"success"})},updateOpenaiOptions(){this.activeContactor.options={...this.activeContactor.options,...this.openaiSettings},l.setLocalStorage()},getShownOpenAISettings(e){const t={};return["model","max_messages_num","stream","enable_tool_call","temperature","top_p","frequency_penalty","presence_penalty"].map((s=>{t[s]=e[s]})),t},getShownKey:e=>({enable_tool_call:"工具调用",model:"模型",max_messages_num:"最大历史消息数",stream:"流式响应",temperature:"温度",top_p:"核采样",frequency_penalty:"重复惩罚度",presence_penalty:"话题新鲜度"}[e]),async delContactor(){this.centerDialogVisible=!1,await l.rmContactor(this.activeContactor.id),this.$router.push("/")}}},[["render",function(e,t,s,a,o,i){const n=p("el-image"),l=p("el-input"),r=p("el-switch"),c=p("el-slider"),d=p("PresetsList"),h=p("el-button"),w=p("el-dialog");return u(),m("div",pe,[g("div",ue,[g("div",me,[g("div",ge,[g("div",ve,[f(n,{src:o.activeContactor.avatar,"preview-src-list":[o.activeContactor.avatar]},null,8,["src","preview-src-list"])]),g("div",ye,[g("div",we,v(o.activeContactor.name),1),g("div",Ce,"ID "+v(o.activeContactor.id),1),g("div",fe,[g("span",{class:y("delay-status "+i.getDelayStatus)},null,2),t[6]||(t[6]=L(" 在线 "))])])]),g("div",_e,["openai"==o.activeContactor.platform?(u(),m("div",be,[t[11]||(t[11]=g("div",{class:"block-title"},"OpenAI 基本配置",-1)),g("div",ke,[(u(!0),m(b,null,k(o.openaiSettings,((e,t)=>(u(),m("div",{key:t,class:"block-content-item"},[g("div",Se,v(i.getShownKey(t)),1),g("div",xe,[["model","max_messages_num"].includes(t)?(u(),x(l,{key:0,modelValue:o.openaiSettings[t],"onUpdate:modelValue":e=>o.openaiSettings[t]=e,onChange:i.updateOpenaiOptions},null,8,["modelValue","onUpdate:modelValue","onChange"])):["stream","enable_tool_call"].includes(t)?(u(),x(r,{key:1,modelValue:o.openaiSettings[t],"onUpdate:modelValue":e=>o.openaiSettings[t]=e,onChange:i.updateOpenaiOptions},null,8,["modelValue","onUpdate:modelValue","onChange"])):["temperature"].includes(t)?(u(),x(c,{key:2,modelValue:o.openaiSettings[t],"onUpdate:modelValue":e=>o.openaiSettings[t]=e,step:o.sliderTypeARange[2],min:o.sliderTypeARange[0],max:o.sliderTypeARange[1],onChange:i.updateOpenaiOptions},null,8,["modelValue","onUpdate:modelValue","step","min","max","onChange"])):["top_p"].includes(t)?(u(),x(c,{key:3,modelValue:o.openaiSettings[t],"onUpdate:modelValue":e=>o.openaiSettings[t]=e,step:o.sliderTypeBRange[2],min:o.sliderTypeBRange[0],max:o.sliderTypeBRange[1],onChange:i.updateOpenaiOptions},null,8,["modelValue","onUpdate:modelValue","step","min","max","onChange"])):["frequency_penalty","presence_penalty"].includes(t)?(u(),x(c,{key:4,modelValue:o.openaiSettings[t],"onUpdate:modelValue":e=>o.openaiSettings[t]=e,step:o.sliderTypeCRange[2],min:o.sliderTypeCRange[0],max:o.sliderTypeCRange[1],onChange:i.updateOpenaiOptions},null,8,["modelValue","onUpdate:modelValue","step","min","max","onChange"])):S("",!0)])])))),128))]),t[12]||(t[12]=g("div",{class:"block-title"},"OpenAI 预设配置",-1)),g("div",Te,[g("div",Me,[t[8]||(t[8]=g("div",{class:"item-title"},"预设历史记录",-1)),g("div",Ie,[g("button",{class:y({active:o.showPresetsDetail,"extra-info-button":!0}),onClick:t[0]||(t[0]=e=>o.showPresetsDetail=!o.showPresetsDetail)},t[7]||(t[7]=[g("svg",{t:"1731677922196",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5948",width:"16",height:"16"},[g("path",{d:"M778.965749 128.759549l-383.064442 383.063419 388.097062 388.096039-0.070608 0.033769c12.709463 13.137205 20.529569 31.024597 20.529569 50.731428 0 40.376593-32.736589 73.112158-73.115228 73.112158-19.705807 0-37.591153-7.819083-50.730405-20.528546l-0.034792 0.035816L241.890654 564.622498l0.035816-0.035816c-13.779841-13.281491-22.3838-31.915897-22.3838-52.585659 0-0.071631 0-0.106424 0-0.178055 0-0.072655 0-0.10847 0-0.144286 0-20.669762 8.603959-39.341007 22.3838-52.622498l-0.035816-0.034792L680.573835 20.337187l0.180102 0.179079c13.139252-12.5662 30.950919-20.313651 50.587142-20.313651 40.378639 0 73.115228 32.736589 73.115228 73.114205C804.455283 95.485725 794.567076 115.334795 778.965749 128.759549z","p-id":"5949"})],-1)]),2)])]),g("div",{class:y({hidden:!o.showPresetsDetail,"block-content-item":!0})},[f(d,{"presets-history":o.presetHistory,onUpdatePresets:i.updateOpenaiPresets},null,8,["presets-history","onUpdatePresets"])],2)]),t[13]||(t[13]=g("div",{class:"block-title"},"OpenAI 工具配置",-1)),g("div",Le,[g("div",Oe,[t[10]||(t[10]=g("div",{class:"item-title"},"工具函数列表",-1)),g("div",Ve,[g("button",{class:y({active:o.showToolsDetail,"extra-info-button":!0}),onClick:t[1]||(t[1]=e=>o.showToolsDetail=!o.showToolsDetail)},t[9]||(t[9]=[g("svg",{t:"1731677922196",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5948",width:"16",height:"16"},[g("path",{d:"M778.965749 128.759549l-383.064442 383.063419 388.097062 388.096039-0.070608 0.033769c12.709463 13.137205 20.529569 31.024597 20.529569 50.731428 0 40.376593-32.736589 73.112158-73.115228 73.112158-19.705807 0-37.591153-7.819083-50.730405-20.528546l-0.034792 0.035816L241.890654 564.622498l0.035816-0.035816c-13.779841-13.281491-22.3838-31.915897-22.3838-52.585659 0-0.071631 0-0.106424 0-0.178055 0-0.072655 0-0.10847 0-0.144286 0-20.669762 8.603959-39.341007 22.3838-52.622498l-0.035816-0.034792L680.573835 20.337187l0.180102 0.179079c13.139252-12.5662 30.950919-20.313651 50.587142-20.313651 40.378639 0 73.115228 32.736589 73.115228 73.114205C804.455283 95.485725 794.567076 115.334795 778.965749 128.759549z","p-id":"5949"})],-1)]),2)])]),g("div",{class:y({hidden:!o.showToolsDetail,"block-content-item":!0})},[g("ul",Re,[(u(!0),m(b,null,k(o.toolsList,((e,t)=>(u(),m("li",{key:t,class:"block-content-item",title:e.description},[g("div",Pe,v(e.name),1),g("div",$e,[f(r,{modelValue:e.enabled,"onUpdate:modelValue":t=>e.enabled=t,onChange:i.handleToolConfig},null,8,["modelValue","onUpdate:modelValue","onChange"])])],8,De)))),128))])],2)])])):S("",!0)]),t[14]||(t[14]=g("div",{class:"extra-info"},null,-1))])]),g("div",Ee,[f(h,{plain:"",onClick:t[2]||(t[2]=t=>e.$router.push(`/chat/${o.activeContactor.id}`))},{default:O((()=>t[15]||(t[15]=[L("发送消息")]))),_:1}),f(h,{type:"danger",plain:"",onClick:t[3]||(t[3]=e=>o.centerDialogVisible=!0)},{default:O((()=>t[16]||(t[16]=[L("删除好友")]))),_:1}),f(w,{modelValue:o.centerDialogVisible,"onUpdate:modelValue":t[5]||(t[5]=e=>o.centerDialogVisible=e),title:"警告",width:"300",center:""},{footer:O((()=>[g("div",Be,[f(h,{onClick:t[4]||(t[4]=e=>o.centerDialogVisible=!1)},{default:O((()=>t[17]||(t[17]=[L("取消")]))),_:1}),f(h,{type:"primary",onClick:i.delContactor},{default:O((()=>t[18]||(t[18]=[L(" 确认 ")]))),_:1},8,["onClick"])])])),default:O((()=>[t[19]||(t[19]=g("span",null," 确认要删除此好友吗？该操作不可逆。 ",-1))])),_:1},8,["modelValue"])])])}],["__scopeId","data-v-603f8e40"]]),Ae=Object.freeze(Object.defineProperty({__proto__:null,default:Ue},Symbol.toStringTag,{value:"Module"})),je={class:"auth-view"},We={class:"container"},He={class:"controls"},qe=e({__name:"AuthView",setup(e){const t=V(),s=V(!1),a=V(),o=async e=>{if(await $((()=>a.value.classList.add("active"))),!s.value){s.value=!0;try{const t=await l.login(e);t&&(I.success(`成功以${t.is_admin?"管理员身份":"游客身份"}登录，欢迎使用!`),ae.currentRoute.value.query.redirect?ae.push(ae.currentRoute.value.query.redirect):ae.push("/"))}catch(t){I.error(t)}finally{await $((()=>a.value.classList.remove("active"))),s.value=!1}}};function i(e){"Enter"===e.key&&o(t.value)}return R((()=>{removeEventListener("keydown",i)})),D((()=>{addEventListener("keydown",i),ae.currentRoute.value.query.key&&o(ae.currentRoute.value.query.key)})),(e,s)=>(u(),m("div",je,[g("div",We,[g("div",{ref_key:"iconContainer",ref:a,class:"icon-container"},s[3]||(s[3]=[g("i",{class:"iconfont ChatGPT"},null,-1)]),512),s[4]||(s[4]=g("h1",{class:"title"},"登录验证",-1)),s[5]||(s[5]=g("p",{class:"hint"},"管理员开启了密码验证，请在下方填入访问码",-1)),w(g("input",{"onUpdate:modelValue":s[0]||(s[0]=e=>t.value=e),type:"password",placeholder:"在此处填写访问码"},null,512),[[P,t.value]]),g("div",He,[g("button",{class:"later",onClick:s[1]||(s[1]=e=>o())},"游客登录"),g("button",{class:"login",onClick:s[2]||(s[2]=e=>o(t.value))},"登录")])])]))}},[["__scopeId","data-v-02fd5e8c"]]),ze=Object.freeze(Object.defineProperty({__proto__:null,default:qe},Symbol.toStringTag,{value:"Module"})),Fe={id:"settings-view"};const Ne=e({name:"SettingsView",data:()=>({}),methods:{reset(){l.reset()}}},[["render",function(e,t,s,a,o,i){const n=p("el-button");return u(),m("div",Fe,[f(n,{type:"info",plain:"",onClick:t[0]||(t[0]=e=>i.reset())},{default:O((()=>t[1]||(t[1]=[L("点我重置")]))),_:1})])}],["__scopeId","data-v-9b0f0942"]]),Ke=Object.freeze(Object.defineProperty({__proto__:null,default:Ne},Symbol.toStringTag,{value:"Module"}));export{ae as r};
//# sourceMappingURL=views-C5p3YvjG.js.map
