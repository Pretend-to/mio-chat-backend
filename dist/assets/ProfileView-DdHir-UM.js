import{_ as I,o as a,c as p,F as D,b as k,a as t,t as C,e as l,f as c,g as d,r as _,j as v,n as S,m as P,l as M,p as x,i as H}from"./index-BzWJa8UJ.js";const U={data(){return{presetMessages:[...this.presetsHistory],hoveredIndex:void 0}},methods:{delPresetMessage(){this.presetMessages.splice(this.hoveredIndex,1),this.$emit("updatePresetsHistory",this.presetMessages)},addPresetMessage(s){if(s=="system"&&this.presetMessages.length>0){this.$message.warning("系统消息必须是第一条消息");return}this.presetMessages.push({role:s,content:""}),this.$emit("updatePresetsHistory",this.presetMessages)},getMessageAvatar(s){return s=="assistant"?"🤖":s=="system"?"⚙️":"👤"},handleMessageUpdate(s){this.presetMessages[s].content=this.$refs[`message-${s}`][0].innerText,this.$emit("updatePresetsHistory",this.presetMessages)}},props:{presetsHistory:{type:Array,default:()=>[]}},watch:{presetsHistory(s){this.presetMessages=[...s]}}},A={class:"presets-list"},T={class:"preset-message-block"},B=["onMouseover"],L={key:0,class:"avatar-emoji"},R=["onInput"],N={class:"messages-buttons"};function q(s,n,b,w,e,o){const f=_("el-button");return a(),p("div",A,[(a(!0),p(D,null,k(e.presetMessages,(m,r)=>(a(),p("div",{key:r,class:"preset-message"},[t("div",T,[t("div",{class:"message-avatar",onMouseover:h=>e.hoveredIndex=r,onMouseleave:n[1]||(n[1]=h=>e.hoveredIndex=null)},[e.hoveredIndex!=r?(a(),p("div",L,C(o.getMessageAvatar(m.role)),1)):(a(),p("div",{key:1,onClick:n[0]||(n[0]=(...h)=>o.delPresetMessage&&o.delPresetMessage(...h)),title:"删除消息",class:"avatar-emoji hovered"},"🗑️"))],40,B),t("div",{class:"message-content",ref_for:!0,ref:`message-${r}`,onInput:h=>o.handleMessageUpdate(r),contenteditable:"true"},C(e.presetMessages[r].content),41,R)])]))),128)),t("div",N,[l(f,{onClick:n[2]||(n[2]=m=>o.addPresetMessage("system")),title:"添加系统消息",plain:""},{default:c(()=>[d("➕ ⚙️")]),_:1}),l(f,{onClick:n[3]||(n[3]=m=>o.addPresetMessage("assistant")),title:"添加助手消息",plain:""},{default:c(()=>[d("➕ 🤖")]),_:1}),l(f,{onClick:n[4]||(n[4]=m=>o.addPresetMessage("user")),title:"添加用户消息",plain:""},{default:c(()=>[d("➕ 👤")]),_:1})])])}const j=I(U,[["render",q],["__scopeId","data-v-ea322baa"]]),K={data(){const s=parseInt(this.$route.params.id),n=v.getContactor(s);return{activeContactor:n,openaiSettings:this.getShownOpenAISettings(n.options),currentDelay:0,centerDialogVisible:!1,sliderTypeARange:[0,1,.1],sliderTypeBRange:[-2,2,.2],showPresetsDetail:!1,presetHistory:n.options.history}},components:{PresetsList:j},mounted(){setInterval(()=>{this.currentDelay=v.socket.delay},3e3)},computed:{getDelayStatus(){return this.currentDelay>1e3?"high":this.currentDelay>500?"mid":this.currentDelay>100?"low":"ultra"}},watch:{"$route.params.id"(s){this.activeContactor=v.getContactor(s),this.activeContactor.platform=="openai"&&(this.openaiSettings=this.getShownOpenAISettings(this.activeContactor.options),this.presetHistory=[...this.activeContactor.options.history])}},methods:{updateOpenaiPresets(s){this.activeContactor.setOpenaiPresets(s),v.setLocalStorage()},updateOpenaiOptions(){this.activeContactor.options={...this.activeContactor.options,...this.openaiSettings},v.setLocalStorage()},getShownOpenAISettings(s){const n=["model","max_messages_num","stream","temperature","top_p","frequency_penalty","presence_penalty"],b={};return n.map(w=>{b[w]=s[w]}),b},getShownKey(s){return{model:"模型",max_messages_num:"最大历史消息数",stream:"流式响应",temperature:"温度 (temperature)",top_p:"核采样 (top_p)",frequency_penalty:"频率惩罚度 (frequency_penalty)",presence_penalty:"话题新鲜度 (presence_penalty)"}[s]},delContactor(){this.centerDialogVisible=!1,v.rmContactor(this.activeContactor.id),this.$router.push("/contactors")}}},y=s=>(x("data-v-2e2b0c9b"),s=s(),H(),s),z={id:"profile"},F={class:"profile-container"},E={class:"base-info"},G={class:"base-info-avatar"},J=["src"],Q={class:"base-info-content"},W={class:"name"},X={class:"id"},Y={class:"status"},Z={class:"info-blocks"},$={key:0,class:"openai-settings"},ee=y(()=>t("div",{class:"block-title"},"OpenAI 协议配置",-1)),te={class:"block-content"},se={class:"item-title"},ne={class:"item-content"},oe=y(()=>t("div",{class:"block-title"},"OpenAI 预设配置",-1)),ie={class:"block-content"},ae={class:"block-content-item"},re=y(()=>t("div",{class:"item-title"},"预设历史记录",-1)),le={class:"item-content"},ce=y(()=>t("svg",{t:"1731677922196",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5948",width:"16",height:"16"},[t("path",{d:"M778.965749 128.759549l-383.064442 383.063419 388.097062 388.096039-0.070608 0.033769c12.709463 13.137205 20.529569 31.024597 20.529569 50.731428 0 40.376593-32.736589 73.112158-73.115228 73.112158-19.705807 0-37.591153-7.819083-50.730405-20.528546l-0.034792 0.035816L241.890654 564.622498l0.035816-0.035816c-13.779841-13.281491-22.3838-31.915897-22.3838-52.585659 0-0.071631 0-0.106424 0-0.178055 0-0.072655 0-0.10847 0-0.144286 0-20.669762 8.603959-39.341007 22.3838-52.622498l-0.035816-0.034792L680.573835 20.337187l0.180102 0.179079c13.139252-12.5662 30.950919-20.313651 50.587142-20.313651 40.378639 0 73.115228 32.736589 73.115228 73.114205C804.455283 95.485725 794.567076 115.334795 778.965749 128.759549z","p-id":"5949"})],-1)),pe=[ce],de=y(()=>t("div",{class:"extra-info"},null,-1)),ue={class:"action-bar"},_e=y(()=>t("span",null," 确认要删除此好友吗？该操作不可逆。 ",-1)),me={class:"dialog-footer"};function he(s,n,b,w,e,o){const f=_("el-input"),m=_("el-switch"),r=_("el-slider"),h=_("PresetsList"),V=_("el-button"),O=_("el-dialog");return a(),p("div",z,[t("div",F,[t("div",E,[t("div",G,[t("img",{src:e.activeContactor.avatar},null,8,J)]),t("div",Q,[t("div",W,C(e.activeContactor.name),1),t("div",X,"ID "+C(e.activeContactor.id),1),t("div",Y,[t("span",{class:S("delay-status "+o.getDelayStatus)},null,2),d(" 在线 ")])])]),t("div",Z,[e.activeContactor.platform=="openai"?(a(),p("div",$,[ee,t("div",te,[(a(!0),p(D,null,k(e.openaiSettings,(g,i)=>(a(),p("div",{key:i,class:"block-content-item"},[t("div",se,C(o.getShownKey(i)),1),t("div",ne,[["model","max_messages_num"].includes(i)?(a(),M(f,{key:0,onChange:o.updateOpenaiOptions,modelValue:e.openaiSettings[i],"onUpdate:modelValue":u=>e.openaiSettings[i]=u},null,8,["onChange","modelValue","onUpdate:modelValue"])):i=="stream"?(a(),M(m,{key:1,onChange:o.updateOpenaiOptions,modelValue:e.openaiSettings[i],"onUpdate:modelValue":u=>e.openaiSettings[i]=u},null,8,["onChange","modelValue","onUpdate:modelValue"])):["top_p","temperature"].includes(i)?(a(),M(r,{key:2,onChange:o.updateOpenaiOptions,modelValue:e.openaiSettings[i],"onUpdate:modelValue":u=>e.openaiSettings[i]=u,step:e.sliderTypeARange[2],min:e.sliderTypeARange[0],max:e.sliderTypeARange[1]},null,8,["onChange","modelValue","onUpdate:modelValue","step","min","max"])):["frequency_penalty","presence_penalty"].includes(i)?(a(),M(r,{key:3,onChange:o.updateOpenaiOptions,modelValue:e.openaiSettings[i],"onUpdate:modelValue":u=>e.openaiSettings[i]=u,step:e.sliderTypeBRange[2],min:e.sliderTypeBRange[0],max:e.sliderTypeBRange[1]},null,8,["onChange","modelValue","onUpdate:modelValue","step","min","max"])):P("",!0)])]))),128))]),oe,t("div",ie,[t("div",ae,[re,t("div",le,[t("button",{class:S({active:e.showPresetsDetail,"extra-info-button":!0}),onClick:n[0]||(n[0]=g=>e.showPresetsDetail=!e.showPresetsDetail)},pe,2)])]),t("div",{class:S({hidden:!e.showPresetsDetail,"block-content-item":!0})},[l(h,{onUpdatePresetsHistory:o.updateOpenaiPresets,presetsHistory:e.presetHistory},null,8,["onUpdatePresetsHistory","presetsHistory"])],2)])])):P("",!0)]),de,t("div",ue,[l(V,{onClick:n[1]||(n[1]=g=>s.$router.push(`/chat/${e.activeContactor.id}`)),type:"primary"},{default:c(()=>[d("发送消息")]),_:1}),l(V,{onClick:n[2]||(n[2]=g=>e.centerDialogVisible=!0),type:"danger"},{default:c(()=>[d("删除好友")]),_:1}),l(O,{modelValue:e.centerDialogVisible,"onUpdate:modelValue":n[4]||(n[4]=g=>e.centerDialogVisible=g),title:"警告",width:"300",center:""},{footer:c(()=>[t("div",me,[l(V,{onClick:n[3]||(n[3]=g=>e.centerDialogVisible=!1)},{default:c(()=>[d("取消")]),_:1}),l(V,{type:"primary",onClick:o.delContactor},{default:c(()=>[d(" 确认 ")]),_:1},8,["onClick"])])]),default:c(()=>[_e]),_:1},8,["modelValue"])])])])}const ve=I(K,[["render",he],["__scopeId","data-v-2e2b0c9b"]]);export{ve as default};
