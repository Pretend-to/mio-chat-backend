import{_,c as a,C as f,o as d,a as c,b as o,F as v,r as g,n as $,t as p,p as w,d as C,e as m,f as u}from"./index-CQdbpc29.js";const L={data(){const t=a.contactList;return{onPhone:a.onPhone,contactorList:t}},methods:{showChat(t){this.$route.name=="blank"||this.$route.name=="chat_view"?this.$router.push({name:"chat_view",params:{id:t}}):this.$route.name=="contactors"||this.$route.name=="profile_view"?this.$router.push({name:"profile_view",params:{id:t}}):this.$router.replace({name:"chat_view",params:{id:t}})},getId(t){let e=this.$route.params.id,i=t.id;return e==i?"active":t.priority==0?"important":""},genOpenaiContactor(){const t={id:this.genFakeId(),name:a.default_model,activeModel:a.default_model,avatar:"/api/avatar/openai.png",title:"gpt",priority:1,options:{}};this.addConcator("openai",t)},async addConcator(t,e){const i=new f(t,e);i.avatar=i.getAvatar(i.activeModel),this.contactorList.push(i),await a.setLocalStorage()},startResize(t){this.isResizing=!0,this.startX=t.clientX,this.startWidth=this.$refs.friendlists.offsetWidth,document.addEventListener("mousemove",this.resize),document.addEventListener("mouseup",this.stopResize)},resize(t){if(this.isResizing){let e=this.startWidth+(t.clientX-this.startX);const i=500,r=176;e=e>i?i:e<r?r:e,this.$refs.friendlists.style.flexBasis=e+"px"}},stopResize(){this.isResizing=!1,document.removeEventListener("mousemove",this.resize),document.removeEventListener("mouseup",this.stopResize)},genFakeId(){const e=`1${Math.floor(1e3+Math.random()*9e3)}`;if(this.id){const i=Math.floor(1e3+Math.random()*9e3),r=`${this.id}${i}`;return parseInt(r)}else return parseInt(e)}},components:{},computed:{sortedList(){return[...this.contactorList].sort((t,e)=>e.priority-t.priority==-1?1:e.lastUpdate-t.lastUpdate)}},mounted(){this.contactorList.map(t=>{t.on("updateMessage",()=>{this.$forceUpdate()})})}},b=t=>(w("data-v-db3268b3"),t=t(),C(),t),z={class:"upsidebar",id:"friends"},y=b(()=>o("div",{class:"search"},[o("i",{class:"iconfont sousuo listicon"}),o("input",{type:"text",id:"tosearch",placeholder:"搜索"})],-1)),k={class:"bu-add"},I={class:"people"},P=["onClick","id"],R={class:"avatar"},M=["src","alt"],x={class:"info"},S={class:"name"},N={class:"msginfo",id:"time"},W={class:"msginfo",id:"msgctt"};function E(t,e,i,r,h,n){return d(),c("div",{id:"friendlists",ref:"friendlists",class:$(h.onPhone?"mobile":"")},[o("div",z,[y,o("div",k,[o("button",{id:"addcont",onClick:e[0]||(e[0]=(...s)=>n.genOpenaiContactor&&n.genOpenaiContactor(...s))},"+")])]),o("div",I,[(d(!0),c(v,null,g(n.sortedList,(s,l)=>(d(),c("div",{onClick:D=>n.showChat(s.id),key:l,class:"lists",id:n.getId(s)},[o("div",R,[o("img",{src:s.avatar,alt:s.name},null,8,M)]),o("div",x,[o("div",S,p(s.name),1),o("div",N,p(s.getLastTime()),1),o("div",W,p(s.getMessageSummary()),1)])],8,P))),128))]),o("div",{class:"resizer",onMousedown:e[1]||(e[1]=(...s)=>n.startResize&&n.startResize(...s))},null,32)],2)}const B=_(L,[["render",E],["__scopeId","data-v-db3268b3"]]),F={data(){return console.log(a.onPhone),{onPhone:a.onPhone,client:a,pagePath:this.$route.path}},components:{friendlist:B},methods:{},mounted(){},computed:{},watch:{$route:function(t){this.pagePath=t.path}}},X={key:0,id:"main"},O={key:1,id:"main-mobile"},U={key:2,id:"main-mobile",class:"mobile-chat"};function V(t,e,i,r,h,n){const s=u("friendlist"),l=u("router-view");return h.onPhone?h.pagePath==="/"?(d(),c("div",O,[m(s)])):(d(),c("div",U,[m(l)])):(d(),c("div",X,[m(s),m(l)]))}const H=_(F,[["render",V]]);export{H as default};
