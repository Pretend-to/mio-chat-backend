import{_ as f,c as r,C as _,o as c,a as l,b as i,F as v,r as g,n as L,t as u,p as C,d as $,e as m,f as p}from"./index-BwvKFpX_.js";const z={data(){const t=r.contactList;return{onPhone:r.onPhone,contactorList:t}},methods:{showChat(t){this.$router.push({path:"/home/chat/"+t})},getId(t){let e=this.$route.params.id,s=t.id;return e==s?"active":t.priority==0?"important":""},genOpenaiContactor(){const e=r.models.map(n=>({value:n.owner,label:n.owner,children:n.models.map(d=>({value:d,label:d}))})),s={id:this.genFakeId(),name:r.default_model,activeModel:r.default_model,avatar:"/api/avatar/openai.png",title:"gpt",priority:1,options:{models:r.models,modelsOptions:e,textWraper:{options:e,presets:{default:""}}}};this.addConcator("openai",s)},async addConcator(t,e){const s=new _(t,e);s.avatar=s.getAvatar(s.activeModel),this.contactorList.push(s),await r.setLocalStorage()},startResize(t){this.isResizing=!0,this.startX=t.clientX,this.startWidth=this.$refs.friendlists.offsetWidth,document.addEventListener("mousemove",this.resize),document.addEventListener("mouseup",this.stopResize)},resize(t){if(this.isResizing){let e=this.startWidth+(t.clientX-this.startX);const s=500,n=176;e=e>s?s:e<n?n:e,this.$refs.friendlists.style.flexBasis=e+"px"}},stopResize(){this.isResizing=!1,document.removeEventListener("mousemove",this.resize),document.removeEventListener("mouseup",this.stopResize)},genFakeId(){const e=`1${Math.floor(1e3+Math.random()*9e3)}`;if(this.id){const s=Math.floor(1e3+Math.random()*9e3),n=`${this.id}${s}`;return parseInt(n)}else return parseInt(e)}},components:{},computed:{sortedList(){return[...this.contactorList].sort((t,e)=>e.priority-t.priority==-1?1:e.lastUpdate-t.lastUpdate)}},mounted(){this.contactorList.map(t=>{t.on("updateMessage",()=>{this.$forceUpdate()})})}},y=t=>(C("data-v-76089549"),t=t(),$(),t),I={class:"upsidebar",id:"friends"},b=y(()=>i("div",{class:"search"},[i("i",{class:"iconfont sousuo listicon"}),i("input",{type:"text",id:"tosearch",placeholder:"搜索"})],-1)),k={class:"bu-add"},w={class:"people"},R=["onClick","id"],x={class:"avatar"},M=["src","alt"],P={class:"info"},S={class:"name"},N={class:"msginfo",id:"time"},W={class:"msginfo",id:"msgctt"};function E(t,e,s,n,d,a){return c(),l("div",{id:"friendlists",ref:"friendlists",class:L(d.onPhone?"mobile":"")},[i("div",I,[b,i("div",k,[i("button",{id:"addcont",onClick:e[0]||(e[0]=(...o)=>a.genOpenaiContactor&&a.genOpenaiContactor(...o))},"+")])]),i("div",w,[(c(!0),l(v,null,g(a.sortedList,(o,h)=>(c(),l("div",{onClick:A=>a.showChat(o.id),key:h,class:"lists",id:a.getId(o)},[i("div",x,[i("img",{src:o.avatar,alt:o.name},null,8,M)]),i("div",P,[i("div",S,u(o.name),1),i("div",N,u(o.getLastTime()),1),i("div",W,u(o.getMessageSummary()),1)])],8,R))),128))]),i("div",{class:"resizer",onMousedown:e[1]||(e[1]=(...o)=>a.startResize&&a.startResize(...o))},null,32)],2)}const B=f(z,[["render",E],["__scopeId","data-v-76089549"]]),F={data(){return{client:r,onList:null}},components:{friendlist:B},methods:{},mounted(){const t=this.$route;t.name==="toChat"||t.name==="toProfile"?this.onList=!0:t.name==="privateChat"&&(this.onList=!1)},computed:{},watch:{$route:function(t){t.name==="toChat"||t.name==="toProfile"?this.onList=!0:t.name==="privateChat"&&(this.onList=!1)}}},O={key:0,id:"main"},X={key:1,id:"main-mobile"},U={key:2,id:"main-mobile",class:"mobile-chat"};function D(t,e,s,n,d,a){const o=p("friendlist"),h=p("router-view");return d.client.onPhone?d.onList||this.$route.name==="home"?(c(),l("div",X,[m(o)])):(c(),l("div",U,[m(h)])):(c(),l("div",O,[m(o),m(h)]))}const T=f(F,[["render",D]]);export{T as default};
