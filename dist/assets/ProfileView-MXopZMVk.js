import{_ as T,o as a,c as r,F as k,b as D,a as e,t as f,e as c,f as u,g as h,r as v,j as g,k as x,n as b,m as P,l as S,p as O,i as L}from"./index-BmylxrHC.js";const U={data(){return{presetMessages:[...this.presetsHistory],hoveredIndex:void 0}},methods:{delPresetMessage(){this.presetMessages.splice(this.hoveredIndex,1),this.$emit("updatePresetsHistory",this.presetMessages)},addPresetMessage(o){if(o=="system"&&this.presetMessages.length>0){this.$message.warning("系统消息必须是第一条消息");return}this.presetMessages.push({role:o,content:""}),this.$emit("updatePresetsHistory",this.presetMessages)},getMessageAvatar(o){return o=="assistant"?"🤖":o=="system"?"⚙️":"👤"},handleMessageUpdate(o){this.presetMessages[o].content=this.$refs[`message-${o}`][0].innerText,this.$emit("updatePresetsHistory",this.presetMessages)}},props:{presetsHistory:{type:Array,default:()=>[]}},watch:{presetsHistory(o){this.presetMessages=[...o]}}},A={class:"presets-list"},H={class:"preset-message-block"},B=["onMouseover"],R={key:0,class:"avatar-emoji"},N=["onInput"],q={class:"messages-buttons"};function j(o,s,w,V,t,n){const C=v("el-button");return a(),r("div",A,[(a(!0),r(k,null,D(t.presetMessages,(m,d)=>(a(),r("div",{key:d,class:"preset-message"},[e("div",H,[e("div",{class:"message-avatar",onMouseover:y=>t.hoveredIndex=d,onMouseleave:s[1]||(s[1]=y=>t.hoveredIndex=null)},[t.hoveredIndex!=d?(a(),r("div",R,f(n.getMessageAvatar(m.role)),1)):(a(),r("div",{key:1,onClick:s[0]||(s[0]=(...y)=>n.delPresetMessage&&n.delPresetMessage(...y)),title:"删除消息",class:"avatar-emoji hovered"},"🗑️"))],40,B),e("div",{class:"message-content",ref_for:!0,ref:`message-${d}`,onInput:y=>n.handleMessageUpdate(d),contenteditable:"true"},f(t.presetMessages[d].content),41,N)])]))),128)),e("div",q,[c(C,{onClick:s[2]||(s[2]=m=>n.addPresetMessage("system")),title:"添加系统消息",plain:""},{default:u(()=>[h("➕ ⚙️")]),_:1}),c(C,{onClick:s[3]||(s[3]=m=>n.addPresetMessage("assistant")),title:"添加助手消息",plain:""},{default:u(()=>[h("➕ 🤖")]),_:1}),c(C,{onClick:s[4]||(s[4]=m=>n.addPresetMessage("user")),title:"添加用户消息",plain:""},{default:u(()=>[h("➕ 👤")]),_:1})])])}const z=T(U,[["render",j],["__scopeId","data-v-ea322baa"]]),K={data(){const o=parseInt(this.$route.params.id),s=g.getContactor(o);return{activeContactor:s,openaiSettings:this.getShownOpenAISettings(s.options),currentDelay:0,centerDialogVisible:!1,sliderTypeARange:[0,1,.1],sliderTypeBRange:[-2,2,.2],showPresetsDetail:!1,showToolsDetail:!1,presetHistory:s.options.history,openaiTools:x.openaiTools,toolsList:[]}},components:{PresetsList:z},mounted(){this.initContactor(),setInterval(()=>{this.currentDelay=g.socket.delay},3e3)},computed:{getDelayStatus(){return this.currentDelay>1e3?"high":this.currentDelay>500?"mid":this.currentDelay>100?"low":"ultra"}},watch:{"$route.params.id"(o){this.activeContactor=g.getContactor(o),this.initContactor()}},methods:{handleToolConfig(){this.activeContactor.options.tools=this.toolsList.map(o=>o.enabled?o.name:void 0),g.setLocalStorage()},initContactor(){this.activeContactor.platform=="openai"&&(this.openaiSettings=this.getShownOpenAISettings(this.activeContactor.options),this.presetHistory=[...this.activeContactor.options.history],this.loadToolsList())},loadToolsList(){const o=this.activeContactor.options.tools;this.toolsList=this.openaiTools.map(s=>({name:s.name,description:s.description,enabled:o.includes(s.name)}))},updateOpenaiPresets(o){this.activeContactor.setOpenaiPresets(o),g.setLocalStorage()},updateOpenaiOptions(){this.activeContactor.options={...this.activeContactor.options,...this.openaiSettings},g.setLocalStorage()},getShownOpenAISettings(o){const s=["model","max_messages_num","stream","enable_tool_call","temperature","top_p","frequency_penalty","presence_penalty"],w={};return s.map(V=>{w[V]=o[V]}),w},getShownKey(o){return{enable_tool_call:"工具调用",model:"模型",max_messages_num:"最大历史消息数",stream:"流式响应",temperature:"温度 (temperature)",top_p:"核采样 (top_p)",frequency_penalty:"频率惩罚度 (frequency_penalty)",presence_penalty:"话题新鲜度 (presence_penalty)"}[o]},delContactor(){this.centerDialogVisible=!1,g.rmContactor(this.activeContactor.id),this.$router.push("/contactors")}}},_=o=>(O("data-v-788042c3"),o=o(),L(),o),F={class:"profile-body"},E={id:"profile"},G={class:"profile-container"},J={class:"base-info"},Q={class:"base-info-avatar"},W=["src"],X={class:"base-info-content"},Y={class:"name"},Z={class:"id"},$={class:"status"},ee={class:"info-blocks"},te={key:0,class:"openai-settings"},se=_(()=>e("div",{class:"block-title"},"OpenAI 基本配置",-1)),oe={class:"block-content"},ne={class:"item-title"},ie={class:"item-content"},ae=_(()=>e("div",{class:"block-title"},"OpenAI 预设配置",-1)),le={class:"block-content"},re={class:"block-content-item"},ce=_(()=>e("div",{class:"item-title"},"预设历史记录",-1)),de={class:"item-content"},pe=_(()=>e("svg",{t:"1731677922196",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5948",width:"16",height:"16"},[e("path",{d:"M778.965749 128.759549l-383.064442 383.063419 388.097062 388.096039-0.070608 0.033769c12.709463 13.137205 20.529569 31.024597 20.529569 50.731428 0 40.376593-32.736589 73.112158-73.115228 73.112158-19.705807 0-37.591153-7.819083-50.730405-20.528546l-0.034792 0.035816L241.890654 564.622498l0.035816-0.035816c-13.779841-13.281491-22.3838-31.915897-22.3838-52.585659 0-0.071631 0-0.106424 0-0.178055 0-0.072655 0-0.10847 0-0.144286 0-20.669762 8.603959-39.341007 22.3838-52.622498l-0.035816-0.034792L680.573835 20.337187l0.180102 0.179079c13.139252-12.5662 30.950919-20.313651 50.587142-20.313651 40.378639 0 73.115228 32.736589 73.115228 73.114205C804.455283 95.485725 794.567076 115.334795 778.965749 128.759549z","p-id":"5949"})],-1)),ue=[pe],_e=_(()=>e("div",{class:"block-title"},"OpenAI 工具配置",-1)),he={class:"block-content"},me={class:"block-content-item"},ge=_(()=>e("div",{class:"item-title"},"工具函数列表",-1)),ve={class:"item-content"},ye=_(()=>e("svg",{t:"1731677922196",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5948",width:"16",height:"16"},[e("path",{d:"M778.965749 128.759549l-383.064442 383.063419 388.097062 388.096039-0.070608 0.033769c12.709463 13.137205 20.529569 31.024597 20.529569 50.731428 0 40.376593-32.736589 73.112158-73.115228 73.112158-19.705807 0-37.591153-7.819083-50.730405-20.528546l-0.034792 0.035816L241.890654 564.622498l0.035816-0.035816c-13.779841-13.281491-22.3838-31.915897-22.3838-52.585659 0-0.071631 0-0.106424 0-0.178055 0-0.072655 0-0.10847 0-0.144286 0-20.669762 8.603959-39.341007 22.3838-52.622498l-0.035816-0.034792L680.573835 20.337187l0.180102 0.179079c13.139252-12.5662 30.950919-20.313651 50.587142-20.313651 40.378639 0 73.115228 32.736589 73.115228 73.114205C804.455283 95.485725 794.567076 115.334795 778.965749 128.759549z","p-id":"5949"})],-1)),fe=[ye],Ce={id:"tools-list"},be=["title"],we={class:"item-title"},Ve={class:"item-content"},Me=_(()=>e("div",{class:"extra-info"},null,-1)),Se={class:"action-bar"},ke=_(()=>e("span",null," 确认要删除此好友吗？该操作不可逆。 ",-1)),De={class:"dialog-footer"};function Pe(o,s,w,V,t,n){const C=v("el-input"),m=v("el-switch"),d=v("el-slider"),y=v("PresetsList"),M=v("el-button"),I=v("el-dialog");return a(),r("div",F,[e("div",E,[e("div",G,[e("div",J,[e("div",Q,[e("img",{src:t.activeContactor.avatar},null,8,W)]),e("div",X,[e("div",Y,f(t.activeContactor.name),1),e("div",Z,"ID "+f(t.activeContactor.id),1),e("div",$,[e("span",{class:b("delay-status "+n.getDelayStatus)},null,2),h(" 在线 ")])])]),e("div",ee,[t.activeContactor.platform=="openai"?(a(),r("div",te,[se,e("div",oe,[(a(!0),r(k,null,D(t.openaiSettings,(l,i)=>(a(),r("div",{key:i,class:"block-content-item"},[e("div",ne,f(n.getShownKey(i)),1),e("div",ie,[["model","max_messages_num"].includes(i)?(a(),S(C,{key:0,onChange:n.updateOpenaiOptions,modelValue:t.openaiSettings[i],"onUpdate:modelValue":p=>t.openaiSettings[i]=p},null,8,["onChange","modelValue","onUpdate:modelValue"])):["stream","enable_tool_call"].includes(i)?(a(),S(m,{key:1,onChange:n.updateOpenaiOptions,modelValue:t.openaiSettings[i],"onUpdate:modelValue":p=>t.openaiSettings[i]=p},null,8,["onChange","modelValue","onUpdate:modelValue"])):["top_p","temperature"].includes(i)?(a(),S(d,{key:2,onChange:n.updateOpenaiOptions,modelValue:t.openaiSettings[i],"onUpdate:modelValue":p=>t.openaiSettings[i]=p,step:t.sliderTypeARange[2],min:t.sliderTypeARange[0],max:t.sliderTypeARange[1]},null,8,["onChange","modelValue","onUpdate:modelValue","step","min","max"])):["frequency_penalty","presence_penalty"].includes(i)?(a(),S(d,{key:3,onChange:n.updateOpenaiOptions,modelValue:t.openaiSettings[i],"onUpdate:modelValue":p=>t.openaiSettings[i]=p,step:t.sliderTypeBRange[2],min:t.sliderTypeBRange[0],max:t.sliderTypeBRange[1]},null,8,["onChange","modelValue","onUpdate:modelValue","step","min","max"])):P("",!0)])]))),128))]),ae,e("div",le,[e("div",re,[ce,e("div",de,[e("button",{class:b({active:t.showPresetsDetail,"extra-info-button":!0}),onClick:s[0]||(s[0]=l=>t.showPresetsDetail=!t.showPresetsDetail)},ue,2)])]),e("div",{class:b({hidden:!t.showPresetsDetail,"block-content-item":!0})},[c(y,{onUpdatePresetsHistory:n.updateOpenaiPresets,presetsHistory:t.presetHistory},null,8,["onUpdatePresetsHistory","presetsHistory"])],2)]),_e,e("div",he,[e("div",me,[ge,e("div",ve,[e("button",{class:b({active:t.showToolsDetail,"extra-info-button":!0}),onClick:s[1]||(s[1]=l=>t.showToolsDetail=!t.showToolsDetail)},fe,2)])]),e("div",{class:b({hidden:!t.showToolsDetail,"block-content-item":!0})},[e("ul",Ce,[(a(!0),r(k,null,D(t.toolsList,(l,i)=>(a(),r("li",{class:"block-content-item",title:l.description,key:i},[e("div",we,f(l.name),1),e("div",Ve,[c(m,{onChange:n.handleToolConfig,modelValue:l.enabled,"onUpdate:modelValue":p=>l.enabled=p},null,8,["onChange","modelValue","onUpdate:modelValue"])])],8,be))),128))])],2)])])):P("",!0)]),Me])]),e("div",Se,[c(M,{onClick:s[2]||(s[2]=l=>o.$router.push(`/chat/${t.activeContactor.id}`)),type:"primary"},{default:u(()=>[h("发送消息")]),_:1}),c(M,{onClick:s[3]||(s[3]=l=>t.centerDialogVisible=!0),type:"danger"},{default:u(()=>[h("删除好友")]),_:1}),c(I,{modelValue:t.centerDialogVisible,"onUpdate:modelValue":s[5]||(s[5]=l=>t.centerDialogVisible=l),title:"警告",width:"300",center:""},{footer:u(()=>[e("div",De,[c(M,{onClick:s[4]||(s[4]=l=>t.centerDialogVisible=!1)},{default:u(()=>[h("取消")]),_:1}),c(M,{type:"primary",onClick:n.delContactor},{default:u(()=>[h(" 确认 ")]),_:1},8,["onClick"])])]),default:u(()=>[ke]),_:1},8,["modelValue"])])])}const Ie=T(K,[["render",Pe],["__scopeId","data-v-788042c3"]]);export{Ie as default};
